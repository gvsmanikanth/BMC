if( window.jstz === undefined) {
(function(e){var t=function(){"use strict";var e="s",n=2011,r=function(e){var t=-e.getTimezoneOffset();return t!==null?t:0},i=function(e,t,n){var r=new Date;return e!==undefined&&r.setFullYear(e),r.setDate(n),r.setMonth(t),r},s=function(e){return r(i(e,0,2))},o=function(e){return r(i(e,5,2))},u=function(e){var t=e.getMonth()>7?o(e.getFullYear()):s(e.getFullYear()),n=r(e);return t-n!==0},a=function(){var t=s(n),r=o(n),i=t-r;return i<0?t+",1":i>0?r+",1,"+e:t+",0"},f=function(){var e=a();return new t.TimeZone(t.olson.timezones[e])},l=function(e){var t=new Date(2010,6,15,1,0,0,0),n={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,10,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":t,"Asia/Yekaterinburg":t,"Asia/Omsk":t,"Asia/Krasnoyarsk":t,"Asia/Irkutsk":t,"Asia/Yakutsk":t,"Asia/Vladivostok":t,"Asia/Kamchatka":t,"Europe/Minsk":t,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return n[e]};return{determine:f,date_is_dst:u,dst_start_for:l}}();t.TimeZone=function(e){"use strict";var n={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Pacific/Tongatapu":["Pacific/Apia"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},r=e,i=function(){var e=n[r],i=e.length,s=0,o=e[0];for(;s<i;s+=1){o=e[s];if(t.date_is_dst(t.dst_start_for(o))){r=o;return}}},s=function(){return typeof n[r]!="undefined"};return s()&&i(),{name:function(){return r}}},t.olson={},t.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},typeof exports!="undefined"?exports.jstz=t:e.jstz=t})(this);
}
if( window.Coveo === undefined) {
/*! jQuery v1.9.1 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery.min.map
*/(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p="1.9.1",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,E=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,j=/^-ms-/,D=/-([\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(o.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===b.type(e)},isArray:Array.isArray||function(e){return"array"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,"@").replace(A,"]").replace(E,"")))?Function("return "+n)():(b.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,"ms-").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call("\ufeff\u00a0")?function(e){return null==e?"":v.call(e)}:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if("object"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),"complete"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{o.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e="string"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);"function"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*"),r=d.getElementsByTagName("a")[0],!n||!r||!n.length)return{};s=o.createElement("select"),l=s.appendChild(o.createElement("option")),a=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip,b(function(){var n,r,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=d.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(o.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)}),n=s=u=l=r=a=null,t}();var O=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u="string"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),("object"==typeof n||"function"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(" "));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,"parsedAttrs"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(B,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if(("data"!==t||!b.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),o.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=b._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\t\r\n]/g,U=/\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u="string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?b.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?"addClass":"removeClass"](o)}else(n===i||"boolean"===n)&&(this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o="":"number"==typeof o?o+="":b.isArray(o)&&(o=b.map(o,function(e){return null==e?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(U,""):null==n?"":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&b.nodeName(n.parentNode,"optgroup"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&"get"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&"set"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&"radio"===t&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),o="boolean"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,"input")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,""===t?!1:t,n)}},b.each(["width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(w)||[""],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,"events"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),u=0>g.indexOf(":")&&"on"+g,n=n[b.expando]?n:new b.Event(g,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,"events")||{})[n.type]&&b._data(l,"handle"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||"click"===g&&b.nodeName(i,"a")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,"events")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;
return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,"form")?!1:(b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,"form")?!1:(b.event.remove(this,"._submit"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(b.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)})),!1):(b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x="sizzle"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=F.replace("w","w#"),B="([*^$|!~]?=)",P="\\["+_+"*("+F+")"+_+"*(?:"+B+_+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+O+")|)|)"+_+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+P.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),$=RegExp("^"+_+"*,"+_+"*"),I=RegExp("^"+_+"*([\\x20\\t\\r\\n\\f>+~])"+_+"*"),z=RegExp(R),X=RegExp("^"+O+"$"),U={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),NAME:RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:RegExp("^("+F.replace("w","w*")+")"),ATTR:RegExp("^"+P),PSEUDO:RegExp("^"+R),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),needsContext:RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},V=/[\x20\t\r\n\f]*[+~]/,Y=/^[^{]+\{\s*\[native code/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute("id"))?g=f.replace(K,"\\$&"):t.setAttribute("id",g),g="[id='"+g+"'] ",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(",")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute("id")}}}return wt(e.replace(W,"$1"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),T.attributes=at(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),T.getByClassName=at(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[":focus"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+_+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||h.push(":checked")}),at(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&h.push("[*^$]="+_+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||h.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),h.push(",.*:")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",R)}),h=RegExp(h.join("|")),g=RegExp(g.join("|")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,"='$1']"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+" "];return t||(t=RegExp("(^|"+_+")"+e+"("+_+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[x]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,"$1"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W," ")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&"parentNode"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+" "+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,"$1"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG("*",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&"ID"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[":"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\[\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||"string"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?"string"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(o),Dt=jt.appendChild(o.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||"string"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||"string"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,"tr"),s=b.map(Ot(l,"script"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,"script"))),r.call(n&&b.nodeName(this[c],"table")?Lt(this[c],"tbody"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(St,"")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,"script"),r.length>0&&Mt(r,!u&&Ot(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),u=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o="table"!==u||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],"tbody")&&!l.childNodes.length&&o.removeChild(l)
}b.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),"script"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+x+")(.*)$","i"),Yt=RegExp("^("+x+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+x+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===b.css(e,"display")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=b._data(r,"olddisplay",un(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||b.cssNumber[u]||(r+="px"),b.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(""!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left="fontSize"===n?"1em":u,u=l.pixelLeft+"px",l.left=i,a&&(o.left=a)),""===u?"auto":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=b.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=b.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=b.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=b.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),"none"!==n&&n||(Pt=(Pt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}b.each(["height","width"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===b.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+"px":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||b.css(e,"display"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==b.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=a.href}catch(Ln){yn=o.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return"string"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o["*"]&&s("*")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(" ");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&b.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks("once memory"),m=p.statusCode||{},y={},v={},x=0,T="canceled",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||"*").toLowerCase().match(w)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?80:443))==(mn[3]||("http:"===mn[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader("If-Modified-Since",b.lastModified[o]),b.etag[o]&&N.setRequestHeader("If-None-Match",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader("Content-Type",p.contentType),N.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T="abort";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger("ajaxSend",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort("timeout")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||"",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader("Last-Modified"),T&&(b.lastModified[o]=T),T=N.getResponseHeader("etag"),T&&(b.etag[o]=T)),204===e?(c=!0,C="nocontent"):304===e?(c=!0,C="notmodified"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+"",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?"ajaxSuccess":"ajaxError",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger("ajaxComplete",[N,p]),--b.active||b.event.trigger("ajaxStop")))}return N},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while("*"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+" "+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if("*"!==r){if("*"!==l&&l!==r){if(i=a[l+" "+r]||a["* "+r],!i)for(n in a)if(o=n.split(" "),o[1]===r&&(i=a[l+" "+o[0]]||a["* "+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+l+" to "+r}}}l=r}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||b("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=On.pop()||b.expando+"_"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||b.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&"withCredentials"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),"string"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+x+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?"":"px"),"px"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||".5",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn["*"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&"expand"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===b.css(e,"display")&&"none"===b.css(e,"float")&&(b.support.inlineBlockNeedsLayout&&"inline"!==un(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||"toggle"===a,a===(m?"hide":"show"))continue;g.push(i)}if(o=g.length){s=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,"fxshow");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");"static"===r&&(e.style.position="relative");var i=b(e),o=i.offset(),a=b.css(e,"top"),s=b.css(e,"left"),u=("absolute"===r||"fixed"===r)&&b.inArray("auto",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),"using"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===b.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,"html")&&"static"===b.css(e,"position"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return b})})(window);
}
if( window._ === undefined) {
//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);
}
if( window.Globalize === undefined) {
/*! globalize - v0.1.1 - 2013-04-30
* https://github.com/jquery/globalize
* Copyright 2013 ; Licensed MIT */
var Globalize = (function(e,r){var t,n,a,s,u,l,i,c,o,f,d,p,h,g,b,m,y,M,v,k,z,F,A,x;t=function(e){return new t.prototype.init(e)},"undefined"!=typeof require&&"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=t:e.Globalize=t,t.cultures={},t.prototype={constructor:t,init:function(e){return this.cultures=t.cultures,this.cultureSelector=e,this}},t.prototype.init.prototype=t.prototype,t.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},t.cultures["default"].calendar=t.cultures["default"].calendars.standard,t.cultures.en=t.cultures["default"],t.cultureSelector="en",n=/^0x[a-f0-9]+$/i,a=/^[+\-]?infinity$/i,s=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,u=/^\s+|\s+$/g,l=function(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0,n=e.length;n>t;t++)if(e[t]===r)return t;return-1},i=function(e,r){return e.substr(e.length-r.length)===r},c=function(){var e,t,n,a,s,u,l=arguments[0]||{},i=1,p=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[1]||{},i=2),"object"==typeof l||f(l)||(l={});p>i;i++)if(null!=(e=arguments[i]))for(t in e)n=l[t],a=e[t],l!==a&&(h&&a&&(d(a)||(s=o(a)))?(s?(s=!1,u=n&&o(n)?n:[]):u=n&&d(n)?n:{},l[t]=c(h,u,a)):a!==r&&(l[t]=a));return l},o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},f=function(e){return"[object Function]"===Object.prototype.toString.call(e)},d=function(e){return"[object Object]"===Object.prototype.toString.call(e)},p=function(e,r){return 0===e.indexOf(r)},h=function(e){return(e+"").replace(u,"")},g=function(e){return isNaN(e)?0/0:Math[0>e?"ceil":"floor"](e)},b=function(e,r,t){var n;for(n=e.length;r>n;n+=1)e=t?"0"+e:e+"0";return e},m=function(e,r){for(var t=0,n=!1,a=0,s=e.length;s>a;a++){var u=e.charAt(a);switch(u){case"'":n?r.push("'"):t++,n=!1;break;case"\\":n&&r.push("\\"),n=!n;break;default:r.push(u),n=!1}}return t},y=function(e,r){r=r||"F";var t,n=e.patterns,a=r.length;if(1===a){if(t=n[r],!t)throw"Invalid date format string '"+r+"'.";r=t}else 2===a&&"%"===r.charAt(0)&&(r=r.charAt(1));return r},M=function(e,r,t){function n(e,r){var t,n=e+"";return r>1&&r>n.length?(t=v[r-2]+n,t.substr(t.length-r,r)):t=n}function a(){return h||g?h:(h=A.test(r),g=!0,h)}function s(e,r){if(b)return b[r];switch(r){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw"Invalid part value "+r}}var u,l=t.calendar,i=l.convert;if(!r||!r.length||"i"===r){if(t&&t.name.length)if(i)u=M(e,l.patterns.F,t);else{var c=new Date(e.getTime()),o=z(e,l.eras);c.setFullYear(F(e,l,o)),u=c.toLocaleString()}else u=""+e;return u}var f=l.eras,d="s"===r;r=y(l,r),u=[];var p,h,g,b,v=["0","00","000"],A=/([^d]|^)(d|dd)([^d]|$)/g,x=0,I=k();for(!d&&i&&(b=i.fromGregorian(e));;){var S=I.lastIndex,w=I.exec(r),C=r.slice(S,w?w.index:r.length);if(x+=m(C,u),!w)break;if(x%2)u.push(w[0]);else{var D=w[0],H=D.length;switch(D){case"ddd":case"dddd":var O=3===H?l.days.namesAbbr:l.days.names;u.push(O[e.getDay()]);break;case"d":case"dd":h=!0,u.push(n(s(e,2),H));break;case"MMM":case"MMMM":var N=s(e,1);u.push(l.monthsGenitive&&a()?l.monthsGenitive[3===H?"namesAbbr":"names"][N]:l.months[3===H?"namesAbbr":"names"][N]);break;case"M":case"MM":u.push(n(s(e,1)+1,H));break;case"y":case"yy":case"yyyy":N=b?b[0]:F(e,l,z(e,f),d),4>H&&(N%=100),u.push(n(N,H));break;case"h":case"hh":p=e.getHours()%12,0===p&&(p=12),u.push(n(p,H));break;case"H":case"HH":u.push(n(e.getHours(),H));break;case"m":case"mm":u.push(n(e.getMinutes(),H));break;case"s":case"ss":u.push(n(e.getSeconds(),H));break;case"t":case"tt":N=12>e.getHours()?l.AM?l.AM[0]:" ":l.PM?l.PM[0]:" ",u.push(1===H?N.charAt(0):N);break;case"f":case"ff":case"fff":u.push(n(e.getMilliseconds(),3).substr(0,H));break;case"z":case"zz":p=e.getTimezoneOffset()/60,u.push((0>=p?"+":"-")+n(Math.floor(Math.abs(p)),H));break;case"zzz":p=e.getTimezoneOffset()/60,u.push((0>=p?"+":"-")+n(Math.floor(Math.abs(p)),2)+":"+n(Math.abs(e.getTimezoneOffset()%60),2));break;case"g":case"gg":l.eras&&u.push(l.eras[z(e,f)].name);break;case"/":u.push(l["/"]);break;default:throw"Invalid date format pattern '"+D+"'."}}}return u.join("")},function(){var e;e=function(e,r,t){var n=t.groupSizes,a=n[0],s=1,u=Math.pow(10,r),l=Math.round(e*u)/u;isFinite(l)||(l=e),e=l;var i=e+"",c="",o=i.split(/e/i),f=o.length>1?parseInt(o[1],10):0;i=o[0],o=i.split("."),i=o[0],c=o.length>1?o[1]:"",f>0?(c=b(c,f,!1),i+=c.slice(0,f),c=c.substr(f)):0>f&&(f=-f,i=b(i,f+1,!0),c=i.slice(-f,i.length)+c,i=i.slice(0,-f)),c=r>0?t["."]+(c.length>r?c.slice(0,r):b(c,r)):"";for(var d=i.length-1,p=t[","],h="";d>=0;){if(0===a||a>d)return i.slice(0,d+1)+(h.length?p+h+c:c);h=i.slice(d-a+1,d+1)+(h.length?p+h:""),d-=a,n.length>s&&(a=n[s],s++)}return i.slice(0,d+1)+p+h+c},v=function(r,t,n){if(!isFinite(r))return 1/0===r?n.numberFormat.positiveInfinity:r===-1/0?n.numberFormat.negativeInfinity:n.numberFormat.NaN;if(!t||"i"===t)return n.name.length?r.toLocaleString():""+r;t=t||"D";var a,s=n.numberFormat,u=Math.abs(r),l=-1;t.length>1&&(l=parseInt(t.slice(1),10));var i,c=t.charAt(0).toUpperCase();switch(c){case"D":a="n",u=g(u),-1!==l&&(u=b(""+u,l,!0)),0>r&&(u="-"+u);break;case"N":i=s;case"C":i=i||s.currency;case"P":i=i||s.percent,a=0>r?i.pattern[0]:i.pattern[1]||"n",-1===l&&(l=i.decimals),u=e(u*("P"===c?100:1),l,i);break;default:throw"Bad number format specifier: "+c}for(var o=/n|\$|-|%/g,f="";;){var d=o.lastIndex,p=o.exec(a);if(f+=a.slice(d,p?p.index:a.length),!p)break;switch(p[0]){case"n":f+=u;break;case"$":f+=s.currency.symbol;break;case"-":/[1-9]/.test(u)&&(f+=s["-"]);break;case"%":f+=s.percent.symbol}}return f}}(),k=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},z=function(e,r){if(!r)return 0;for(var t,n=e.getTime(),a=0,s=r.length;s>a;a++)if(t=r[a].start,null===t||n>=t)return a;return 0},F=function(e,r,t,n){var a=e.getFullYear();return!n&&r.eras&&(a-=r.eras[t].offset),a},function(){var e,r,t,n,a,s,u;e=function(e,r){if(100>r){var t=new Date,n=z(t),a=F(t,e,n),s=e.twoDigitYearMax;s="string"==typeof s?(new Date).getFullYear()%100+parseInt(s,10):s,r+=a-a%100,r>s&&(r-=100)}return r},r=function(e,r,t){var n,a=e.days,i=e._upperDays;return i||(e._upperDays=i=[u(a.names),u(a.namesAbbr),u(a.namesShort)]),r=s(r),t?(n=l(i[1],r),-1===n&&(n=l(i[2],r))):n=l(i[0],r),n},t=function(e,r,t){var n=e.months,a=e.monthsGenitive||e.months,i=e._upperMonths,c=e._upperMonthsGen;i||(e._upperMonths=i=[u(n.names),u(n.namesAbbr)],e._upperMonthsGen=c=[u(a.names),u(a.namesAbbr)]),r=s(r);var o=l(t?i[1]:i[0],r);return 0>o&&(o=l(t?c[1]:c[0],r)),o},n=function(e,r){var t=e._parseRegExp;if(t){var n=t[r];if(n)return n}else e._parseRegExp=t={};for(var a,s=y(e,r).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),u=["^"],l=[],i=0,c=0,o=k();null!==(a=o.exec(s));){var f=s.slice(i,a.index);if(i=o.lastIndex,c+=m(f,u),c%2)u.push(a[0]);else{var d,p=a[0],h=p.length;switch(p){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":d="(\\D+)";break;case"tt":case"t":d="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":d="(\\d{"+h+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":d="(\\d\\d?)";break;case"zzz":d="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":d="([+-]?\\d\\d?)";break;case"/":d="(\\/)";break;default:throw"Invalid date format pattern '"+p+"'."}d&&u.push(d),l.push(a[0])}}m(s.slice(i),u),u.push("$");var g=u.join("").replace(/\s+/g,"\\s+"),b={regExp:g,groups:l};return t[r]=b},a=function(e,r,t){return r>e||e>t},s=function(e){return e.split("\u00a0").join(" ").toUpperCase()},u=function(e){for(var r=[],t=0,n=e.length;n>t;t++)r[t]=s(e[t]);return r},A=function(s,u,l){s=h(s);var i=l.calendar,c=n(i,u),o=RegExp(c.regExp).exec(s);if(null===o)return null;for(var f,d=c.groups,g=null,b=null,m=null,y=null,M=null,v=0,k=0,z=0,F=0,A=null,x=!1,I=0,S=d.length;S>I;I++){var w=o[I+1];if(w){var C=d[I],D=C.length,H=parseInt(w,10);switch(C){case"dd":case"d":if(y=H,a(y,1,31))return null;break;case"MMM":case"MMMM":if(m=t(i,w,3===D),a(m,0,11))return null;break;case"M":case"MM":if(m=H-1,a(m,0,11))return null;break;case"y":case"yy":case"yyyy":if(b=4>D?e(i,H):H,a(b,0,9999))return null;break;case"h":case"hh":if(v=H,12===v&&(v=0),a(v,0,11))return null;break;case"H":case"HH":if(v=H,a(v,0,23))return null;break;case"m":case"mm":if(k=H,a(k,0,59))return null;break;case"s":case"ss":if(z=H,a(z,0,59))return null;break;case"tt":case"t":if(x=i.PM&&(w===i.PM[0]||w===i.PM[1]||w===i.PM[2]),!x&&(!i.AM||w!==i.AM[0]&&w!==i.AM[1]&&w!==i.AM[2]))return null;break;case"f":case"ff":case"fff":if(F=H*Math.pow(10,3-D),a(F,0,999))return null;break;case"ddd":case"dddd":if(M=r(i,w,3===D),a(M,0,6))return null;break;case"zzz":var O=w.split(/:/);if(2!==O.length)return null;if(f=parseInt(O[0],10),a(f,-12,13))return null;var N=parseInt(O[1],10);if(a(N,0,59))return null;A=60*f+(p(w,"-")?-N:N);break;case"z":case"zz":if(f=H,a(f,-12,13))return null;A=60*f;break;case"g":case"gg":var T=w;if(!T||!i.eras)return null;T=h(T.toLowerCase());for(var j=0,$=i.eras.length;$>j;j++)if(T===i.eras[j].name.toLowerCase()){g=j;break}if(null===g)return null}}}var P,G=new Date,E=i.convert;if(P=E?E.fromGregorian(G)[0]:G.getFullYear(),null===b?b=P:i.eras&&(b+=i.eras[g||0].offset),null===m&&(m=0),null===y&&(y=1),E){if(G=E.toGregorian(b,m,y),null===G)return null}else{if(G.setFullYear(b,m,y),G.getDate()!==y)return null;if(null!==M&&G.getDay()!==M)return null}if(x&&12>v&&(v+=12),G.setHours(v,k,z,F),null!==A){var Y=G.getMinutes()-(A+G.getTimezoneOffset());G.setHours(G.getHours()+parseInt(Y/60,10),Y%60)}return G}}(),x=function(e,r,t){var n,a=r["-"],s=r["+"];switch(t){case"n -":a=" "+a,s=" "+s;case"n-":i(e,a)?n=["-",e.substr(0,e.length-a.length)]:i(e,s)&&(n=["+",e.substr(0,e.length-s.length)]);break;case"- n":a+=" ",s+=" ";case"-n":p(e,a)?n=["-",e.substr(a.length)]:p(e,s)&&(n=["+",e.substr(s.length)]);break;case"(n)":p(e,"(")&&i(e,")")&&(n=["-",e.substr(1,e.length-2)])}return n||["",e]},t.prototype.findClosestCulture=function(e){return t.findClosestCulture.call(this,e)},t.prototype.format=function(e,r,n){return t.format.call(this,e,r,n)},t.prototype.localize=function(e,r){return t.localize.call(this,e,r)},t.prototype.parseInt=function(e,r,n){return t.parseInt.call(this,e,r,n)},t.prototype.parseFloat=function(e,r,n){return t.parseFloat.call(this,e,r,n)},t.prototype.culture=function(e){return t.culture.call(this,e)},t.addCultureInfo=function(e,r,t){var n={},a=!1;"string"!=typeof e?(t=e,e=this.culture().name,n=this.cultures[e]):"string"!=typeof r?(t=r,a=null==this.cultures[e],n=this.cultures[e]||this.cultures["default"]):(a=!0,n=this.cultures[r]),this.cultures[e]=c(!0,{},n,t),a&&(this.cultures[e].calendar=this.cultures[e].calendars.standard)},t.findClosestCulture=function(e){var r;if(!e)return this.findClosestCulture(this.cultureSelector)||this.cultures["default"];if("string"==typeof e&&(e=e.split(",")),o(e)){var t,n,a=this.cultures,s=e,u=s.length,l=[];for(n=0;u>n;n++){e=h(s[n]);var i,c=e.split(";");t=h(c[0]),1===c.length?i=1:(e=h(c[1]),0===e.indexOf("q=")?(e=e.substr(2),i=parseFloat(e),i=isNaN(i)?0:i):i=1),l.push({lang:t,pri:i})}for(l.sort(function(e,r){return e.pri<r.pri?1:e.pri>r.pri?-1:0}),n=0;u>n;n++)if(t=l[n].lang,r=a[t])return r;for(n=0;u>n;n++)for(t=l[n].lang;;){var f=t.lastIndexOf("-");if(-1===f)break;if(t=t.substr(0,f),r=a[t])return r}for(n=0;u>n;n++){t=l[n].lang;for(var d in a){var p=a[d];if(p.language===t)return p}}}else if("object"==typeof e)return e;return r||null},t.format=function(e,r,t){var n=this.findClosestCulture(t);return e instanceof Date?e=M(e,r,n):"number"==typeof e&&(e=v(e,r,n)),e},t.localize=function(e,r){return this.findClosestCulture(r).messages[e]||this.cultures["default"].messages[e]},t.parseDate=function(e,r,t){t=this.findClosestCulture(t);var n,a,s;if(r){if("string"==typeof r&&(r=[r]),r.length)for(var u=0,l=r.length;l>u;u++){var i=r[u];if(i&&(n=A(e,i,t)))break}}else{s=t.calendar.patterns;for(a in s)if(n=A(e,s[a],t))break}return n||null},t.parseInt=function(e,r,n){return g(t.parseFloat(e,r,n))},t.parseFloat=function(e,r,t){"number"!=typeof r&&(t=r,r=10);var u=this.findClosestCulture(t),l=0/0,i=u.numberFormat;if(e.indexOf(u.numberFormat.currency.symbol)>-1&&(e=e.replace(u.numberFormat.currency.symbol,""),e=e.replace(u.numberFormat.currency["."],u.numberFormat["."])),e.indexOf(u.numberFormat.percent.symbol)>-1&&(e=e.replace(u.numberFormat.percent.symbol,"")),e=e.replace(/ /g,""),a.test(e))l=parseFloat(e);else if(!r&&n.test(e))l=parseInt(e,16);else{var c=x(e,i,i.pattern[0]),o=c[0],f=c[1];""===o&&"(n)"!==i.pattern[0]&&(c=x(e,i,"(n)"),o=c[0],f=c[1]),""===o&&"-n"!==i.pattern[0]&&(c=x(e,i,"-n"),o=c[0],f=c[1]),o=o||"+";var d,p,h=f.indexOf("e");0>h&&(h=f.indexOf("E")),0>h?(p=f,d=null):(p=f.substr(0,h),d=f.substr(h+1));var g,b,m=i["."],y=p.indexOf(m);0>y?(g=p,b=null):(g=p.substr(0,y),b=p.substr(y+m.length));var M=i[","];g=g.split(M).join("");var v=M.replace(/\u00A0/g," ");M!==v&&(g=g.split(v).join(""));var k=o+g;if(null!==b&&(k+="."+b),null!==d){var z=x(d,i,"-n");k+="e"+(z[0]||"+")+z[1]}s.test(k)&&(l=parseFloat(k))}return l},t.culture=function(e){return e!==r&&(this.cultureSelector=e),this.findClosestCulture(e)||this.cultures["default"]}; return Globalize;}(this));
}
if( window.Coveo === undefined) {
!function(){"use strict";var t,e,n="undefined",r="string",i=self.navigator,o=String,a=Object.prototype.hasOwnProperty,l={},u={},s=!1,f=!0,c=/^\s*application\/(?:vnd\.oftn\.|x-)?l10n\+json\s*(?:$|;)/i,p="locale",g="defaultLocale",h="toLocaleString",y="toLowerCase",v=Array.prototype.indexOf||function(t){for(var e=this.length,n=0;e>n;n++)if(n in this&&this[n]===t)return n;return-1},d=function(e){var n=new t;return n.open("GET",e,s),n.send(null),200!==n.status?(setTimeout(function(){var t=new Error("Unable to load localization data: "+e);throw t.name="Localization Error",t},0),{}):JSON.parse(n.responseText)},m=o[h]=function(t){if(arguments.length>0&&"number"!=typeof t)if(typeof t===r)m(d(t));else if(t===s)u={};else{var e,n,i;for(e in t)if(a.call(t,e)){if(n=t[e],e=e[y](),e in u&&n!==s||(u[e]={}),n===s)continue;if(typeof n===r){if(0!==o[p][y]().indexOf(e)){e in l||(l[e]=[]),l[e].push(n);continue}n=d(n)}for(i in n)a.call(n,i)&&(u[e][i]=n[i])}}return Function.prototype[h].apply(o,arguments)},w=function(t){for(var e,n=l[t],r=0,i=n.length;i>r;r++)e={},e[t]=d(n[r]),m(e);delete l[t]},b=o.prototype[h]=function(){var t,n=e,r=o[n?g:p],i=r[y]().split("-"),a=i.length,c=this.valueOf();e=s;do if(t=i.slice(0,a).join("-"),t in l&&w(t),t in u&&c in u[t])return u[t][c];while(a-->1);return!n&&o[g]?(e=f,b.call(c)):c};if(typeof XMLHttpRequest===n&&typeof ActiveXObject!==n){var L=ActiveXObject;t=function(){try{return new L("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new L("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new L("Msxml2.XMLHTTP")}catch(n){}throw new Error("XMLHttpRequest not supported by this browser.")}}else t=XMLHttpRequest;if(o[g]=o[g]||"",o[p]=i&&(i.language||i.userLanguage)||"",typeof document!==n)for(var T,M=document.getElementsByTagName("link"),O=M.length;O--;){var X=M[O],x=(X.getAttribute("rel")||"")[y]().split(/\s+/);c.test(X.type)&&(-1!==v.call(x,"localizations")?m(X.getAttribute("href")):-1!==v.call(x,"localization")&&(T={},T[(X.getAttribute("hreflang")||"")[y]()]=X.getAttribute("href"),m(T)))}}();
}
if( window.$.jsonp === undefined) {
// jquery.jsonp 2.4.0 (c)2012 Julian Aubourg | MIT License
// https://github.com/jaubourg/jquery-jsonp
(function(e){function t(){}function n(e){C=[e]}function r(e,t,n){return e&&e.apply&&e.apply(t.context||t,n)}function i(e){return/\?/.test(e)?"&":"?"}function O(c){function Y(e){z++||(W(),j&&(T[I]={s:[e]}),D&&(e=D.apply(c,[e])),r(O,c,[e,b,c]),r(_,c,[c,b]))}function Z(e){z++||(W(),j&&e!=w&&(T[I]=e),r(M,c,[c,e]),r(_,c,[c,e]))}c=e.extend({},k,c);var O=c.success,M=c.error,_=c.complete,D=c.dataFilter,P=c.callbackParameter,H=c.callback,B=c.cache,j=c.pageCache,F=c.charset,I=c.url,q=c.data,R=c.timeout,U,z=0,W=t,X,V,J,K,Q,G;return S&&S(function(e){e.done(O).fail(M),O=e.resolve,M=e.reject}).promise(c),c.abort=function(){!(z++)&&W()},r(c.beforeSend,c,[c])===!1||z?c:(I=I||u,q=q?typeof q=="string"?q:e.param(q,c.traditional):u,I+=q?i(I)+q:u,P&&(I+=i(I)+encodeURIComponent(P)+"=?"),!B&&!j&&(I+=i(I)+"_"+(new Date).getTime()+"="),I=I.replace(/=\?(&|$)/,"="+H+"$1"),j&&(U=T[I])?U.s?Y(U.s[0]):Z(U):(E[H]=n,K=e(y)[0],K.id=l+N++,F&&(K[o]=F),L&&L.version()<11.6?(Q=e(y)[0]).text="document.getElementById('"+K.id+"')."+p+"()":K[s]=s,A&&(K.htmlFor=K.id,K.event=h),K[d]=K[p]=K[v]=function(e){if(!K[m]||!/i/.test(K[m])){try{K[h]&&K[h]()}catch(t){}e=C,C=0,e?Y(e[0]):Z(a)}},K.src=I,W=function(e){G&&clearTimeout(G),K[v]=K[d]=K[p]=null,x[g](K),Q&&x[g](Q)},x[f](K,J=x.firstChild),Q&&x[f](Q,J),G=R>0&&setTimeout(function(){Z(w)},R)),c)}var s="async",o="charset",u="",a="error",f="insertBefore",l="_jqjsp",c="on",h=c+"click",p=c+a,d=c+"load",v=c+"readystatechange",m="readyState",g="removeChild",y="<script>",b="success",w="timeout",E=window,S=e.Deferred,x=e("head")[0]||document.documentElement,T={},N=0,C,k={callback:l,url:location.href},L=E.opera,A=!!e("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;O.setup=function(t){e.extend(k,t)},e.jsonp=O})(jQuery)
}
if( window.Coveo === undefined || window.Coveo['ModalBox'] === undefined) {
var Coveo;!function(o){var e;!function(e){function n(e,n){void 0===n&&(n={});var a=n.body||document.body;o.$(a).addClass("coveo-modalBox-opened");var l=o.$('<div class="coveo-modalBox" />').appendTo(a);n.fullscreen===!0&&l.addClass("coveo-fullscreen");var c=o.$('<div class="coveo-overlay" />').appendTo(l),d=o.$('<div class="coveo-wrapper" />').appendTo(l);if(null!=n.title){var v=o.$('<div class="coveo-title" />').appendTo(d);n.title instanceof o.$?v.append(n.title):v.html(n.title),n.titleClose===!0&&v.click(function(){return s()})}e.length>1&&(e=o.$("<div />").append(e)),d.append(e.addClass("coveo-body"));var i,s=function(e,c){void 0===e&&(e=0),void 0===c&&(c=!1);var d=null==n.validation||n.validation(e);if(d!==!1||c){l.detach();var v=o.$.inArray(s,t);return v>=0&&t.splice(v,1),0==o.$(a).find(".coveo-modalBox").length&&o.$(a).removeClass("coveo-modalBox-opened"),!0}return!1};if(null!=n.buttons){var r=function(o){return function(){return s(o)}};i=o.$('<div class="coveo-buttons" />').appendTo(d),1&n.buttons&&o.$('<div class="coveo-button">Ok</div>').click(r(1)).appendTo(i),2&n.buttons&&o.$('<div class="coveo-button">Apply</div>').click(r(2)).appendTo(i),4&n.buttons&&o.$('<div class="coveo-button">Yes</div>').click(r(4)).appendTo(i),8&n.buttons&&o.$('<div class="coveo-button">No</div>').click(r(8)).appendTo(i),16&n.buttons&&o.$('<div class="coveo-button">Cancel</div>').click(r(16)).appendTo(i)}return t.push(s),n.overlayClose===!0&&c.click(function(){return s()}),null!=n.className&&l.addClass(n.className),{modalBox:l,overlay:c,wrapper:d,buttons:i,content:e,close:s}}function a(o){void 0===o&&(o=!1);for(var e=0;t.length>e;){var n=t[e](0,o);n||e++}}!function(o){o[o.OK=1]="OK",o[o.APPLY=2]="APPLY",o[o.YES=4]="YES",o[o.NO=8]="NO",o[o.CANCEL=16]="CANCEL"}(e.BUTTON||(e.BUTTON={}));var t=(e.BUTTON,[]);e.open=n,e.close=a}(e=o.ModalBox||(o.ModalBox={}))}(Coveo||(Coveo={}));
}
if( window.fastclick === undefined) {
!function(){"use strict";function t(e,o){function i(t,e){return function(){return t.apply(e,arguments)}}var r;if(o=o||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=o.touchBoundary||10,this.layer=e,this.tapDelay=o.tapDelay||200,this.tapTimeout=o.tapTimeout||700,!t.notNeeded(e)){for(var a=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],c=this,s=0,u=a.length;u>s;s++)c[a[s]]=i(c[a[s]],c);n&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,o){var i=Node.prototype.removeEventListener;"click"===t?i.call(e,t,n.hijacked||n,o):i.call(e,t,n,o)},e.addEventListener=function(t,n,o){var i=Node.prototype.addEventListener;"click"===t?i.call(e,t,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),o):i.call(e,t,n,o)}),"function"==typeof e.onclick&&(r=e.onclick,e.addEventListener("click",function(t){r(t)},!1),e.onclick=null)}}var e=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!e,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,i=o&&/OS 4_\d(_\d)?/.test(navigator.userAgent),r=o&&/OS [6-7]_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(o&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var n,o;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),o=e.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},t.prototype.determineEventType=function(t){return n&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(t){var e;o&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,n;if(e=t.fastClickScrollParent,!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,n,r;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],o){if(r=window.getSelection(),r.rangeCount&&!r.isCollapsed)return!0;if(!i){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},t.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n?!0:!1},t.prototype.onTouchMove=function(t){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},t.prototype.onTouchEnd=function(t){var e,a,c,s,u,l=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,a=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,r&&(u=t.changedTouches[0],l=document.elementFromPoint(u.pageX-window.pageXOffset,u.pageY-window.pageYOffset)||l,l.fastClickScrollParent=this.targetElement.fastClickScrollParent),c=l.tagName.toLowerCase(),"label"===c){if(e=this.findControl(l)){if(this.focus(l),n)return!1;l=e}}else if(this.needsFocus(l))return t.timeStamp-a>100||o&&window.top!==window&&"input"===c?(this.targetElement=null,!1):(this.focus(l),this.sendClick(l,t),o&&"select"===c||(this.targetElement=null,t.preventDefault()),!1);return o&&!i&&(s=l.fastClickScrollParent,s&&s.fastClickLastScrollTop!==s.scrollTop)?!0:(this.needsClick(l)||(t.preventDefault(),this.sendClick(l,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return this.targetElement?t.forwardedTouchEvent?!0:t.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0:!0:!0},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail?!0:(e=this.onMouse(t),e||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;n&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,o,i,r;if("undefined"==typeof window.ontouchstart)return!0;if(o=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(o>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(a&&(i=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),i[1]>=10&&i[2]>=3&&(e=document.querySelector("meta[name=viewport]")))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction?!0:(r=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],r>=27&&(e=document.querySelector("meta[name=viewport]"),e&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===t.style.touchAction||"manipulation"===t.style.touchAction?!0:!1)},t.attach=function(e,n){return new t(e,n)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}();
}
var secretFeatureVariable1309=!1,Coveo;!function(e){e.version={lib : "1.0.176.50",product:"1.0.139.0",supportedApiVersion:2}}(Coveo||(Coveo={}));var Coveo;!function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];return e.L10N.format.apply(this,arguments)}e.l=t}(Coveo||(Coveo={})),function(){var e={Unknown:"Unknown",And:"AND",Authenticating:"Authenticating {0}...",Clear:"Clear {0}",CompleteQuery:"Complete Query",Exclude:"Exclude {0}",EnterTag:"Add Tag",Next:"Next",Last:"Last",Link:"Link",Or:"OR",Previous:"Previous",QueryDidntMatchAnyDocuments:"Your query did not match any documents.",QueryException:"Your query has an error: {0}.",Me:"Me",Remove:"Remove",Search:"Search",SearchFor:"Search for {0}",ShareQuery:"Share Query",Preferences:"Preferences",LinkOpeningSettings:"Link Opening Settings",Reauthenticate:"Reauthenticate {0}",ResultsFilteringExpression:"Results Filtering Expressions",FiltersInYourPreferences:"Filters in your preferences",Create:"Create",SearchIn:"Search in {0}",Seconds:"in {0} second<pl>s</pl>",ShowingResultsOf:"Result<pl>s</pl> {0}<pl>-{1}</pl> of {2}",SwitchTo:"Switch to {0}",Unexclude:"Unexclude {0}",ClearAllFilters:"Clear All Filters",SkipLogin:"Skip login",LoginInProgress:"Login in progress, please wait ...",Login:"Log In",GetStarted:"Get Started",More:"More",Less:"Fewer",Settings:"Settings",Score:"Score",ScoreDescription:"The score is computed from the number of occurrences as well as from the position in the result set.",Occurrences:"Occurrences",OccurrencesDescription:"Sort by number of occurrences, with values having the highest number appearing first.",Label:"Label",Of:"of",LabelDescription:"Sort alphabetically on the field values.",Value:"Value",ValueDescription:"Sort on the values of the first computed field",AlphaAscending:"Value Ascending",AlphaDescending:"Value Descending",ChiSquare:"Chi Square",Nosort:"No Sort",RelativeFrequency:"Relative Frequency",RelativeFrequencyDescription:"Sort based on the relative frequency of values. Less common values will appear higher.",DateDistribution:"Date distribution",Custom:"Custom",CustomDescription:"Sort based on a custom order",ComputedField:"Computed Field",Ascending:"Ascending",Descending:"Descending",noResultFor:"No results for {0}",autoCorrectedQueryTo:"Query was automatically corrected to {0}",didYouMean:"Did you mean: {0}",SuggestedResults:"Suggested Results",SuggestedQueries:"Suggested Queries",MostRelevantItems:"Most relevant items:",AllItems:"All items:",ShowLess:"Show less",ShowMore:"Show more",HideFacet:"Hide Facet",ShowFacet:"Show Facet",AndOthers:"and {0} other<pl>s</pl>",Others:"{0} other<pl>s</pl>",MostRelevantPosts:"Most Relevant Posts:",CompleteThread:"Complete Thread:",ShowCompleteThread:"Show Complete Thread",ShowOnlyTopMatchingPosts:"Show Only Top Matching Posts",MostRelevantReplies:"Most Relevant Replies:",AllConversation:"All Conversation:",ShowAllConversation:"Show All Conversation",ShowAllReplies:"Show All Replies",ShowOnlyMostRelevantReplies:"Show Only Most Relevant Replies",Close:"Close",Open:"Open",OpenInOutlookWhenPossible:"Open in Outlook (when possible)",AlwaysOpenInNewWindow:"Always open results in new window",Quickview:"Quick View",ErrorReport:"Error Report",OopsError:"Something went wrong.",ProblemPersists:"If the problem persists contact the administrator.",GoBack:"Go Back",Reset:"Reset",Retry:"Retry",MoreInfo:"More Information",Username:"Username",Password:"Password",PostedBy:"Posted by",CannotConnect:"Cannot connect to the server address.",BadUserPass:"Password does not match with username.",PleaseEnterYourCredentials:"Please enter your credentials for {0}.",PleaseEnterYourSearchPage:"Please enter your search page URL",Collapse:"Collapse",Collapsable:"Collapsible",Expand:"Expand",Today:"Today",Yesterday:"Yesterday",Tomorrow:"Tomorrow",Duration:"Duration: {0}",IndexDuration:"Index Duration: {0}",ProxyDuration:"Proxy Duration: {0}",ClientDuration:"Client Duration: {0}",Unavailable:"Unavailable",Reply:"Reply",ReplyAll:"Reply All",Forward:"Forward",From:"From",Caption:"Caption",Expression:"Expression",Tab:"Tab",Tabs:"Tabs",EnterExpressionName:"Enter expression name",EnterExpressionToFilterWith:"Enter expression to filter results with",SelectTab:"Select Tab",SelectAll:"Select All",PageUrl:"Search page URL",ErrorSavingToDevice:"Error while saving the information to your device",ErrorReadingFromDevice:"Error while reading the information from your device",AppIntro:"Speak with a product specialist who can answer your questions about Coveo and help you decide which Coveo solution is right for you. Or, try a live demo !",TryDemo:"Try the demo",ContactUs:"Contact us",NewToCoveo:"New to Coveo?",LetUsHelpGetStarted:"Let us help you get started",LikesThis:"{0} like<sn>s</sn> this.",CannotConnectSearchPage:"Cannot connect to your search page",AreYouSureDeleteFilter:"Are you sure you want to delete the filter {0} with the expression {1}",OnlineHelp:"Online Help",Done:"Done",SaveFacetState:"Save this facet state",ClearFacetState:"Clear facet state",DisplayingTheOnlyMessage:"Displaying the only message in this conversation",NoNetworkConnection:"No network connection",UnknownConnection:"Unknown connection",EthernetConnection:"Ethernet connection",WiFi:"WiFi connection",CELL:"Cellular connection",CELL_2G:"Cellular 2G connection",CELL_3G:"Cellular 3G connection",CELL_4G:"Cellular 4G connection",Relevance:"Relevance",Date:"Date",Amount:"Amount",QueryExceptionNoException:"No exception",QueryExceptionInvalidSyntax:"Invalid syntax",QueryExceptionInvalidCustomField:"Invalid custom field",QueryExceptionInvalidDate:"Invalid date",QueryExceptionInvalidExactPhrase:"Invalid exact phrase",QueryExceptionInvalidDateOp:"Invalid date operator",QueryExceptionInvalidNear:"Invalid NEAR operator",QueryExceptionInvalidWeightedNear:"Invalid weighted NEAR",QueryExceptionInvalidTerm:"Invalid term",QueryExceptionTooManyTerms:"Too many terms",QueryExceptionWildcardTooGeneral:"Wildcard too general",QueryExceptionInvalidSortField:"Invalid sort field",QueryExceptionInvalidSmallStringOp:"Invalid small string operator",QueryExceptionRequestedResultsMax:"Requested results maximum",QueryExceptionAggregatedMirrorDead:"Aggregated mirror is offline",QueryExceptionAggregatedMirrorQueryTimeOut:"Aggregated mirror query timeout",QueryExceptionAggregatedMirrorInvalidBuildNumber:"Aggregated mirror invalid build number",QueryExceptionAggregatedMirrorCannotConnect:"Aggregated mirror cannot connect",QueryExceptionNotEnoughLeadingCharsWildcard:"Not enough leading character wildcard",QueryExceptionSecurityInverterNotFound:"Security inverter not found",QueryExceptionSecurityInverterAccessDenied:"Security inverter access denied",QueryExceptionAggregatedMirrorCannotImpersonate:"Aggregated mirror cannot impersonate",QueryExceptionUnexpected:"Unexpected",QueryExceptionAccessDenied:"Access denied",QueryExceptionSuperUserTokenInvalid:"Super user token invalid",QueryExceptionSuperUserTokenExpired:"Super user token is expired",QueryExceptionLicenseQueriesExpired:"Queries license expired",QueryExceptionLicenseSuperUserTokenNotSupported:"License super user token not supported",QueryExceptionInvalidSession:"Invalid session",QueryExceptionInvalidDocument:"Invalid document",QueryExceptionSearchDisabled:"Search disabled",FileType:"File type",ShowAttachment:"Show attachment",OnFeed:"on {0}'s feed.",Author:"Author",NoTitle:"No title",CurrentSelections:"Current selections",AllContent:"All content",CancelLastAction:"Cancel last action",SearchTips:"Search tips",CheckSpelling:"Check the spelling of your keywords.",TryUsingFewerKeywords:"Try using fewer, different or more general keywords.",SelectFewerFilters:"Select fewer filters to broaden your search.",Document:"Document",Time:"Time",StartDate:"Start Date",StartTime:"Start Time",DurationTitle:"Duration",UserQuery:"User query",ShowUserActions:"Show User Actions",NoData:"No data available",EventType:"Event type",GoToFullSearch:"Full search",GoToEdition:"Customize Panel",RemoveContext:"Remove context",BoxAttachToCase:"Attach to Case",AttachToCase:"Attach to Case",Attach:"Attach",Detach:"Detach",AdditionalFilters:"Additional filters",SelectNonContextualSearch:"Remove the context from the current record to broaden your search",CopyPasteToSupport:"Copy paste this message to Coveo Support team for more information.",StartTypingCaseForSuggestions:"Describe your problem to see possible solutions",ExportToExcel:"Export to Excel",ExportToExcelDescription:"Export search results to Excel",CaseCreationNoResults:"No recommended solutions were found",objecttype_people:"People",objecttype_message:"Message",objecttype_feed:"RSS Feed",objecttype_thread:"Thread",objecttype_file:"File",objecttype_board:"",objecttype_category:"",objecttype_account:"Account",objecttype_campaign:"Campaign",objecttype_case:"Case",objecttype_contact:"Contact",objecttype_contract:"Contract",objecttype_event:"Event",objecttype_lead:"Lead",objecttype_solution:"Solution",objecttype_task:"Task",objecttype_user:"User",objecttype_attachment:"Attachment",objecttype_casecomment:"Case Comment",objecttype_opportunity:"Opportunity",objecttype_feeditem:"Chatter",objecttype_feedcomment:"Chatter",objecttype_note:"Note",objecttype_product:"Product",objecttype_partner:"Partner",objecttype_kbdocumentation:"Documentation",objecttype_kbsolution:"Solution",objecttype_kbknowledgearticle:"Knowledge Article",objecttype_kbattachment:"Attachment",sysfiletype_html:"HTML File",sysfiletype_image:"Image",sysfiletype_folder:"Folder",sysfiletype_txt:"Text",sysfiletype_zip:"Zip File",sysfiletype_pdf:"PDF File",sysfiletype_xml:"XML File",sysfiletype_doc:"Word Document",sysfiletype_xls:"Excel Document",sysfiletype_ppt:"PowerPoint Document",sysfiletype_video:"Video",sysfiletype_youtube:"YouTube video",sysfiletype_saleforceitem:"Salesforce",sysfiletype_exchangemessage:"Message",sysfiletype_exchangeappointment:"Appointment",sysfiletype_exchangenote:"Note",sysfiletype_exchangetask:"Task",sysfiletype_exchangeperson:"Exchange user",sysfiletype_activedirperson:"Active Directory user",sysfiletype_exchangeactivity:"Activity",sysfiletype_exchangecalendarmessage:"Calendar message",sysfiletype_exchangedocument:"Exchange document",sysfiletype_exchangerssfeed:"RSS Feed",sysfiletype_exchangejunkmessage:"Junk email",sysfiletype_exchangeofficecom:"Communications",sysfiletype_lithiummessage:"Message",sysfiletype_lithiumthread:"Thread",sysfiletype_lithiumboard:"Board",sysfiletype_lithiumcategory:"Category",sysfiletype_lithiumcommunity:"Community",sysfiletype_spportal:"Portal",sysfiletype_spsite:"Site",sysfiletype_spuserprofile:"SharePoint User",sysfiletype_sparea:"Area",sysfiletype_spannouncement:"Announcement",sysfiletype_spannouncementlist:"Announcements",sysfiletype_spcontact:"Contact",sysfiletype_spcontactlist:"Contacts",sysfiletype_spcustomlist:"Custom Lists",sysfiletype_spdiscussionboard:"Discussion Board",sysfiletype_spdiscussionboardlist:"Discussion Boards",sysfiletype_spdocumentlibrarylist:"Document Library",sysfiletype_spevent:"Event",sysfiletype_speventlist:"Events",sysfiletype_spformlibrarylist:"Form Library",sysfiletype_spissue:"Issue",sysfiletype_spissuelist:"Issues",sysfiletype_splink:"Link",sysfiletype_splinklist:"Links",sysfiletype_sppicturelibrarylist:"Picture Library",sysfiletype_spsurvey:"Survey",sysfiletype_spsurveylist:"Surveys",sysfiletype_sptask:"Task",sysfiletype_sptasklist:"Tasks",sysfiletype_spagenda:"Agenda",sysfiletype_spagendalist:"Agendas",sysfiletype_spattendee:"Attendee",sysfiletype_spattendeelist:"Attendees",sysfiletype_spcustomgridlist:"Custom Grids",sysfiletype_spdecision:"Decision",sysfiletype_spdecisionlist:"Decisions",sysfiletype_spobjective:"Objective",sysfiletype_spobjectivelist:"Objectives",sysfiletype_sptextbox:"Textbox",sysfiletype_sptextboxlist:"Textbox list",sysfiletype_spthingstobring:"Thing To Bring",sysfiletype_spthingstobringlist:"Things To Bring",sysfiletype_sparealisting:"Area Listing",sysfiletype_spmeetingserie:"Meeting series",sysfiletype_spmeetingserielist:"Meeting Series List",sysfiletype_spsitedirectory:"Site Directory Item",sysfiletype_spsitedirectorylist:"Site Directory",sysfiletype_spdatasource:"Data Source",sysfiletype_spdatasourcelist:"Data Source List",sysfiletype_splisttemplatecataloglist:"List Template Catalog List",sysfiletype_spwebpartcataloglist:"WebPart catalog list",sysfiletype_spwebtemplatecataloglist:"Web Template Catalog List",sysfiletype_spworkspacepagelist:"Workspace Page List",sysfiletype_spunknownlist:"Custom List",sysfiletype_spadministratortask:"Administrator Task",sysfiletype_spadministratortasklist:"Administrator Tasks",sysfiletype_spareadocumentlibrarylist:"Area Document Library",sysfiletype_spblogcategory:"Blog Category",sysfiletype_spblogcategorylist:"Blog Category",sysfiletype_spblogcomment:"Blog Comment",sysfiletype_spblogcommentlist:"Blog Comments",sysfiletype_spblogpost:"Blog Post",sysfiletype_spblogpostlist:"Blog Posts",sysfiletype_spdataconnectionlibrarylist:"Data Connection Library",sysfiletype_spdistributiongroup:"Distribution Group",sysfiletype_spdistributiongrouplist:"Distribution Groups",sysfiletype_spipfslist:"InfoPath Form Servers",sysfiletype_spkeyperformanceindicator:"Key Performance Indicator",sysfiletype_spkeyperformanceindicatorlist:"Key Performance Indicators",sysfiletype_splanguagesandtranslator:"Languages and Translator",sysfiletype_splanguagesandtranslatorlist:"Languages and Translators",sysfiletype_spmasterpagescataloglist:"Master Pages Library",sysfiletype_spnocodeworkflowlibrarylist:"No Code Workflow Library",sysfiletype_spprojecttask:"Project Task",sysfiletype_spprojecttasklist:"Project Tasks",sysfiletype_sppublishingpageslibrarylist:"Page Library",sysfiletype_spreportdocumentlibrarylist:"Report Document Library",sysfiletype_spreportlibrarylist:"Report Library",sysfiletype_spslidelibrarylist:"Slide Library",sysfiletype_sptab:"Tabs",sysfiletype_sptablist:"Tabs List",sysfiletype_sptranslationmanagementlibrarylist:"Translation Management Library",sysfiletype_spuserinformation:"User Information",sysfiletype_spuserinformationlist:"User Information List",sysfiletype_spwikipagelibrarylist:"Wiki Page Library",sysfiletype_spworkflowhistory:"Workflow History",sysfiletype_spworkflowhistorylist:"Workflow Histories",sysfiletype_spworkflowprocess:"Custom Workflow Process",sysfiletype_spworkflowprocesslist:"Custom Workflow Processes",sysfiletype_sppublishingimageslibrarylist:"Publishing Image Library",sysfiletype_spcirculation:"Circulation",sysfiletype_spcirculationlist:"Circulations",sysfiletype_spdashboardslibrarylist:"Dashboard Library",sysfiletype_spdataconnectionforperformancepointlibrarylist:"Data Connection for Performance Point Library",sysfiletype_sphealthreport:"Health Report",sysfiletype_sphealthreportlist:"Health Reports",sysfiletype_sphealthrule:"Health Rule",sysfiletype_sphealthrulelist:"Health Rules",sysfiletype_spimedictionary:"IME Dictionary",sysfiletype_spimedictionarylist:"IME Dictionaries",sysfiletype_spperformancepointcontent:"Performance Point Content",sysfiletype_spperformancepointcontentlist:"Performance Point Contents",sysfiletype_spphonecallmemo:"Phone Call Memo",sysfiletype_spphonecallmemolist:"Phone Call Memos",sysfiletype_sprecordlibrarylist:"Record Library",sysfiletype_spresource:"Resource",sysfiletype_spresourcelist:"Resources",sysfiletype_spprocessdiagramslibrarylist:"Process Diagram Library",sysfiletype_spsitethemeslibrarylist:"Site Theme Library",sysfiletype_spsolutionslibrarylist:"Solution Library",sysfiletype_spwfpublibrarylist:"WFPUB Library",sysfiletype_spwhereabout:"Whereabout",sysfiletype_spwhereaboutlist:"Whereabouts",sysfiletype_spdocumentlink:"Link to a Document",sysfiletype_spdocumentset:"Document Set",sysfiletype_spmicrofeedpost:"Microfeed Post",sysfiletype_spmicrofeedlist:"Microfeed",sysfiletype_splistfolder:"List Folder"},t=String.locales||(String.locales={});t.en=_.extend({},t.en,e),String.toLocaleString.call(this,{en:e}),String.locale="en",String.defaultLocale="en"}(),function(e){var t;t="undefined"!=typeof e.require&&"undefined"!=typeof e.exports&&"undefined"!=typeof e.module?e.require("globalize"):e.Globalize,t.addCultureInfo("en-US","default",{name:"en-US",englishName:"English (United States)"})}(this);var Coveo;!function(e){var t=/<pl>(((?!<\/pl>).)*)<\/pl>/g,i=/<sn>(((?!<\/sn>).)*)<\/sn>/g;e.L10N={format:function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t.toLocaleString();if(i.length>0){var s=e._.last(i);e._.isNumber(s)&&(i.pop(),o=e.L10N.formatPlSn(o,s));for(var r in i)o=o.replace("{"+r+"}",i[r])}return o},formatPlSn:function(e,n){return e=n>1?e.replace(t,"$1").replace(i,""):e.replace(t,"").replace(i,"$1")}}}(Coveo||(Coveo={}));var Coveo;!function(e){window.console||(console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},assert:function(){},clear:function(){},count:function(){},dir:function(){},dirxml:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},msIsIndependentlyComposed:function(){},profile:function(){},profileEnd:function(){},select:function(){},time:function(){},timeEnd:function(){},trace:function(){}});var t=function(){function e(e){this.owner=e}return e.prototype.trace=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.TRACE&&this.log("TRACE",t)},e.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.DEBUG&&this.log("DEBUG",t)},e.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.INFO&&this.log("INFO",t)},e.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.WARN&&this.log("WARN",t)},e.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.ERROR&&this.log("ERROR",t)},e.prototype.log=function(t,i){window.console&&console.log&&(console.log([t,this.owner].concat(i)),e.executionTime&&(console.timeEnd("Execution time"),console.time("Execution time")))},e.enable=function(){e.level=e.TRACE},e.disable=function(){e.level=e.NOTHING},e.TRACE=1,e.DEBUG=2,e.INFO=3,e.WARN=4,e.ERROR=5,e.NOTHING=6,e.level=e.INFO,e.executionTime=!1,e}();e.Logger=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.fail=function(e){t.failureHandler(e)},t.check=function(e,i){e||t.fail(i)},t.isUndefined=function(i){t.check(e.Utils.isUndefined(i),"Value should be undefined.")},t.isNotUndefined=function(i){t.check(!e.Utils.isUndefined(i),"Value should not be undefined.")},t.isNull=function(i){t.check(e.Utils.isNull(i),"Value should be null.")},t.isNotNull=function(i){t.check(!e.Utils.isNull(i),"Value should not be null.")},t.exists=function(i){t.check(!e.Utils.isNullOrUndefined(i),"Value should not be null or undefined")},t.doesNotExists=function(i){t.check(e.Utils.isNullOrUndefined(i),"Value should be null or undefined")},t.isString=function(i){t.check(e._.isString(i),"Value should be a string.")},t.stringStartsWith=function(e,i){t.isNonEmptyString(e),t.isNonEmptyString(i),t.check(0==e.indexOf(i),"Value should start with "+i)},t.isNonEmptyString=function(i){t.check(e.Utils.isNonEmptyString(i),"Value should be a non-empty string.")},t.isNumber=function(i){t.check(e._.isNumber(i),"Value should be a number.")},t.isLargerThan=function(e,i){t.check(i>e,"Value "+i+" should be larger than "+e)},t.isLargerOrEqualsThan=function(e,i){t.check(i>=e,"Value "+i+" should be larger or equal than "+e)},t.isSmallerThan=function(e,i){t.check(e>i,"Value "+i+" should be smaller than "+e)},t.isSmallerOrEqualsThan=function(e,i){t.check(e>=i,"Value "+i+" should be smaller or equal than "+e)},t.logger=new e.Logger("Assert"),t.failureHandler=function(n){throw t.logger.error("Assertion Failed!",n),window.console&&console.trace&&console.trace(),e.Utils.isNonEmptyString(n)?new i(n):new i("Assertion Failed!")},t}();e.Assert=t;var i=function(){function e(e){this.message=e}return e.prototype.toString=function(){return this.message},e}();e.PreconditionFailedException=i}(Coveo||(Coveo={}));var Coveo;!function(e){e.$=jQuery}(Coveo||(Coveo={}));var Coveo;!function(e){e._=window._}(Coveo||(Coveo={})),Coveo.$.fn.getCursorPosition=function(){var e=this.get(0);if(e){if("selectionStart"in e)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-i}}};var Coveo;!function(e){var t=function(){function t(){}return t.defer=function(e){t.functions.push(e),t.arm()},t.flush=function(){for(;t.popOne(););},t.arm=function(){e._.defer(function(){t.popOne()&&t.arm()})},t.popOne=function(){if(t.functions.length>0){var i=t.functions[0];return t.functions=e._.rest(t.functions),i(),t.functions.length>0}return!1},t.functions=[],t}();e.Defer=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.onEmpty=e,this.cache=[]}return e.prototype.get=function(){return 0==this.cache.length?this.onEmpty():this.cache.pop()},e.prototype.push=function(e){this.cache.push(e)},e}();e.Cache=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){return"undefined"==typeof e}function n(e){return null===e}function o(e){return t.isUndefined(e)||t.isNull(e)}function s(e){return!t.isNullOrUndefined(e)}function r(t){return e._.isString(t)?t:""}function a(e){return e?e.toString():""}function l(e){return t.isNullOrUndefined(e)||!t.isNonEmptyString(e)}function u(t){return e._.isString(t)&&""!==t}function c(e){return!u(e)}function p(e,t){return e.slice(0,t.length)==t}function d(t){return e._.isArray(t)&&t.length>0}function h(e){return!t.isNonEmptyArray(e)}function f(e){return void 0!=window.HTMLElement?e instanceof HTMLElement:e&&e.nodeType&&1==e.nodeType}function m(e){return t.isNonEmptyString(e)?parseInt(e,10):void 0}function v(e){return t.isNonEmptyString(e)?parseFloat(e):void 0}function g(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function y(e){if(!t.isNonEmptyString(e))return void 0;switch(e.toLowerCase()){case"true":case"1":case"yes":return!0;case"false":case"0":case"no":return!1;default:return void 0}}function C(e){return null==e?null:e.replace(/^\s+|\s+$/g,"")}function b(e){for(var t=[],i=e.length-1;i>=0;i--)t.unshift(["&#",e.charCodeAt(i),";"].join(""));return t.join("")}function S(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})}function x(t,i,n){if(void 0===n&&(n=!0),n)return e._.isEqual(t,i);var o=[t,i];return e._.all(o,function(t){return t.length==o[0].length&&0==e._.difference(t,o[0]).length})}function O(t,i){return e._.isEqual(t,i)}function T(e){return/^@[a-zA-Z0-9_\.]+$/.test(e)}function E(e){var t=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");return t}function A(t,i){var n=t[i];if(null==n){var o=i.toLowerCase();if(n=t[o],null==n){var s=e._.find(e._.keys(t),function(e){return e.toLowerCase()==o});null!=s&&(n=t[s])}}return n}function w(t,n){if(null==n)return void 0;if(n=n.trim(),"@"==n[0]&&(n=n.substr(1)),""==n)return void 0;e.Assert.check(T("@"+n));for(var o=n.split(".").reverse(),s=t.raw;o.length>1;)if(s=A(s,o.pop()),i(s))return void 0;var r=A(s,o[0]);return null==r&&(r=A(t,n)),r}function I(e,t,i,n,o){void 0===i&&(i={});var s,r=null,a=0,l=function(){a=i.leading===!1?0:(new Date).getTime(),r=null,s=e.apply(n,o)};return function(){var u=(new Date).getTime();a||i.leading!==!1||(a=u);var c=t-(u-a);return n=this,o=arguments,0>=c?(clearTimeout(r),r=null,a=u,s=e.apply(n,o)):r||i.trailing===!1||(r=setTimeout(l,c)),s}}function F(t,i){var n=this,o=e._.isArray(i),s=o&&[]||{};return o?(t=t||[],s=s.concat(t),e._.each(i,function(e,i){"undefined"==typeof t[i]?s[i]=e:"object"==typeof e?s[i]=n.extendDeep(t[i],e):-1===t.indexOf(e)&&s.push(e)})):(t&&"object"==typeof t&&e._.each(e._.keys(t),function(e){s[e]=t[e]}),e._.each(e._.keys(i),function(e){s[e]="object"==typeof i[e]&&i[e]?t[e]?n.extendDeep(t[e],i[e]):i[e]:i[e]})),s}function D(e,t){return void 0===t&&(t=window.location.search),t.replace(new RegExp("^(?:.*[&\\?]"+e.replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")}function _(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)}function R(e,t){var i,n;return function(){for(var o=this,s=[],r=0;r<arguments.length;r++)s[r-0]=arguments[r];null==i?(i=setTimeout(function(){i=null},t),n=setTimeout(function(){e.apply(o,s),n=null})):null==n&&(clearTimeout(i),i=setTimeout(function(){e.apply(o,s),i=null},t))}}function V(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}t.isUndefined=i,t.isNull=n,t.isNullOrUndefined=o,t.exists=s,t.toNotNullString=r,t.anyTypeToString=a,t.isNullOrEmptyString=l,t.isNonEmptyString=u,t.isEmptyString=c,t.stringStartsWith=p,t.isNonEmptyArray=d,t.isEmptyArray=h,t.isHtmlElement=f,t.parseIntIfNotUndefined=m,t.parseFloatIfNotUndefined=v,t.round=g,t.parseBooleanIfNotUndefined=y,t.trim=C,t.encodeHTMLEntities=b,t.decodeHTMLEntities=S,t.arrayEqual=x,t.objectEqual=O,t.isCoveoField=T,t.escapeRegexCharacter=E,t.getCaseInsensitiveProperty=A,t.getFieldValue=w,t.throttle=I,t.extendDeep=F,t.getQueryStringValue=D,t.isValidUrl=_,t.debounce=R,t.readCookie=V}(t=e.Utils||(e.Utils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){void 0===t&&(t=!0),this.milliseconds=t?e:1e3*e}return t.prototype.getMilliseconds=function(){return this.milliseconds},t.prototype.getSeconds=function(){return this.getMilliseconds()/1e3},t.prototype.getMinutes=function(){return this.getSeconds()/60},t.prototype.getHours=function(){return this.getMinutes()/60},t.prototype.getDays=function(){return this.getHours()/24},t.prototype.getWeeks=function(){return this.getDays()/7},t.prototype.getHHMMSS=function(){var e,t,i,n=Math.floor(this.getHours()),o=Math.floor(this.getMinutes())%60,s=Math.floor(this.getSeconds())%60;e=0==n?"":10>n?"0"+n.toString():n.toString(),t=10>o?"0"+o.toString():o.toString(),i=10>s?"0"+s.toString():s.toString();var r=(""!=e?e+":":"")+t+":"+i;return r},t.fromDates=function(i,n){return e.Assert.exists(i),e.Assert.exists(n),new t(n.valueOf()-i.valueOf())},t}();e.TimeSpan=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){var e=navigator.userAgent;return e.match(/Android/i)?"Android":e.match(/BlackBerry/i)?"BlackBerry":e.match(/iPhone/i)?"iPhone":e.match(/iPad/i)?"iPad":e.match(/iPod/i)?"iPod":e.match(/Opera Mini/i)?"Opera Mini":e.match(/IEMobile/i)?"IE Mobile":e.match(/Chrome/i)?"Chrome":e.match(/MSIE/i)||e.match(/Trident/i)?"IE":e.match(/Opera/i)?"Opera":e.match(/Firefox/i)?"Firefox":e.match(/Safari/i)?"Safari":"Others"}function i(){return"Android"==t()}function n(){var e=t();return"iPhone"==e||"iPad"==e||"iPod"==e}function o(){var e=navigator.userAgent.toLowerCase();return-1==e.indexOf("msie")?!1:parseInt(e.split("msie")[1])<10}function s(){return u}function r(){return c}function a(){return screen.width<=480}function l(){return screen.height<=640}var u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),c=/^file:\/\/\/.*_asset/i.test(document.URL)||/^file:\/\/\/.*var\/mobile/i.test(document.URL)||/^file:\/\/\/.*\/CoreSimulator/.test(document.URL);e.getDeviceName=t,e.isAndroid=i,e.isIos=n,e.isIE8or9=o,e.isMobileDevice=s,e.isPhonegap=r,e.isSmallScreenWidth=a,e.isSmallScreenHeight=l}(t=e.DeviceUtils||(e.DeviceUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.createGuid=function(){return"undefined"!=typeof crypto&&"undefined"!=typeof crypto.getRandomValues?t.generateWithCrypto():t.generateWithRandom()},t.generateWithRandom=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},t.generateWithCrypto=function(){var e=new Uint16Array(8);crypto.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])},t.setStateObjectOnQueryResults=function(e,i){t.setPropertyOnResults(i,"state",e)},t.setStateObjectOnQueryResult=function(e,i){t.setPropertyOnResult(i,"state",e)},t.setIndexAndUidOnQueryResults=function(i,n,o,s,r){e.Assert.exists(i),e.Assert.exists(n);var a=i.firstResult;t.setPropertyOnResults(n,"queryUid",o),t.setPropertyOnResults(n,"pipeline",s),t.setPropertyOnResults(n,"splitTestRun",r),t.setPropertyOnResults(n,"index",a,function(){return++a})},t.setTermsToHighlightOnQueryResults=function(e,i){t.setPropertyOnResults(i,"termsToHighlight",i.termsToHighlight),t.setPropertyOnResults(i,"phrasesToHighlight",i.phrasesToHighlight)},t.splitFlags=function(t,i){return void 0===i&&(i=";"),e.Assert.exists(t),t.split(i)},t.isAttachment=function(i){return e._.contains(t.splitFlags(i.flags),"IsAttachment")},t.containsAttachment=function(i){return e._.contains(t.splitFlags(i.flags),"ContainsAttachment")},t.hasHTMLVersion=function(i){return e._.contains(t.splitFlags(i.flags),"HasHtmlVersion")},t.hasThumbnail=function(i){return e._.contains(t.splitFlags(i.flags),"HasThumbnail")},t.quoteAndEscapeIfNeeded=function(i){return e.Assert.isString(i),t.isAtomicString(i)||t.isRangeString(i)||t.isRangeWithoutOuterBoundsString(i)?i:t.quoteAndEscape(i)},t.quoteAndEscape=function(i){return e.Assert.isString(i),'"'+t.escapeString(i)+'"'},t.escapeString=function(t){return e.Assert.isString(t),t.replace(/"/g," ")},t.isAtomicString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^[\d\w]+$/.test(t)},t.isRangeString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?\.\.\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}\.\.\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.isRangeWithoutOuterBoundsString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.buildFieldExpression=function(i,n,o){return e.Assert.isNonEmptyString(i),e.Assert.stringStartsWith(i,"@"),e.Assert.isNonEmptyString(n),e.Assert.isLargerOrEqualsThan(1,o.length),1==o.length?i+n+t.quoteAndEscapeIfNeeded(o[0]):i+n+"("+e._.map(o,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")"},t.buildFieldNotEqualExpression=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.stringStartsWith(i,"@"),e.Assert.isLargerOrEqualsThan(1,n.length);var o;return o=1==n.length?i+"=="+t.quoteAndEscapeIfNeeded(n[0]):i+"==("+e._.map(n,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")","(NOT "+o+")"},t.mergeQueryString=function(e,t){var i=e.indexOf("?");return e+=-1!=i?"&"+t:"?"+t},t.mergePath=function(e,t){var i=e.split("?");return i[0]+t+"?"+(i[1]||"")},t.setPropertyOnResults=function(i,n,o,s){e._.each(i.results,function(e){t.setPropertyOnResult(e,n,o),o=s?s():o})},t.setPropertyOnResult=function(t,i,n){t[i]=n,e._.each(t.childResults,function(e){e[i]=n}),e.Utils.isNullOrUndefined(t.parentResult)||(t.parentResult[i]=n)},t.getUrlParameter=function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},t}();e.QueryUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.javascriptEncode=function(t){return e.Assert.isString(t),t=t.replace(/\\/g,"\\\\"),t=t.replace(/'/g,"\\'"),t=t.replace(/"/g,'\\"')},t.htmlEncode=function(t){return e.Assert.isString(t),e.$("<div/>").text(t).html()},t.splice=function(e,t,i,n){return e.slice(0,t)+n+e.slice(t+Math.abs(i))},t.removeMiddle=function(e,i,n){if(e.length<i)return e;var o=e.length-i,s=Math.floor(i/2);return t.splice(e,s,o,n)},t.regexEncode=function(t){return e.Assert.isString(t),t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.stringToRegex=function(i,n){void 0===n&&(n=!1),e.Assert.isString(i);var o=t.regexEncode(i);return n?e._.map(o,function(i){var n=e._.find(t.accented,function(e){return null!=i.match(e)
});return n?n.source:i}).join(""):o},t.wildcardsToRegex=function(i,n){void 0===n&&(n=!1),e.Assert.isString(i);var o=t.stringToRegex(i,n);return o=o.replace(/\\\*/,".*"),o=o.replace(/\\\?/,".")},t.getHighlights=function(t,i,n){for(var o,s=[];o=i.exec(t);){var r=o[2],a=o[1],l=o.index+a.length;if(s.push({offset:l,length:r.length,dataHighlightGroupTerm:n}),!i.global)break}return e._.isEmpty(s)?void 0:s},t.encodeCarriageReturn=function(t){return e.Assert.isString(t),t.replace(/\n/g,"<br/>")},t.equalsCaseInsensitive=function(e,t){return e.toLowerCase()==t.toLowerCase()},t.match=function(e,t){for(var i,n=[];null!==(i=t.exec(e));)n.push(i);return n},t.removePunctuation=function(e){var t=/[\u2000-\u206F\u2E00-\u2E7F\\'!"#\$%&\(\)\*\+,\-\.\/:;<=>\?@\[\]\^_`\{\|\}~]/g,i=/\s+/g;return e.replace(t,"").replace(i," ")},t.accented={A:/[Aa\xaa\xc0-\xc5\xe0-\xe5\u0100-\u0105\u01cd\u01ce\u0200-\u0203\u0226\u0227\u1d2c\u1d43\u1e00\u1e01\u1e9a\u1ea0-\u1ea3\u2090\u2100\u2101\u213b\u249c\u24b6\u24d0\u3371-\u3374\u3380-\u3384\u3388\u3389\u33a9-\u33af\u33c2\u33ca\u33df\u33ff\uff21\uff41]/g,B:/[Bb\u1d2e\u1d47\u1e02-\u1e07\u212c\u249d\u24b7\u24d1\u3374\u3385-\u3387\u33c3\u33c8\u33d4\u33dd\uff22\uff42]/g,C:/[Cc\xc7\xe7\u0106-\u010d\u1d9c\u2100\u2102\u2103\u2105\u2106\u212d\u216d\u217d\u249e\u24b8\u24d2\u3376\u3388\u3389\u339d\u33a0\u33a4\u33c4-\u33c7\uff23\uff43]/g,D:/[Dd\u010e\u010f\u01c4-\u01c6\u01f1-\u01f3\u1d30\u1d48\u1e0a-\u1e13\u2145\u2146\u216e\u217e\u249f\u24b9\u24d3\u32cf\u3372\u3377-\u3379\u3397\u33ad-\u33af\u33c5\u33c8\uff24\uff44]/g,E:/[Ee\xc8-\xcb\xe8-\xeb\u0112-\u011b\u0204-\u0207\u0228\u0229\u1d31\u1d49\u1e18-\u1e1b\u1eb8-\u1ebd\u2091\u2121\u212f\u2130\u2147\u24a0\u24ba\u24d4\u3250\u32cd\u32ce\uff25\uff45]/g,F:/[Ff\u1da0\u1e1e\u1e1f\u2109\u2131\u213b\u24a1\u24bb\u24d5\u338a-\u338c\u3399\ufb00-\ufb04\uff26\uff46]/g,G:/[Gg\u011c-\u0123\u01e6\u01e7\u01f4\u01f5\u1d33\u1d4d\u1e20\u1e21\u210a\u24a2\u24bc\u24d6\u32cc\u32cd\u3387\u338d-\u338f\u3393\u33ac\u33c6\u33c9\u33d2\u33ff\uff27\uff47]/g,H:/[Hh\u0124\u0125\u021e\u021f\u02b0\u1d34\u1e22-\u1e2b\u1e96\u210b-\u210e\u24a3\u24bd\u24d7\u32cc\u3371\u3390-\u3394\u33ca\u33cb\u33d7\uff28\uff48]/g,I:/[Ii\xcc-\xcf\xec-\xef\u0128-\u0130\u0132\u0133\u01cf\u01d0\u0208-\u020b\u1d35\u1d62\u1e2c\u1e2d\u1ec8-\u1ecb\u2071\u2110\u2111\u2139\u2148\u2160-\u2163\u2165-\u2168\u216a\u216b\u2170-\u2173\u2175-\u2178\u217a\u217b\u24a4\u24be\u24d8\u337a\u33cc\u33d5\ufb01\ufb03\uff29\uff49]/g,J:/[Jj\u0132-\u0135\u01c7-\u01cc\u01f0\u02b2\u1d36\u2149\u24a5\u24bf\u24d9\u2c7c\uff2a\uff4a]/g,K:/[Kk\u0136\u0137\u01e8\u01e9\u1d37\u1d4f\u1e30-\u1e35\u212a\u24a6\u24c0\u24da\u3384\u3385\u3389\u338f\u3391\u3398\u339e\u33a2\u33a6\u33aa\u33b8\u33be\u33c0\u33c6\u33cd-\u33cf\uff2b\uff4b]/g,L:/[Ll\u0139-\u0140\u01c7-\u01c9\u02e1\u1d38\u1e36\u1e37\u1e3a-\u1e3d\u2112\u2113\u2121\u216c\u217c\u24a7\u24c1\u24db\u32cf\u3388\u3389\u33d0-\u33d3\u33d5\u33d6\u33ff\ufb02\ufb04\uff2c\uff4c]/g,M:/[Mm\u1d39\u1d50\u1e3e-\u1e43\u2120\u2122\u2133\u216f\u217f\u24a8\u24c2\u24dc\u3377-\u3379\u3383\u3386\u338e\u3392\u3396\u3399-\u33a8\u33ab\u33b3\u33b7\u33b9\u33bd\u33bf\u33c1\u33c2\u33ce\u33d0\u33d4-\u33d6\u33d8\u33d9\u33de\u33df\uff2d\uff4d]/g,N:/[Nn\xd1\xf1\u0143-\u0149\u01ca-\u01cc\u01f8\u01f9\u1d3a\u1e44-\u1e4b\u207f\u2115\u2116\u24a9\u24c3\u24dd\u3381\u338b\u339a\u33b1\u33b5\u33bb\u33cc\u33d1\uff2e\uff4e]/g,O:/[Oo\xba\xd2-\xd6\xf2-\xf6\u014c-\u0151\u01a0\u01a1\u01d1\u01d2\u01ea\u01eb\u020c-\u020f\u022e\u022f\u1d3c\u1d52\u1ecc-\u1ecf\u2092\u2105\u2116\u2134\u24aa\u24c4\u24de\u3375\u33c7\u33d2\u33d6\uff2f\uff4f]/g,P:/[Pp\u1d3e\u1d56\u1e54-\u1e57\u2119\u24ab\u24c5\u24df\u3250\u3371\u3376\u3380\u338a\u33a9-\u33ac\u33b0\u33b4\u33ba\u33cb\u33d7-\u33da\uff30\uff50]/g,Q:/[Qq\u211a\u24ac\u24c6\u24e0\u33c3\uff31\uff51]/g,R:/[Rr\u0154-\u0159\u0210-\u0213\u02b3\u1d3f\u1d63\u1e58-\u1e5b\u1e5e\u1e5f\u20a8\u211b-\u211d\u24ad\u24c7\u24e1\u32cd\u3374\u33ad-\u33af\u33da\u33db\uff32\uff52]/g,S:/[Ss\u015a-\u0161\u017f\u0218\u0219\u02e2\u1e60-\u1e63\u20a8\u2101\u2120\u24ae\u24c8\u24e2\u33a7\u33a8\u33ae-\u33b3\u33db\u33dc\ufb06\uff33\uff53]/g,T:/[Tt\u0162-\u0165\u021a\u021b\u1d40\u1d57\u1e6a-\u1e71\u1e97\u2121\u2122\u24af\u24c9\u24e3\u3250\u32cf\u3394\u33cf\ufb05\ufb06\uff34\uff54]/g,U:/[Uu\xd9-\xdc\xf9-\xfc\u0168-\u0173\u01af\u01b0\u01d3\u01d4\u0214-\u0217\u1d41\u1d58\u1d64\u1e72-\u1e77\u1ee4-\u1ee7\u2106\u24b0\u24ca\u24e4\u3373\u337a\uff35\uff55]/g,V:/[Vv\u1d5b\u1d65\u1e7c-\u1e7f\u2163-\u2167\u2173-\u2177\u24b1\u24cb\u24e5\u2c7d\u32ce\u3375\u33b4-\u33b9\u33dc\u33de\uff36\uff56]/g,W:/[Ww\u0174\u0175\u02b7\u1d42\u1e80-\u1e89\u1e98\u24b2\u24cc\u24e6\u33ba-\u33bf\u33dd\uff37\uff57]/g,X:/[Xx\u02e3\u1e8a-\u1e8d\u2093\u213b\u2168-\u216b\u2178-\u217b\u24b3\u24cd\u24e7\u33d3\uff38\uff58]/g,Y:/[Yy\xdd\xfd\xff\u0176-\u0178\u0232\u0233\u02b8\u1e8e\u1e8f\u1e99\u1ef2-\u1ef9\u24b4\u24ce\u24e8\u33c9\uff39\uff59]/g,Z:/[Zz\u0179-\u017e\u01f1-\u01f3\u1dbb\u1e90-\u1e95\u2124\u2128\u24b5\u24cf\u24e9\u3390-\u3394\uff3a\uff5a]/g},t}();e.StringUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e,t,a,c,p,d){void 0===d&&(d=0),e.appendTo(a),p.verticalOffset=p.verticalOffset?p.verticalOffset:0,p.horizontalOffset=p.horizontalOffset?p.horizontalOffset:0;var h=t.offset();o(h,e,t,p),s(h,e,t,p),n(e.offset(),h,e,p);var f=l(e),m=l(c);if(2>d){var v=u(f,m);if("ok"!=v.vertical||"ok"!=v.horizontal){var g=r(p,v);i(e,t,a,c,g,d+1)}}}function n(e,t,i,n){var o=i.position();i.css({position:"absolute",top:o.top+n.verticalOffset-(e.top-t.top)+"px",left:o.left+n.horizontalOffset-(e.left-t.left)+"px"})}function o(e,t,i,n){switch(n.vertical){case 0:e.top-=t.outerHeight();break;case 2:e.top+=i.outerHeight();break;case 1:e.top-=t.outerHeight()/3;case 3:break;case 4:e.top-=t.outerHeight()-i.outerHeight()}}function s(e,t,i,n){switch(n.horizontal){case 0:e.left-=t.outerWidth();break;case 2:e.left+=i.outerWidth();break;case 1:e.left+=a(t,i);break;case 3:break;case 4:e.left-=t.outerWidth()-i.outerWidth()}}function r(e,t){var i=e;return"left"==t.horizontal&&(i.horizontal=2),"right"==t.horizontal&&(i.horizontal=0),"top"==t.vertical&&(i.vertical=2),"bottom"==t.vertical&&(i.vertical=0),i}function a(e,t){return(t.outerWidth()-e.outerWidth())/2}function l(e){var t=e.offset();return{top:t.top,left:t.left,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight()}}function u(e,t){var i={vertical:"ok",horizontal:"ok"};return e.top<t.top&&(i.vertical="top"),e.bottom>t.bottom&&(i.vertical="bottom"),e.left<t.left&&(i.horizontal="left"),e.right>t.right&&(i.horizontal="right"),i}function c(t,i,n){var o="";i.showDate&&(o=e.DateUtils.dateTimeToString(new Date(t.raw.sysdate)));var s=e.FileTypes.get(t),r=e.$("<div class='coveo-quickview-right-header'>\n        <span class='coveo-quickview-time'>"+o+"</span>\n        <span class='coveo-quickview-close-button'>\n          <span class='coveo-icon coveo-sprites-common-clear'></span>\n        </span>\n      </div>\n      <div class='coveo-quickview-left-header'>\n        <span class='coveo-quickview-icon "+s.icon+"'></span>\n        <span class='coveo-quickview-pop-up-reminder'> "+(i.title||"")+"</span>\n      </div>");return new e.ResultLink(r.find(".coveo-quickview-pop-up-reminder").get(0),void 0,n,t),r}function p(e,t){return"<span class='coveo-close-button'><span class='coveo-icon coveo-sprites-quickview-close'></span>"+e+"</span><span class='coveo-pop-up-reminder' >"+t+"</span>"}function d(){var t="coveo-loading-dot";return e.$("<div class='coveo-first-loading-animation' ><div class='coveo-logo' ></div><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function h(){var t="coveo-loading-dot";return e.$("<div class='coveo-generic-loading-animation coveo-loading-animation'><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function f(){return e.$('<div class="coveo-loading-spinner"/>')}function m(t,i){var n=new RegExp(e.Utils.escapeRegexCharacter(i),"i"),o=t.search(n),s=o+i.length;return e.StringUtils.htmlEncode(t.slice(0,o))+"<span class='coveo-highlight'>"+e.StringUtils.htmlEncode(t.slice(o,s))+"</span>"+e.StringUtils.htmlEncode(t.slice(s))}function v(t){for(var i=e.$(t);!i.is(document)&&0!=i.length;){if(g(i))return i.is("body")?e.$(window).get(0):i.get(0);i=i.parent()}return e.$(window).get(0)}function g(e){return"scroll"==e.css("overflow-y")}function y(t){var i=e.$("<div>").html(t);return 1==i.children().length?i.children().get(0):i.get(0)}!function(e){e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.innerTop=3]="innerTop",e[e.innerBottom=4]="innerBottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalAlignment;!function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right",e[e.innerLeft=3]="innerLeft",e[e.innerRight=4]="innerRight"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.HorizontalAlignment;t.positionPopup=i,t.getQuickviewHeader=c,t.getPopUpCloseButton=p,t.getBasicLoadingAnimation=d,t.getBasicLoadingDots=h,t.getLoadingSpinner=f,t.highlightElement=m,t.findScrollingParent=v,t.htmlToDom=y,e.$.fn.fastToggle=function(e){return this.css("display",e?"":"none")}}(t=e.JQueryUtils||(e.JQueryUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.getHash=function(i){void 0===i&&(i=window),e.Assert.exists(i);var n="#"+(i.location.href.split("#")[1]||"");return t.getAjaxcrawlableHash(n)},t.getValue=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),n=t.getAjaxcrawlableHash(n);var o=t.getRawValue(i,n);return void 0!=o&&(o=t.getValueDependingOnType(o)),o},t.encodeValues=function(i){var n=[];return e._.each(i,function(i,o){var s="";s=e.Utils.isNonEmptyArray(i)?t.encodeArray(i):e._.isObject(i)&&e.Utils.isNonEmptyArray(e._.keys(i))?t.encodeObject(i):encodeURIComponent(i.toString()),""!=s&&n.push(o+"="+s)}),n.join("&")},t.getAjaxcrawlableHash=function(e){return void 0!=e[1]&&"!"==e[1]?e.substring(0,1)+e.substring(2):e},t.getRawValue=function(t,i){e.Assert.exists(t),e.Assert.exists(i),e.Assert.check(0==i.indexOf("#")||""==i);for(var n=i.substr(1).split("&"),o=0,s=!0,r=void 0;s;){var a=n[o].split("=");a[0]==t?(s=!1,r=a[1]):(o++,o>=n.length&&(o=void 0,s=!1))}return r},t.getValueDependingOnType=function(e){var i,n=t.getValueType(e);return i="object"==n?t.decodeObject(e):"array"==n?t.decodeArray(e):decodeURIComponent(e)},t.getValueType=function(e){return t.isObject(e)?"object":t.isArray(e)?"array":"other"},t.isArrayStartNotEncoded=function(e){return e.substr(0,1)==t.Delimiter.arrayStart},t.isArrayStartEncoded=function(e){return 0==e.indexOf(encodeURIComponent(t.Delimiter.arrayStart))},t.isArrayEndNotEncoded=function(e){return e.substr(e.length-1)},t.isArrayEndEncoded=function(e){return e.indexOf(encodeURIComponent(t.Delimiter.arrayEnd))==e.length-encodeURIComponent(t.Delimiter.arrayEnd).length},t.isObjectStartNotEncoded=function(e){return e.substr(0,1)==t.Delimiter.objectStart},t.isObjectStartEncoded=function(e){return 0==e.indexOf(encodeURIComponent(t.Delimiter.objectStart))},t.isObjectEndNotEncoded=function(e){return e.substr(e.length-1)==t.Delimiter.objectEnd},t.isObjectEndEncoded=function(e){return e.indexOf(encodeURIComponent(t.Delimiter.objectEnd))==e.length-encodeURIComponent(t.Delimiter.objectEnd).length},t.isObject=function(e){var i=t.isObjectStartNotEncoded(e)||t.isObjectStartEncoded(e),n=t.isObjectEndNotEncoded(e)||t.isObjectEndEncoded(e);return i&&n},t.isArray=function(e){var i=t.isArrayStartNotEncoded(e)||t.isArrayStartEncoded(e),n=t.isArrayEndNotEncoded(e)||t.isArrayEndEncoded(e);return i&&n},t.encodeArray=function(i){var n=[];return e._.each(i,function(e){n.push(encodeURIComponent(e))}),t.Delimiter.arrayStart+n.join(",")+t.Delimiter.arrayEnd},t.encodeObject=function(i){var n=t.Delimiter.objectStart,o=[];return e._.each(i,function(i,n){var s="";s+='"'+encodeURIComponent(n)+'" : ',s+=e._.isArray(i)?t.encodeArray(i):e._.isObject(i)?t.encodeObject(i):e._.isNumber(i)||e._.isBoolean(i)?encodeURIComponent(i):'"'+encodeURIComponent(i)+'"',o.push(s)}),n+=o.join(" , "),n+t.Delimiter.objectEnd},t.decodeObject=function(e){return t.isObjectStartEncoded(e)&&t.isObjectEndEncoded(e)&&(e=e.replace(/encodeURIComponent(HashUtils.Delimiter.objectStart)/,t.Delimiter.objectStart),e=e.replace(encodeURIComponent(t.Delimiter.objectEnd),t.Delimiter.objectEnd)),JSON.parse(decodeURIComponent(e))},t.decodeArray=function(i){t.isArrayStartEncoded(i)&&t.isArrayEndEncoded(i)&&(i=i.replace(encodeURIComponent(t.Delimiter.arrayStart),t.Delimiter.arrayStart),i=i.replace(encodeURIComponent(t.Delimiter.arrayEnd),t.Delimiter.arrayEnd)),i=i.substr(1),i=i.substr(0,i.length-1);var n=i.split(",");return e._.map(n,function(e){return decodeURIComponent(e)})},t.Delimiter={objectStart:"{",objectEnd:"}",arrayStart:"[",arrayEnd:"]",objectStartRegExp:"^{",objectEndRegExp:"}+$",arrayStartRegExp:"^[",arrayEndRegExp:"]+$"},t}();e.HashUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){c.addClass("active"),setTimeout(function(){c.removeClass("active")},e)}function n(e,t){e.addClass("coveo-clicked"),setTimeout(function(){e.removeClass("coveo-clicked")},t)}function o(i,n){void 0===n&&(n=!1);var o="."+e.Component.computeCssClassNameForType(e.SearchInterface.ID);e.$(o+",.coveo-glass").addClass("coveo-"+i),e.$(".coveo-glass").addClass("coveo-active-glass"),n&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).on("backbutton",e.$.proxy(t.removeToggleClassOnSearchInterface,this,!0))}function s(t){void 0===t&&(t=!1);var i="."+e.Component.computeCssClassNameForType(e.SearchInterface.ID);e.$(i+",.coveo-glass").removeClass("coveo-slide-right").removeClass("coveo-slide-left").removeClass("coveo-active-glass").removeClass("coveo-active-glass-for-current-tab"),e.$(".coveo-tab-section").removeClass("coveo-opened-by-current-tab");var n=e.Component.getComponentRef("CurrentTab");if(n){var o="."+e.Component.computeCssClassNameForType(n.ID);e.$(o).removeClass("coveo-opening-tab-section")}t&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).off("backbutton")}function r(){e.$("."+e.Component.computeCssClassNameForType(e.SearchInterface.ID)).append(c)}function a(t){e.$(window).focus(),e.$(t).blur()}function l(){e.DeviceUtils.isIos()&&e.$(window).on("touchstart",function(i){!e.$(i.target).is("input")&&e.$(document.activeElement).is("input")&&t.hideIOSKeyboard(document.activeElement)})}function u(){e.DeviceUtils.isMobileDevice()&&(e.$(function(){return r()}),l())}var c=e.$(document.createElement("div")).addClass("coveo-click-canceling-overlay");t.showClickCancelingOverlay=i,t.showClickFeedback=n,t.addToggleClassOnSearchInterface=o,t.removeToggleClassOnSearchInterface=s,t.hideIOSKeyboard=a,u()}(t=e.MobileUtils||(e.MobileUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(e,t,i){var n,o,s,r=Math.floor(6*e),a=6*e-r,l=i*(1-t),u=i*(1-a*t),c=i*(1-(1-a)*t);switch(r%6){case 0:n=i,o=c,s=l;break;case 1:n=u,o=i,s=l;break;case 2:n=l,o=i,s=c;break;case 3:n=l,o=u,s=i;break;case 4:n=c,o=l,s=i;break;case 5:n=i,o=l,s=u}return[Math.round(255*n),Math.round(255*o),Math.round(255*s)]}function i(e,t,i){e/=255,t/=255,i/=255;var n,o,s=Math.max(e,t,i),r=Math.min(e,t,i),a=s,l=s-r;if(o=0==s?0:l/s,s==r)n=0;else{switch(s){case e:n=(t-i)/l+(i>t?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return[n,o,a]}e.hsvToRgb=t,e.rgbToHsv=i}(t=e.ColorUtils||(e.ColorUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){this.message=t,this.status=i,e.Assert.exists(t),e.Assert.exists(i),this.type="Ajax Error (status: "+i+")"}return t}();e.AjaxError=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.provider=e,this.isMissingAuthentication=!0,this.type=this.message="Missing Authentication (provider: "+e+")"}return e}();e.MissingAuthenticationError=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.status=t.statusCode,this.message=t.data.message,this.type=t.data.type,this.queryExecutionReport=t.data.executionReport,e.Assert.isNumber(this.status),e.Assert.isNonEmptyString(this.message),e.Assert.isNonEmptyString(this.type)}return t}();e.QueryError=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){e[e.OPENED=XMLHttpRequest.OPENED||1]="OPENED",e[e.DONE=XMLHttpRequest.DONE||4]="DONE"}(t||(t={}));var i=function(){function i(t){void 0===t&&(t={}),this.options=t,this.useJsonp=!1,this.logger=new e.Logger(this)}return i.prototype.call=function(t){e.Assert.isNonEmptyString(t.url);var n={url:t.url,queryString:t.errorsAsSuccess?t.queryString.concat(["errorsAsSuccess=1"]):t.queryString,requestData:t.requestData,deferred:e.$.Deferred(),begun:new Date,method:t.method};this.logger.trace("Performing REST request",n);var o=i.parseURL(n.url),s=window.location.hostname===o.hostname||""===o.hostname,r=""!=window.location.port?window.location.port:"https:"==window.location.protocol?"443":"80",a=r==o.port,l=!(s&&a);return this.useJsonp?this.callUsingAjaxJsonP(n):this.isCORSSupported()||!l?this.callUsingXMLHttpRequest(n,t.responseType):this.isXDomainRequestSupported()?this.callUsingXDomainRequest(n):this.callUsingAjaxJsonP(n),n.deferred},i.parseURL=function(e){var t=document.createElement("a");return t.href=e,t},i.convertJsonToQueryString=function(t){e.Assert.exists(t);var i=[];return e._.each(t,function(t,n){null!=t&&(e._.isObject(t)?i.push(n+"="+encodeURIComponent(JSON.stringify(t))):i.push(n+"="+encodeURIComponent(t.toString())))}),i},i.convertJsonToFormBody=function(e){return i.convertJsonToQueryString(e).join("&")},i.prototype.callUsingXMLHttpRequest=function(n,o){var s=this;void 0===o&&(o="text");var r=new XMLHttpRequest,a=!1;r.onreadystatechange=function(){if(r.readyState!=t.OPENED||a){if(r.readyState==t.DONE){var l,u=r.status;"text"==o?l=s.tryParseResponseText(r.responseText,r.getResponseHeader("Content-Type")):(l=r.response,void 0==l&&(l=s.tryParseResponseText(r.responseText,r.getResponseHeader("Content-Type")))),s.isSuccessHttpStatus(u)?s.handleSuccessfulResponseThatMightBeAnError(n,l):s.handleError(n,r.status,void 0)}}else a=!0,r.withCredentials=!0,s.options.accessToken?r.setRequestHeader("Authorization","Bearer "+s.options.accessToken):s.options.username&&s.options.password&&r.setRequestHeader("Authorization","Basic "+btoa(s.options.username+":"+s.options.password)),e.DeviceUtils.isPhonegap()&&r.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"),"GET"==n.method?r.send():(r.setRequestHeader("Content-Type",'application/x-www-form-urlencoded; charset="UTF-8"'),r.send(i.convertJsonToFormBody(n.requestData))),r.responseType=o};var l=n.queryString;"GET"==n.method&&(l=l.concat(i.convertJsonToQueryString(n.requestData))),r.open(n.method,this.combineUrlAndQueryString(n.url,l))},i.prototype.callUsingXDomainRequest=function(t){var n=this,o=t.queryString.concat([]);this.options.accessToken&&o.push("access_token="+encodeURIComponent(this.options.accessToken));var s=new XDomainRequest;"GET"==t.method&&(o=o.concat(i.convertJsonToQueryString(t.requestData))),s.open(t.method,this.combineUrlAndQueryString(t.url,o)),s.onload=function(){var e=n.tryParseResponseText(s.responseText,s.contentType);n.handleSuccessfulResponseThatMightBeAnError(t,e)},s.onerror=function(){var e=n.tryParseResponseText(s.responseText,s.contentType);n.handleError(t,0,e)},s.ontimeout=function(){return n.logger.error("Request timeout",s,t.requestData)},s.onprogress=function(){return n.logger.trace("Request progress",s,t.requestData)},e._.defer(function(){"GET"==t.method?s.send():s.send(i.convertJsonToFormBody(t.requestData))})},i.prototype.callUsingAjaxJsonP=function(t){var n=this,o=t.queryString.concat(i.convertJsonToQueryString(t.requestData));this.options.accessToken&&o.push("access_token="+encodeURIComponent(this.options.accessToken)),o.push("callback=?"),e.$.jsonp({url:this.combineUrlAndQueryString(t.url,o),success:function(e){return n.handleSuccessfulResponseThatMightBeAnError(t,e)},error:function(){return n.handleError(t,0,void 0)}})},i.prototype.handleSuccessfulResponseThatMightBeAnError=function(e,t){this.isErrorResponseBody(t)?this.handleError(e,t.statusCode,t):this.handleSuccess(e,t)},i.prototype.handleSuccess=function(t,i){var n={duration:e.TimeSpan.fromDates(t.begun,new Date).getMilliseconds(),data:i};this.logger.trace("REST request successful",i,t),t.deferred.resolve(n)},i.prototype.handleError=function(e,t,i){var n={statusCode:t,data:i};this.logger.error("REST request failed",t,i,e),e.deferred.reject(n)},i.prototype.combineUrlAndQueryString=function(e,t){return e+(t.length>0?"?"+t.join("&"):"")},i.prototype.isXDomainRequestSupported=function(){return"XDomainRequest"in window},i.prototype.isCORSSupported=function(){return"withCredentials"in new XMLHttpRequest},i.prototype.isSuccessHttpStatus=function(e){return e>=200&&300>e||304===e},i.prototype.tryParseResponseText=function(t,i){if(null==i||-1==i.indexOf("application/json"))return t;if(!e.Utils.isNonEmptyString(t))return void 0;try{return JSON.parse(t)}catch(n){return void 0}},i.prototype.isErrorResponseBody=function(e){return e&&e.statusCode?!this.isSuccessHttpStatus(e.statusCode):!1},i}();e.EndpointCaller=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){this.queryStringArguments={},this.anonymous=!1,this.isOldRestAPI=!1}return e}();e.DefaultSearchEndpointOptions=t;var i=function(){function i(i){this.options=i,this._batchListFieldValues=[],e.Assert.exists(i);var n=new t;n.anonymous=0==window.location.href.indexOf("file://")&&e.Utils.isNonEmptyString(i.accessToken),this.options=e.$.extend({},n,i),e.SearchEndpoint.isDebugArgumentPresent()&&(this.options.queryStringArguments.debug=1),e.$(window).on("beforeunload",e.$.proxy(this.handleUnload,this)),this.logger=new e.Logger(this),this.createEndpointCaller()}return i.configureSampleEndpoint=function(){i.endpoints["default"]=i.isUseLocalArgumentPresent()?new i({restUri:"http://localhost:8100/rest/search"}):new i({restUri:"https://cloudplatform.coveo.com/rest/search",accessToken:"52d806a2-0f64-4390-a3f2-e0f41a4a73ec"})},i.configureCloudEndpoint=function(e,t,n,o){void 0===n&&(n="https://cloudplatform.coveo.com/rest/search");var s=i.mergeConfigOptions({restUri:n,accessToken:t,queryStringArguments:{workgroup:e}},o);i.endpoints["default"]=new i(i.removeUndefinedConfigOption(s))},i.configureOnPremiseEndpoint=function(e,t,n){var o=i.mergeConfigOptions({restUri:e,accessToken:t},n);i.endpoints["default"]=new i(i.removeUndefinedConfigOption(o))},i.removeUndefinedConfigOption=function(t){return e._.each(e._.keys(t),function(e){void 0==t[e]&&delete t[e]}),t},i.mergeConfigOptions=function(t,n){return t=i.removeUndefinedConfigOption(t),n=i.removeUndefinedConfigOption(n),e.$.extend({},t,n)},i.prototype.reset=function(){this.createEndpointCaller()},i.isDebugArgumentPresent=function(){return/[?&]debug=1([&]|$)/.test(window.location.search)},i.isUseLocalArgumentPresent=function(){return/[?&]useLocal=1([&]|$)/.test(window.location.search)},i.prototype.handleUnload=function(){this.isRedirecting=!0},i.prototype.getBaseUri=function(){return this.options.restUri},i.prototype.getAuthenticationProviderUri=function(t,i,n){var o=this.buildBaseUri("/login/"+t)+"?";return e.Utils.isNonEmptyString(i)?o+="redirectUri="+encodeURIComponent(i):e.Utils.isNonEmptyString(n)&&(o+="message="+encodeURIComponent(n)),o},i.prototype.isJsonp=function(){return this.caller.useJsonp},i.prototype.search=function(t,i){var n=this;e.Assert.exists(t),this.logger.info("Performing REST query",t),i=e._.extend({},i);var o={url:this.buildBaseUri("/"),queryString:this.buildBaseQueryString(i),requestData:t,errorsAsSuccess:!0,responseType:"text",method:"POST"},s=this.callWithErrorHandling(o);return s.done(function(i){n.logger.info("REST query successful",i,t),null==i.apiVersion&&(i.apiVersion=1),i.apiVersion<e.version.supportedApiVersion&&n.logger.error("Please update your REST Search API"),e.Utils.isNullOrEmptyString(i.searchUid)&&(i.searchUid=e.QueryUtils.createGuid()),e.QueryUtils.setIndexAndUidOnQueryResults(t,i,i.searchUid,i.pipeline,i.splitTestRun),e.QueryUtils.setTermsToHighlightOnQueryResults(t,i)}),s},i.prototype.getExportToExcelLink=function(t,i){var n=this.buildBaseUri("/"),o=this.buildCompleteQueryString(i,null,t);return e.Utils.isNonEmptyString(this.options.accessToken)&&o.push("access_token="+encodeURIComponent(this.options.accessToken)),o.push("format=xlsx"),n+"?"+o.join("&")},i.prototype.getRawDataStream=function(t,i,n){var o=this;e.Assert.exists(t),n=e._.extend({},n);var s={url:this.buildBaseUri("/datastream"),queryString:this.buildViewAsHtmlQueryString(t,n).concat(["dataStream="+i]),requestData:{},errorsAsSuccess:!1,method:"GET",responseType:"arraybuffer"},r=this.callWithErrorHandling(s);return this.logger.info("Performing REST query for datastream "+i+" on document uniqueID"+t),r.done(function(e){return o.logger.info("REST query successful",e,t)}),r},i.prototype.getDocumentText=function(t,i){i=e._.extend({},i);var n={url:this.buildBaseUri("/text"),queryString:this.buildViewAsHtmlQueryString(t,i),method:"GET",requestData:{},responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(n)},i.prototype.getDocumentHtml=function(t,i){i=e._.extend({},i);var n={url:this.buildBaseUri("/html"),queryString:this.buildViewAsHtmlQueryString(t,i),method:"GET",requestData:{},responseType:"document",errorsAsSuccess:!0};return this.callWithErrorHandling(n)},i.prototype.getViewAsHtmlUri=function(t,i){return i=e._.extend({},i),this.buildViewAsHtmlUri("/html",t,i)},i.prototype.getViewAsDatastreamUri=function(t,i,n){return n=e._.extend({},n),this.buildViewAsHtmlUri("/datastream",t,n)+"&dataStream="+encodeURIComponent(i)},i.prototype.batchFieldValues=function(t,i){var n=this;e.Assert.exists(t),i=e._.extend({},i),this.logger.info("Listing field values",t);var o=e.$.Deferred(),s={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(s).done(function(e){return o.resolve(e.values)}).fail(function(e,t){return o.reject(null,t)}),o.done(function(e){return n.logger.info("REST list field values successful",e,t)}),o},i.prototype.listFieldValues=function(t,i){var n=this;e.Assert.exists(t),i=e._.extend({},i),this.logger.info("Listing field values",t);var o=e.$.Deferred(),s={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(s).done(function(e){return o.resolve(e.values)}).fail(function(e,t){return o.reject(null,t)}),o.done(function(e){return n.logger.info("REST list field values successful",e,t)}),o},i.prototype.listFields=function(t){t=e._.extend({},t),this.logger.info("Listing fields");var i=e.$.Deferred(),n={url:this.buildBaseUri("/fields"),queryString:this.buildBaseQueryString(t),requestData:{},method:"GET",responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(n).done(function(e){return i.resolve(e.fields)}).fail(function(e,t){return i.reject(null,t)}),i},i.prototype.extensions=function(t){t=e._.extend({},t),this.logger.info("Listing extensions");var i={url:this.buildBaseUri("/extensions"),queryString:this.buildBaseQueryString(t),requestData:{},method:"GET",responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(i)},i.prototype.rateDocument=function(t,i){i=e._.extend({},i),this.logger.info("Rating a document",t);var n=e.$.Deferred(),o={url:this.buildBaseUri("/rating"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!1,responseType:"text"};return this.callWithErrorHandling(o).done(function(){return n.resolve(!0)}).fail(function(){return n.reject(!1)}),n},i.prototype.tagDocument=function(t,i){i=e._.extend({},i),this.logger.info("Tagging a document",t);var n=e.$.Deferred(),o={url:this.buildBaseUri("/tag"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!1,responseType:"text"};return this.callWithErrorHandling(o).done(function(){return n.resolve(!0)}).fail(function(){return n.reject(!1)}),n},i.prototype.createEndpointCaller=function(){this.caller=new e.EndpointCaller(this.options)},i.prototype.buildBaseUri=function(t){e.Assert.isString(t);var i=this.options.restUri;return i=this.removeTrailingSlash(i),i+=t,this.options.isOldRestAPI&&(i=this.addTrailingSlash(i)),i},i.prototype.buildBaseQueryString=function(t){var i=[];for(var n in this.options.queryStringArguments)i.push(n+"="+encodeURIComponent(this.options.queryStringArguments[n]));return e._.isArray(t.authentication)&&0!=t.authentication.length&&i.push("authentication="+t.authentication.join(",")),i},i.prototype.buildCompleteQueryString=function(t,i,n){var o=this.buildBaseQueryString(t);return n?(n.q,n.aq,n.cq,n.dq,n.searchHub,n.tab,n.language,n.pipeline,n.lowercaseOperators,e._.each(["q","aq","cq","dq","searchHub","tab","language","pipeline","lowercaseOperators"],function(e){n[e]&&o.push(e+"="+encodeURIComponent(n[e]))}),e._.each(n.context,function(e,t){o.push("context["+t+"]="+encodeURIComponent(e))})):i&&o.push("q="+encodeURIComponent(i)),o},i.prototype.buildViewAsHtmlUri=function(t,i,n){e.Assert.isNonEmptyString(i);var o=this.buildViewAsHtmlQueryString(i,n);e.Utils.isNonEmptyString(this.options.accessToken)&&o.push("access_token="+encodeURIComponent(this.options.accessToken));var s=this.buildBaseUri(t);return s+"?"+o.join("&")},i.prototype.buildViewAsHtmlQueryString=function(e,t){var i=this.buildCompleteQueryString(t,t.query,t.queryObject);return i.push("uniqueId="+encodeURIComponent(e)),(t.query||t.queryObject)&&i.push("enableNavigation=true"),t.requestedOutputSize&&i.push("requestedOutputSize="+encodeURIComponent(t.requestedOutputSize.toString())),t.contentType&&i.push("contentType="+encodeURIComponent(t.contentType)),i},i.prototype.callWithErrorHandling=function(t){var i=e.$.Deferred();return this.performOneCall(t,i,!0),i},i.prototype.performOneCall=function(t,i,n){var o=this;this.caller.call(t).done(function(e){e.data.clientDuration=e.duration,i.resolve(e.data,t.requestData)}).fail(function(s){n&&o.canRenewAccessToken()&&o.isAccessTokenExpiredStatus(s.statusCode)?o.renewAccessToken().done(function(){return o.performOneCall(t,i,!1)}).fail(function(){return o.handleErrorResponse(s,i)}):0==s.statusCode&&o.isRedirecting?e._.defer(function(){i.resolve()}):o.handleErrorResponse(s,i)})},i.prototype.handleErrorResponse=function(t,i){this.isMissingAuthenticationProviderStatus(t.statusCode)?i.reject(null,new e.MissingAuthenticationError(t.data.provider)):t.data&&t.data.message?i.reject(null,new e.QueryError(t)):i.reject(null,new e.AjaxError("Request Error",t.statusCode))},i.prototype.canRenewAccessToken=function(){return e.Utils.isNonEmptyString(this.options.accessToken)&&e._.isFunction(this.options.renewAccessToken)},i.prototype.isAccessTokenExpiredStatus=function(e){return 419==e},i.prototype.renewAccessToken=function(){var t=this;return this.logger.info("Renewing expired access token"),this.options.renewAccessToken().done(function(i){e.Assert.isNonEmptyString(i),t.options.accessToken=i,t.createEndpointCaller()}).fail(function(e){t.logger.error("Failed to renew access token",e)})},i.prototype.isMissingAuthenticationProviderStatus=function(e){return 402==e},i.prototype.addTrailingSlash=function(e){return this.hasTrailingSlash(e)||(e+="/"),e},i.prototype.removeTrailingSlash=function(e){return this.hasTrailingSlash(e)&&(e=e.substr(0,e.length-1)),e},i.prototype.hasTrailingSlash=function(e){return"/"==e.charAt(e.length-1)},i.endpoints={},i}();e.SearchEndpoint=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.endpoint=e,this.callOptions=t,this.options=e.options}return t.prototype.getBaseUri=function(){return this.endpoint.getBaseUri()},t.prototype.getAuthenticationProviderUri=function(e,t,i){return this.endpoint.getAuthenticationProviderUri(e,t,i)
},t.prototype.isJsonp=function(){return this.endpoint.isJsonp()},t.prototype.search=function(e,t){return this.endpoint.search(e,this.enrichCallOptions(t))},t.prototype.getExportToExcelLink=function(e,t){return this.endpoint.getExportToExcelLink(e,this.enrichCallOptions(t))},t.prototype.tagDocument=function(e){return this.endpoint.tagDocument(e,this.enrichCallOptions(e))},t.prototype.rateDocument=function(e,t){return this.endpoint.rateDocument(e,this.enrichCallOptions(t))},t.prototype.getRawDataStream=function(e,t,i){return this.endpoint.getRawDataStream(e,t,this.enrichCallOptions(i))},t.prototype.getDocumentText=function(e,t){return this.endpoint.getDocumentText(e,this.enrichCallOptions(t))},t.prototype.getDocumentHtml=function(e,t){return this.endpoint.getDocumentHtml(e,this.enrichCallOptions(t))},t.prototype.getViewAsHtmlUri=function(e,t){return this.endpoint.getViewAsHtmlUri(e,this.enrichCallOptions(t))},t.prototype.getViewAsDatastreamUri=function(e,t,i){return this.endpoint.getViewAsDatastreamUri(e,t,this.enrichCallOptions(i))},t.prototype.listFieldValues=function(e,t){return this.endpoint.listFieldValues(e,this.enrichCallOptions(t))},t.prototype.listFields=function(e){return this.endpoint.listFields(this.enrichCallOptions(e))},t.prototype.enrichCallOptions=function(t){return e._.extend({},t,this.callOptions)},t}();e.SearchEndpointWithDefaultCallOptions=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.registerDefaultOptions=function(t,i){var n=e.$(t).data("CoveoDefaultOptions")||{},o=e.$.extend(!0,{},n,i);e.$(t).data("CoveoDefaultOptions",o)},t.resolveDefaultOptions=function(i,n){var o,s=e.$(i).data("CoveoDefaultOptions");return o=e.Utils.exists(s)?e.$.extend(!0,{},s,n):n,i.parentElement?t.resolveDefaultOptions(i.parentElement,o):o},t.registerAutoCreateComponent=function(i){e.Assert.exists(i),e.Assert.exists(i.ID),e.Assert.doesNotExists(t.autoCreateComponents[i.ID]),e.Assert.doesNotExists(t.namedMethods[i.ID]),t.autoCreateComponents[i.ID]=i},t.isComponentClassIdRegistered=function(i){return e.Utils.exists(t.autoCreateComponents[i])},t.getListOfRegistredComponents=function(){return e._.keys(t.autoCreateComponents)},t.getRegistredComponent=function(e){return t.autoCreateComponents[e]},t.initializeFramework=function(i,n,o){e.Assert.exists(i),this.logger.info("Internal Coveo JQuery version",e.$.fn.jquery),e.DeviceUtils.isIE8or9()&&e.$("html").addClass("ie8or9"),n=t.resolveDefaultOptions(i,n),t.performInitFunctionsOption(n,e.InitializationEvents.beforeInitialization),e.$(i).trigger(e.InitializationEvents.beforeInitialization),o(i,n),t.initExternalComponents(i,n),t.performInitFunctionsOption(n,e.InitializationEvents.afterComponentsInitialization),e.$(i).trigger(e.InitializationEvents.afterComponentsInitialization),e.$(i).trigger(e.InitializationEvents.restoreHistoryState),t.performInitFunctionsOption(n,e.InitializationEvents.afterInitialization),e.$(i).trigger(e.InitializationEvents.afterInitialization);var s=e.Component.get(i,e.SearchInterface);e.$(".coveo-hide-until-loaded").removeClass("coveo-hide-until-loaded").addClass("coveo-show-after-loaded"),s.options.autoTriggerQuery&&(t.logFirstQueryCause(s),e.Component.get(i,e.QueryController).executeQuery())},t.logFirstQueryCause=function(t){var i=e.HashUtils.getValue("firstQueryCause",e.HashUtils.getHash());if(null!=i){var n=e.HashUtils.getValue("firstQueryMeta",e.HashUtils.getHash())||{};t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList[i],n)}else e.Utils.isNonEmptyString(t.getBindings().queryStateModel.get("q"))?t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchFromLink,{}):t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.interfaceLoad,{})},t.performInitFunctionsOption=function(i,n){e.Utils.exists(i)&&t.performFunctions(i[n])},t.performPreInitFunctions=function(i){e.Utils.exists(i)&&t.performFunctions(i[e.InitializationEvents.beforeInitialization])},t.performPostInitFunction=function(i){e.Utils.exists(i)&&t.performFunctions(i[e.InitializationEvents.afterInitialization])},t.performFunctions=function(t){e.Utils.exists(t)&&e._.each(t,function(e){"function"==typeof e&&e()})},t.initSearchInterface=function(i,n){void 0===n&&(n={}),n=t.resolveDefaultOptions(i,n);var o=new e.SearchInterface(i,n.SearchInterface,n.Analytics);o.options.originalOptionsObject=n;var s={options:n,bindings:o.getBindings()};t.automaticallyCreateComponentsInside(i,s)},t.initStandaloneSearchInterface=function(i,n){void 0===n&&(n={}),n=t.resolveDefaultOptions(i,n);var o=new e.StandaloneSearchInterface(i,n.StandaloneSearchInterface,n.Analytics);o.options.originalOptionsObject=n;var s={options:n,bindings:o.getBindings()};t.automaticallyCreateComponentsInside(i,s)},t.initBoxInterface=function(i,n,o,s){void 0===n&&(n={}),void 0===o&&(o="Standard"),void 0===s&&(s=!0),n=t.resolveDefaultOptions(i,n);var r="Box";"Standard"!=o&&(r+="For"+o);var a=e.Component.getComponentRef(r);if(a){new e.Logger(i).info("Initializing box of type "+r);var l=s?a.getInjection:function(){},u=new a(i,n[r],n.Analytics,l,n);u.options.originalOptionsObject=n;var c={options:n,bindings:u.getBindings()};t.automaticallyCreateComponentsInside(i,c)}else new e.Logger(i).error("Trying to initialize box of type : "+r+" but not found in code (not compiled)!"),e.Assert.fail("Cannot initialize unknown type of box")},t.initExternalComponents=function(i,n){if(n&&n.externalComponents){var o=e.$(i).coveo(e.SearchInterface),s=e.$(i).coveo(e.QueryStateModel),r=e.$(i).coveo(e.ComponentStateModel),a=e.$(i).coveo(e.QueryController),l=e.$(i).coveo(e.ComponentOptionsModel),u=o.usageAnalytics;e.Assert.exists(o),e.Assert.exists(s),e.Assert.exists(a),e.Assert.exists(r),e.Assert.exists(u);var c={options:n,bindings:{searchInterface:o,queryStateModel:s,queryController:a,usageAnalytics:u,componentStateModel:r,componentOptionsModel:l,root:i}};e._.each(n.externalComponents,function(i){var n=i;n instanceof e.$&&(n=e.$(n).get(0)),e.Utils.isHtmlElement(n)&&t.automaticallyCreateComponentsInside(n,c)})}},t.automaticallyCreateComponentsInside=function(i,n,o){e.Assert.exists(i);var s=[];for(var r in t.autoCreateComponents)if(!e._.contains(o,r)){var a=t.autoCreateComponents[r],l=e.Component.computeCssClassNameForType(a.ID),u=e.$(i).find("."+l);e.$(i).hasClass(l)&&(u=u.add(i)),0!=u.length&&s.push(t.createFunctionThatInitializesComponentOnElements(u,r,a,n))}e._.each(s,function(e){return e()})},t.createFunctionThatInitializesComponentOnElements=function(i,n,o,s){return function(){i.each(function(i,r){if(null==e.Component.get(r,n)){var a=void 0;if(e.Utils.exists(s.options)){var l=s.options[n],u=s.options[r.id],c=s.options.initOptions?s.options.initOptions[n]:{};a=e.$.extend({},l,u,c)}var p=e.$.extend({},s,{options:a});t.createComponentOfThisClassOnElement(o.ID,r,p)}})}},t.createComponentOfThisClassOnElement=function(i,n,o){e.Assert.isNonEmptyString(i),e.Assert.exists(n);var s=t.autoCreateComponents[i];e.Assert.exists(s);var r={},a={},l=void 0;return void 0!=o&&(e._.each(o.bindings,function(e,t){r[t]=e}),a=o.options,l=o.result),t.logger.trace("Creating component of class "+i,n,a),new s(n,a,r,l)},t.registerNamedMethod=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.doesNotExists(t.autoCreateComponents[i]),e.Assert.doesNotExists(t.namedMethods[i]),e.Assert.exists(n),t.namedMethods[i]=n},t.isNamedMethodRegistered=function(i){return e.Utils.exists(t.namedMethods[i])},t.dispatchNamedMethodCall=function(i,n,o){e.Assert.isNonEmptyString(i),e.Assert.exists(n);var s=t.namedMethods[i];return e.Assert.exists(s),t.logger.trace("Dispatching named method call of "+i,n,o),s.apply(null,[n].concat(o))},t.isThereASingleComponentBoundToThisElement=function(t){return e.Assert.exists(t),e.Utils.exists(e.Component.get(t))},t.dispatchMethodCallOnBoundComponent=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.exists(i);var o=e.Component.get(i);e.Assert.exists(o);var s=o[t];return e.Utils.exists(s)?s.apply(o,n):(e.Assert.fail("No method named "+t+" exist on component "+o.type),void 0)},t.dispatchNamedMethodCallOrComponentCreation=function(i,n,o){return e.Assert.isNonEmptyString(i),e.Assert.exists(n),t.isNamedMethodRegistered(i)?t.dispatchNamedMethodCall(i,n,o):t.isComponentClassIdRegistered(i)?t.createComponentOfThisClassOnElement(i,n,o[0]):t.isThereASingleComponentBoundToThisElement(n)?t.dispatchMethodCallOnBoundComponent(i,n,o):(e.Assert.fail("No method or component named "+i+" are registered."),void 0)},t.monkeyPatchComponentMethod=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.exists(n);var o;if(t.indexOf(".")>0){var s=t.split(".");e.Assert.check(2==s.length,"Invalid method name, correct syntax is CoveoComponent.methodName."),o=s[0],t=s[1]}var r=e.Component.get(i,o);e.Assert.exists(r),e.Assert.exists(r[t]);var a="__"+t;e.Utils.exists(r[a])||(r[a]=r[t]),r[t]=n},t.noConflict=function(){e.$=jQuery.noConflict(!0),window.$.fn.coveo=e.$.fn.coveo},t.logger=new e.Logger("JQuery"),t.autoCreateComponents={},t.namedMethods={},t}();e.CoveoJQuery=t}(Coveo||(Coveo={})),$.fn.coveo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var i;return this.each(function(t,n){var o;if(_.isString(e[0])){var s=e[0];o=Coveo.CoveoJQuery.dispatchNamedMethodCallOrComponentCreation(s,n,e.slice(1))}else o=Coveo.CoveoJQuery.dispatchNamedMethodCall("get",n,e);i=i||o}),i},Coveo.CoveoJQuery.registerNamedMethod("options",function(e,t){void 0===t&&(t={}),Coveo.CoveoJQuery.registerDefaultOptions(e,t)}),Coveo.CoveoJQuery.registerNamedMethod("init",function(e,t){void 0===t&&(t={}),Coveo.CoveoJQuery.initializeFramework(e,t,function(){Coveo.CoveoJQuery.initSearchInterface(e,t)})}),Coveo.CoveoJQuery.registerNamedMethod("initBox",function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n,o,s={};0==t.length?(n="Standard",o=!1):1==t.length?"string"==typeof t[0]?(n=t[0],o=!0):"object"==typeof t[0]?(n="Standard",o=!1,s=t[0]):Coveo.Assert.fail("Invalid parameters to init a box"):2==t.length&&(n=t[0],s=t[1],o=!0);var r={};r[n||"Container"]=_.extend({},s.SearchInterface,s[n]),s=_.extend({},s,r),Coveo.CoveoJQuery.initializeFramework(e,s,function(){Coveo.CoveoJQuery.initBoxInterface(e,s,n,o)})}),Coveo.CoveoJQuery.registerNamedMethod("initSearchbox",function(e,t,i){void 0===i&&(i={}),Coveo.Assert.isNonEmptyString(t);var n={};n.searchPageUri=t,n.autoTriggerQuery=!1,n.hideUntilFirstQuery=!1,n.enableHistory=!1,i=_.extend({},i,{StandaloneSearchInterface:n}),Coveo.CoveoJQuery.initializeFramework(e,i,function(){Coveo.CoveoJQuery.initStandaloneSearchInterface(e,i)})}),Coveo.CoveoJQuery.registerNamedMethod("patch",function(e,t,i){Coveo.CoveoJQuery.monkeyPatchComponentMethod(t,e,i)}),Coveo.CoveoJQuery.registerNamedMethod("noConflict",function(){Coveo.CoveoJQuery.noConflict()});var Coveo;!function(e){var t=function(){function t(i,n,o){var s=this;void 0===o&&(o={}),this.element=i,this.type=n,this.disabled=!1,this.bind=new e.ComponentEvents(this),e.Assert.exists(i),e.Assert.isNonEmptyString(n),t.bindComponentToElement(this.element,this),this.logger=new e.Logger(this),this.root=o.root||this.resolveRoot(),this.queryStateModel=o.queryStateModel||this.resolveQueryStateModel(),this.componentStateModel=o.componentStateModel||this.resolveComponentStateModel(),this.queryController=o.queryController||this.resolveQueryController(),this.searchInterface=o.searchInterface||this.resolveSearchInterface(),this.usageAnalytics=o.usageAnalytics||this.resolveUA(),this.componentOptionsModel=o.componentOptionsModel||this.resolveComponentOptionsModel(),this.ensureDom=e._.once(function(){return s.createDom()}),this.initDebugInfo(),null!=this.searchInterface&&this.searchInterface.attachComponent(n,this)}return t.prototype.getBindings=function(){return{root:this.root,queryStateModel:this.queryStateModel,queryController:this.queryController,searchInterface:this.searchInterface,componentStateModel:this.componentStateModel,componentOptionsModel:this.componentOptionsModel,usageAnalytics:this.usageAnalytics}},t.prototype.initDebugInfo=function(){var t=this;e.$(this.element).dblclick(function(i){if(i.altKey){var n=t.debugInfo();null!=n&&e.$(t.root).trigger(e.DebugEvents.showDebugPanel,t.debugInfo())}})},t.prototype.debugInfo=function(){var e={};return e[this.constructor.ID]=this,e},t.prototype.enable=function(){this.disabled=!1},t.prototype.disable=function(){this.disabled=!0},t.prototype.createDom=function(){},t.prototype.resolveSearchInterface=function(){return t.resolveBinding(this.element,e.SearchInterface)},t.prototype.resolveRoot=function(i){var n=t.resolveBinding(this.element,e.SearchInterface);return n?n.element:i},t.prototype.resolveQueryController=function(i){return t.resolveBinding(this.element,e.QueryController)||i},t.prototype.resolveComponentStateModel=function(i){return t.resolveBinding(this.element,e.ComponentStateModel)||i},t.prototype.resolveQueryStateModel=function(i){return t.resolveBinding(this.element,e.QueryStateModel)||i},t.prototype.resolveComponentOptionsModel=function(i){return t.resolveBinding(this.element,e.ComponentOptionsModel)||i},t.prototype.resolveUA=function(){var t=this.resolveSearchInterface();return t&&t.usageAnalytics?t.usageAnalytics:new e.NoopAnalyticsClient},t.prototype.resolveResultElement=function(){return e.$(this.element).closest(".CoveoResult")},t.prototype.resolveResult=function(){var t=this.resolveResultElement();return e.Assert.check(1==t.length),t.data("CoveoResult")},t.prototype.isInstanceOf=function(i){return t.getComponentRef(i)&&this instanceof e[i]},t.getComponentRef=function(t){return e[t]},t.get=function(i,n,o){if(e.Assert.exists(i),e._.isString(n))return i[t.computeMemberNameForType(n)];if(e.Utils.exists(n))return e.Assert.exists(n.ID),i[t.computeMemberNameForType(n.ID)];var s=t.getBoundComponentsForElement(i);return o||e.Assert.check(s.length<=1,"More than one component is bound to this element. You need to specify the component type."),s[0]},t.bindComponentToElement=function(i,n){e.Assert.exists(i),e.Assert.exists(n),e.Assert.isNonEmptyString(n.type),i[t.computeMemberNameForType(n.type)]=n,e.$(i).addClass(t.computeCssClassNameForType(n.type)),t.getBoundComponentsForElement(i).push(n)},t.bindResultToElement=function(t,i){e.Assert.exists(t),e.Assert.exists(i),e.$(t).addClass("CoveoResult").data("CoveoResult",i),t.CoveoResult=i},t.resolveBinding=function(i,n){e.Assert.exists(i),e.Assert.exists(n),e.Assert.exists(n.ID);var o=e.$(i).closest("."+t.computeCssClassNameForType(n.ID));return 0==o.length?void 0:o.get(0)[t.computeMemberNameForType(n.ID)]},t.computeCssClassNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},t.computeSelectorForType=function(i){return e.Assert.isNonEmptyString(i),"."+t.computeCssClassNameForType(i)},t.computeMemberNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},t.pointElementsToDummyForm=function(e){e.add(e.find("*")).filter("input").attr("form","coveo-dummy-form")},t.getBoundComponentsForElement=function(t){return e.Assert.exists(t),null==t.CoveoBoundComponents&&(t.CoveoBoundComponents=[]),t.CoveoBoundComponents},t}();e.Component=t,e.CoveoJQuery.registerNamedMethod("get",function(i,n){return e.Assert.exists(i),t.get(i,n)})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.owner=t,e.Assert.exists(t)}return t.prototype.on=function(e,t,i){e.on(t,this.wrapToCallIfEnabled(i))},t.prototype.onRoot=function(t,i){this.on(e.$(this.owner.root),t,i)},t.prototype.click=function(e,t){e.click(this.wrapToCallIfEnabled(t)),"A"==e.prop("tagName")&&null==e.attr("href")&&e.attr("href","javascript:")},t.prototype.trigger=function(e,t,i){this.wrapToCallIfEnabled(function(){e.trigger(t,i)})},t.prototype.wrapToCallIfEnabled=function(e){var t=this;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];return t.owner.disabled?void 0:e.apply(t.owner,i)}},t}();e.ComponentEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){return g(0,w,e)}function n(e){return g(1,A,e)}function o(e){return g(2,O,e)}function s(e){return g(9,O,e)}function r(e){return g(12,O,e)}function a(e){return g(14,O,e)}function l(e){return g(3,E,e)}function u(e){return g(8,T,e)}function c(e){return g(4,I,e)}function p(e){return g(5,D,e)}function d(e){return g(6,_,e)}function h(e){return g(7,$,e)}function f(e,t){var i=function(t,i,n){var o=O(t,i,n);return e(o)};return g(2,i,t)}function m(e,t){var i=function(t,i,n){var o=I(t,i,n);return e(o)};return g(4,i,t)}function v(t){var i=function(i,n){for(var o=e._.keys(t.subOptions),s={},r={},a=0;a<o.length;a++){var l=o[a],u=b(n,l);s[u]=t.subOptions[l]}x(i,s,r);for(var c={},a=0;a<o.length;a++){var l=o[a],u=b(n,l);null!=r[u]&&(c[l]=r[u])}return e._.keys(c).length>0?c:null};return g(10,i,t)}function g(e,t,i){void 0===i&&(i={});var n=i;return n.type=e,n.load=t,n}function y(e,t){return t&&t.attrName?t.attrName:"data-"+C(e)}function C(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function b(e,t){return e+t.substr(0,1).toUpperCase()+t.substr(1)}function S(e,t,i){return x(e,t.options,i)}function x(t,i,n){null==n&&(n={});for(var o=e._.keys(i),s=0;s<o.length;s++){var r,a=o[s],l=i[a],u=(l.attrName||y(a,l),l.load);null!=u&&(r=u(t,a,l)),null==r&&void 0==n[a]&&(null!=l.defaultValue?r=4==l.type?e._.extend([],l.defaultValue):10==l.type?e._.extend({},l.defaultValue):l.defaultValue:null!=l.defaultFunction&&(r=l.defaultFunction(t))),null!=r&&(n[a]=10==l.type&&null!=n[a]?e._.extend(n[a],r):r)}for(var s=0;s<o.length;s++){var a=o[s],l=i[a];l.postProcessing&&(n[a]=l.postProcessing(n[a],n))}return n}function O(t,i,n){return e.$(t).attr(y(i,n))}function T(t,i,n){var o=O(t,i,n);return e.Assert.check(!e.Utils.isNonEmptyString(o)||e.Utils.isCoveoField(o),o+" is not a valid field"),o}function E(t,i,n){var o=O(t,i,n),s=String.locale||String.defaultLocale;if(null!=s&&null!=o){var r=s.toLowerCase().split("-"),a=e._.map(r,function(e,t){return r.slice(0,t+1).join("-")}),l=o.match(P);if(null!=l)for(var u=0;u<l.length;u++){var c=P.exec(l[u]);if(null!=c){var p=c[1].toLowerCase();if(e._.contains(a,p))return c[2].replace(/^\s+|\s+$/g,"")}}return null!=o?o.toLocaleString():null}return o}function A(t,i,n){var o=O(t,i,n);if(null==o)return null;var s=n.float===!0?e.Utils.parseFloatIfNotUndefined(o):e.Utils.parseIntIfNotUndefined(o);return null!=n.min&&n.min>s&&(s=n.min),null!=n.max&&n.max<s&&(s=n.max),s}function w(t,i,n){return e.Utils.parseBooleanIfNotUndefined(O(t,i,n))}function I(t,i,n){var o=n.separator||/\s*,\s*/,s=O(t,i,n);return e.Utils.isNonEmptyString(s)?s.split(o):null}function F(e,t,i,n){var o=O(e,t,i);return null!=o?n[o]:null}function D(t,i,n){var o=O(t,i,n);return e.Utils.isNonEmptyString(o)?e.$(o).get(0):null}function _(t,i,n){var o,s=n.selectorAttr||y(i,n)+"-selector",r=e.$(t).attr(s);if(o=e.$(r).get(0),null==o){var a=n.childSelector;null==a&&(a="."+i),o=R(t,a)}return o}function R(t,i){if(e.Assert.isNonEmptyString(i),e.$(t).is(i))return t;var n=e.$(t).find(i);return 0!=n.length?n.get(0):null}function V(t,i){return e.Assert.isNonEmptyString(i),e.$(t).find(i).toArray()}function $(t,i,n){if(n.lazy)return new e.LazyTemplate(t,i,n);var o,s=n.selectorAttr||y(i,n)+"-selector",r=e.$(t).attr(s),a=e.$(r).get(0);if(null!=a&&(o=B(a)),null==o){var l=n.idAttr||y(i,n)+"-id",u=e.$(t).attr(l);null!=u&&(o=Q(u))}if(null==o){var c=n.childSelector;null==c&&(c="."+i.replace(/([A-Z])/g,"-$1").toLowerCase()),o=U(t,c)}return o}function Q(t){return e.Utils.isNonEmptyString(t)?e.TemplateCache.getTemplate(t):null}function U(t,i){var n=V(t,i);return n.length>0?new e.TemplateList(e._.compact(e._.map(n,function(e){return B(e)}))):null}function M(t){for(var i=e.$(t);!i.is(document)&&0!=i.length;){if(N(i))return i.is("body")?e.$(window).get(0):i.get(0);i=i.parent()}return e.$(window).get(0)}function N(e){return"scroll"==e.css("overflow-y")}function B(t){e.Assert.exists(t);var i=e.$(t).attr("type"),n="You must specify the type of template. Valid values are : "+e.UnderscoreTemplate.mimeTypes.toString()+" "+e.HtmlTemplate.mimeTypes.toString();return e.Assert.check(e.Utils.isNonEmptyString(i),n),-1!=e._.indexOf(e.UnderscoreTemplate.mimeTypes,i)?e.UnderscoreTemplate.create(t):-1!=e._.indexOf(e.HtmlTemplate.mimeTypes,i)?new e.HtmlTemplate(t):(e.Assert.fail("Cannot guess template type from attribute: "+i+". Valid values are "+n),void 0)}!function(e){e[e.BOOLEAN=0]="BOOLEAN",e[e.NUMBER=1]="NUMBER",e[e.STRING=2]="STRING",e[e.LOCALIZED_STRING=3]="LOCALIZED_STRING",e[e.LIST=4]="LIST",e[e.SELECTOR=5]="SELECTOR",e[e.CHILD_HTML_ELEMENT=6]="CHILD_HTML_ELEMENT",e[e.TEMPLATE=7]="TEMPLATE",e[e.FIELD=8]="FIELD",e[e.ICON=9]="ICON",e[e.OBJECT=10]="OBJECT",e[e.QUERY=11]="QUERY",e[e.HELPER=12]="HELPER",e[e.LONG_STRING=13]="LONG_STRING",e[e.JSON=14]="JSON",e[e.JAVASCRIPT=15]="JAVASCRIPT",e[e.NONE=16]="NONE"}(t.Type||(t.Type={}));t.Type;t.buildBooleanOption=i,t.buildNumberOption=n,t.buildStringOption=o,t.buildIconOption=s,t.buildHelperOption=r,t.buildJsonOption=a,t.buildLocalizedStringOption=l,t.buildFieldOption=u,t.buildListOption=c,t.buildSelectorOption=p,t.buildChildHtmlElementOption=d,t.buildTemplateOption=h,t.buildCustomOption=f,t.buildCustomListOption=m,t.buildObjectOption=v,t.buildOption=g,t.attrNameFromName=y,t.camelCaseToHyphen=C,t.mergeCamelCase=b,t.initComponentOptions=S,t.initOptions=x,t.loadStringOption=O,t.loadFieldOption=T;var P=/([a-zA-Z\-]+)\s*:\s*(([^,]|,\s*(?!([a-zA-Z\-]+)\s*:))+)/g;t.loadLocalizedStringOption=E,t.loadNumberOption=A,t.loadBooleanOption=w,t.loadListOption=I,t.loadEnumOption=F,t.loadSelectorOption=D,t.loadChildHtmlElementOption=_,t.loadChildHtmlElementFromSelector=R,t.loadChildrenHtmlElementFromSelector=V,t.loadTemplateOption=$,t.loadResultTemplateFromId=Q,t.loadChildrenResultTemplateFromSelector=U,t.findParentScrolling=M,t.isElementScrollable=N,t.createResultTemplateFromElement=B}(t=e.ComponentOptions||(e.ComponentOptions={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.expression=new e.ExpressionBuilder,this.advancedExpression=new e.ExpressionBuilder,this.constantExpression=new e.ExpressionBuilder,this.disjunctionExpression=new e.ExpressionBuilder,this.firstResult=0,this.numberOfResults=10,this.enableDidYouMean=!1,this.enableDebug=!1,this.sortCriteria="relevancy",this.retrieveFirstSentences=!0,this.queryUid=e.QueryUtils.createGuid(),this.queryFunctions=[],this.rankingFunctions=[],this.groupByRequests=[],this.enableDuplicateFiltering=!1}return t.prototype.build=function(){var e={q:this.expression.build(),aq:this.advancedExpression.build(),cq:this.constantExpression.build(),dq:this.disjunctionExpression.build(),searchHub:this.searchHub,tab:this.tab,language:this.language,pipeline:this.pipeline,wildcards:this.enableWildcards,questionMarks:this.enableQuestionMarks,lowercaseOperators:this.enableLowercaseOperators,partialMatch:this.enablePartialMatch,partialMatchKeywords:this.partialMatchKeywords,partialMatchThreshold:this.partialMatchThreshold,firstResult:this.firstResult,numberOfResults:this.numberOfResults,excerptLength:this.excerptLength,filterField:this.filterField,filterFieldRange:this.filterFieldRange,parentField:this.parentField,childField:this.childField,fieldsToInclude:this.fieldsToInclude,fieldsToExclude:this.fieldsToExclude,enableDidYouMean:this.enableDidYouMean,sortCriteria:this.sortCriteria,sortField:this.sortField,queryFunctions:this.queryFunctions,rankingFunctions:this.rankingFunctions,groupBy:this.groupByRequests,retrieveFirstSentences:this.retrieveFirstSentences,timezone:this.timezone,enableDuplicateFiltering:this.enableDuplicateFiltering,enableCollaborativeRating:this.enableCollaborativeRating,debug:this.enableDebug,context:this.context};return e},t.prototype.computeCompleteExpression=function(){return this.computeCompleteExpressionParts().full},t.prototype.computeCompleteExpressionParts=function(){var t=e.ExpressionBuilder.merge(this.expression,this.advancedExpression);return{full:e.ExpressionBuilder.mergeUsingOr(e.ExpressionBuilder.merge(t,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:e.ExpressionBuilder.mergeUsingOr(t,this.disjunctionExpression).build(),constant:e.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},t.prototype.computeCompleteExpressionExcept=function(e){return this.computeCompleteExpressionPartsExcept(e).full},t.prototype.computeCompleteExpressionPartsExcept=function(t){var i=e.ExpressionBuilder.merge(this.expression,this.advancedExpression);return i.remove(t),{full:e.ExpressionBuilder.mergeUsingOr(e.ExpressionBuilder.merge(i,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:e.ExpressionBuilder.mergeUsingOr(i,this.disjunctionExpression).build(),constant:e.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},t.prototype.addContextValue=function(e,t){null==this.context&&(this.context={}),this.context[e]=t},t.prototype.addContext=function(t){null==this.context&&(this.context={}),e._.extend(this.context,t)},t}();e.QueryBuilder=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.parts=[],this.wrapParts=!0}return t.prototype.add=function(t){e.Assert.isNonEmptyString(t),this.parts.push(t)},t.prototype.fromExpressionBuilder=function(e){this.parts=this.parts.concat(e.parts)},t.prototype.addFieldExpression=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isNonEmptyString(i),e.Assert.isLargerOrEqualsThan(1,n.length),this.add(e.QueryUtils.buildFieldExpression(t,i,n))},t.prototype.addFieldNotEqualExpression=function(t,i){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isLargerOrEqualsThan(1,i.length),this.add(e.QueryUtils.buildFieldNotEqualExpression(t,i))},t.prototype.remove=function(t){e.Assert.isNonEmptyString(t);var i=e._.indexOf(this.parts,t);-1!=i&&this.parts.splice(e._.indexOf(this.parts,t),1)},t.prototype.isEmpty=function(){return 0==this.parts.length},t.prototype.build=function(){return 0==this.parts.length?void 0:1==this.parts.length?this.parts[0]:this.wrapParts?"("+this.parts.join(") (")+")":this.parts.join(" ")},t.merge=function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];var o=new t;return e._.each(i,function(e){o.parts=o.parts.concat(e.parts)}),o},t.mergeUsingOr=function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];var o=e._.filter(i,function(e){return!e.isEmpty()}),s=new t;if(1==o.length)s.parts=[].concat(o[0].parts);else if(o.length>1){var r=e._.map(o,function(e){return e.build()});s.add("("+r.join(") OR (")+")")}return s},t}();e.ExpressionBuilder=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){this.dataToString=t,this.condition=i,this.logger=new e.Logger(this)}return t.prototype.instantiateToString=function(e,t){return void 0===t&&(t=!0),!this.dataToString||t&&null!=this.condition&&!this.condition(e)?null:this.dataToString(e)},t.prototype.instantiateToElement=function(t,i){void 0===i&&(i=!0);var n=this.instantiateToString(t,i);if(null!=n){var o=e.JQueryUtils.htmlToDom(n);return this.logger.trace("Instantiated result template",t,o),e.$(o).data("template",this),o}return null},t.prototype.toHtmlElement=function(){return null},t.prototype.getType=function(){return"Template"},t}();e.Template=t}(Coveo||(Coveo={}));var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},Coveo;!function(e){var t=function(t){function i(){t.call(this)}return __extends(i,t),i.prototype.instantiateToString=function(t){e.Assert.exists(t),t=e._.extend({},t,e.UnderscoreTemplate.templateHelpers);var i=e._.map(e.TemplateCache.getDefaultTemplates(),function(t){return e.TemplateCache.getTemplate(t)});i.sort(function(e,t){return null==e.condition&&null!=t.condition?1:null!=e.condition&&null==t.condition?-1:0});for(var n=0;n<i.length;n++){var o=i[n].instantiateToString(t);if(null!=o)return o}return e._.template('<div><div class="coveo-title"><a class="CoveoResultLink"><%= title?highlight(title, titleHighlights):clickUri %></a></div><% if(excerpt){ %><div class="coveo-excerpt"><%= highlight(excerpt, excerptHighlights) %></div><% } %><table class="CoveoFieldTable"><%= templateFields() %></table></div>')(t)},i.prototype.getType=function(){return"DefaultResultTemplate"},i}(e.Template);e.DefaultResultTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){e._.templateSettings={evaluate:/(?:<%|{{)([\s\S]+?)(?:%>|}})/g,interpolate:/(?:<%|{{)=([\s\S]+?)(?:%>|}})/g,escape:/(?:<%|{{)-([\s\S]+?)(?:%>|}})/g};var t=function(t){function i(n){var o=this;t.call(this),this.element=n,e.Assert.exists(n);var s=e.$(n).html();this.template=e._.template(s);var r=e.$(n).data("condition");null!=r&&(this.condition=new Function("obj","with(obj||{}){return "+r+"}")),this.dataToString=function(t){var n=e._.extend({},t,i.templateHelpers);return o.template(n)}}return __extends(i,t),i.prototype.toHtmlElement=function(){var t=document.createElement("script");return e.$(t).attr("type",e._.first(i.mimeTypes)).attr("data-condition",e.$(this.element).data("condition")).text(this.element.innerHTML),t},i.prototype.getType=function(){return"UnderscoreTemplate"},i.create=function(t){return e.Assert.exists(t),new i(t)},i.fromString=function(t,n){var o=document.createElement("script");return o.text=t,null!=n&&e.$(o).attr("data-condition",n),new i(o)},i.registerTemplateHelper=function(e,t){i.templateHelpers[e]=t},i.isLibraryAvailable=function(){return e.Utils.exists(window._)},i.templateHelpers={},i.mimeTypes=["text/underscore","text/underscore-template","text/x-underscore","text/x-underscore-template"],i}(e.Template);e.UnderscoreTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i){t.call(this,function(){return i.innerHTML}),this.element=i;var n=e.$(i).data("condition");null!=n&&(n=n.replace(/&quot;/g,'"'),this.condition=new Function("obj","with(obj||{}){return "+n+"}"))}return __extends(i,t),i.prototype.toHtmlElement=function(){var t=document.createElement("script");return e.$(t).attr("type",e._.first(i.mimeTypes)).attr("data-condition",e.$(this.element).data("condition")).text(this.element.innerHTML),t},i.prototype.getType=function(){return"HtmlTemplate"},i.create=function(t){return e.Assert.exists(t),new i(t)},i.fromString=function(t,n){var o=document.createElement("script");return o.text=t,null!=n&&e.$(o).attr("data-condition",n),new i(o)},i.mimeTypes=["text/html"],i}(e.Template);e.HtmlTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.registerTemplate=function(i,n,o,s){void 0===o&&(o=!0),void 0===s&&(s=!1),e.Assert.isNonEmptyString(i),e.Assert.exists(n),n instanceof e.Template||(n=new e.Template(n)),null==n.name&&(n.name=i),t.templates[i]=n,o&&!e._.contains(t.templateNames,i)&&t.templateNames.push(i),s&&(t.defaultTemplates[i]=n)},t.getTemplate=function(i){return e.Assert.exists(t.templates[i]),t.templates[i]},t.getTemplates=function(){return t.templates},t.getTemplateNames=function(){return t.templateNames},t.getDefaultTemplates=function(){return e._.keys(t.defaultTemplates)},t.getDefaultTemplate=function(i){return e.Assert.exists(t.defaultTemplates[i]),t.defaultTemplates[i]},t.scanAndRegisterTemplates=function(){e.UnderscoreTemplate.isLibraryAvailable()&&t.scanAndRegisterUnderscoreTemplates(),t.scanAndRegisterHtmlTemplates()},t.scanAndRegisterUnderscoreTemplates=function(){e._.each(e.UnderscoreTemplate.mimeTypes,function(i){e.$("script[id][type='"+i+"']").each(function(i,n){var o=new e.UnderscoreTemplate(n);t.registerTemplate(e.$(n).attr("id"),o)})})},t.scanAndRegisterHtmlTemplates=function(){e._.each(e.HtmlTemplate.mimeTypes,function(i){e.$("script[id][type='"+i+"']").each(function(i,n){var o=new e.HtmlTemplate(n);t.registerTemplate(e.$(n).attr("id"),o)})})},t.templates={},t.templateNames=[],t.defaultTemplates={},t}();e.TemplateCache=t,e.$(function(){t.scanAndRegisterTemplates()})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,i,n){t.call(this),this.element=e,this.attrName=i,this.option=n
}return __extends(i,t),i.prototype.instantiateToString=function(t,i){return void 0===i&&(i=!0),void 0===this.template&&(this.template=this.option.load(this.element,this.attrName,e._.extend({},this.option,{lazy:!1})),null==this.template&&(null!=this.option.defaultValue?this.template=this.option.defaultValue:null!=this.option.defaultFunction&&(this.template=this.option.defaultFunction(this.element)))),null!=this.template?this.template.instantiateToString(t,i):null},i.prototype.getType=function(){return"LazyTemplate"},i}(e.Template);e.LazyTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t){e.call(this),this.templates=t}return __extends(t,e),t.prototype.instantiateToString=function(e,t){for(var i=0;i<this.templates.length;i++){var n=this.templates[i].instantiateToString(e,t);if(null!=n)return n}return null},t.prototype.instantiateToElement=function(e,t){void 0===t&&(t=!0);for(var i=0;i<this.templates.length;i++){var n=this.templates[i].instantiateToElement(e,t);if(null!=n)return n}return null},t.prototype.getType=function(){return"TemplateList"},t}(e.Template);e.TemplateList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.registerFieldHelper=function(e,i){t.fieldHelpers.push(e),t.registerTemplateHelper(e,i)},t.registerTemplateHelper=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),e.UnderscoreTemplate.isLibraryAvailable()&&t.registerTemplateHelperInUnderscore(i,n),t.helpers[i]=n},t.getHelper=function(e){return t.helpers[e]},t.getHelpers=function(){return t.helpers},t.registerTemplateHelperInUnderscore=function(t,i){e.Assert.isNonEmptyString(t),e.Assert.exists(i),e.Assert.check(e.UnderscoreTemplate.isLibraryAvailable()),e.UnderscoreTemplate.registerTemplateHelper(t,i)},t.helpers={},t.fieldHelpers=[],t}();e.TemplateHelpers=t}(Coveo||(Coveo={}));var Coveo;!function(e){e.AnalyticsActionCauseList={interfaceLoad:{name:"interfaceLoad",type:"interface"},interfaceChange:{name:"interfaceChange",type:"interface",metaMap:{interfaceChangeTo:1}},contextRemove:{name:"contextRemove",type:"misc",metaMap:{contextName:1}},didyoumeanAutomatic:{name:"didyoumeanAutomatic",type:"misc"},didyoumeanClick:{name:"didyoumeanClick",type:"misc"},resultsSort:{name:"resultsSort",type:"misc",metaMap:{resultsSortBy:1}},searchboxSubmit:{name:"searchboxSubmit",type:"search box"},searchboxClear:{name:"searchboxClear",type:"search box"},searchboxAsYouType:{name:"searchboxAsYouType",type:"search box"},breadcrumbFacet:{name:"breadcrumbFacet",type:"breadcrumb",metaMap:{facetId:1,facetValue:2,facetTitle:3}},breadcrumbResetAll:{name:"breadcrumbResetAll",type:"breadcrumb"},documentTag:{name:"documentTag",type:"document",metaMap:{facetId:1,facetValue:2,facetTitle:3}},documentField:{name:"documentField",type:"document",metaMap:{facetId:1,facetValue:2,facetTitle:3}},documentQuickview:{name:"documentQuickview",type:"document",metaMap:{documentTitle:1,documentURL:2}},documentOpen:{name:"documentOpen",type:"document",metaMap:{documentTitle:1,documentURL:2}},omniboxFacet:{name:"omniboxFacet",type:"omnibox",metaMap:{facetId:1,facetValue:2,facetTitle:3}},omniboxAnalytics:{name:"omniboxAnalytics",type:"omnibox",metaMap:{partialQuery:1,suggestionRanking:2,partialQueries:3,suggestions:4}},omniboxField:{name:"omniboxField",type:"omnibox"},facetClearAll:{name:"facetClearAll",type:"facet",metaMap:{facetId:1}},facetSearch:{name:"facetSearch",type:"facet",metaMap:{facetId:1}},facetToggle:{name:"facetToggle",type:"facet",metaMap:{facetId:1,facetOperatorBefore:2,facetOperatorAfter:3}},facetRangeSlider:{name:"facetRangeSlider",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetRangeGraph:{name:"facetRangeGraph",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetSelect:{name:"facetSelect",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetSelectAll:{name:"facetSelectAll",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetDeselect:{name:"facetDeselect",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetExclude:{name:"facetExclude",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetUnexclude:{name:"facetUnexclude",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},errorBack:{name:"errorBack",type:"errors"},errorClearQuery:{name:"errorClearQuery",type:"errors"},errorRetry:{name:"errorRetry",type:"errors"},noResultsBack:{name:"noResultsBack",type:"noResults"},expandToFullUI:{name:"expandToFullUI",type:"interface"},caseCreationInputChange:{name:"inputChange",type:"caseCreation"},caseCreationSubmitButton:{name:"submitButton",type:"caseCreation"},caseCreationCancelButton:{name:"cancelButton",type:"caseCreation"},caseCreationUnloadPage:{name:"unloadPage",type:"caseCreation"},casecontextAdd:{name:"casecontextAdd",type:"casecontext",metaMap:{caseID:5}},casecontextRemove:{name:"casecontextRemove",type:"casecontext",metaMap:{caseID:5}},preferencesChange:{name:"preferencesChange",type:"preferences",metaMap:{preferenceName:1,preferenceType:2}},getUserHistory:{name:"getUserHistory",type:"userHistory"},caseAttach:{name:"caseAttach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},caseDetach:{name:"caseDetach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},customfiltersChange:{name:"customfiltersChange",type:"customfilters",metaMap:{customFilterName:1,customFilterType:2,customFilterExpression:3}},pagerNumber:{name:"pagerNumber",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerNext:{name:"pagerNext",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerPrevious:{name:"pagerPrevious",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerScrolling:{name:"pagerScrolling",type:"getMoreResults"},searchFromLink:{name:"searchFromLink",type:"interface"},triggerNotify:{name:"notify",type:"queryPipelineTriggers"},triggerExecute:{name:"execute",type:"queryPipelineTriggers"},triggerRedirect:{name:"redirect",type:"queryPipelineTriggers"},queryError:{name:"query",type:"errors",metaMap:{query:1,aq:2,cq:3,dq:4,errorType:5,errorMessage:6}},exportToExcel:{name:"exportToExcel",type:"misc"}}}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.isContextual=!1}return t.prototype.isActivated=function(){return!1},t.prototype.getCurrentEventCause=function(){return null},t.prototype.getCurrentEventMeta=function(){return{}},t.prototype.logSearchEvent=function(){},t.prototype.logSearchAsYouType=function(){},t.prototype.logClickEvent=function(){},t.prototype.logCustomEvent=function(){},t.prototype.getTopQueries=function(){var t=e.$.Deferred();return t.resolve([]),t},t.prototype.getCurrentVisitId=function(){return e.$.Deferred().resolve(null)},t.prototype.sendAllPendingEvents=function(){},t.prototype.warnAboutSearchEvent=function(){},t}();e.NoopAnalyticsClient=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o,s){t.call(this,i,n,s),this.eventNameSpace=n,this.defaultAttributes=e.$.extend(!0,{},this.defaultAttributes,o),this.attributes=o,this.logger.debug("Creating model")}return __extends(i,t),i.prototype.set=function(e,t,i){var n={};n[e]=t,this.setMultiple(n,i)},i.prototype.getAttributes=function(){var t=this,i={};return e._.each(this.attributes,function(n,o){e._.isObject(n)?e.Utils.objectEqual(n,t.defaultAttributes[o])||(i[o]=n):n!=t.defaultAttributes[o]&&(i[o]=n)}),i},i.prototype.setMultiple=function(t,i){var n=this,o=!1;this.preprocessEvent(t),e._.each(t,function(e,t){i&&i.customAttribute||n.checkIfAttributeExists(t),e=n.parseToCorrectType(t,e),(!i||i.validateType)&&n.validateType(t,e),n.checkIfAttributeChanged(t,e)&&(n.attributes[t]=e,o=!0,null!=i&&i.silent||n.attributeHasChangedEvent(t))}),!o||null!=i&&i.silent||(this.attributesHasChangedEvent(),this.anyEvent())},i.prototype.setNewDefault=function(e,t,i){i&&i.customAttribute||this.checkIfAttributeExists(e),this.defaultAttributes[e]=t},i.prototype.setDefault=function(e){this.set(e,this.defaultAttributes[e])},i.prototype.get=function(e){return void 0==e?this.attributes:this.attributes[e]},i.prototype.getDefault=function(e){return void 0==e?this.defaultAttributes:this.defaultAttributes[e]},i.prototype.reset=function(){this.setMultiple(this.defaultAttributes),this.modelWasResetEvent()},i.prototype.registerNewAttribute=function(e,t){this.defaultAttributes[e]=t,this.attributes[e]=t},i.prototype.getEventName=function(e){return this.eventNameSpace+":"+e},i.prototype.attributesHasChangedEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.change),this.createAttributesChangedArgument())},i.prototype.attributeHasChangedEvent=function(t){e.$(this.element).trigger(this.getEventName(i.eventTypes.changeOne)+t,this.createAttributeChangedArgument(t))},i.prototype.preprocessEvent=function(t){e.$(this.element).trigger(this.getEventName(i.eventTypes.preprocess),t)},i.prototype.modelWasResetEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.reset),this.createModelChangedArgument())},i.prototype.anyEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.all),this.createModelChangedArgument())},i.prototype.createAttributeChangedArgument=function(e){return{attribute:e,value:this.attributes[e]}},i.prototype.createAttributesChangedArgument=function(){return{attributes:this.attributes}},i.prototype.createModelChangedArgument=function(){return{model:this}},i.prototype.checkIfAttributeExists=function(t){e.Assert.check(e._.has(this.attributes,t))},i.prototype.validateType=function(t,i){e.Utils.isNullOrUndefined(this.attributes[t])||e.Utils.isUndefined(i)||(e._.isNumber(this.attributes[t])?e.Assert.check(e._.isNumber(i)&&!isNaN(i),"Non-matching type"):e._.isBoolean(this.attributes[t])?e.Assert.check(e._.isBoolean(i)||void 0!==e.Utils.parseBooleanIfNotUndefined(i),"Non-matching type"):e.Utils.isNullOrUndefined(this.defaultAttributes[t])||e.Assert.check(typeof i==typeof this.defaultAttributes[t],"Non-matching type"))},i.prototype.parseToCorrectType=function(t,i){return e._.isNumber(this.attributes[t])?parseInt(i,10):e._.isBoolean(this.attributes[t])?e._.isBoolean(i)?i:e.Utils.parseBooleanIfNotUndefined(i):i},i.prototype.checkIfAttributeChanged=function(t,i){var n=this.attributes[t];return e._.isNumber(n)||e._.isString(n)||e._.isBoolean(n)?n!==i:e._.isArray(n)?!e.Utils.arrayEqual(n,i):e._.isObject(n)?!e.Utils.objectEqual(n,i):!0},i.prototype.debugInfo=function(){return null},i.eventTypes={preprocess:"preprocess",changeOne:"change:",change:"change",reset:"reset",all:"all"},i}(e.Component);e.Model=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i){if(e.Assert.exists(t),0==i.length||void 0==i[0])return t;if(1==i.length&&e.Utils.isNonEmptyString(i[0]))return t.get(i[0]);if(e._.isObject(i[0])){var n=i[0],o=e.$.extend({customAttribute:!0},i[1]);return t.setMultiple(n,o)}if(i.length>1){var s=i[0],r=i[1],o=e.$.extend({customAttribute:!0},i[2]);return e.Assert.isNonEmptyString(s),t.set(s,r,o)}}var i=function(t){function i(n,o,s){var r=e._.extend({},i.defaultAttributes,o);t.call(this,n,i.ID,r,s)}return __extends(i,t),i.getFacetId=function(e,t){return void 0===t&&(t=!0),"f:"+e+(t?"":":not")},i.getFacetOperator=function(e){return"f:"+e+":operator"},i.getFacetLookupValue=function(e){return i.getFacetId(e)+":lookupvalues"},i.prototype.atLeastOneFacetIsActive=function(){return!e._.isUndefined(e._.find(this.attributes,function(t,i){return 0==i.indexOf("f:")&&e.Utils.isNonEmptyArray(t)&&i.indexOf(":range")<0}))},i.prototype.set=function(e,i,n){this.validate(e,i),t.prototype.set.call(this,e,i,n)},i.prototype.validate=function(t,n){t==i.attributesEnum.first&&e.Assert.isLargerOrEqualsThan(0,n)},i.ID="state",i.defaultAttributes={q:"",first:0,t:"",hd:"",hq:"",sort:"",tg:"",quickview:""},i.attributesEnum={q:"q",first:"first",t:"t",sort:"sort",hd:"hd",hq:"hq",tg:"tg",quickview:"quickview"},i}(e.Model);e.QueryStateModel=i,e.setState=t,e.CoveoJQuery.registerNamedMethod("state",function(n){e.Assert.exists(n);var o=e.Component.resolveBinding(n,i);return t(o,e._.toArray(arguments).slice(1))})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(i){e.call(this,i,t.ID,{})}return __extends(t,e),t.prototype.registerComponent=function(e,t){var i=this.attributes[e];void 0==i?this.attributes[e]=[t]:this.attributes[e].push(t)},t.ID="ComponentState",t}(e.Model);e.ComponentStateModel=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o){var s=e._.extend({},i.defaultAttributes,o);t.call(this,n,i.ID,s)}return __extends(i,t),i.ID="ComponentOptions",i.defaultAttributes={resultLink:void 0},i.attributesEnum={resultLink:"resultLink"},i}(e.Model);e.ComponentOptionsModel=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this._window=o,this.model=s,this.queryController=r,this.ignoreNextHashChange=!1,this.initialHashChange=!1,this.willUpdateHash=!1,this._window=this._window||window,this.model=s||this.resolveQueryStateModel(),this.queryController=r||this.resolveQueryController(),e.Assert.exists(this.model),e.Assert.exists(this.queryController),e.$(this.element).on(e.InitializationEvents.restoreHistoryState,function(){a.logger.trace("Restore history state. Update model"),a.updateModelFromHash()}),e.$(this.element).on(this.model.getEventName(e.Model.eventTypes.all),function(){a.logger.trace("Query model changed. Update hash"),a.updateHashFromModel()}),e.$(this._window).on("hashchange",e.$.proxy(this.handleHashChange,this))}return __extends(i,t),i.prototype.handleHashChange=function(){if(this.logger.trace("History hash changed"),this.ignoreNextHashChange)return this.logger.trace("History hash change ignored"),this.ignoreNextHashChange=!1,void 0;var t=this.updateModelFromHash();e._.difference(i.attributesThatDoNotTriggerQuery,t).length>0&&this.queryController.executeQuery()},i.prototype.updateHashFromModel=function(){var t=this;this.logger.trace("Model -> history hash"),this.willUpdateHash||(e.Defer.defer(function(){var e=t.model.getAttributes();t.setHashValues(e),t.logger.debug("Saving state to hash",e),t.willUpdateHash=!1}),this.willUpdateHash=!0)},i.prototype.updateModelFromHash=function(){var t=this;this.logger.trace("History hash -> model");var i={},n=[];return e._.each(this.model.attributes,function(e,o){var s=t.getHashValue(o);void 0==s&&(s=t.model.defaultAttributes[o]),i[o]=s,t.model.get(o)!=s&&n.push(o)}),this.initialHashChange=!0,this.model.setMultiple(i),n},i.prototype.getHashValue=function(t){return e.Assert.isNonEmptyString(t),e.HashUtils.getValue(t,e.HashUtils.getHash(this._window))},i.prototype.setHashValues=function(t){this.logger.trace("Update history hash");var i="#"+e.HashUtils.encodeValues(t);this.ignoreNextHashChange=this._window.location.hash!=i,this.logger.trace("ignoreNextHashChange",this.ignoreNextHashChange),this.logger.trace("initialHashChange",this.initialHashChange),this.logger.trace("from",this._window.location.hash,"to",i),this.initialHashChange?(this.initialHashChange=!1,this._window.location.replace(i),this.logger.trace("History hash modified",i)):this.ignoreNextHashChange&&(this._window.location.hash=i,this.logger.trace("History hash created",i))},i.prototype.debugInfo=function(){return{state:this.model.getAttributes()}},i.ID="HistoryController",i.attributesThatDoNotTriggerQuery=["quickview"],i}(e.Component);e.HistoryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=window.localStorage,i=function(){function e(e){this.id=e}return e.prototype.save=function(e){try{null!=t&&t.setItem(this.getLocalStorageKey(),JSON.stringify(e))}catch(i){}},e.prototype.load=function(){try{if(null==t)return null;var e=t.getItem(this.getLocalStorageKey());return e&&JSON.parse(e)}catch(i){return null}},e.prototype.remove=function(e){try{if(null!=t)if(void 0==e)t.removeItem(this.getLocalStorageKey());else{var i=this.load();delete i[e],this.save(i)}}catch(n){}},e.prototype.getLocalStorageKey=function(){return"coveo-"+this.id},e}();e.LocalStorageUtils=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this._window=o,this.model=s,this.queryController=r,this.omit=[],o.localStorage?(this.storage=new e.LocalStorageUtils(i.ID),this.model=s||this.resolveQueryStateModel(),this.queryController=r||this.resolveQueryController(),e.Assert.exists(this.model),e.Assert.exists(this.queryController),e.$(this.element).on(e.InitializationEvents.restoreHistoryState,function(){return a.updateModelFromLocalStorage()}),e.$(this.element).on(this.model.getEventName(e.Model.eventTypes.all),function(){return a.updateLocalStorageFromModel()})):new e.Logger(n).info("No local storage available in current browser. LocalStorageHistoryController cannot initialize itself",this)}return __extends(i,t),i.prototype.withoutThoseAttribute=function(e){this.omit=e},i.prototype.updateLocalStorageFromModel=function(){var t=e._.omit(this.model.getAttributes(),this.omit);this.setStorageValues(t),this.logger.debug("Saving state to localstorage",t)},i.prototype.updateModelFromLocalStorage=function(){var t=this,i={},n=this.storage.load();e._.each(this.model.attributes,function(e,o){var s=n?n[o]:void 0;void 0==s&&(s=t.model.defaultAttributes[o]),i[o]=s}),this.model.setMultiple(i)},i.prototype.setStorageValues=function(e){this.storage.save(e)},i.ID="LocalStorageHistoryController",i}(e.Component);e.LocalStorageHistoryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){this.searchAsYouType=!1,this.closeModalBox=!0,this.cancel=!1}return e}(),i=function(i){function n(t,o){i.call(this,t,n.ID),this.options=o,this.showingExecutingQueryAnimation=!1,this.localStorage=new e.LocalStorageUtils("lastQueryHash"),e.Assert.exists(t),e.Assert.exists(o),this.firstQuery=!0}return __extends(n,i),n.prototype.setEndpoint=function(e){this.overrideEndpoint=e,this.logger.debug("Endpoint set",e)},n.prototype.getEndpoint=function(){var t=this.overrideEndpoint||this.options.endpoint;return new e.SearchEndpointWithDefaultCallOptions(t,this.getCallOptions())},n.prototype.getLastQuery=function(){return this.lastQuery||(new e.QueryBuilder).build()},n.prototype.getLastQueryHash=function(){return null!=this.lastQueryHash?this.lastQueryHash:(this.loadLastQueryHash(),this.lastQueryHash||this.queryHash((new e.QueryBuilder).build()))},n.prototype.getLastSearchUid=function(){return null!=this.lastSearchUid?this.lastSearchUid:(this.loadLastQueryHash(),this.lastSearchUid)},n.prototype.loadLastQueryHash=function(){var e=this.localStorage.load();null!=e&&(new Date).getTime()<=e.expire&&(this.lastQueryHash=e.hash,this.lastSearchUid=e.uid,this.localStorage.remove())},n.prototype.saveLastQuery=function(){this.localStorage.save({expire:(new Date).getTime()+18e5,hash:this.lastQueryHash,uid:this.lastSearchUid})},n.prototype.executeQuery=function(i){var n=this;null==i&&(i=e._.extend(new t,i)),i.closeModalBox&&e.ModalBox.close(!0),this.logger.debug("Executing new query",a);var i=e._.extend(new t,i);this.cancelAnyCurrentPendingQuery(),null!=i.beforeExecuteQuery&&i.beforeExecuteQuery(),i.ignoreWarningSearchEvent||this.usageAnalytics.warnAboutSearchEvent(),this.showExecutingQueryAnimation();var o=e.$.Deferred();this.currentPendingQuery=o;var s={deferred:o,searchAsYouType:i.searchAsYouType,cancel:i.cancel,origin:i.origin};if(this.newQueryEvent(s),s.cancel)return this.cancelQuery(),void 0;var r=this.createQueryBuilder(i);if(r){var a=r.build(),l=this.getEndpoint(),u=l.search(a);u.done(function(t){e.Assert.exists(t);var s=n.firstQuery;if(n.firstQuery&&(n.firstQuery=!1),o===n.currentPendingQuery){n.logger.debug("Query results received",a,t),s&&!n.searchInterface.options.enableHistory||!n.keepLastSearchUid(a,t)?(n.lastQueryHash=n.queryHash(a,t),n.lastSearchUid=t.searchUid):(t.searchUid=n.getLastSearchUid(),t._reusedSearchUid=!0,e.QueryUtils.setPropertyOnResults(t,"queryUid",n.getLastSearchUid())),n.lastQuery=a,n.lastQueryResults=t,n.currentError=null;var l={queryBuilder:r,query:a,results:t,searchAsYouType:i.searchAsYouType};n.preprocessResultsEvent(l);var u={queryBuilder:r,query:a,results:t,searchAsYouType:i.searchAsYouType,retryTheQuery:!1};if(0==t.results.length&&n.noResultEvent(u),u.retryTheQuery)n.executeQuery().done(function(e){o.resolve(e)}).fail(function(e,t){o.reject(e,t)});else{n.lastQueryBuilder=r,n.currentPendingQuery.resolve(t),n.currentPendingQuery=void 0;var c={queryBuilder:r,query:a,results:t,searchAsYouType:i.searchAsYouType};n.querySuccessEvent(c),e.Defer.defer(function(){n.deferredQuerySuccessEvent(c),n.hideExecutingQueryAnimation()})}}}),u.fail(function(e,t){if(o===n.currentPendingQuery){n.logger.error("Query triggered an error",a,t),n.currentPendingQuery.reject(t),n.currentPendingQuery=void 0;var s={queryBuilder:r,endpoint:l,query:a,error:t,searchAsYouType:i.searchAsYouType};n.lastQueryResults=null,n.currentError=t,n.queryError(s),n.hideExecutingQueryAnimation()}});var c={queryBuilder:r,query:a,deferred:o,searchAsYouType:i.searchAsYouType};return this.duringQueryEvent(c),o}},n.prototype.deferExecuteQuery=function(t){var i=this;this.showExecutingQueryAnimation(),e.Defer.defer(function(){return i.executeQuery(t)})},n.prototype.fetchMore=function(t){var i=this;if(void 0!=this.currentPendingQuery)return void 0;var n=this.currentPendingQuery=e.$.Deferred(),o=new e.QueryBuilder;this.continueLastQueryBuilder(o,t);var s=o.build(),r=this.getEndpoint();n=r.search(s);var a={queryBuilder:o,query:s,deferred:n,searchAsYouType:!1};return e.$(this.element).trigger(e.QueryEvents.duringFetchMoreQuery,a),this.lastQueryBuilder=o,this.lastQuery=s,n.done(function(t){i.currentPendingQuery=void 0,null==i.lastQueryResults?i.lastQueryResults=t:e._.forEach(t.results,function(e){i.lastQueryResults.results.push(e)});var n={queryBuilder:o,query:s,results:t,searchAsYouType:!1};i.preprocessResultsEvent(n),e.QueryUtils.setIndexAndUidOnQueryResults(s,t,i.getLastSearchUid(),t.pipeline,t.splitTestRun);var r={query:s,results:t,queryBuilder:o,searchAsYouType:!1};i.fetchMoreSuccessEvent(r)}),n},n.prototype.isStandaloneSearchbox=function(){return e.Utils.isNonEmptyString(this.options.searchPageUri)},n.prototype.cancelQuery=function(){this.cancelAnyCurrentPendingQuery(),this.hideExecutingQueryAnimation()},n.prototype.continueLastQueryBuilder=function(t,i){e.$.extend(t,this.lastQueryBuilder),t.firstResult=t.firstResult+t.numberOfResults,t.numberOfResults=i},n.prototype.createQueryBuilder=function(t){e.Assert.exists(t);var i=new e.QueryBuilder;i.language=String.locale,i.firstResult=i.firstResult||0,i.numberOfResults=this.options.resultsPerPage,i.filterField=this.options.filterField,i.excerptLength=this.options.excerptLength,i.enableCollaborativeRating=this.options.enableCollaborativeRating,e.Utils.isNonEmptyString(this.options.expression)&&i.advancedExpression.add(this.options.expression),e.Utils.isNonEmptyString(this.options.timezone)&&(i.timezone=this.options.timezone);var n={queryBuilder:i,searchAsYouType:t.searchAsYouType,cancel:t.cancel};this.buildingQueryEvent(n);var o={queryBuilder:i,searchAsYouType:t.searchAsYouType,cancel:t.cancel};if(this.doneBuildingQueryEvent(o),n.cancel||o.cancel)return this.cancelQuery(),void 0;var s=this.getPipelineInUrl();return s&&(i.pipeline=s),i},n.prototype.getPipelineInUrl=function(){return e.QueryUtils.getUrlParameter("pipeline")},n.prototype.cancelAnyCurrentPendingQuery=function(){return e.Utils.exists(this.currentPendingQuery)?(this.logger.debug("Cancelling current pending query"),this.currentPendingQuery.reject(),this.currentPendingQuery=void 0,!0):!1},n.prototype.showExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation||(e.$(this.root).addClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!0)},n.prototype.hideExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation&&(e.$(this.root).removeClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!1)},n.prototype.keepLastSearchUid=function(e,t){return this.getLastQueryHash()==this.queryHash(e,t)},n.prototype.queryHash=function(t,i){var n=JSON.stringify(e._.omit(t,"firstResult","groupBy","debug"));return null!=i&&(n+=i.pipeline),n},n.prototype.getCallOptions=function(){var t={options:{authentication:[]}};return e.$(this.element).trigger(e.QueryEvents.buildingCallOptions,t),t.options},n.prototype.newQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.newQuery,t)},n.prototype.buildingQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.buildingQuery,t)},n.prototype.doneBuildingQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.doneBuildingQuery,t)},n.prototype.duringQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.duringQuery,t)},n.prototype.querySuccessEvent=function(t){e.$(this.element).trigger(e.QueryEvents.querySuccess,t)},n.prototype.fetchMoreSuccessEvent=function(t){e.$(this.element).trigger(e.QueryEvents.fetchMoreSuccess,t)},n.prototype.deferredQuerySuccessEvent=function(t){e.$(this.element).trigger(e.QueryEvents.deferredQuerySuccess,t)},n.prototype.queryError=function(t){e.$(this.element).trigger(e.QueryEvents.queryError,t)},n.prototype.preprocessResultsEvent=function(t){e.$(this.element).trigger(e.QueryEvents.preprocessResults,t)},n.prototype.noResultEvent=function(t){e.$(this.element).trigger(e.QueryEvents.noResults,t)},n.prototype.debugInfo=function(){var t=this,i={query:this.lastQuery};return null!=this.lastQueryResults&&(i.queryDuration=function(){return t.buildQueryDurationSection(t.lastQueryResults)},i.results=function(){return e._.omit(t.lastQueryResults,"results")}),null!=this.currentError&&(i.error=function(){return t.currentError}),i},n.prototype.buildQueryDurationSection=function(t){var i=e.$('<div class="coveo-debug-queryDuration"></div>'),n=e.$('<div class="coveo-debug-durations"></div>').appendTo(i);return e._.forEach(e.Debug.durationKeys,function(o){var s=t[o];if(null!=s){n.append('<div class="coveo-debug-duration" style="width:'+s+'px" data-id="'+o+'"></div>');var r=e.$('<div class="coveo-debug-duration-legend" data-id="'+o+'"></div>').appendTo(i);e.$('<span class="coveo-debug-duration-label"></span>').text(o).appendTo(r),e.$('<span class="coveo-debug-duration-value"></span>').text(s).appendTo(r)}}),i},n.ID="QueryController",n}(e.Component);e.QueryController=i,e.CoveoJQuery.registerNamedMethod("executeQuery",function(t){e.Assert.exists(t);var n=e.Component.resolveBinding(t,i);e.Assert.exists(n),n.executeQuery()})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.newQuery="newQuery",e.buildingQuery="buildingQuery",e.doneBuildingQuery="doneBuildingQuery",e.duringQuery="duringQuery",e.duringFetchMoreQuery="duringFetchMoreQuery",e.querySuccess="querySuccess",e.fetchMoreSuccess="fetchMoreSuccess",e.deferredQuerySuccess="deferredQuerySuccess",e.queryError="queryError",e.preprocessResults="preprocessResults",e.noResults="noResults",e.buildingCallOptions="buildingCallOptions",e}();e.QueryEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.beforeInitialization="beforeInitialization",e.afterComponentsInitialization="afterComponentsInitialization",e.restoreHistoryState="restoreHistoryState",e.afterInitialization="afterInitialization",e}();e.InitializationEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.newResultsDisplayed="newResultsDisplayed",e.newResultDisplayed="newResultDisplayed",e.openQuickview="openQuickview",e}();e.ResultListEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.imageResultsLayoutComplete="imageResultsLayoutComplete",e}();e.ImageResultListEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.enterOnSearchbox="enterOnSearchbox",e.quickviewLoaded="quickviewLoaded",e.openQuickview="openQuickview",e}();e.UserActionEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.savePreferences="savePreferences",e.exitPreferencesWithoutSave="exitPreferencesWithoutSave",e}();e.PreferencesPanelEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;void 0===r&&(r=window),t.call(this,n,i.ID),this.element=n,this.options=o,this.analyticsOptions=s,e.$(document.body).toggleClass("coveo-mobile-device",e.DeviceUtils.isMobileDevice()),FastClick.attach(n),this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.options.hideUntilFirstQuery&&this.showAndHideFirstQueryAnimation(),this.root=n,this.usageAnalytics=this.initializeAnalytics(),this.queryStateModel=new e.QueryStateModel(n),this.componentStateModel=new e.ComponentStateModel(n),this.componentOptionsModel=new e.ComponentOptionsModel(n),this.queryController=new e.QueryController(n,this.options),this.searchInterface=this;var l=this.queryStateModel.getEventName(e.Model.eventTypes.preprocess);e.$(this.element).on(l,function(e,t){return a.handlePreprocessQueryStateModel(t)}),e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),this.options.enableHistory?this.options.useLocalStorageForHistory?new e.LocalStorageHistoryController(n,r,this.queryStateModel,this.queryController):new e.HistoryController(n,r,this.queryStateModel,this.queryController):e.$(this.element).on(e.InitializationEvents.restoreHistoryState,function(){return a.queryStateModel.setMultiple(a.queryStateModel.defaultAttributes)});var u=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.quickview);e.$(this.element).on(u,e.$.proxy(this.handleQuickviewChanged,this)),e.$(this.element).css("display","block"),this.setupDebugInfo()}return __extends(i,t),i.prototype.initializeAnalytics=function(){var t=e.Component.getComponentRef("Analytics");return t?t.create(this.element,this.analyticsOptions):new e.NoopAnalyticsClient},i.prototype.setupDebugInfo=function(){var t=this;if(this.options.enableDebugInfo){var i=e.Component.getComponentRef("Debug");i?setTimeout(function(){return new i(t.element)}):this.logger.warn("Options to enable debug component was true, but not present in the Coveo object (not compiled)")}},i.prototype.showAndHideFirstQueryAnimation=function(){var t=this;this.displayFirstQueryWaitAnimation(),e.$(this.element).one(e.QueryEvents.querySuccess,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})}),e.$(this.element).on(e.QueryEvents.queryError,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})})},i.prototype.displayFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).addClass("coveo-waiting-for-first-query"),e.$(this.element).append(this.options.firstLoadingAnimation)},i.prototype.hideFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).removeClass("coveo-waiting-for-first-query")},i.prototype.handlePreprocessQueryStateModel=function(t){var i=this.queryStateModel.get(e.QueryStateModel.attributesEnum.tg),n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.t),o=i,s=n;void 0!==t.tg&&(t.tg=this.getTabGroupId(t.tg),o!=t.tg&&(t.t=t.t||e.QueryStateModel.defaultAttributes.t,t.sort=t.sort||e.QueryStateModel.defaultAttributes.sort,o=t.tg)),void 0!==t.t&&(t.t=this.getTabId(o,t.t),s!=t.t&&(t.sort=t.sort||e.QueryStateModel.defaultAttributes.sort,s=t.t)),void 0!==t.sort&&(t.sort=this.getSort(s,t.sort)),void 0!==t.quickview&&(t.quickview=this.getQuickview(t.quickview))},i.prototype.getTabGroupId=function(t){var i=e.Component.getComponentRef("TabGroup");if(i){var n=this.searchInterface.components(i.ID);if(t!=e.QueryStateModel.defaultAttributes.tg&&e._.any(n,function(e){return!e.disabled&&t==e.options.id}))return t;if(n.length>0)return n[0].options.id}return e.QueryStateModel.defaultAttributes.tg},i.prototype.getTabId=function(t,i){var n=e.Component.getComponentRef("Tab"),o=e.Component.getComponentRef("TabGroup");if(n){var s=this.searchInterface.components(n.ID);
if(o&&t!=e.QueryStateModel.defaultAttributes.tg){var r=this.searchInterface.components(o.ID),a=e._.find(r,function(e){return t==e.options.id});if(i!=e.QueryStateModel.defaultAttributes.t&&e._.any(s,function(e){return i==e.options.id&&a.isElementIncludedInTabGroup(e.element)}))return i;var l=e._.find(s,function(e){return a.isElementIncludedInTabGroup(e.element)});return null!=l?l.options.id:e.QueryStateModel.defaultAttributes.t}if(i!=e.QueryStateModel.defaultAttributes.t&&e._.any(s,function(e){return i==e.options.id}))return i;if(s.length>0)return s[0].options.id}return e.QueryStateModel.defaultAttributes.t},i.prototype.getSort=function(t,i){var n=e.Component.getComponentRef("Sort");if(n){var o=this.searchInterface.components(n.ID),s=e.Component.getComponentRef("Tab");if(s&&t!=e.QueryStateModel.defaultAttributes.t){var r=this.searchInterface.components(s.ID),a=e._.find(r,function(e){return t==e.options.id}),l=a.options.sort;if(i!=e.QueryStateModel.defaultAttributes.sort&&e._.any(o,function(e){return a.isElementIncludedInTab(e.element)&&e.match(i)}))return i;if(null!=l)return l.toString();var u=e._.find(o,function(e){return a.isElementIncludedInTab(e.element)});return null!=u?u.options.sortCriteria[0].toString():e.QueryStateModel.defaultAttributes.sort}if(i!=e.QueryStateModel.defaultAttributes.sort&&e._.any(o,function(e){return e.match(i)}))return i;if(o.length>0)return o[0].options.sortCriteria[0].toString()}return e.QueryStateModel.defaultAttributes.sort},i.prototype.getQuickview=function(t){var i=e.Component.getComponentRef("Quickview");if(i){var n=this.searchInterface.components(i.ID);if(e._.any(n,function(e){return e.getHashId()==t}))return t}return e.QueryStateModel.defaultAttributes.quickview},i.prototype.handleQuickviewChanged=function(t,i){var n=e.Component.getComponentRef("Quickview");if(n){var o=this.searchInterface.components(n.ID);if(""!=i.value){var s=e._.partition(o,function(e){return e.getHashId()==i.value});0!=s[0].length&&(e._.first(s[0]).open(),e._.forEach(e._.tail(s[0]),function(e){return e.close()})),e._.forEach(s[1],function(e){return e.close()})}else e._.forEach(o,function(e){e.close()})}},i.prototype.handleBuildingQuery=function(e,t){this.options.enableDuplicateFiltering&&(t.queryBuilder.enableDuplicateFiltering=!0),null!=this.options.pipeline&&(t.queryBuilder.pipeline=this.options.pipeline)},i.prototype.attachComponent=function(e,t){this.components(e).push(t)},i.prototype.detachComponent=function(t,i){var n=this.components(t),o=e._.indexOf(n,i);o>-1&&n.splice(o,1)},i.prototype.components=function(e){return null==this.attachedComponents&&(this.attachedComponents={}),e in this.attachedComponents||(this.attachedComponents[e]=[]),this.attachedComponents[e]},i.ID="SearchInterface",i.options={searchPageUri:e.ComponentOptions.buildStringOption(),enableHistory:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),resultsPerPage:e.ComponentOptions.buildNumberOption({defaultValue:10,min:0}),excerptLength:e.ComponentOptions.buildNumberOption({defaultValue:200,min:0}),expression:e.ComponentOptions.buildStringOption({defaultValue:""}),filterField:e.ComponentOptions.buildStringOption({defaultValue:""}),hideUntilFirstQuery:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),firstLoadingAnimation:e.ComponentOptions.buildChildHtmlElementOption({childSelector:".coveo-first-loading-animation",defaultFunction:function(){return e.JQueryUtils.getBasicLoadingAnimation().get(0)}}),autoTriggerQuery:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),endpoint:e.ComponentOptions.buildCustomOption(function(t){return null!=t&&t in e.SearchEndpoint.endpoints?e.SearchEndpoint.endpoints[t]:null},{defaultFunction:function(){return e.SearchEndpoint.endpoints["default"]}}),timezone:e.ComponentOptions.buildStringOption({defaultFunction:function(){return jstz.determine().name()}}),enableDebugInfo:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableCollaborativeRating:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),useLocalStorageForHistory:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableDuplicateFiltering:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),pipeline:e.ComponentOptions.buildStringOption()},i}(e.Component);e.SearchInterface=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){void 0===r&&(r=window),t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,r),this.element=n,this.options=o,this.analyticsOptions=s,e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this.handleRedirect,this))}return __extends(i,t),i.prototype.handleRedirect=function(t,i){var n={searchPageUri:this.options.searchPageUri,cancel:!1};e.$(this.root).trigger(e.StandaloneSearchInterfaceEvents.beforeRedirect,n),n.cancel||(i.cancel=!0,(!this.searchboxIsEmpty()||this.options.redirectIfEmpty)&&this.redirectToSearchPage(n.searchPageUri))},i.prototype.redirectToSearchPage=function(t){var i=this.queryStateModel.getAttributes(),n=this.usageAnalytics.getCurrentEventCause();null!=n&&(i.firstQueryCause=n);var o=this.usageAnalytics.getCurrentEventMeta();null!=o&&(i.firstQueryMeta=o),window.location.href=t+"#"+e.HashUtils.encodeValues(i)},i.prototype.searchboxIsEmpty=function(){return e.Utils.isEmptyString(this.queryStateModel.get(e.QueryStateModel.attributesEnum.q))},i.ID="StandaloneSearchInterface",i.options={redirectIfEmpty:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.SearchInterface);e.StandaloneSearchInterface=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.beforeRedirect="beforeRedirect",e}();e.StandaloneSearchInterfaceEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.debug=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).on(e.QueryEvents.buildingQuery,function(e,t){t.queryBuilder.enableDebug=r.debug||t.queryBuilder.enableDebug}),e.$(this.element).on(e.ResultListEvents.newResultDisplayed,function(e,t){return r.handleNewResultDisplayed(e,t)}),e.$(this.root).on(e.DebugEvents.showDebugPanel,function(e,t){r.handleShowDebugPanel(t)}),this.localStorageDebug=new e.LocalStorageUtils("DebugPanel"),this.collapsedSections=this.localStorageDebug.load()||[]}return __extends(i,t),i.prototype.showDebugPanel=function(t){var i=this,n=t(),o=function(){var e=t();return l.attr("href",i.dowloadHref(e.json)),e.body},s=e.ModalBox.open(n.body,{title:"",className:"coveo-debug",titleClose:!0,overlayClose:!0}),r=s.wrapper.children(".coveo-title"),a=this.buildSearchbox(n.body);this.buildEnableCheckbox(n.body,a,o).appendTo(r),a.appendTo(r);var l=e.$('<a download="debug.json">Download</a>').appendTo(r).attr("href",this.dowloadHref(n.json))},i.prototype.handleShowDebugPanel=function(t){var i=this;null==this.stackDebug&&(setTimeout(function(){var e=i.stackDebug;i.showDebugPanel(function(){return i.buildStackPanel(e)}),i.stackDebug=null}),this.stackDebug={}),e._.extend(this.stackDebug,t)},i.prototype.handleNewResultDisplayed=function(t,i){var n=this;null!=i.item&&e.$(i.item).dblclick(function(e){n.handleResultDoubleClick(e,i)})},i.prototype.handleResultDoubleClick=function(t,i){var n=this;if(t.altKey){var o=i.result.index,s=function(t){return null!=t?e._.find(t.results,function(e){return e.index==o}):i.result},r=e.$(i.item),a=r.data("template");this.handleShowDebugPanel({result:s,fields:function(e){return n.buildFieldsSection(s(e))},rankingInfo:function(e){return n.buildRankingInfoSection(s(e))},template:this.templateToJson(a)})}},i.prototype.dowloadHref=function(e){return"data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))},i.prototype.buildStackPanel=function(t,n){var o=this,s=e.$('<div class="coveo-debug"></div>'),r=e._.pairs(e._.keys(t));r=r.sort(function(t,n){var o=e._.indexOf(i.customOrder,t[1]),s=e._.indexOf(i.customOrder,n[1]);return-1!=o&&-1!=s?o-s:-1!=o?-1:-1!=s?1:t[0]-n[0]});var a={};return e._.forEach(r,function(e){var i=o.buildSection(e[1]),r=o.buildStackPanelSection(t[e[1]],n);i.container.append(r.section),null!=r.json&&(a[e[1]]=r.json),i.dom.appendTo(s)}),{body:s,json:a}},i.prototype.buildStackPanelSection=function(t,i){if(t instanceof e.$)return{section:t};if(e._.isFunction(t))return this.buildStackPanelSection(t(i),i);var n=this.toJson(t);return{section:this.buildProperty(n),json:n}},i.prototype.buildSearchbox=function(t){var i=this,n=e.$('<div class="coveo-debug-search"><input type="text"/></div>').click(function(e){e.stopPropagation()}),o="",s=e.$(n).find("input").attr({placeholder:"Search in debug"}).keyup(function(e){if(13==e.keyCode){var n=s.val().toLowerCase();o!=n&&(o=n,i.search(n,t))}}).change(function(){var e=s.val().toLowerCase();o!=e&&(o=e,i.search(e,t))});return n},i.prototype.search=function(t,i){var n=this;e._.isEmpty(t)?(i.find(".coveo-search-match, .coveo-search-submatch").removeClass("coveo-search-match, coveo-search-submatch"),i.removeClass("coveo-searching")):(i.addClass("coveo-searching-loading"),setTimeout(function(){var o=i.find(".coveo-section .coveo-section-container > .coveo-property"),s=(new Date).getTime();e._.each(o,function(e){n.findInProperty(e,t),console.log((new Date).getTime()-s)}),i.addClass("coveo-searching"),i.removeClass("coveo-searching-loading")}))},i.prototype.findInProperty=function(t,i){var n=this,o=e.$(t),s=-1!=t.label.indexOf(i);if(s?this.highlightSearch(t.labelDom,i):this.removeHighlightSearch(t.labelDom),o.hasClass("coveo-property-object")){o.toggleClass("coveo-search-match",s);var r=t.buildKeys(),a=!1;return e._.each(r,function(e){a=n.findInProperty(e,i)||a}),o.toggleClass("coveo-search-submatch",a),s||a}return-1!=t.value.indexOf(i)?(this.highlightSearch(t.valueDom,i),s=!0):this.removeHighlightSearch(t.valueDom),o.toggleClass("coveo-search-match",s),s},i.prototype.buildEnableCheckbox=function(t,i,n){var o=this,s=e.$('<div class="coveo-enabled-debug"><label>Enable query debug <input type="checkbox"/></label></div>').click(function(e){e.stopPropagation()}),r=e.$(s).find("input");return r.prop("checked",this.debug),r.change(function(){o.debug=!o.debug,e.$(o.element).one(e.QueryEvents.querySuccess+" "+e.QueryEvents.queryError,function(e,i){t.removeClass("coveo-debug-loading"),t.empty().append(n(i.results).children())}),o.queryController.executeQuery({closeModalBox:!1}),t.addClass("coveo-debug-loading"),i.find("input").val("").keyup()}),s},i.prototype.buildSection=function(t){var i=this,n=e.$('<div class="coveo-section"></div>').addClass("coveo-"+t+"-section"),o=e.$('<div class="coveo-section-header"></div>').text(t).appendTo(n),s=e.$('<div class="coveo-section-container"></div>').appendTo(n);return e._.contains(this.collapsedSections,t)&&n.addClass("coveo-debug-collapsed"),o.click(function(){n.toggleClass("coveo-debug-collapsed"),e._.contains(i.collapsedSections,t)?i.collapsedSections=e._.without(i.collapsedSections,t):i.collapsedSections.push(t),i.localStorageDebug.save(i.collapsedSections)}),{dom:n,header:o,container:s}},i.prototype.buildFieldsSection=function(t){var i={};return e._.each(t.raw,function(e,t){i["@"+t]=e}),i},i.prototype.buildRankingInfoSection=function(e){return e.rankingInfo&&this.parseRankingInfo(e.rankingInfo)},i.prototype.parseRankingInfo=function(t){var i=this,n={},o=t.match(/^(?:Document weights:\n((?:.)*?)\n)?\n(?:Terms weights:\n((?:.|\n)*))?Total weight: ([0-9]+)$/);if(null!=o[1]&&(n["Document weights"]=this.parseWeights(o[1])),null!=o[2]){var s=e.StringUtils.match(o[2],/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g);n["Terms weights"]=e._.object(e._.map(s,function(t){var n=e._.object(e._.map(e.StringUtils.match(t[1],/([^:]+): ([0-9]+), ([0-9]+); /g),function(e){return[e[1],{Correlation:Number(e[2]),"TF-IDF":Number(e[3])}]})),o=i.parseWeights(t[2]);return[e._.keys(n).join(", "),{terms:n,Weights:o}]}))}return n["Total weight"]=Number(o[3]),n},i.prototype.parseWeights=function(t){var i=t.match(/(\w+(?:\s\w+)*): ([0-9]+)/g);return e._.object(e._.map(i,function(e){var t=e.match(/^(\w+(?:\s\w+)*): ([0-9]+)$/);return[t[1],Number(t[2])]}))},i.prototype.buildProperty=function(t,i){return!e._.isArray(t)&&!e._.isObject(t)||e._.isString(t)?this.buildBasicProperty(t,i):this.buildObjectProperty(t,i)},i.prototype.buildObjectProperty=function(t,i){var n=this,o=document.createElement("div");o.className="coveo-property coveo-property-object";var s=document.createElement("div");s.className="coveo-property-value";var r=e._.keys(t);e._.isArray(t)||r.sort();var a,l=function(){return null==a&&(a=[],e._.each(r,function(e){var i=n.buildProperty(t[e],e);null!=i&&(a.push(i),s.appendChild(i))})),a};if(o.buildKeys=l,null!=i){var u=document.createElement("div");u.className="coveo-property-label",u.appendChild(document.createTextNode(i)),o.labelDom=u,o.appendChild(u),0!=r.length&&(o.className+=" coveo-collapsible",u.onclick=function(){l();var t=o.className.split(/\s+/);e._.contains(t,"coveo-expanded")?t=e._.without(t,"coveo-expanded"):t.push("coveo-expanded"),o.className=t.join(" ")})}else l();if(0==r.length){var c=e._.without(o.className.split(/\s+/),"coveo-property-object");c.push("coveo-property-basic"),o.className=c.join(" "),s.innerHTML=e._.isArray(t)?"[]":"{}",o.value=""}return o.label=null!=i?i.toLowerCase():"",o.appendChild(s),o},i.prototype.buildBasicProperty=function(t,i){var n=this,o=document.createElement("div");if(o.className="coveo-property coveo-property-basic",null!=i){var s=document.createElement("div");s.className="coveo-property-label",s.appendChild(document.createTextNode(i)),o.appendChild(s),o.labelDom=s}var r=null!=t?t.toString():String(t);null!=t&&null!=t.ref&&(t=t.ref);var a=document.createElement("div");a.appendChild(document.createTextNode(r)),a.ondblclick=function(){n.selectElementText(a)},o.appendChild(a),o.valueDom=a;var l=["coveo-property-value"];return e._.isString(t)&&l.push("coveo-property-value-string"),(e._.isNull(t)||e._.isUndefined(t))&&l.push("coveo-property-value-null"),e._.isNumber(t)&&l.push("coveo-property-value-number"),e._.isBoolean(t)&&l.push("coveo-property-value-boolean"),e._.isObject(t)&&l.push("coveo-property-value-object"),e._.isArray(t)&&l.push("coveo-property-value-array"),a.className=l.join(" "),o.label=null!=i?i.toLowerCase():"",o.value=r.toLowerCase(),o},i.prototype.toJson=function(t,n,o){var s=this;if(void 0===n&&(n=0),void 0===o&&(o=[]),t instanceof e.Component||t instanceof e.SearchEndpoint)return this.componentToJson(t,n);if(t instanceof HTMLElement)return this.htmlToJson(e.$(t));if(t instanceof e.$)return this.htmlToJson(t);if(t instanceof e.Template)return this.templateToJson(t);if(t==window)return this.toJsonRef(t);if(e._.isArray(t)||e._.isObject(t)){if(e._.contains(o,t))return this.toJsonRef(t,"< RECURSIVE >");if(n>=i.maxDepth)return this.toJsonRef(t);if(e._.isArray(t))return e._.map(t,function(e){return s.toJson(e,n+1,o.concat([t]))});var r={};return e._.each(t,function(e,i){r[i]=s.toJson(e,n+1,o.concat([t]))}),r.ref,r}return t},i.prototype.toJsonRef=function(e,t){return t=new String(t||e),t.ref=e,t},i.prototype.componentToJson=function(t,i){void 0===i&&(i=0);var n=e._.keys(t.options);return n.length>0?this.toJson(t.options,i):this.toJsonRef(t.options,new String("No options"))},i.prototype.htmlToJson=function(t){var i=this;return t.length>0?void 0:t.length>1?e._.map(t,function(t){return i.htmlToJson(e.$(t))}):{tagName:t.prop("tagName"),id:t.attr("id"),classList:t.attr("class").split(/\s+/),data:t.data()}},i.prototype.templateToJson=function(t){if(null==t)return null;var i=t.element,n={type:t.getType()};return null!=i&&(n.id=i.id,n.condition=e.$(i).data("condition"),n.content=e.$(i).html()),n},i.prototype.selectElementText=function(e){if(window.getSelection&&document.createRange){var t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}else if("createTextRange"in document.body){var n=document.body.createTextRange();n.moveToElementText(e),n.select()}},i.prototype.highlightSearch=function(t,i){null!=t&&(t.innerHTML=t.innerText.replace(new RegExp("("+e.StringUtils.regexEncode(i)+")","gi"),'<span class="coveo-debug-highlight">$1</span>'))},i.prototype.removeHighlightSearch=function(e){null!=e&&(e.innerHTML=e.innerText)},i.prototype.debugInfo=function(){return null},i.ID="Debug",i.options={enableDebug:e.ComponentOptions.buildBooleanOption({defaultvalue:!1})},i.customOrder=["error","queryDuration","result","fields","rankingInfo","template","query","results","state"],i.durationKeys=["indexDuration","proxyDuration","clientDuration","duration"],i.maxDepth=10,i}(e.Component);e.Debug=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.showDebugPanel="showDebugPanel",e}();e.DebugEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.querySuccess,this.handleQuerySuccess),e.$(this.element).hide()}return __extends(i,t),i.prototype.handleBuildingQuery=function(e,t){var i={field:this.options.field,maximumNumberOfValues:0,computedFields:[{field:this.options.field,operation:this.options.operation}]};this.index=t.queryBuilder.groupByRequests.length,t.queryBuilder.groupByRequests.push(i)},i.prototype.handleQuerySuccess=function(t,i){if(e._.isNumber(this.index)&&0!=i.results.groupByResults.length){var n=i.results.groupByResults[this.index],o=n.globalComputedFieldResults[0];e.$(this.element).text(Globalize.format(o,this.options.format)),e.$(this.element).show()}else e.$(this.element).hide()},i.ID="Aggregate",i.options={field:e.ComponentOptions.buildStringOption(),operation:e.ComponentOptions.buildStringOption({defaultValue:"sum"}),format:e.ComponentOptions.buildStringOption({defaultValue:"c0"})},i}(e.Component);e.Aggregate=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.options=t,this.visitId=void 0,this.logger=new e.Logger(this)}return t.prototype.getVisitId=function(i){var n=this,o=e.$.Deferred();if(this.visitId)o.resolve(this.visitId);else{var s=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/analytics/visit");this.getFromService(s,i).done(function(e){n.visitId=e.id,o.resolve(n.visitId)})}return o},t.prototype.sendSearchEvents=function(t){var i=this;t.length>0&&(this.logger.info("Logging analytics search events",t),this.sendEventToApi(t,"searches","searchEvents").done(function(t){e.Utils.isNullOrUndefined(t)||(i.visitId=e._.first(t.searchEventResponses).visitId)}))},t.prototype.sendDocumentViewEvent=function(t){var i=this;e.Assert.exists(t),this.logger.info("Logging analytics document view",t),this.sendEventToApi(t,"click","clickEvent").done(function(t){e.Utils.isNullOrUndefined(t)||(i.visitId=t.visitId)})},t.prototype.sendCustomEvent=function(t){var i=this;e.Assert.exists(t),this.logger.info("Logging analytics custom event",t),this.sendEventToApi(t,"custom","customEvent").done(function(t){e.Utils.isNullOrUndefined(t)||(i.visitId=t.visitId)})},t.prototype.getTopQueries=function(i){var n=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/stats/topQueries");return this.getFromService(n,i)},t.prototype.sendEventToApi=function(i,n,o){var s=this,r=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/analytics/"+n);if(r=this.appendUrlParamSign(r),r+=o+"="+encodeURIComponent(JSON.stringify(i)),this.options.token&&""!=this.options.token&&(r+="&access_token="+encodeURIComponent(this.options.token)),null==t.pendingRequest){var a=t.pendingRequest=e.$.ajax({url:r,dataType:"jsonp",async:!1});return t.pendingRequest.done(function(){t.pendingRequest=null}),a}var l=e.$.Deferred();return t.pendingRequest.always(function(){s.sendEventToApi(i,n,o).done(function(e){l.resolve(e)}).fail(function(e){l.reject(e)})}),l},t.prototype.appendUrlParamSign=function(e){return"?"==e.charAt(e.length-1)?e:e+"?"},t.prototype.getFromService=function(t,i){var n=this.options.token&&""!=this.options.token?e.$.extend({access_token:this.options.token},i):i;return e.$.ajax({url:this.appendUrlParamSign(t)+this.buildQueryStringFromParam(n),dataType:"jsonp"})},t.prototype.buildQueryStringFromParam=function(t){var i=e._.map(e._.pairs(t),function(e){return e[0]+"="+encodeURIComponent(e[1])});return i.join("&")},t.DEFAULT_ANALYTICS_URI="https://usageanalytics.coveo.com",t.DEFAULT_ANALYTICS_VERSION="v14",t.CUSTOM_ANALYTICS_VERSION=void 0,t}();e.AnalyticsEndpoint=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n,o){this._root=t,this._endpoint=i,this._templateSearchEvent=n,this._sendToCloud=o,this.searchDeferred=[],this.searchEvents=[],this.results=[],this._cancelled=!1,this._finished=!1,e.Assert.exists(t),e.Assert.exists(i),e.Assert.exists(n),this.handler=e.$.proxy(this._handleDuringQuery,this),e.$(t).on(e.QueryEvents.duringQuery+" "+e.QueryEvents.duringFetchMoreQuery,this.handler)}return t.prototype.getEventCause=function(){return this._templateSearchEvent.actionCause},t.prototype.getEventMeta=function(){return this._templateSearchEvent.customData},t.prototype.cancel=function(){this._stopRecording(),this._cancelled=!0},t.prototype._handleDuringQuery=function(t,i){var n=this;e.Assert.check(!this._finished),e.Assert.check(!this._cancelled),this.searchDeferred.push(i.deferred);var o=e.Component.get(t.target,e.SearchInterface);e.Assert.exists(o);var s=e.Component.get(t.target,e.QueryController);e.Assert.exists(s),i.deferred.done(function(t){if(e.Assert.exists(t),e.Assert.check(!n._finished),t._reusedSearchUid!==!0){var s=e._.extend({},n._templateSearchEvent);n.fillSearchEvent(s,o,i.query,t),n.searchEvents.push(s),n.results.push(t)}}).always(function(){var t=e._.indexOf(n.searchDeferred,i.deferred);n.searchDeferred.splice(t,1),0==n.searchDeferred.length&&n.flush()})},t.prototype._stopRecording=function(){this.handler&&(e.$(this._root).off(e.QueryEvents.duringQuery+" "+e.QueryEvents.duringFetchMoreQuery,this.handler),this.handler=void 0)},t.prototype.flush=function(){var t=this;this._cancelled||(this._stopRecording(),this._finished=!0,e.Assert.check(this.searchEvents.length==this.results.length),e.Defer.defer(function(){t._sendToCloud&&t._endpoint.sendSearchEvents(t.searchEvents);var i=e._.map(t.searchEvents,function(t){return e.APIAnalyticsBuilder.convertSearchEventToAPI(t)});e.$(t._root).trigger(e.AnalyticsEvents.searchEvent,{searchEvents:i})}))},t.prototype.fillSearchEvent=function(t,i,n,o){e.Assert.exists(t),e.Assert.exists(i),e.Assert.exists(n),e.Assert.exists(o);var s=i.queryStateModel.get(e.QueryStateModel.attributesEnum.q);t.queryPipeline=o.pipeline,t.splitTestRunName=t.splitTestRunName||o.splitTestRun,t.splitTestRunVersion=t.splitTestRunVersion||(void 0!=o.splitTestRun?o.pipeline:void 0),t.originLevel2=t.originLevel2||i.queryStateModel.get("t")||"default",t.queryText=s||n.q||"",t.advancedQuery=n.aq||"",t.didYouMean=n.enableDidYouMean,t.numberOfResults=o.totalCount,t.responseTime=o.duration,t.pageNumber=n.firstResult/n.numberOfResults,t.resultsPerPage=n.numberOfResults,t.searchQueryUid=o.searchUid,t.queryPipeline=o.pipeline},t}();e.PendingSearchEvent=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o,s){t.call(this,i,n,o,s),this._root=i,this._endpoint=n,this._templateSearchEvent=o,this._sendToCloud=s,this.delayBeforeSending=5e3,this.armBatchDelay=50,this.beforeUnloadHandler=e.$.proxy(this.onWindowUnload,this),e.$(window).on("beforeunload",this.beforeUnloadHandler)}return __extends(i,t),i.prototype._handleDuringQuery=function(i,n){var o=this;this.toSendRightNow=function(){o.isCancelledOrFinished()||t.prototype._handleDuringQuery.call(o,i,n)},e._.delay(function(){o.toSendRightNow()},this.delayBeforeSending)},i.prototype.sendRightNow=function(){this.toSendRightNow&&this.toSendRightNow()},i.prototype._stopRecording=function(){t.prototype._stopRecording.call(this),this.beforeUnloadHandler&&(e.$(window).off("beforeunload",this.beforeUnloadHandler),this.beforeUnloadHandler=void 0)},i.prototype.onWindowUnload=function(){this.isCancelledOrFinished()||(this.armBatchDelay=0,this.sendRightNow())},i.prototype.isCancelledOrFinished=function(){return this._cancelled?!0:this._finished?(this.cancel(),!0):!1},i}(e.PendingSearchEvent);e.PendingSearchAsYouTypeSearchEvent=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.searchEvent="analyticsSearchEvent",e.documentViewEvent="analyticsDocumentViewEvent",e.customEvent="analyticsCustomEvent",e.changeAnalyticsCustomData="changeAnalyticsCustomData",e}();e.AnalyticsEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.convertSearchEventToAPI=function(e){var t={advancedQuery:e.advancedQuery,customMetadatas:e.customData,device:e.device,didYouMean:e.didYouMean,language:e.language,pageNumber:e.pageNumber,queryText:e.queryText,responseTime:e.responseTime,numberOfResults:e.numberOfResults,resultsPerPage:e.resultsPerPage,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,type:e.actionType,actionCause:e.actionCause,queryPipeline:e.queryPipeline,splitTestRunName:e.splitTestRunName,splitTestRunVersion:e.splitTestRunVersion};return t},e.convertDocumentViewToAPI=function(e){var t={collectionName:e.collectionName,device:e.device,documentPosition:e.documentPosition,title:e.documentTitle,documentUrl:e.documentUrl,documentUri:e.documentUri,documentUriHash:e.documentUriHash,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,sourceName:e.sourceName,viewMethod:e.viewMethod,customMetadatas:e.customData,actionCause:e.actionCause,queryPipeline:e.queryPipeline,splitTestRunName:e.splitTestRunName,splitTestRunVersion:e.splitTestRunVersion};return t},e.convertCustomEventToAPI=function(e){var t={actionCause:e.actionCause,actionType:e.actionType,device:e.device,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,customMetadatas:e.customData};return t},e}();e.APIAnalyticsBuilder=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n,o,s,r,a,l,u){this.endpoint=t,this.rootElement=i,this.userId=n,this.userDisplayName=o,this.anonymous=s,this.splitTestRunName=r,this.splitTestRunVersion=a,this.originLevel1=l,this.sendToCloud=u,this.isContextual=!1,this.language=String.locale,this.device=e.DeviceUtils.getDeviceName(),this.mobile=e.DeviceUtils.isMobileDevice(),e.Assert.exists(t),e.Assert.exists(i),e.Assert.isNonEmptyString(this.language),e.Assert.isNonEmptyString(this.device),e.Assert.isNonEmptyString(this.originLevel1),this.logger=new e.Logger(this)}return t.prototype.isActivated=function(){return!0},t.prototype.getCurrentVisitId=function(){var t={},i=e.Utils.readCookie("visitor");return i&&(t.visitor=i),this.endpoint.getVisitId(t)},t.prototype.getCurrentEventCause=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventCause():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventCause():null},t.prototype.getCurrentEventMeta=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventMeta():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventMeta():null},t.prototype.logSearchEvent=function(e,t){var i=this.buildMetaObject(t);this.pushSearchEvent(e,i)},t.prototype.logSearchAsYouType=function(e,t){var i=this.buildMetaObject(t);this.pushSearchAsYouTypeEvent(e,i)},t.prototype.logClickEvent=function(e,t,i,n){var o=this.buildMetaObject(t);this.pushClickEvent(e,o,i,n)},t.prototype.logCustomEvent=function(e,t,i){var n=this.buildMetaObject(t);this.pushCustomEvent(e,n,i)},t.prototype.getTopQueries=function(e){return this.endpoint.getTopQueries(e)},t.prototype.sendAllPendingEvents=function(){this.pendingSearchAsYouTypeSearchEvent&&this.pendingSearchAsYouTypeSearchEvent.sendRightNow()},t.prototype.warnAboutSearchEvent=function(){e._.isUndefined(this.pendingSearchEvent)&&e._.isUndefined(this.pendingSearchAsYouTypeSearchEvent)&&(this.logger.warn("A search was triggered, but no analytics event was logged. If you wish to have consistent analytics data, consider logging a search event using the methods provided by the framework","https://developers.coveo.com/x/TwA5"),window.console&&console.trace&&console.trace())},t.prototype.pushCustomEvent=function(t,i,n){var o=this,s=this.buildCustomEvent(t,i,n);this.triggerChangeAnalyticsCustomData("CustomEvent",i,s),this.checkToSendAnyPendingSearchAsYouType(t),e.Defer.defer(function(){o.sendToCloud&&o.endpoint.sendCustomEvent(s),e.$(o.rootElement).trigger(e.AnalyticsEvents.customEvent,{customEvent:e.APIAnalyticsBuilder.convertCustomEventToAPI(s)})})},t.prototype.pushSearchEvent=function(t,i){var n=this;if(e.Assert.exists(t),this.pendingSearchEvent&&this.pendingSearchEvent.getEventCause()!==t.name&&(this.pendingSearchEvent._stopRecording(),this.pendingSearchEvent=null),this.checkToSendAnyPendingSearchAsYouType(t),!this.pendingSearchEvent){var o=this.buildSearchEvent(t,i);this.triggerChangeAnalyticsCustomData("SearchEvent",i,o);var s=this.pendingSearchEvent=new e.PendingSearchEvent(this.rootElement,this.endpoint,o,this.sendToCloud);e.Defer.defer(function(){n.pendingSearchEvent=void 0,s._stopRecording()})}},t.prototype.checkToSendAnyPendingSearchAsYouType=function(e){this.eventIsNotRelatedToSearchbox(e.name)?this.sendAllPendingEvents():this.cancelAnyPendingSearchAsYouTypeEvent()},t.prototype.pushSearchAsYouTypeEvent=function(t,i){this.cancelAnyPendingSearchAsYouTypeEvent();var n=this.buildSearchEvent(t,i);this.triggerChangeAnalyticsCustomData("SearchEvent",i,n),this.pendingSearchAsYouTypeSearchEvent=new e.PendingSearchAsYouTypeSearchEvent(this.rootElement,this.endpoint,n,this.sendToCloud)},t.prototype.pushClickEvent=function(t,i,n,o){var s=this,r=this.buildClickEvent(t,i,n,o);this.checkToSendAnyPendingSearchAsYouType(t),this.triggerChangeAnalyticsCustomData("ClickEvent",i,r),e.Assert.isNonEmptyString(r.searchQueryUid),e.Assert.isNonEmptyString(r.collectionName),e.Assert.isNonEmptyString(r.sourceName),e.Assert.isNumber(r.documentPosition),e.Defer.defer(function(){s.sendToCloud&&s.endpoint.sendDocumentViewEvent(r),e.$(s.rootElement).trigger(e.AnalyticsEvents.documentViewEvent,{documentViewEvent:e.APIAnalyticsBuilder.convertDocumentViewToAPI(r)})})},t.prototype.buildAnalyticsEvent=function(t,i){return{actionCause:t.name,actionType:t.type,username:this.userId,userDisplayName:this.userDisplayName,anonymous:this.anonymous,device:this.device,mobile:this.mobile,language:this.language,responseTime:void 0,originLevel1:this.originLevel1,originLevel2:this.resolveActiveTabFromElement(this.rootElement),customData:e._.keys(i).length>0?i:void 0,userAgent:navigator.userAgent}},t.prototype.buildSearchEvent=function(e,t){return this.merge(this.buildAnalyticsEvent(e,t),{searchQueryUid:void 0,pipeline:void 0,splitTestRunName:this.splitTestRunName,splitTestRunVersion:this.splitTestRunVersion,queryText:void 0,advancedQuery:void 0,results:void 0,resultsPerPage:void 0,pageNumber:void 0,didYouMean:void 0,facets:void 0,contextual:this.isContextual})},t.prototype.buildClickEvent=function(e,t,i,n){return this.merge(this.buildAnalyticsEvent(e,t),{searchQueryUid:i.queryUid,queryPipeline:i.pipeline,splitTestRunName:this.splitTestRunName||i.splitTestRun,splitTestRunVersion:this.splitTestRunVersion||(void 0!=i.splitTestRun?i.pipeline:void 0),documentUri:i.uri,documentUriHash:i.raw.sysurihash,documentUrl:i.clickUri,documentTitle:i.title,originLevel2:this.resolveActiveTabFromElement(n)||"default",collectionName:i.raw.syscollection,sourceName:i.raw.syssource,documentPosition:i.index+1,responseTime:0,viewMethod:e.name,rankingModifier:i.rankingModifier})
},t.prototype.buildCustomEvent=function(e,t,i){return this.merge(this.buildAnalyticsEvent(e,t),{eventType:e.type,eventValue:e.name,originLevel2:this.resolveActiveTabFromElement(i)||"default",responseTime:0})},t.prototype.buildMetaObject=function(t){var i=e._.extend({},t);return i.JSUIVersion=e.version.lib+";"+e.version.product,i},t.prototype.cancelAnyPendingSearchAsYouTypeEvent=function(){this.pendingSearchAsYouTypeSearchEvent&&(this.pendingSearchAsYouTypeSearchEvent.cancel(),this.pendingSearchAsYouTypeSearchEvent=void 0)},t.prototype.resolveActiveTabFromElement=function(t){e.Assert.exists(t);var i=this.resolveQueryStateModel(t);return i&&i.get(e.QueryStateModel.attributesEnum.t)},t.prototype.resolveQueryStateModel=function(t){return e.Component.resolveBinding(t,e.QueryStateModel)},t.prototype.eventIsNotRelatedToSearchbox=function(t){return t!==e.AnalyticsActionCauseList.searchboxSubmit.name&&t!==e.AnalyticsActionCauseList.searchboxClear.name},t.prototype.triggerChangeAnalyticsCustomData=function(t,i,n){var o={language:n.language,originLevel1:n.originLevel1,originLevel2:n.originLevel2,originLevel3:n.originLevel3};i.metaDataAsString={},i.metaDataAsNumber={};var s=e.$.extend({},{type:t,metaObject:i},o);e.$(this.rootElement).trigger(e.AnalyticsEvents.changeAnalyticsCustomData,s),n.language=s.language,n.originLevel1=s.originLevel1,n.originLevel2=s.originLevel2,n.originLevel3=s.originLevel3,n.customData=i;var r=n.customData.metaDataAsString;e._.keys(r).length>0&&(this.logger.warn("Using deprecated 'metaDataAsString' key to log custom analytics data. Custom meta should now be put at the root of the object."),e._.extend(n.customData,r)),delete n.customData.metaDataAsString;var a=n.customData.metaDataAsNumber;e._.keys(a).length>0&&(this.logger.warn("Using deprecated 'metaDataAsNumber' key to log custom analytics data. Custom meta should now be put at the root of the object."),e._.extend(n.customData,a)),delete n.customData.metaDataAsNumber},t.prototype.merge=function(t,i){return e.$.extend({},t,i)},t}();e.LiveAnalyticsClient=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e){void 0===e&&(e=[]),this.analyticsClients=e,this.isContextual=!1}return t.prototype.isActivated=function(){return e._.some(this.analyticsClients,function(e){return e.isActivated()})},t.prototype.getCurrentEventCause=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventCause()}),function(e){return null!=e})},t.prototype.getCurrentEventMeta=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventMeta()}),function(e){return null!=e})},t.prototype.logSearchEvent=function(t,i){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,i)})},t.prototype.logSearchAsYouType=function(t,i){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,i)})},t.prototype.logClickEvent=function(t,i,n,o){e._.each(this.analyticsClients,function(e){return e.logClickEvent(t,i,n,o)})},t.prototype.logCustomEvent=function(t,i,n){e._.each(this.analyticsClients,function(e){return e.logCustomEvent(t,i,n)})},t.prototype.getTopQueries=function(t){var i=this,n=e.$.Deferred(),o=[];return e._.forEach(this.analyticsClients,function(e){e.getTopQueries(t).done(function(e){o[r]=e;for(var s=!0,r=0;r<i.analyticsClients.length&&s;r++)s=s&&void 0!=o[r];s&&n.resolve(i.mergeTopQueries(o,t.pageSize))})}),n},t.prototype.getCurrentVisitId=function(){return e._.first(this.analyticsClients).getCurrentVisitId()},t.prototype.sendAllPendingEvents=function(){e._.each(this.analyticsClients,function(e){return e.sendAllPendingEvents()})},t.prototype.warnAboutSearchEvent=function(){e._.each(this.analyticsClients,function(e){return e.warnAboutSearchEvent()})},t.prototype.mergeTopQueries=function(t,i){var n=[];return e._.each(t,function(t){return e._.each(t,function(e){return n.push(e)})}),n.length=Math.min(n.length,i),n},t}();e.MultiAnalyticsClient=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(e){var t=i(e);return t?t.client:void 0}function i(t){var i=e.$(t).find("."+e.Component.computeCssClassNameForType(e.Analytics.ID));return 0!=i.length?i.coveo():void 0}e.CoveoJQuery.registerNamedMethod("logCustomEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1];o.logCustomEvent(s,r,e)}}),e.CoveoJQuery.registerNamedMethod("logSearchEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1];o.logSearchEvent(s,r)}}),e.CoveoJQuery.registerNamedMethod("logSearchAsYouTypeEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1];o.logSearchAsYouType(s,r)}}),e.CoveoJQuery.registerNamedMethod("logClickEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1],a=i[2];o.logClickEvent(s,r,a,e)}}),e.CoveoJQuery.registerNamedMethod("logCustomEventVersion",function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var s=t(i);if(s){var r=s;e.AnalyticsEndpoint.CUSTOM_ANALYTICS_VERSION=n[0],r.endpoint.sendCustomEvent(n[1]),e.AnalyticsEndpoint.CUSTOM_ANALYTICS_VERSION=void 0}})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){if(void 0===o&&(o={}),t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null==this.options.token){var r=e.SearchEndpoint.endpoints["default"];r&&(this.options.token=r.options.accessToken)}this.initializeAnalyticsClient(),e.Assert.exists(this.client),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.queryError,this.handleQueryError)}return __extends(i,t),i.create=function(t,n){var o=e.Component.computeSelectorForType(i.ID),s=e.$(t),r=s.find(o).add(s.closest(o));return 1==r.length?i.getClient(r.get(0),n):r.length>1?new e.MultiAnalyticsClient(e._.map(r,function(e){return i.getClient(e,n)})):new e.NoopAnalyticsClient},i.getClient=function(t,n){var o=e.Component.get(t,i,!0);return o instanceof i?o.client:new i(t,n).client},i.prototype.initializeAnalyticsEndpoint=function(){return new e.AnalyticsEndpoint({token:this.options.token,serviceUrl:this.options.endpoint})},i.prototype.initializeAnalyticsClient=function(){if(e.Utils.isNonEmptyString(this.options.endpoint)){var t=this.initializeAnalyticsEndpoint();this.client=new e.LiveAnalyticsClient(t,this.root||this.element,this.options.user,this.options.userDisplayName,this.options.anonymous,this.options.splitTestRunName,this.options.splitTestRunVersion,this.options.searchHub,this.options.sendToCloud)}else this.client=new e.NoopAnalyticsClient},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),i.queryBuilder.searchHub=this.options.searchHub},i.prototype.handleQueryError=function(t,i){e.Assert.exists(i),this.client.logCustomEvent(e.AnalyticsActionCauseList.queryError,{query:i.query.q,aq:i.query.aq,cq:i.query.cq,dq:i.query.dq,errorType:i.error.type,errorMessage:i.error.message},e.$(t.target)[0])},i.ID="Analytics",i.options={user:e.ComponentOptions.buildStringOption(),userDisplayName:e.ComponentOptions.buildStringOption(),token:e.ComponentOptions.buildStringOption(),endpoint:e.ComponentOptions.buildStringOption({defaultValue:e.AnalyticsEndpoint.DEFAULT_ANALYTICS_URI}),anonymous:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchHub:e.ComponentOptions.buildStringOption({defaultValue:"default"}),splitTestRunName:e.ComponentOptions.buildStringOption(),splitTestRunVersion:e.ComponentOptions.buildStringOption(),sendToCloud:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.Analytics=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){void 0===o&&(o={}),t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.bind.onRoot(e.QueryEvents.buildingCallOptions,this.handleBuildingCallOptions),this.bind.onRoot(e.QueryEvents.queryError,this.handleQueryError)}return __extends(i,t),i.prototype.getCssClass=function(){return"coveo-authentication-provider"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("Reauthenticate",this.options.caption),onOpen:function(){return t.authenticateWithProvider()},onClose:function(){return 0}}]},i.prototype.handleBuildingCallOptions=function(e,t){t.options.authentication.push(this.options.name)},i.prototype.handleQueryError=function(e,t){t.error.provider==this.options.name&&this.authenticateWithProvider()},i.prototype.authenticateWithProvider=function(){this.options.useIFrame?this.useIFrameToAuthenticate():this.redirectToAuthenticationProvider()},i.prototype.redirectToAuthenticationProvider=function(){this.logger.info("Redirecting to authentication provider "+this.options.name),window.location.href=this.getAuthenticationProviderUriForRedirect()},i.prototype.useIFrameToAuthenticate=function(){var t=this;this.logger.info("Using iframe to retrieve authentication for provider "+this.options.name);var i,n=e.$("<iframe/>").attr("src",this.getAuthenticationProviderUriForIFrame());i=this.options.showIFrame?this.createPopupForVisibleIFrame(n):this.createPopupForWaitMessage(n),e.$(window).one("message",function(){i.close(),n.detach(),t.logger.info("Got authentication for provider "+t.options.name+"; retrying query."),t.queryController.executeQuery()})},i.prototype.createPopupForWaitMessage=function(t){var i=e.$("<div/>").addClass("coveo-waiting-for-authentication-popup").append(e.JQueryUtils.getBasicLoadingDots());return t.hide().appendTo(document.body),e.ModalBox.open(i,{title:e.l("Authenticating",this.options.caption)})},i.prototype.createPopupForVisibleIFrame=function(t){var i=e.$("<div/>");return t.addClass("coveo-authentication-iframe").appendTo(i),e.ModalBox.open(i,{className:"coveo-authentication-popup"})},i.prototype.getAuthenticationProviderUriForRedirect=function(){return this.queryController.getEndpoint().getAuthenticationProviderUri(this.options.name,window.location.href,void 0)},i.prototype.getAuthenticationProviderUriForIFrame=function(){return this.queryController.getEndpoint().getAuthenticationProviderUri(this.options.name,void 0,"success")},i.ID="AuthenticationProvider",i.options={name:e.ComponentOptions.buildStringOption(),caption:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.name}}),useIFrame:e.ComponentOptions.buildBooleanOption({defaultValue:!1,attrName:"data-use-iframe"}),showIFrame:e.ComponentOptions.buildBooleanOption({defaultValue:!0,attrName:"data-show-iframe"})},i}(e.Component);e.AuthenticationProvider=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.populateBreadcrumb="populateBreadcrumb",e.clearBreadcrumb="clearBreadcrumb",e.redrawBreadcrumb="redrawBreadcrumb",e}();e.BreadcrumbEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).one(e.InitializationEvents.afterInitialization,function(){return r.handleAfterInitialization()}),e.$(this.root).on(e.BreadcrumbEvents.redrawBreadcrumb,function(){return r.redrawBreadcrumb()}),e.$(this.element).hide()}return __extends(i,t),i.prototype.drawBreadcrumb=function(t){var i=this;e.$(this.element).children().detach();var n=e.$("<div />").addClass("coveo-breadcrumb-clear-all");e.$(this.element).fastToggle(0!=t.length),e.$(this.element).append(n);for(var o=0;o<t.length;o++)e.$(t[o].element).addClass("coveo-breadcrumb-item").appendTo(this.element);n.attr("title",e.l("ClearAllFilters")),n.append(e.$("<div />").addClass("coveo-icon coveo-breadcrumb-icon-clear-all")),this.bind.click(n,function(){i.clearBreadcrumbs()})},i.prototype.redrawBreadcrumb=function(){this.lastBreadcrumbs?this.drawBreadcrumb(this.lastBreadcrumbs):this.drawBreadcrumb(this.getBreadcrumbs())},i.prototype.handleDeferredQuerySuccess=function(){this.drawBreadcrumb(this.getBreadcrumbs())},i.prototype.handleAfterInitialization=function(){var t=this;e.$(this.root).on(e.QueryEvents.deferredQuerySuccess,function(){return t.handleDeferredQuerySuccess()})},i.prototype.getBreadcrumbs=function(){var t={breadcrumbs:[]};return e.$(this.root).trigger(e.BreadcrumbEvents.populateBreadcrumb,t),this.logger.debug("Retrieved breadcrumbs",t.breadcrumbs),this.lastBreadcrumbs=t.breadcrumbs,t.breadcrumbs},i.prototype.clearBreadcrumbs=function(){var t=this,i={};e.$(this.root).trigger(e.BreadcrumbEvents.clearBreadcrumb,i),this.logger.debug("Clearing breadcrumbs"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.breadcrumbResetAll,{})}})},i.ID="Breadcrumb",i.options={},i}(e.Component);e.Breadcrumb=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(i,n){void 0===n&&(n=""),this.sort=i,this.direction=n,e.Assert.isNonEmptyString(i),e.Assert.check(e._.contains(t.validSorts,i)||t.sortIsField(i)),t.sortNeedsDirection(i)?e.Assert.check(e._.contains(t.validDirections,n)):e.Assert.check(""==n)}return t.prototype.putInQueryBuilder=function(i){e.Assert.exists(i),t.sortIsField(this.sort)?(i.sortCriteria="field"+this.direction,i.sortField=this.sort):i.sortCriteria=""!=this.direction?this.sort+this.direction:this.sort},t.prototype.getValueFromResult=function(i){return e.Assert.exists(i),t.sortIsField(this.sort)?(e.Assert.stringStartsWith(this.sort,"@"),e.Utils.getFieldValue(i,this.sort)):"date"==this.sort?i.raw.sysdate:(e.Assert.fail("Cannot retrieve value: "+this.sort),void 0)},t.prototype.toString=function(){return e.Utils.isNonEmptyString(this.direction)?this.sort+" "+this.direction:this.sort},t.prototype.equals=function(t){return e.Assert.exists(t),t.sort==this.sort&&t.direction==this.direction},t.parse=function(i){e.Assert.isNonEmptyString(i);var n=i.match(/\S+/g);return new t(n[0],n[1])},t.sortIsField=function(e){return"@"==e.substr(0,1)},t.sortNeedsDirection=function(i){return e._.contains(t.sortsNeedingDirection,i)||t.sortIsField(i)},t.validSorts=["relevancy","date","qre"],t.sortsNeedingDirection=["date"],t.validDirections=["ascending","descending"],t}();e.SortCriteria=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.iconTemplate=e._.template("<span class='coveo-icon <%= icon %>'></span>"),this.tabTemplate=e._.template("<span><%= caption %></span>"),this.isFirstQuery=!0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this));var r=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);e.$(this.root).on(r,e.$.proxy(this.handleQueryStateChanged,this)),this.render(),e.$(this.element).click(e.$.proxy(this.handleClick,this))}return __extends(i,t),i.prototype.select=function(){this.disabled||this.queryStateModel.setMultiple({t:this.options.id,sort:this.options.sort||e.QueryStateModel.defaultAttributes.sort})},i.prototype.handleClick=function(t){var i=this;t.preventDefault(),this.select(),e.DeviceUtils.isMobileDevice()&&e.MobileUtils.removeToggleClassOnSearchInterface(),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.interfaceChange,{interfaceChangeTo:i.options.id})}})},i.prototype.render=function(){var t=this.options.icon;""!=t&&e.$(this.element).prepend(this.iconTemplate({icon:t}));var i=this.options.caption;e.Utils.isNonEmptyString(i)&&e.$(this.element).append(this.tabTemplate({caption:i}))},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),this.isFirstQuery=!1,!this.disabled&&this.isSelected()&&(i.queryBuilder.tab=this.options.id,e.Utils.isNonEmptyString(this.options.expression)&&(this.options.constant?i.queryBuilder.constantExpression.add(this.options.expression):i.queryBuilder.advancedExpression.add(this.options.expression)),this.options.enableDuplicateFiltering&&(i.queryBuilder.enableDuplicateFiltering=!0),null!=this.options.pipeline&&(i.queryBuilder.pipeline=this.options.pipeline))},i.prototype.handleQueryStateChanged=function(t,i){e.Assert.exists(i),!this.disabled&&this.isSelected()?(e.$(this.element).addClass("coveo-selected"),this.queryController.setEndpoint(this.options.endpoint),this.showAndHideAppropriateElements()):e.$(this.element).removeClass("coveo-selected")},i.prototype.isSelected=function(){var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.t);return t==this.options.id},i.prototype.showAndHideAppropriateElements=function(){var t=this,i=[],n=[];e._.each(e.$(this.root).find("[data-tab],[data-tab-not]"),function(e){t.isElementIncludedInTab(e)?(t.toggleAllComponentsUnder(e,!0),i.push(e)):(t.toggleAllComponentsUnder(e,!1),n.push(e))}),e.$(this.root).one(e.QueryEvents.querySuccess,function(){e._.each(i,function(t){return e.$(t).removeClass("coveo-tab-disabled")}),e._.each(n,function(t){return e.$(t).addClass("coveo-tab-disabled")})})},i.prototype.isElementIncludedInTab=function(t){e.Assert.exists(t);var i=this.splitListOfTabs(e.$(t).attr("data-tab")),n=this.splitListOfTabs(e.$(t).attr("data-tab-not"));return e.Assert.check(!(0!=i.length&&0!=n.length),"You cannot both explicity include and exclude an element from tabs"),0!=i.length&&-1!=e._.indexOf(i,this.options.id)||0!=n.length&&-1==e._.indexOf(n,this.options.id)||0==i.length&&0==n.length},i.prototype.splitListOfTabs=function(t){return e.Utils.exists(t)?e._.map(t.split(","),function(t){return e.Utils.trim(t)}):[]},i.prototype.toggleAllComponentsUnder=function(t,i){e.Assert.exists(t),e.$(t).find("*").addBack().each(function(t,n){var o=e.Component.get(n,void 0,!0);o&&(i?o.enable():o.disable())})},i.prototype.enable=function(){t.prototype.enable.call(this),e.$(this.element).css("display","")},i.prototype.disable=function(){t.prototype.disable.call(this),e.$(this.element).css("display","none")},i.ID="Tab",i.options={id:e.ComponentOptions.buildStringOption({required:!0}),caption:e.ComponentOptions.buildLocalizedStringOption({required:!0}),icon:e.ComponentOptions.buildIconOption(),expression:e.ComponentOptions.buildStringOption(),endpoint:e.ComponentOptions.buildCustomOption(function(t){return null!=t?e.SearchEndpoint.endpoints[t]:null}),sort:e.ComponentOptions.buildStringOption(),constant:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableDuplicateFiltering:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),pipeline:e.ComponentOptions.buildStringOption()},i}(e.Component);e.Tab=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o);var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);e.$(this.root).on(a,e.$.proxy(this.handleTabChange,this)),this.options.tabSectionToOpen&&(e.$(this.options.tabSectionToOpen).addClass("coveo-targeted-by-current-tab"),e.$(this.element).addClass("coveo-targeting-tab-section"),this.bind.click(e.$(this.element),function(){e.$(".coveo-glass").toggleClass("coveo-active-glass").toggleClass("coveo-active-glass-for-current-tab"),e.$(r.element).toggleClass("coveo-opening-tab-section"),e.$(r.options.tabSectionToOpen).toggleClass("coveo-opened-by-current-tab"),e.$(r.element).hasClass("coveo-opening-tab-section")?(e.$(r.options.tabSectionToOpen).css("z-index","1001"),e.$(r.element).css("z-index","1001")):(e.$(r.options.tabSectionToOpen).css("z-index",void 0),e.$(r.element).css("z-index",void 0))}))}return __extends(i,t),i.prototype.handleTabChange=function(){var t=this,i=this.queryStateModel.get(e.QueryStateModel.attributesEnum.t);if(e.Utils.isNonEmptyString(i)){var n=!1;e.$(this.root).find(e.Component.computeSelectorForType(e.Tab.ID)).each(function(o,s){var r=e.Component.get(s,e.Tab);r.options.id==i&&(e.$(t.element).html(e.$(r.element).html()),n=!0)}),e.Assert.check(n,"Cannot find the currently active tab")}else e.$(this.element).hide()},i.ID="CurrentTab",i.options={tabSectionToOpen:e.ComponentOptions.buildStringOption()},i}(e.Component);e.CurrentTab=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.hideNext=!0,this.bind.onRoot(e.QueryEvents.buildingQuery,this.handlePrepareQueryBuilder),this.bind.onRoot(e.QueryEvents.querySuccess,this.handleProcessNewQueryResults),this.bind.onRoot(e.QueryEvents.noResults,this.handleNoResults),this.bind.onRoot(e.QueryEvents.newQuery,this.handleNewQuery),e.$(this.element).hide()}return __extends(i,t),i.prototype.handleNewQuery=function(){this.hideNext?(e.$(this.element).empty(),e.$(this.element).hide()):this.hideNext=!0},i.prototype.handlePrepareQueryBuilder=function(t,i){e.Assert.exists(i),i.queryBuilder.enableDidYouMean=!0},i.prototype.handleNoResults=function(t,i){if(e.Utils.isNonEmptyArray(i.results.queryCorrections)&&!i.searchAsYouType&&this.options.enableAutoCorrection){var n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.q),o=this.buildCorrectedSentence(i.results.queryCorrections[0]);this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,i.results.queryCorrections[0].correctedQuery),i.retryTheQuery=!0,this.hideNext=!1,e.$('<div class="coveo-did-you-mean-no-results-for"/>').html(e.l("noResultFor","<span class='coveo-highlight coveo-did-you-mean-highlight'>"+e.StringUtils.htmlEncode(n)+"</span>")).appendTo(this.element),e.$('<div class="coveo-did-you-mean-automatic-correct" />').html(e.l("autoCorrectedQueryTo","<span class='coveo-highlight'>"+o+"</span>")).appendTo(this.element),e.$(this.element).show(),this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.didyoumeanAutomatic,{})}},i.prototype.handleProcessNewQueryResults=function(t,i){var n=this;e.Assert.exists(i),e.Assert.exists(i.results);var o=i.results;if(this.logger.trace("Received query results from new query",o),e.Utils.isNonEmptyArray(o.queryCorrections)){var s=this.buildCorrectedSentence(o.queryCorrections[0]),r=e.$('<div class="coveo-did-you-mean-suggestion"/>').text(e.l("didYouMean","")).appendTo(this.element),a=e.$("<a/>").html(s).appendTo(r);e.$(a).click(function(){n.doQueryWithCorrectedTerm(o.queryCorrections[0].correctedQuery)}),e.$(this.element).show()}},i.prototype.buildCorrectedSentence=function(t){var i=[],n='<span class="coveo-did-you-mean-word-correction">',o="</span>",s=0;return e._.each(t.wordCorrections,function(r){i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s,r.offset))),s=r.offset,i.push(n),i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s,r.length+s))),i.push(o),s=r.offset+r.length}),i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s))),i.join("")},i.prototype.doQueryWithCorrectedTerm=function(t){var i=this;this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.didyoumeanClick,{})}})},i.ID="DidYouMean",i.options={enableAutoCorrection:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.DidYouMean=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).append(e.$("<div />").addClass("coveo-error-report-title").append("<h3></h3><h4></h4>"));var r=e.$("<div />").addClass("coveo-error-report-options").append(this.buildPrevious()).append(this.buildClear()).append(this.buildRetry());e.$(this.element).append(r).append(this.message=e.$("<div class='coveo-error-report-message'></div>")).hide(),e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this.handleNewQuery,this)),e.$(this.root).on(e.QueryEvents.queryError,e.$.proxy(this.handleQueryError,this))}return __extends(i,t),i.prototype.setErrorTitle=function(){var t={h3:e.l("OopsError"),h4:e.l("ProblemPersists")};e.DeviceUtils.isPhonegap()&&navigator.connection&&window.Connection&&(navigator.connection.type==window.Connection.NONE||0===navigator.connection.type)&&(t={h3:e.l("CannotConnect"),h4:e.l("NoNetworkConnection")}),e.$(this.element).find("h3").text(t.h3),e.$(this.element).find("h4").text(t.h4)},i.prototype.buildPrevious=function(){var t=this;return e.$("<span class='coveo-error-report-previous' > "+e.l("GoBack")+" </span>").click(function(){t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.errorBack,{},t.root),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.errorBack,{}),history.back()})},i.prototype.buildClear=function(){var t=this;return e.$("<span class='coveo-error-report-clear'>"+e.l("Reset")+"</span>").click(function(){t.queryStateModel.reset(),t.queryController.deferExecuteQuery({beforeExecuteQuery:function(){t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.errorClearQuery,{}),t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.errorClearQuery,{},t.root)}})})},i.prototype.buildRetry=function(){var t=this;return e.$("<span class='coveo-error-report-retry'>"+e.l("Retry")+"</span>").click(function(){t.queryController.deferExecuteQuery({beforeExecuteQuery:function(){t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.errorRetry,{}),t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.errorRetry,{},t.root)}})})},i.prototype.handleNewQuery=function(){e.$(this.element).hide(),null!=this.closePopup&&this.closePopup()},i.prototype.handleQueryError=function(t,i){var n=this;if(e.Assert.exists(i),e.Assert.exists(i.error),!i.error.isMissingAuthentication&&(this.message.empty(),this.setErrorTitle(),this.options.showDetailedError&&this.message.append(e.$("<span class='coveo-error-report-more-info'>"+e.l("MoreInfo")+"</span>").click(function(t){e.$(t.target).empty(),e.$(t.target).parent().append(n.buildErrorInfo(i.error))})),e.$(this.element).show(),this.options.enablePopup)){var o=e.ModalBox.open(e.$(this.element).clone(!0,!0),{title:e.JQueryUtils.getPopUpCloseButton(e.l("Close"),e.l("ErrorReport")),titleClose:!0,overlayClose:!0,className:"coveo-error-report"});this.closePopup=o.close}},i.prototype.buildErrorInfo=function(t){{var i=e.$("<div class='coveo-error-info'></div>");e.$("<textarea>"+JSON.stringify(t,null,2)+"</textarea>").appendTo(i),e.$("<div class='coveo-error-info-label'>"+e.l("CopyPasteToSupport")+"</div>").appendTo(i)}return i.get(0)},i.ID="ErrorReport",i.options={enablePopup:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),showDetailedError:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ErrorReport=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),e.Assert.exists(this.result),this.element.innerHTML=e.HighlightUtils.highlightString(this.result.excerpt,this.result.excerptHighlights,null,"coveo-highlight")}return __extends(i,t),i.ID="Excerpt",i}(e.Component);e.Excerpt=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.selected=!1,this.excluded=!1,this.waitingForDelta=!1}return t.prototype.reset=function(){this.selected=!1,this.excluded=!1},t.prototype.updateCountsFromNewValue=function(t){e.Assert.exists(t),this.occurrences=t.occurrences,this.delta=t.delta,this.computedField=t.computedField},t.prototype.cloneWithZeroOccurrences=function(){return this.occurrences=0,this.computedField=0,this.delta=void 0,this},t.prototype.cloneWithDelta=function(t,i){e.Assert.isLargerOrEqualsThan(0,t);var n=this.cloneWithZeroOccurrences();return n.delta=i,n.occurrences=t,n},t.prototype.getFormattedCount=function(){var t=void 0;return e.Utils.exists(this.delta)&&this.delta>0?t="+"+Globalize.format(this.delta,"n0"):this.occurrences>0&&(t=Globalize.format(this.occurrences,"n0")),t},t.prototype.getFormattedComputedField=function(e){return 0!=this.computedField?Globalize.format(this.computedField,e):void 0},t.create=function(i){if(e._.isString(i))return t.createFromValue(i);if(e._.isObject(i))return"computedFieldResults"in i?t.createFromGroupByValue(i):t.createFromFieldValue(i);throw new Error("Can't create value from "+i)},t.createFromValue=function(i){e.Assert.isNonEmptyString(i);var n=new t;return n.value=i,n.lookupValue=i,n},t.createFromGroupByValue=function(i){e.Assert.exists(i),e.Assert.exists(i);var n=new t;return n.value=i.value,n.lookupValue=e.Utils.exists(i.lookupValue)?i.lookupValue:i.value,n.occurrences=i.numberOfResults,n.computedField=e.Utils.isNonEmptyArray(i.computedFieldResults)?i.computedFieldResults[0]:void 0,n.score=i.score,n},t.createFromFieldValue=function(i){e.Assert.exists(i);var n=new t;return n.value=i.value,n.lookupValue=i.lookupValue,n.occurrences=i.numberOfResults,n},t}();e.FacetValue=t;var i=function(){function i(i){this.values=e.Utils.exists(i)?e._.map(i.values,function(e){return t.createFromGroupByValue(e)}):[]}return i.prototype.add=function(t){e.Assert.exists(t),e.Assert.check(!this.contains(t.value)),this.values.push(t)},i.prototype.remove=function(t){e.Assert.isNonEmptyString(t),t=t,this.values=e._.filter(this.values,function(e){return e.value!=t})},i.prototype.size=function(){return this.values.length},i.prototype.isEmpty=function(){return 0==this.values.length},i.prototype.at=function(t){return e.Assert.isLargerOrEqualsThan(0,t),e.Assert.isSmallerThan(this.values.length,t),this.values[t]},i.prototype.get=function(t){return e._.find(this.values,function(e){return e.value.toLowerCase()==t.toLowerCase()})},i.prototype.contains=function(t){return e.Utils.exists(this.get(t))},i.prototype.getAll=function(){return this.values},i.prototype.getSelected=function(){return e._.filter(this.values,function(e){return e.selected})},i.prototype.getExcluded=function(){return e._.filter(this.values,function(e){return e.excluded})},i.prototype.hasSelectedOrExcludedValues=function(){return 0!=this.getSelected().length||0!=this.getExcluded().length},i.prototype.reset=function(){e._.each(this.values,function(e){return e.reset()})},i.prototype.importActiveValuesFromOtherList=function(t){var i=this;e.Assert.exists(t),e._.each(t.getSelected(),function(t){var n=i.get(t.value);e.Utils.exists(n)?n.selected=!0:i.values.push(t.cloneWithZeroOccurrences())}),e._.each(t.getExcluded(),function(t){var n=i.get(t.value);e.Utils.exists(n)?n.excluded=!0:i.values.push(t.cloneWithZeroOccurrences())})},i.prototype.updateCountsFromNewValues=function(t){e.Assert.exists(t),this.values=e._.map(this.values,function(i){var n=t.get(i.value);return e.Utils.exists(n)?(i.updateCountsFromNewValue(n),i):i.cloneWithZeroOccurrences()})},i.prototype.updateDeltaWithFilteredFacetValues=function(t){e.Assert.exists(t),e._.each(this.values,function(i){var n=t.get(i.value);i.waitingForDelta=!1,e.Utils.exists(n)?i.delta=i.occurrences-n.occurrences>0?i.occurrences-n.occurrences:null:i.selected||i.excluded||(i.delta=i.occurrences)})},i.prototype.mergeWithUnfilteredFacetValues=function(t){var i=this;e.Assert.exists(t);var n=[];e._.each(t.values,function(t){var o=i.get(t.value);e.Utils.exists(o)?o.occurrences==t.occurrences?n.push(o):n.push(t.cloneWithDelta(t.occurrences,t.occurrences-o.occurrences)):n.push(t.cloneWithDelta(t.occurrences,t.occurrences))});var o=0;e._.each(this.values,function(i){var s=t.get(i.value);
if(e.Utils.exists(s)){for(var r=0;r<n.length;r++)if(n[r].value==i.value){o=r+1;break}}else(i.selected||i.excluded)&&(n.splice(o,0,i),o++)}),this.values=n},i.prototype.sortValuesDependingOnStatus=function(t){if(this.values=e._.sortBy(this.values,function(e){return e.selected?1:e.excluded?3:2}),null!=t&&t<this.values.length){var i=this.getExcluded().length,n=this.values.splice(this.values.length-i,i);Array.prototype.splice.apply(this.values,[t-i,0].concat(n))}},i}();e.FacetValues=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(t){var i=t.raw.objecttype,s=t.raw.sysfiletype;return e.Utils.isNonEmptyString(i)&&"file"!=i.toLowerCase()?n(i):e.Utils.isNonEmptyString(s)?o(s):{icon:"coveo-icon sysfiletype",caption:e.l("Unknown")}}function n(t){t=t.toLowerCase();var i=e.l["objecttype_"+t];return{icon:"coveo-icon objecttype "+t,caption:i?i():t}}function o(t){t=t.toLowerCase(),"."==t[0]&&(t=t.substring(1));var i=e.l["sysfiletype_"+t];return{icon:"coveo-icon sysfiletype "+t,caption:i?i():t}}function s(){if(void 0==r){r={};var t=String.locales[String.locale];e.Assert.isNotUndefined(t),e._.each(e._.keys(t),function(e){0==e.indexOf("sysfiletype_")?r[e.substr("sysfiletype_".length)]=e.toLocaleString():0==e.indexOf("objecttype_")&&(r[e.substr("objecttype_".length)]=e.toLocaleString())})}return r}var r;t.get=i,t.getObjectType=n,t.getSysFileType=o,t.getSysFileTypeCaptions=s}(t=e.FileTypes||(e.FileTypes={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(t,i){return new RegExp(e.StringUtils.stringToRegex(t,i),"i")}function n(t,i){var n=[t],o=this.getRegexToUseForFacetSearch(t,i.options.facetSearchIgnoreAccents);return i.options.valueCaption?e._.chain(i.options.valueCaption).pairs().filter(function(e){return o.test(e[1])}).each(function(e){n.push(e[0])}):"@objecttype"==i.options.field||"@sysfiletype"==i.options.field?e._.each(e._.filter(e._.pairs(e.FileTypes.getSysFileTypeCaptions()),function(e){return o.test(e[1])}),function(e){n.push(e[0])}):"@sysmonth"==i.options.field&&e._.each(e._.range(1,13),function(t){o.test(e.DateUtils.monthToString(t-1))&&n.push(("0"+t.toString()).substr(-2))}),n}function o(t){return t=e._.map(t,function(t){return e.Utils.escapeRegexCharacter(t)}),t[0]=".*"+t[0]+".*",t.join("|")}function s(e,t,i,n){return t>e&&n>e&&t!=i}function r(t,i){if(0!=t.values.getSelected().length){var n=i.find("li").not(".coveo-selected");e._.each(n,function(t){e.$(t).addClass("coveo-no-state")})}}function a(t,i){var n;if("@sysfiletype"==t.toLowerCase())n=e.FileTypes.getSysFileTypeCaptions()[i.toLowerCase()];else if("@sysmonth"==t.toLowerCase())try{var o=parseInt(i);n=e.DateUtils.monthToString(o-1)}catch(s){}return void 0!=n&&e.Utils.isNonEmptyString(n)?n:i}function l(t,i){if(!t.isInstanceOf("HierarchicalFacet")||i){t.logger.trace("Clipping captions");for(var n=e.$(t.element).show(),o=n.find(".coveo-facet-value-caption"),s=0;s<o.length;s++)""!=o[s].style.width&&(o[s].style.width="");for(var r=n.find(".coveo-facet-value-label-wrapper"),a=[],s=0;s<r.length;s++){var l=r.get(s),u=e.$(l),c=u.find(".coveo-facet-value-caption"),p=c.get(0),d=l.scrollWidth,h=l.clientWidth,f=p.scrollWidth,m=Math.max(0,d-h);m&&a.push({element:c,width:f,crop:m,label:u})}n.css("display","");for(var s=0;s<a.length;s++){var v=a[s],g=v.element.get(0);g.style.width=v.width-v.crop+"px";{v.element[0]}v.crop>0?v.label.attr("title",v.element.text()):v.label.attr("title",null)}}}t.getRegexToUseForFacetSearch=i,t.getValuesToUseForSearchInFacet=n,t.buildFacetSearchPattern=o,t.needAnotherFacetSearch=s,t.addNoStateCssClassToFacetValues=r,t.tryToGetTranslatedCaption=a,t.clipCaptionsToAvoidOverflowingTheirContainer=l}(t=e.FacetUtils||(e.FacetUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e){this.facet=e}return t.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0,this.expressionToUseForFacetSearch=void 0,this.constantExpressionToUseForFacetSearch=void 0},t.prototype.computeOurFilterExpression=function(){var t=this;e.Assert.check(this.facet.values.hasSelectedOrExcludedValues());var i=new e.ExpressionBuilder,n=this.facet.values.getSelected();n.length>0&&(this.facet.options.useAnd?e._.each(n,function(e){i.addFieldExpression(t.facet.options.field,"==",[e.value])}):i.addFieldExpression(this.facet.options.field,"==",e._.map(n,function(e){return e.value})));var o=this.facet.values.getExcluded();return o.length>0&&i.addFieldNotEqualExpression(this.facet.options.field,e._.map(o,function(e){return e.value})),i.build()},t.prototype.putGroupByIntoQueryBuilder=function(t){e.Assert.exists(t);var i=this.createGroupByAllowedValues(),n=this.createBasicGroupByRequest(i),o=this.createGroupByQueryOverride(t);if(e.Utils.isNullOrUndefined(o)){var s=t.computeCompleteExpressionParts();this.expressionToUseForFacetSearch=s.withoutConstant,null==this.expressionToUseForFacetSearch&&(this.expressionToUseForFacetSearch="@sysuri"),this.constantExpressionToUseForFacetSearch=s.constant}else n.queryOverride=o.withoutConstant,n.constantQueryOverride=o.constant,this.expressionToUseForFacetSearch=o.withoutConstant,this.constantExpressionToUseForFacetSearch=o.constant;this.lastGroupByRequestIndex=t.groupByRequests.length,this.lastGroupByRequest=n,t.groupByRequests.push(n)},t.prototype.searchInFacet=function(e,t,i){void 0===i&&(i=!0);var n=this.buildListFieldValuesRequest(e,t,i);return this.createListFieldDeferer(n)},t.prototype.searchInFacetWithLookupField=function(t,i,n){void 0===n&&(n=!0);var o=this.buildGroupByQuery(),s=o.groupBy[0];s.maximumNumberOfValues=t,s.allowedValues=e._.map(i,function(e){return"*"+e+"*"});var r=this.buildSearchQueryForFacetWithLookupField(i);return null==o.aq?o.aq=r:o.aq+=" "+r,this.createSearchDeferer(o)},t.prototype.recursiveFacetSearch=function(t,i,n,o){var s=this;void 0===o&&(o=e.$.Deferred());var r,a=e.FacetUtils.getValuesToUseForSearchInFacet(t,this.facet),l=function(r){var a=r.length;r=s.checkForFacetSearchValuesToRemove(r,t),e.FacetUtils.needAnotherFacetSearch(r.length,a,n,5)?s.recursiveFacetSearch(t,i+i,a,o):o.resolve(r)};return null==this.facet.options.lookupField&&null==this.facet.options.computedField?(r=this.facet.facetQueryController.searchInFacet(i,a,this.facet.options.facetSearchIgnoreAccents),r.done(l)):(r=this.facet.facetQueryController.searchInFacetWithLookupField(i,a,this.facet.options.facetSearchIgnoreAccents),r.done(function(e){var t=e.groupByResults.length>0?e.groupByResults[0].values:[];l(t)})),r.fail(function(e,t){o.reject(e,t)}),o.fail(function(){r.reject()}),o},t.prototype.fetchMore=function(){var t=this.facet.options.allowedValues||e._.pluck(this.facet.values.getAll(),"value"),i=this.buildGroupByQuery(t);return this.createSearchDeferer(i)},t.prototype.searchInFacetToUpdateDelta=function(t){var i=this.buildGroupByQuery();return i.aq=this.computeOurFilterExpression(),e._.each(t,function(e){e.waitingForDelta=!0}),i.groupBy=[this.createBasicGroupByRequest(e._.map(t,function(e){return e.value}))],i.groupBy[0].completeFacetWithStandardValues=!1,this.createSearchDeferer(i)},t.prototype.createSearchDeferer=function(e){return this.facet.getEndpoint().search(e)},t.prototype.createListFieldDeferer=function(e){return this.facet.queryController.getEndpoint().listFieldValues(e)},t.prototype.buildSearchQueryForFacetWithLookupField=function(t){var i=this.facet.options.lookupField?this.facet.options.lookupField:this.facet.options.field;return"("+t.map(function(t){return e.QueryUtils.buildFieldExpression(i,"*=",["*"+t+"*"])}).join(" OR ")+")"},t.prototype.buildListFieldValuesRequest=function(e,i,n,o){void 0===n&&(n=!0);var s={field:this.facet.options.field,ignoreAccents:n,sortCriteria:"occurrences",maximumNumberOfValues:e,queryOverride:o||this.expressionToUseForFacetSearch,constantQueryOverride:this.constantExpressionToUseForFacetSearch};return null!=i&&(s.pattern=t.makeFacetSearchPattern(i),s.patternType="RegularExpression"),s},t.prototype.buildGroupByQuery=function(e){var t=[this.createBasicGroupByRequest(e)];return{q:this.expressionToUseForFacetSearch,cq:this.constantExpressionToUseForFacetSearch,enableDidYouMean:!1,firstResult:0,numberOfResults:0,groupBy:t}},t.prototype.createGroupByAllowedValues=function(){var t;if(void 0!=this.facet.options.allowedValues)return this.facet.options.allowedValues;if(void 0!=this.facet.options.customSort)return this.facet.options.customSort;if(this.facet.options.useAnd||!this.facet.keepDisplayedValuesNextTime){var i=this.facet.values.getSelected();if(0==i.length)return void 0;t=this.facet.values.getSelected()}else t=this.facet.values.getAll();return e._.map(t,function(e){return e.value})},t.prototype.createGroupByQueryOverride=function(t){var i=this.facet.options.additionalFilter?this.facet.options.additionalFilter:void 0;if(!this.facet.values.hasSelectedOrExcludedValues()||this.facet.options.useAnd)return i?{constant:i,withoutConstant:"@sysuri"}:void 0;var n=e._.defaults(t.computeCompleteExpressionPartsExcept(this.computeOurFilterExpression()),{withoutConstant:"@sysuri"});return void 0==n.constant?n.constant=i:n.constant+=i?" "+i:"",n},t.prototype.createBasicGroupByRequest=function(t,i){void 0===i&&(i=!0);var n=this.facet.numberOfValues;if(null!=this.facet.options.customSort){var o=e._.union(e._.map(this.facet.values.getSelected(),function(e){return e.value}),e._.map(this.facet.values.getExcluded(),function(e){return e.value}),this.facet.options.customSort);n=Math.max(n,o.length)}var s={field:this.facet.options.field,maximumNumberOfValues:n+(this.facet.options.enableMoreLess?1:0),sortCriteria:this.facet.options.sortCriteria,injectionDepth:this.facet.options.injectionDepth,completeFacetWithStandardValues:void 0==this.facet.options.allowedValues?!0:!1};return this.facet.options.lookupField&&(s.lookupField=this.facet.options.lookupField),null!=t&&(s.allowedValues=t),i&&e.Utils.isNonEmptyString(this.facet.options.computedField)&&(s.computedFields=[{field:this.facet.options.computedField,operation:this.facet.options.computedFieldOperation}]),s},t.prototype.checkForFacetSearchValuesToRemove=function(t,i){var n=this,o=e.FacetUtils.getRegexToUseForFacetSearch(i,this.facet.options.facetSearchIgnoreAccents);return e._.filter(t,function(t){var i=e._.isEmpty(n.facet.options.allowedValues)||e._.contains(n.facet.options.allowedValues,t.value),s=n.facet.getValueCaption(t);return i&&o.test(s)})},t.makeFacetSearchPattern=function(t){return t=e._.map(t,function(t){return e.Utils.escapeRegexCharacter(t)}),t[0]=".*"+t[0]+".*",t.join("|")},t}();e.FacetQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){!function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACEBAR=32]="SPACEBAR",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE"}(e.KEYBOARD||(e.KEYBOARD={}));var t=(e.KEYBOARD,function(){function t(){}return t.keysEqual=function(t,i){return e.Utils.isNullOrUndefined(t.keyCode)?e.Utils.isNullOrUndefined(t.which)?!1:t.which==i:t.keyCode==i},t.isAllowedKeyForOmnibox=function(e){var i=e.keyCode,n=t.isNumberKeyPushed(i)||32==i||13==i||t.isLetterKeyPushed(i)||i>95&&112>i||i>185&&193>i||i>218&&223>i||8==i||46==i||t.isArrowKeyPushed(i);return n},t.isAllowedKeyForSearchAsYouType=function(e){return t.isAllowedKeyForOmnibox(e)&&!t.isArrowKeyPushed(e.keyCode)},t.isDeleteOrBackspace=function(e){return t.keysEqual(e,8)||t.keysEqual(e,46)},t.isArrowKeyPushed=function(e){return 37==e||38==e||39==e||40==e},t.isNumberKeyPushed=function(e){return e>47&&58>e},t.isLetterKeyPushed=function(e){return e>64&&91>e},t}());e.KeyboardUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){var n=this;this.facet=t,this.facetSearchValuesListKlass=i,this.showingFacetSearchWaitAnimation=!1,this.searchTemplate=e._.template("<div class='coveo-facet-search'></div>"),this.magnifierTemplate=e._.template("<div class='coveo-facet-search-magnifier'></div>"),this.waitTemplate=e._.template("<div class='coveo-facet-search-wait-animation'></div>"),this.clearIconTemplate=e._.template("<span class='coveo-icon'></span>"),this.clearTemplate=e._.template("<div title='"+e.l("Clear",e.l("Search"))+"' class='coveo-facet-search-clear'></div>"),this.middleTemplate=e._.template("<div class='coveo-facet-search-middle'></div>"),this.inputTemplate=e._.template("<input type='text' autocapitalize='off' autocorrect='off' placeholder='<%- placeholder %>' class='coveo-facet-search-input'/>"),this.searchResultsTemplate=e._.template('<ul class="coveo-facet-search-results"/>'),this.searchResults=e.$(this.searchResultsTemplate()),e.$(window).resize(function(){e.DeviceUtils.isMobileDevice()||n.positionSearchResults()})}return t.prototype.build=function(){return e.DeviceUtils.isMobileDevice()?this.buildSearchMobile():this.buildBaseSearch()},t.prototype.positionSearchResults=function(){if(null!=this.searchResults&&this.searchResults.is(":visible"))if(e.DeviceUtils.isMobileDevice())this.searchResults.insertAfter(this.search);else{var t=this.searchResults.outerWidth()-this.searchResults.innerWidth();this.searchResults.outerWidth(this.search.outerWidth()-t),this.searchResults.show(),e.JQueryUtils.positionPopup(this.searchResults,this.search,e.$(this.facet.element),e.$(this.facet.root),{vertical:2,horizontal:1})}},t.prototype.completelyDismissSearch=function(){this.cancelAnyPendingSearchOperation(),this.facet.unfadeInactiveValuesInMainList(),this.search.removeClass("coveo-facet-search-no-results"),this.hideSearchResultsElement(),this.input.val(""),this.clear.hide()},t.prototype.buildBaseSearch=function(){var t=this;return this.search=e.$(this.searchTemplate()),this.magnifier=e.$(this.magnifierTemplate()).appendTo(this.search),this.wait=e.$(this.waitTemplate()).hide().appendTo(this.search),this.clearIcon=e.$(this.clearIconTemplate()),this.clear=e.$(this.clearTemplate()).appendTo(this.search).hide().append(this.clearIcon),this.middle=e.$(this.middleTemplate()).appendTo(this.search),this.input=e.$(this.inputTemplate({placeholder:e.l("SearchIn",this.facet.options.title)})).appendTo(this.middle),e.Component.pointElementsToDummyForm(this.input),this.input.keyup(function(e){return t.handleFacetSearchKeyUp(e)}),this.clear.click(function(){return t.handleFacetSearchClear()}),this.input.focus(function(e){return t.handleFacetSearchFocus(e)}),this.input.blur(function(){return t.handleFacetSearchBlur()}),this.search},t.prototype.buildSearchMobile=function(){var t=this,i=e.$("<div class='coveo-facet-search-button-mobile'>"+e.l("Search")+"</div>");return this.search=this.buildBaseSearch(),i.click(function(){var i=e.ModalBox.open(e.$("<div />").append(t.search),{title:e.JQueryUtils.getPopUpCloseButton(e.l("Close"),e.l("SearchIn",t.facet.options.title)),validation:function(){return t.completelyDismissSearch(),!0},className:"coveo-mobile-facet-search"});e.$(i.wrapper.find(".coveo-title")).click(function(){return i.close()}),t.input.val("").keyup().focus()}),i},t.prototype.handleFacetSearchKeyUp=function(t){e.Assert.exists(t);var i=""==this.input.val();this.showOrHideClearElement(i),e.DeviceUtils.isMobileDevice()?this.startNewSearchTimeout():this.handleKeyboardNavigation(t,i)},t.prototype.handleFacetSearchFocus=function(){""==this.getValueInInputForFacetSearch()||e.DeviceUtils.isMobileDevice()||this.startNewSearchTimeout(),e.DeviceUtils.isSmallScreenWidth()&&e.MobileUtils.addToggleClassOnSearchInterface("slide-left")},t.prototype.handleFacetSearchBlur=function(){var t=this;setTimeout(function(){e.DeviceUtils.isMobileDevice()||t.completelyDismissSearch()},250)},t.prototype.handleFacetSearchClear=function(){this.input.val(""),this.clear.hide(),this.completelyDismissSearch()},t.prototype.showOrHideClearElement=function(e){e?(this.clear.hide(),this.search.removeClass("coveo-facet-search-no-results")):this.clear.show()},t.prototype.handleKeyboardNavigation=function(e,t){switch(e.which){case 13:this.keyboardNavigationEnterPressed(e,t);break;case 46:this.keyboardNavigationDeletePressed(e);break;case 27:this.completelyDismissSearch();break;case 40:this.moveCurrentResultDown();break;case 38:this.moveCurrentResultUp();break;default:this.highlightCurrentQueryWithinSearchResults(),this.startNewSearchTimeout()}},t.prototype.keyboardNavigationEnterPressed=function(e,t){e.shiftKey?this.triggerNewFacetSearch():this.searchResults.is(":visible")||"block"==this.searchResults.css("display")?(this.performSelectActionOnCurrentSearchResult(),this.completelyDismissSearch()):this.search.is(".coveo-facet-search-no-results")||t||this.selectAllValuesMatchingSearch()},t.prototype.keyboardNavigationDeletePressed=function(e){e.shiftKey&&(this.performExcludeActionOnCurrentSearchResult(),this.completelyDismissSearch(),this.input.val(""))},t.prototype.triggerNewFacetSearch=function(t){var i=this;void 0===t&&(t=this.facet.options.numberOfValuesInFacetSearch),this.cancelAnyPendingSearchOperation(),this.showFacetSearchWaitingAnimation(),this.facet.logger.info("Triggering new facet search");var n=this.getValueInInputForFacetSearch();this.facetSearchDeferred=this.facet.facetQueryController.recursiveFacetSearch(n,this.facet.options.numberOfValuesInFacetSearch),this.facetSearchDeferred.done(function(t){i.facet.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.facetSearch,{facetId:i.facet.options.id,facetTitle:i.facet.options.title},i.facet.root),i.facet.logger.debug("Received field values",t),i._processNewFacetSearchResults(t.slice(0,i.facet.options.numberOfValuesInFacetSearch+1)),i.hideFacetSearchWaitingAnimation(),i.facetSearchDeferred=void 0}),this.facetSearchDeferred.fail(function(t,n){e.Utils.exists(n)&&(i.facet.logger.error("Error while retrieving facet values",n),i.hideFacetSearchWaitingAnimation()),i.facetSearchDeferred=void 0})},t.prototype.startNewSearchTimeout=function(){var e=this;this.cancelAnyPendingSearchOperation(),this.facetSearchTimeout=setTimeout(function(){""!=e.getValueInInputForFacetSearch()?e.triggerNewFacetSearch():e.completelyDismissSearch()},this.facet.options.facetSearchDelay)},t.prototype.cancelAnyPendingSearchOperation=function(){e.Utils.exists(this.facetSearchTimeout)&&(clearTimeout(this.facetSearchTimeout),this.facetSearchTimeout=void 0),e.Utils.exists(this.facetSearchDeferred)&&(this.facetSearchDeferred.reject(),this.facetSearchDeferred=void 0),this.hideFacetSearchWaitingAnimation()},t.prototype._processNewFacetSearchResults=function(t){e.Assert.exists(t),t.length>0?(this.search.removeClass("coveo-facet-search-no-results"),this.facet.fadeInactiveValuesInMainList(this.facet.options.facetSearchDelay),this.rebuildSearchResults(t),this.showSearchResultsElement(),this.highlightCurrentQueryWithinSearchResults(),e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet,!0),this.makeFirstSearchResultTheCurrentOne()):(this.hideSearchResultsElement(),this.search.addClass("coveo-facet-search-no-results"))},t.prototype.rebuildSearchResults=function(t){var i=this;e.Assert.exists(t),this.searchResults.empty();var n=e.$('<li class="coveo-facet-selectable coveo-facet-search-selectable coveo-facet-search-select-all "/>').text(e.l("SelectAll"));n.click(function(){return i.selectAllValuesMatchingSearch()}),e.DeviceUtils.isMobileDevice()||n.appendTo(this.searchResults);var o=e._.map(t,function(t){return e.FacetValue.create(t)});new this.facetSearchValuesListKlass(this.facet,e.FacetValueElement).build(o).appendTo(this.searchResults),e.DeviceUtils.isMobileDevice()&&(n.append("<span class='coveo-mobile-facet-search-select-all'></span>"),n.appendTo(this.searchResults)),this.searchResults.find(".coveo-facet-selectable").each(function(t,n){e.$(n).addClass("coveo-facet-search-selectable"),e.$(n).mousemove(function(){i.makeCurrentResult(e.$(n))})})},t.prototype.showSearchResultsElement=function(){this.searchResults.appendTo(this.facet.root),this.positionSearchResults()},t.prototype.hideSearchResultsElement=function(){this.searchResults.remove()},t.prototype.highlightCurrentQueryWithinSearchResults=function(){var t=this;e.$(this.searchResults).find(".coveo-facet-value-caption").each(function(i,n){var o=t.getValueInInputForFacetSearch(),s=new RegExp("("+e.StringUtils.wildcardsToRegex(o,t.facet.options.facetSearchIgnoreAccents)+")","ig"),r=e.$(n).text(),a=r.replace(s,'<span class="coveo-highlight">$1</span>');e.$(n).html(a)})},t.prototype.makeFirstSearchResultTheCurrentOne=function(){this.makeCurrentResult(this.getSelectables().first())},t.prototype.makeCurrentResult=function(){this.getSelectables().removeClass("coveo-current"),this.getSelectables().first().addClass("coveo-current")},t.prototype.moveCurrentResultDown=function(){var e=this.searchResults.find(".coveo-current");this.getSelectables().removeClass("coveo-current");var t=e.next(".coveo-facet-selectable").first();t.length>0?t.addClass("coveo-current"):e.siblings(".coveo-facet-selectable").first().addClass("coveo-current")},t.prototype.moveCurrentResultUp=function(){var e=this.searchResults.find(".coveo-current");this.searchResults.find(".coveo-facet-selectable").removeClass("coveo-current");var t=e.prev(".coveo-facet-selectable").first();t.length>0?t.addClass("coveo-current"):e.siblings(".coveo-facet-selectable").last().addClass("coveo-current")},t.prototype.getSelectables=function(e){return void 0===e&&(e=this.searchResults),e.find(".coveo-facet-selectable")},t.prototype.performSelectActionOnCurrentSearchResult=function(){var t=this.searchResults.find(".coveo-current");e.Assert.check(1==t.length);var i=t.find('input[type="checkbox"]');i.length>0?(i.prop("checked",!0),i.change()):t.click()},t.prototype.performExcludeActionOnCurrentSearchResult=function(){var t=this.searchResults.find(".coveo-current");e.Assert.check(1==t.length),t.find(".coveo-facet-value-exclude").click()},t.prototype.getValueInInputForFacetSearch=function(){return this.input.val()},t.prototype.selectAllValuesMatchingSearch=function(){var t=this;this.facet.showWaitingAnimation();var i=this.getValueInInputForFacetSearch(),n=e.FacetUtils.getValuesToUseForSearchInFacet(i,this.facet),o=this.facet.facetQueryController.searchInFacet(1e3,n,this.facet.options.facetSearchIgnoreAccents);o.done(function(i){t.completelyDismissSearch();var n=e._.map(i,function(i){var n=t.facet.values.get(i.value);return e.Utils.exists(n)||(n=e.FacetValue.create(i)),n.selected=!0,n.excluded=!1,n});t.facet.processFacetSearchAllResultsSelected(n)}),this.completelyDismissSearch()},t.prototype.showFacetSearchWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingFacetSearchWaitAnimation||(t.magnifier.hide(),t.wait.show(),t.showingFacetSearchWaitAnimation=!0)})},t.prototype.hideFacetSearchWaitingAnimation=function(){this.showingFacetSearchWaitAnimation&&(this.magnifier.show(),this.wait.hide(),this.showingFacetSearchWaitAnimation=!1)},t}();e.FacetSearch=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.options=t,this.element=e.$('<div class="coveo-facet-header"/>')}return t.prototype.build=function(){return this.buildIcon().appendTo(this.element),this.buildWaitAnimation().appendTo(this.element),this.options.settingsKlass?(this.sort=this.settings=new this.options.settingsKlass(this.options.availableSorts,this.options.facet),this.settings.build().appendTo(this.element)):this.options.sortKlass&&(this.sort=new this.options.sortKlass(this.options.availableSorts,this.options.facet)),this.options.enableCollapseElement&&(this.collapseElement=this.buildCollapse().appendTo(this.element),this.excludeElement=this.buildExpand().appendTo(this.element)),this.options.facet&&(this.operatorElement=this.buildOperatorToggle().appendTo(this.element),this.operatorElement.fastToggle(this.options.facet.options.allowTogglingOperator)),this.eraserElement=this.buildEraser().appendTo(this.element),this.buildTitle().appendTo(this.element),this.element},t.prototype.switchToAnd=function(){this.options.facet&&(this.options.facet.options.useAnd=!0,this.rebuildOperatorToggle(),this.updateOperatorQueryStateModel())},t.prototype.switchToOr=function(){this.options.facet&&(this.options.facet.options.useAnd=!1,this.rebuildOperatorToggle(),this.updateOperatorQueryStateModel())},t.prototype.collapseFacet=function(){this.collapseElement.hide(),this.excludeElement.show(),e.$(this.options.facetElement).addClass("coveo-facet-collapsed")},t.prototype.expandFacet=function(){this.excludeElement.hide(),this.collapseElement.show(),e.$(this.options.facetElement).removeClass("coveo-facet-collapsed"),this.options.facet&&e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.options.facet)},t.prototype.rebuildOperatorToggle=function(){var e=this.buildOperatorToggle();this.operatorElement&&this.operatorElement.replaceWith(e),this.operatorElement=e},t.prototype.updateOperatorQueryStateModel=function(){if(this.options.facet&&this.options.facet.options.allowTogglingOperator){var e="";(0!=this.options.facet.getSelectedValues().length||0!=this.options.facet.getExcludedValues().length)&&(e=this.options.facet.options.useAnd?"and":"or"),this.options.facet.queryStateModel.set(this.options.facet.operatorAttributeId,e)}},t.prototype.buildIcon=function(){var t;return t=this.options.icon?"coveo-icon-custom "+this.options.icon:"coveo-icon "+this.options.field.substr(1),this.icon=e.$("<div></div>").addClass(t),this.icon},t.prototype.buildWaitAnimation=function(){return this.waitElement=e.$("<div />").addClass("coveo-facet-header-wait-animation").css("display","none"),this.waitElement},t.prototype.buildCollapse=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",e.l("Collapse")).addClass("coveo-facet-header-collapse").append(i).click(function(){t.collapseFacet()})},t.prototype.buildExpand=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",e.l("Expand")).hide().addClass("coveo-facet-header-expand").append(i).click(function(){t.expandFacet()})},t.prototype.buildOperatorToggle=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return i.addClass("coveo-"+(this.options.facet.options.useAnd?"and":"or")),e.$("<div />").attr("title",e.l("SwitchTo",this.options.facet.options.useAnd?e.l("Or"):e.l("And"))).addClass("coveo-facet-header-operator").append(i).click(function(){t.handleOperatorClick()})},t.prototype.handleOperatorClick=function(){var t=this;if(this.options.facet.options.useAnd?this.options.facet.switchToOr():this.options.facet.switchToAnd(),0!=this.options.facet.getSelectedValues().length){var i=this.options.facet.options.useAnd?"AND":"OR",n=this.options.facet.options.useAnd?"OR":"AND";this.options.facet.triggerNewQuery(function(){return t.options.facet.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetToggle,{facetId:t.options.facet.options.id,facetOperatorBefore:n,facetOperatorAfter:i,facetTitle:t.options.title})})}},t.prototype.buildTitle=function(){return e.$('<div class="coveo-facet-header-title"/>').text(this.options.title)},t.prototype.buildEraser=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",e.l("Clear",this.options.title)).append(i).addClass("coveo-facet-header-eraser").click(function(){t.options.onEraserClick()})},t}();e.FacetHeader=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){var n=this;this.facet=i,this.enabledSorts=[],this.customSortDirection="ascending",e._.each(t,function(t){var i=e.FacetSettings.availableSorts[t.toLowerCase()];void 0!=i&&n.enabledSorts.push(i)}),this.removeEnabledSortsBasedOnFacetType(),e.Utils.isNonEmptyArray(this.enabledSorts)&&(void 0!=this.facet.options.sortCriteria&&(this.activeSort=e._.find(this.enabledSorts,function(e){return e.name==n.facet.options.sortCriteria})),this.activeSort||(this.activeSort=this.enabledSorts[0]))}return t.prototype.removeEnabledSortsBasedOnFacetType=function(){if(this.facet.isInstanceOf("FacetRange")){var e=this.facet;e.options.slider&&(this.enabledSorts=[])}},t.prototype.reorderValues=function(e){return"custom"==this.activeSort.name&&void 0!=this.facet.options.customSort?this.reorderValuesWithCustomOrder(e):e},t.prototype.reorderValuesWithCustomOrder=function(t){var i=t.length,n=e._.map(this.facet.options.customSort,function(e){return e.toLowerCase()}),o=e._.map(t,function(t){var o=e._.reduce(n,function(i,n,o){return-1!=i?i:e.StringUtils.equalsCaseInsensitive(n,t.value)||null!=t.lookupValue&&e.StringUtils.equalsCaseInsensitive(n,t.lookupValue)?o:-1},-1);return o=-1==o?++i:o,{facetValue:t,index:o}}),s=e._.sortBy(o,"index");return s="ascending"==this.customSortDirection?s:s.reverse(),e._.pluck(s,"facetValue")},t.availableSorts={score:{label:e.l("Score"),directionToggle:!1,description:e.l("ScoreDescription"),name:"score"},occurrences:{label:e.l("Occurrences"),directionToggle:!1,description:e.l("OccurrencesDescription"),name:"occurrences"},alphaascending:{label:e.l("Label"),directionToggle:!0,description:e.l("LabelDescription"),name:"alphaascending",relatedSort:"alphadescending"},alphadescending:{label:e.l("Label"),directionToggle:!0,description:e.l("LabelDescription"),name:"alphadescending",relatedSort:"alphaascending"},computedfieldascending:{label:e.l("Value"),directionToggle:!0,description:e.l("ValueDescription"),name:"computedfieldascending",relatedSort:"computedfielddescending"},computedfielddescending:{label:e.l("Value"),directionToggle:!0,description:e.l("ValueDescription"),name:"computedfielddescending",relatedSort:"computedfieldascending"},chisquare:{label:e.l("RelativeFrequency"),directionToggle:!1,description:e.l("RelativeFrequencyDescription"),name:"chisquare"},custom:{label:e.l("Custom"),directionToggle:!0,description:e.l("CustomDescription"),name:"custom",relatedSort:"custom"}},t}();e.FacetSort=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n){t.call(this,i,n),this.facet=n,this.facetSettingsIconTemplate=e._.template("<span class='coveo-icon'></span>"),this.facetSettingsButtonTemplate=e._.template("<div title='"+e.l("Settings")+"' class='coveo-facet-header-settings'></div>"),this.facetSettingsPopupTemplate=e._.template('<div class="coveo-facet-settings-popup"></div>'),this.facetSettingsSectionTemplate=e._.template("<div class='coveo-facet-settings-section <%= _class %>'></div>"),this.facetSettingsSectionIconTemplate=e._.template("<div class='coveo-icon'></div>"),this.facetSettingsItemsTemplate=e._.template("<div class='coveo-facet-settings-items'></div>"),this.facetSettingsItemTemplate=e._.template("<div class='coveo-facet-settings-item' title='<%- title %>'><%- label %></div>"),this.customSortDirectionChange=!1,this.enabledSortsIgnoreRenderBecauseOfPairs=[],this.filterDuplicateForRendering()}return __extends(i,t),i.prototype.build=function(){if(this.settingsButton=e.$(this.facetSettingsButtonTemplate()),this.settingsIcon=e.$(this.facetSettingsIconTemplate()),this.settingsPopup=e.$(this.facetSettingsPopupTemplate()),e.Utils.isNonEmptyArray(this.enabledSorts)){var t=this.buildSortSection();this.directionSection=this.buildDirectionSection()}return this.facet.options.enableSettingsFacetState&&(this.saveStateSection=this.buildSaveStateSection(),this.clearStateSection=this.buildClearStateSection()),this.hideSection=this.buildHideSection(),this.showSection=this.buildShowSection(),this.handleMouseEventOnButton(t),e.Utils.isNonEmptyArray(this.enabledSorts)?this.settingsPopup.append(t.element,this.directionSection,this.saveStateSection,this.clearStateSection,this.hideSection,this.showSection):this.settingsPopup.append(this.saveStateSection,this.clearStateSection,this.hideSection,this.showSection),this.settingsButton.append(this.settingsIcon),this.settingsButton},i.prototype.loadSavedState=function(){var t=this.facetStateLocalStorage.load(),i=this.facet.queryStateModel.get(this.includedStateAttribute),n=this.facet.queryStateModel.get(this.excludedStateAttribute),o=this.facet.queryStateModel.get(this.operatorStateAttribute);
if(!e.Utils.isNullOrUndefined(t)&&e.Utils.isEmptyArray(i)&&e.Utils.isEmptyArray(n)&&!e.Utils.isNonEmptyString(o)){var s={};s[this.includedStateAttribute]=t.included,s[this.excludedStateAttribute]=t.excluded,s[this.operatorStateAttribute]=t.operator,this.facet.queryStateModel.setMultiple(s),this.loadedFromSettings=s}},i.prototype.buildSortSection=function(){var t=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-sort"})),i=e.$(this.facetSettingsSectionIconTemplate()),n=e.$(this.facetSettingsItemsTemplate()),o=this.buildSortSectionItems();return n.append(o),t.append(i,n),{element:t,sortItems:o}},i.prototype.buildSortSectionItems=function(){var t=this;return e._.map(this.enabledSorts,function(i){return e._.contains(t.enabledSortsIgnoreRenderBecauseOfPairs,i)?e.$():e.$(t.facetSettingsItemTemplate({label:e.L10N.format(i.label),title:i.description})).click(function(e){return t.handleClickSortButton(e,i)})})},i.prototype.closePopupAndUpdateSort=function(){this.closePopup(),"custom"!=this.activeSort.name?this.facet.updateSort(this.activeSort.name):(this.facet.updateSort("nosort"),this.customSortDirectionChange&&(this.customSortDirectionChange=!1,this.facet.queryController.executeQuery()))},i.prototype.closePopup=function(){this.settingsPopup.detach()},i.prototype.buildDirectionSection=function(){var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-direction"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate()),s=e.$(this.facetSettingsItemTemplate({label:e.l("Ascending"),title:e.l("Ascending")})).click(function(e){return t.handleDirectionClick(e,"ascending")}),r=e.$(this.facetSettingsItemTemplate({label:e.l("Descending"),title:e.l("Descending")})).click(function(e){return t.handleDirectionClick(e,"descending")});return o.append(s,r),i.append(n,o),this.activeSort.directionToggle?this.selectItem(this.getItems(i).first()):i.addClass("coveo-facet-settings-disabled"),i},i.prototype.buildSaveStateSection=function(){var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-save-state"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());this.facetStateLocalStorage=new e.LocalStorageUtils("facet-state-"+this.facet.options.id),this.includedStateAttribute=e.QueryStateModel.getFacetId(this.facet.options.id),this.excludedStateAttribute=e.QueryStateModel.getFacetId(this.facet.options.id,!1),this.operatorStateAttribute=e.QueryStateModel.getFacetOperator(this.facet.options.id);e.$(this.facetSettingsItemTemplate({label:e.l("SaveFacetState"),title:e.l("SaveFacetState")})).click(function(e){return t.handleSaveStateClick(e)}).appendTo(o);return i.append(n,o),i},i.prototype.buildClearStateSection=function(){{var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-clear-state"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:e.l("ClearFacetState"),title:e.l("ClearFacetState")})).click(function(e){return t.handleClearStateClick(e)}).appendTo(o)}return i.append(n,o),i},i.prototype.buildHideSection=function(){{var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-hide"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:e.l("Collapse"),title:e.l("HideFacet")})).click(function(){t.facet.facetHeader.collapseFacet(),t.settingsPopup.detach()}).appendTo(o)}return i.append(n,o),i},i.prototype.buildShowSection=function(){{var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-show"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:e.l("Expand"),title:e.l("Expand")})).click(function(){t.facet.facetHeader.expandFacet(),t.settingsPopup.detach()}).appendTo(o)}return i.append(n,o),i},i.prototype.handleClickSettingsButtons=function(t,i){var n=this;this.settingsPopup.is(":visible")?this.settingsPopup.detach():(e.JQueryUtils.positionPopup(this.settingsPopup,e.$(t.delegateTarget),e.$(this.facet.root),e.$(this.facet.root),this.getPopupAlignment()),this.hideSection.toggle(!e.$(this.facet.element).hasClass("coveo-facet-collapsed")),this.showSection.toggle(e.$(this.facet.element).hasClass("coveo-facet-collapsed")),this.facet.options.enableSettingsFacetState&&this.clearStateSection.toggle(!e.Utils.isNullOrUndefined(this.facetStateLocalStorage.load())),e._.each(this.enabledSorts,function(e,t){n.activeSort.name.toLowerCase()==e.name.toLowerCase()?n.selectItem(i.sortItems[t]):n.unselectItem(i.sortItems[t])}))},i.prototype.handleClickSortButton=function(t,n){this.activeSort=n,n.directionToggle&&e._.contains(this.enabledSorts,i.availableSorts[this.activeSort.relatedSort])?this.activateDirectionSection():this.disableDirectionSection(),this.selectItem(e.$(t.target)),this.closePopupAndUpdateSort()},i.prototype.handleDirectionClick=function(t,n){e.$(t.target).parent().parent().hasClass("coveo-facet-settings-disabled")||-1!=this.activeSort.name.indexOf(n)||(this.activeSort=i.availableSorts[this.activeSort.relatedSort],this.unselectSection(this.directionSection),this.selectItem(e.$(t.target)),"custom"==this.activeSort.name&&this.customSortDirection!=n&&(this.customSortDirection=n,this.customSortDirectionChange=!0),this.closePopupAndUpdateSort())},i.prototype.handleSaveStateClick=function(){this.facetStateLocalStorage.save({included:this.facet.queryStateModel.get(this.includedStateAttribute),excluded:this.facet.queryStateModel.get(this.excludedStateAttribute),operator:this.facet.queryStateModel.get(this.operatorStateAttribute)}),this.closePopup()},i.prototype.handleClearStateClick=function(){var t=this;this.facetStateLocalStorage.remove(),this.facet.reset(),this.closePopup(),this.facet.triggerNewQuery(function(){return t.facet.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.facet.options.id,facetTitle:t.facet.options.title})})},i.prototype.handleMouseEventOnButton=function(t){var i,n=this;this.settingsButton.click(function(e){return n.handleClickSettingsButtons(e,t)}),e.$([this.settingsIcon[0],this.settingsPopup[0]]).mouseleave(function(){return i=setTimeout(function(){n.settingsPopup.detach()},300)}).mouseenter(function(){return clearTimeout(i)})},i.prototype.activateDirectionSection=function(){this.directionSection.removeClass("coveo-facet-settings-disabled"),this.unselectSection(this.directionSection),this.selectItem(this.getItems(this.directionSection).first())},i.prototype.disableDirectionSection=function(){this.directionSection.addClass("coveo-facet-settings-disabled"),this.unselectSection(this.directionSection)},i.prototype.getItems=function(e){return e.find(".coveo-facet-settings-item")},i.prototype.unselectSection=function(e){this.getItems(e).removeClass("coveo-selected")},i.prototype.selectItem=function(e){e.addClass("coveo-selected")},i.prototype.unselectItem=function(e){e.removeClass("coveo-selected")},i.prototype.getPopupAlignment=function(){var t=e.DeviceUtils.isMobileDevice()?1:2,i=2;return{horizontal:t,vertical:i}},i.prototype.filterDuplicateForRendering=function(){this.hasDuplicate("alphaascending","alphadescending")&&this.enabledSortsIgnoreRenderBecauseOfPairs.push(i.availableSorts.alphadescending),this.hasDuplicate("computedfieldascending","computedfielddescending")&&this.enabledSortsIgnoreRenderBecauseOfPairs.push(i.availableSorts.computedfielddescending)},i.prototype.hasDuplicate=function(t,i){var n=e._.filter(this.enabledSorts,function(e){return e.name==t||e.name==i});return void 0!=n&&2==n.length},i}(e.FacetSort);e.FacetSettings=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValueElementKlass=t,this.valueList={}}return t.prototype.build=function(){return this.valueContainer=e.$('<ul class="coveo-facet-values"/>'),this.valueContainer},t.prototype.get=function(t){var i;return t instanceof e.FacetValue?i=t.value:(t=e.Utils.anyTypeToString(t),i=t),this.ensureFacetValueIsInList(t),this.valueList[i.toLowerCase()]},t.prototype.select=function(e){var t=this.get(e);return t.select(),t},t.prototype.unselect=function(e){var t=this.get(e);return t.unselect(),t},t.prototype.exclude=function(e){var t=this.get(e);return t.exclude(),t},t.prototype.unExclude=function(e){var t=this.get(e);return t.unexclude(),t},t.prototype.toggleSelect=function(e){var t=this.get(e);return t.facetValue.selected?t.unselect():t.select(),t},t.prototype.toggleExclude=function(e){var t=this.get(e);return t.facetValue.excluded?t.unexclude():t.exclude(),t},t.prototype.rebuild=function(t){var i=this;this.valueContainer.empty();var n=this._getValuesToBuildWith(),o=t;e._.each(n,function(e,t){if(i.facetValueShouldBeRemoved(e))i.facet.values.remove(e.value),o+=1;else if(o>t){var n=new i.facetValueElementKlass(i.facet,e,!0);i.valueList[e.value.toLowerCase()]=n;var s=n.build().listElement;i.valueContainer.append(s)}}),e.FacetUtils.addNoStateCssClassToFacetValues(this.facet,this.valueContainer),e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet)},t.prototype._getValuesToBuildWith=function(){return this.facet.facetSort.reorderValues(this.facet.values.getAll())},t.prototype.facetValueShouldBeRemoved=function(e){return!(0!=e.occurrences||0!=e.delta&&void 0!=e.delta||e.selected||e.excluded||this.facet.keepDisplayedValuesNextTime)},t.prototype.ensureFacetValueIsInList=function(t){var i;t instanceof e.FacetValue?(i=this.facet.values.get(t.value),null==i&&(this.facet.values.add(t),i=t)):(i=this.facet.values.get(t),null==i&&(i=e.FacetValue.createFromValue(t),this.facet.values.add(i)));var n=i.value.toLowerCase(),o=this.valueList[n];void 0==o?(o=this.valueList[n]=new e.FacetValueElement(this.facet,i,!0),o.build()):o.facetValue=i},t.prototype.addNoStateCssClassToFacetValues=function(){if(0!=this.facet.values.getSelected().length){var t=this.valueContainer.find("li").not(".coveo-selected");e._.each(t,function(t){e.$(t).addClass("coveo-no-state")})}},t}();e.FacetValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValue=t}return t.prototype.build=function(){this.listElement=e.$('<li class="coveo-facet-value coveo-facet-selectable"/>'),this.listElement.data("value",this.facetValue.value),this.excludeIcon=this._buildExcludeIcon().appendTo(this.listElement),this.label=e.$('<label class="coveo-facet-value-label"/>').appendTo(this.listElement),e.Utils.exists(this.facetValue.computedField)&&(this.computedField=this._buildValueComputedField().appendTo(this.label),this.label.addClass("coveo-with-computed-field"));var t=e.$('<div class="coveo-facet-value-label-wrapper"/>').appendTo(this.label);return this.checkbox=this._buildValueCheckbox().appendTo(t),this.stylishCheckbox=this._buildValueStylishCheckbox().appendTo(t),this.facet.options.showIcon&&(this.icon=this._buildValueIcon().appendTo(t)),this.valueCaption=this._buildValueCaption().appendTo(t),this.valueCount=this._buildValueCount().appendTo(t),this._setCssClassOnListValueElement(),this.bindEvent({displayNextTime:!0,pinFacet:this.facet.options.preservePosition}),this},t.prototype.bindEvent=function(t){this.isOmnibox=e.Utils.isNullOrUndefined(t.omniboxObject)?!1:!0,this._handleEventForCheckboxChange(t),this.facetValue.excluded?this._handleEventForExcludedValueElement(t):this._handleEventForValueElement(t)},t.prototype.select=function(){this.facetValue.selected=!0,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},t.prototype.unselect=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},t.prototype.exclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!0,this._setCssClassOnListValueElement()},t.prototype.unexclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},t.prototype._buildExcludeIcon=function(){return e.$("<div />").attr("title",e.l("Exclude",this.facet.getValueCaption(this.facetValue))).addClass("coveo-facet-value-exclude")},t.prototype._buildValueComputedField=function(){var t=this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat);return e.Utils.isNonEmptyString(t)?e.$("<span/>").addClass("coveo-facet-value-computed-field").text(t):e.$([])},t.prototype._buildValueCheckbox=function(){var t=e.$('<input type="checkbox"/>');return t.prop("checked",this.facetValue.selected),t.prop("disabled",this.facetValue.excluded),e.Component.pointElementsToDummyForm(t),t},t.prototype._buildValueStylishCheckbox=function(){var t=e.$("<div/>").addClass("coveo-facet-value-checkbox");return e.$("<span/>").appendTo(t),t},t.prototype._buildValueIcon=function(){var t=this._getValueIcon();return e.Utils.exists(t)?e.$('<img class="coveo-facet-value-icon coveo-icon"/>').prop("src",this._getValueIcon()):this._buildValueIconFromSprite()},t.prototype._getValueIcon=function(){return e.Utils.exists(this.facet.options.valueIcon)?this.facet.options.valueIcon(this.facetValue):void 0},t.prototype._buildValueIconFromSprite=function(){return e.$("<div />").addClass("coveo-facet-value-icon coveo-icon").addClass(this.facet.options.field.substr(1)).addClass(this.facetValue.value)},t.prototype._buildValueCaption=function(){return e.$('<span class="coveo-facet-value-caption"/>').text(this.facet.getValueCaption(this.facetValue))},t.prototype._buildValueCount=function(){var t=this.facetValue.getFormattedCount();if(e.Utils.isNonEmptyString(t)){var i=e.$("<span/>").addClass("coveo-facet-value-count").text(t);return i}return e.$([])},t.prototype._handleSelectValue=function(t){var i=this;this.facet.keepDisplayedValuesNextTime=t.displayNextTime&&!this.facet.options.useAnd;var n;this.facetValue.excluded?(n=e.AnalyticsActionCauseList.facetUnexclude,this.facet.unexcludeValue(this.facetValue)):(n=this.facetValue.selected?e.AnalyticsActionCauseList.facetDeselect:e.AnalyticsActionCauseList.facetSelect,this.facet.toggleSelectValue(this.facetValue)),this.isOmnibox&&(n=e.AnalyticsActionCauseList.omniboxFacet),this.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(n,i.getAnalyticsFacetMeta())})},t.prototype._handleExcludeClick=function(t){var i=this;this.facet.keepDisplayedValuesNextTime=t.displayNextTime&&!this.facet.options.useAnd,this.facet.toggleExcludeValue(this.facetValue);var n=this.isOmnibox?e.AnalyticsActionCauseList.omniboxFacet:e.AnalyticsActionCauseList.facetExclude;this.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(n,i.getAnalyticsFacetMeta())})},t.prototype._handleEventForExcludedValueElement=function(e){var t=this;this.label.click(function(i){return e.pinFacet&&t.facet.pinFacetPosition(),e.omniboxObject&&t._omniboxCloseEvent(e.omniboxObject),t._handleSelectValue(e),i.stopPropagation(),!1})},t.prototype._handleEventForValueElement=function(e){var t=this;this.excludeIcon.click(function(i){return e.omniboxObject&&t._omniboxCloseEvent(e.omniboxObject),t._handleExcludeClick(e),i.stopPropagation(),!1}),this.label.click(function(i){return e.pinFacet&&t.facet.pinFacetPosition(),i.preventDefault(),t.checkbox.change(),!1})},t.prototype._handleEventForCheckboxChange=function(t){var i=this;this.checkbox.change(function(){t.omniboxObject&&i._omniboxCloseEvent(t.omniboxObject),i._handleSelectValue(t),e.DeviceUtils.isMobileDevice()&&i.facet.options.enableFacetSearch&&e.Defer.defer(function(){e.ModalBox.close(!0),i.facet.facetSearch.completelyDismissSearch()})})},t.prototype._omniboxCloseEvent=function(e){e.closeOmnibox(),e.clear()},t.prototype._setCssClassOnListValueElement=function(){this.listElement.toggleClass("coveo-selected",this.facetValue.selected),this.listElement.toggleClass("coveo-excluded",this.facetValue.excluded)},t.prototype.getAnalyticsFacetMeta=function(){return{facetId:this.facet.options.id,facetValue:this.facetValue.value,facetTitle:this.facet.options.title}},t}();e.ValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){var s=this;t.call(this,i,n),this.facet=i,this.facetValue=n,this.keepDisplayedValueNextTime=o,this.firstQuery=!0,e.$(i.root).one(e.QueryEvents.querySuccess,function(){s.firstQuery=!1})}return __extends(i,t),i.prototype.bindEvent=function(){t.prototype.bindEvent.call(this,{displayNextTime:this.keepDisplayedValueNextTime,pinFacet:this.facet.options.preservePosition})},i}(e.ValueElement);e.FacetValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i),this.facet=t,this.facetValue=i,this.eventArg=n}return __extends(t,e),t.prototype.bindEvent=function(){e.prototype.bindEvent.call(this,{displayNextTime:!1,pinFacet:!1,omniboxObject:this.eventArg})},t}(e.ValueElement);e.OmniboxValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValueElementKlass=t}return t.prototype.build=function(t){var i=this,n=e._.map(t,function(t){return e._.find(i.facet.values.getAll(),function(e){return e.value==t.value})||t});return e.$(e._.map(n,function(e){return new i.facetValueElementKlass(i.facet,e,i.facet.keepDisplayedValuesNextTime).build().listElement.get(0)}))},t}();e.FacetSearchValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValue=t}return t.prototype.build=function(t){var i=this;void 0===t&&(t=!0),e.Assert.exists(this.facetValue);var n=e.DeviceUtils.isMobileDevice()?e.$("<div/>"):e.$("<span/>");n.addClass("coveo-facet-breadcrumb-value"),n.toggleClass("coveo-selected",this.facetValue.selected),n.toggleClass("coveo-excluded",this.facetValue.excluded),n.attr("title",this.getBreadcrumbTooltip()),e.$("<span/>").addClass("coveo-facet-breadcrumb-caption").text(this.facet.getValueCaption(this.facetValue)).appendTo(n),e.$("<span/>").addClass("coveo-facet-breadcrumb-clear").appendTo(n);var o=!1;return n.click(function(){o||(o=!0,i.facetValue.excluded?i.facet.unexcludeValue(i.facetValue.value):i.facet.deselectValue(i.facetValue.value),i.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.breadcrumbFacet,{facetId:i.facet.options.id,facetValue:i.facetValue.value,facetTitle:i.facet.options.title})}))}),n},t.prototype.getBreadcrumbTooltip=function(){var t=[this.facet.getValueCaption(this.facetValue),this.facetValue.getFormattedCount(),this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat)];return e._.compact(t).join(" ")},t}();e.BreadcrumbValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n){this.facet=t,this.facetValues=i,this.breadcrumbValueElementKlass=n,this.setExpandedAndCollapsed(),this.elem=e.$("<div/>").addClass("coveo-facet-breadcrumb");var o=e.DeviceUtils.isMobileDevice()?e.$("<div/>"):e.$("<span/>");o.addClass("coveo-facet-breadcrumb-title").text(this.facet.options.title+(e.DeviceUtils.isMobileDevice()?"":":")).appendTo(this.elem),this.valueContainer=e.$("<span/>").addClass("coveo-facet-breadcrumb-values").appendTo(this.elem)}return t.prototype.build=function(){return this.buildExpanded(),0!=this.collapsed.length&&this.buildCollapsed(),this.elem},t.prototype.buildExpanded=function(){var t=this;e._.each(this.expanded,function(i,n){0==n||e.DeviceUtils.isMobileDevice()||e.$("<span/>").addClass("coveo-facet-breadcrumb-separator").text(", ").appendTo(t.valueContainer),new t.breadcrumbValueElementKlass(t.facet,i).build().appendTo(t.valueContainer)})},t.prototype.buildCollapsed=function(){var t=this,i=e._.filter(this.collapsed,function(e){return e.selected}).length,n=e._.filter(this.collapsed,function(e){return e.excluded}).length;e.Assert.check(i+n==this.collapsed.length);var o=e.$("<div/>").addClass("coveo-facet-breadcrumb-value");e.DeviceUtils.isMobileDevice()||e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(o),i>0&&(e.$("<span/>").addClass("coveo-facet-breadcrumb-multi-count").text(Globalize.format(i,"n0")).appendTo(o),e.$("<div/>").addClass("coveo-selected").addClass("coveo-facet-breadcrumb-multi-icon").appendTo(o)),n>0&&(e.$("<span/>").addClass("coveo-facet-breadcrumb-multi-count").text(Globalize.format(n,"n0")).appendTo(o),e.$("<div />").addClass("coveo-excluded").addClass("coveo-facet-breadcrumb-multi-icon").appendTo(o));var s=e._.map(this.collapsed,function(e){return new t.breadcrumbValueElementKlass(t.facet,e)}),r=e._.map(s,function(e){return e.getBreadcrumbTooltip()});o.attr("title",r.join("\n")),o.click(function(){var t=[];e._.forEach(s,function(i){e.DeviceUtils.isMobileDevice()||t.push(e.$("<span/>").addClass("coveo-facet-breadcrumb-separator").text(", ")[0]),t.push(i.build(!1).get(0))}),e.$(t).insertBefore(o),o.detach()}),this.valueContainer.append(o)},t.prototype.setExpandedAndCollapsed=function(){this.facetValues.length>this.facet.options.numberOfValuesInBreadcrumb?(this.collapsed=e._.rest(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1),this.expanded=e._.first(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1)):(this.collapsed=[],this.expanded=this.facetValues)},t}();e.BreadcrumbValueList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t,i,n){this.facet=e,this.facetValues=t,this.omniboxObject=i,this.omniboxValueElementKlass=n}return t.prototype.build=function(){var t=this,i=[];return e._.each(this.facetValues,function(e){i.push(t.buildOmniboxForOneRow(e,t.omniboxObject))}),this.buildFinalOmniboxElement(i)},t.prototype.buildOmniboxForOneRow=function(t,i){var n=new this.omniboxValueElementKlass(this.facet,t,i),o=n.build().listElement,s=i.completeQueryExpression.regex,r=i.completeQueryExpression.word;o.find(".coveo-facet-value-caption").html(this.highlightOmniboxMatch(this.facet.getValueCaption(t),s,r));var a=e.$("<div class='coveo-omnibox-selectable coveo-facet-value coveo-omnibox-facet-value'></div>").append(o);return a.on("keyboardSelect",function(){o.find("input[type=checkbox]").change()}),a},t.prototype.buildFinalOmniboxElement=function(t){var i=this.buildOmniboxHeader();if(e.Utils.isEmptyArray(t))return void 0;var n=e.$("<div></div>").append(i,t);return e.FacetUtils.addNoStateCssClassToFacetValues(this.facet,n),n},t.prototype.buildOmniboxHeader=function(){var t=e.$("<span class='coveo-icon "+this.facet.options.field.substr(1)+"'></span>"),i=this.facet.options.title;return e.$("<div class='coveo-omnibox-facet-header'></div>").append(t,i)},t.prototype.highlightOmniboxMatch=function(e,t,i){var n=e.search(t),o=n+i.length;return e.slice(0,n)+"<span class='coveo-highlight'>"+e.slice(n,o)+"</span>"+e.slice(o)},t.prototype.omniboxCloseEvent=function(e){e.closeOmnibox(),e.clear()},t}();e.OmniboxValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.populateOmnibox="populateOmnibox",e.openOmnibox="openOmnibox",e.closeOmnibox="closeOmnibox",e}();e.OmniboxEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;void 0===r&&(r=i.ID),t.call(this,n,r,s),this.element=n,this.options=o,this.keepDisplayedValuesNextTime=!1,this.values=new e.FacetValues,this.currentPage=0,this.firstQuery=!0,this.canFetchMore=!0,this.showingWaitAnimation=!1,this.listenToQueryStateChange=!0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null!=this.options.valueCaption&&(this.options.availableSorts=e._.filter(this.options.availableSorts,function(e){return!/^alpha.*$/.test(e)})),this._omniboxZIndex=i.omniboxIndex,i.omniboxIndex--,this.checkForComputedFieldAndSort(),this.checkForValueCaptionType(),this.checkForCustomSort(),this.initFacetQueryController(),this.initQueryEvents(),this.initQueryStateEvents(),this.initComponentStateEvents(),this.initOmniboxEvents(),this.initBreadCrumbEvents(),this.updateNumberOfValues(),e.$(window).resize(function(){a.disabled||e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(a)}),e.$(this.root).one(e.QueryEvents.querySuccess,function(){a.firstQuery=!1})}return __extends(i,t),i.prototype.createDom=function(){if(this.initBottomAndTopSpacer(),this.buildFacetContent(),this.updateAppearanceDependingOnState(),this.facetSettings&&this.options.enableSettingsFacetState){var t=e._.once(e.$.proxy(this.facetSettings.loadSavedState,this.facetSettings));this.bind.onRoot(e.QueryEvents.newQuery,t)}},i.prototype.selectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Selecting facet value",this.facetValuesList.select(t)),this.facetValueHasChanged()},i.prototype.selectMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Selecting facet value",i.facetValuesList.select(e))}),this.facetValueHasChanged()},i.prototype.deselectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Deselecting facet value",this.facetValuesList.unselect(t)),this.facetValueHasChanged()},i.prototype.deselectMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Deselecting facet value",i.facetValuesList.unselect(e))}),this.facetValueHasChanged()},i.prototype.excludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Excluding facet value",this.facetValuesList.exclude(t)),this.facetValueHasChanged()},i.prototype.excludeMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Excluding facet value",i.facetValuesList.exclude(e))}),this.facetValueHasChanged()},i.prototype.unexcludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Unexcluding facet value",this.facetValuesList.unExclude(t)),this.facetValueHasChanged()},i.prototype.unexcludeMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Unexcluding facet value",i.facetValuesList.unExclude(e))}),this.facetValueHasChanged()},i.prototype.toggleSelectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle select facet value",this.facetValuesList.toggleSelect(t)),this.facetValueHasChanged()},i.prototype.toggleExcludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle exclude facet value",this.facetValuesList.toggleExclude(t)),this.facetValueHasChanged()},i.prototype.getDisplayedValues=function(){return this.ensureDom(),e._.first(e._.pluck(this.values.getAll(),"value"),this.numberOfValues)},i.prototype.getSelectedValues=function(){return this.ensureDom(),e._.map(this.values.getSelected(),function(e){return e.value})},i.prototype.getExcludedValues=function(){return this.ensureDom(),e._.map(this.values.getExcluded(),function(e){return e.value})},i.prototype.reset=function(){this.ensureDom(),this.values.reset(),this.rebuildValueElements(),this.updateAppearanceDependingOnState(),this.updateQueryStateModel()},i.prototype.switchToAnd=function(){this.ensureDom(),this.logger.info("Switching to AND"),this.facetHeader.switchToAnd()},i.prototype.switchToOr=function(){this.ensureDom(),this.logger.info("Switching to OR"),this.facetHeader.switchToOr()},i.prototype.getEndpoint=function(){return this.queryController.getEndpoint()},i.prototype.updateSort=function(e){this.options.sortCriteria!=e&&(this.options.sortCriteria=e,this.triggerNewQuery())},i.prototype.unfadeInactiveValuesInMainList=function(){e.$(this.element).removeClass("coveo-facet-fade")},i.prototype.fadeInactiveValuesInMainList=function(){e.$(this.element).addClass("coveo-facet-fade")},i.prototype.showWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingWaitAnimation||(t.headerElement.find(".coveo-icon").first().css("display","none"),t.headerElement.find(".coveo-facet-header-wait-animation").css("display",""),t.showingWaitAnimation=!0)})},i.prototype.hideWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingWaitAnimation&&(t.headerElement.find(".coveo-icon").css("display",""),t.headerElement.find(".coveo-facet-header-wait-animation").css("display","none"),t.showingWaitAnimation=!1)})},i.prototype.processFacetSearchAllResultsSelected=function(t){var i=this,n=[];e._.each(t,function(e){i.ensureFacetValueIsInList(e),n.push(e.value)}),this.updateQueryStateModel(),this.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetSelectAll,{facetId:i.options.id,facetTitle:i.options.title})})},i.prototype.pinFacetPosition=function(){this.pinnedViewportPosition=this.element.getBoundingClientRect().top},i.prototype.getValueCaption=function(t){e.Assert.exists(t);var i=t.lookupValue||t.value,n=i;return n=e.FacetUtils.tryToGetTranslatedCaption(this.options.field,i),e.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(n=this.options.valueCaption[i]||n),"function"==typeof this.options.valueCaption&&(this.values.get(i),n=this.options.valueCaption.call(this,this.facetValuesList.get(i).facetValue))),n},i.prototype.enable=function(){t.prototype.enable.call(this)},i.prototype.disable=function(){t.prototype.disable.call(this)},i.prototype.triggerNewQuery=function(t){var i=this;t?this.queryController.deferExecuteQuery({beforeExecuteQuery:t}):this.queryController.deferExecuteQuery({ignoreWarningSearchEvent:!0}),e.Defer.defer(function(){return i.showWaitingAnimation()})},i.prototype.handleDeferredQuerySuccess=function(t,i){e.Assert.exists(i),this.unfadeInactiveValuesInMainList(),this.hideWaitingAnimation(),this.updateVisibilityBasedOnDependsOn();var n=i.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];this.facetQueryController.lastGroupByResult=n,n||(this.keepDisplayedValuesNextTime=!1),this.processNewGroupByResults(n)},i.prototype.handlePopulateBreadcrumb=function(t,i){if(e.Assert.exists(i),this.values.hasSelectedOrExcludedValues()){var n=new e.BreadcrumbValueList(this,this.values.getSelected().concat(this.values.getExcluded()),e.BreadcrumbValueElement).build();i.breadcrumbs.push({element:n.get(0)})}},i.prototype.initFacetQueryController=function(){this.facetQueryController=new e.FacetQueryController(this)},i.prototype.initFacetValuesList=function(){this.facetValuesList=new e.FacetValuesList(this,e.FacetValueElement),e.$(this.element).append(this.facetValuesList.build())},i.prototype.initFacetSearch=function(){this.facetSearch=new e.FacetSearch(this,e.FacetSearchValuesList),e.$(this.element).append(this.facetSearch.build())},i.prototype.facetValueHasChanged=function(){var t=this;this.updateQueryStateModel(),this.rebuildValueElements(),e.Defer.defer(function(){t.updateAppearanceDependingOnState()})},i.prototype.updateAppearanceDependingOnState=function(){e.$(this.element).toggleClass("coveo-active",this.values.hasSelectedOrExcludedValues()),e.$(this.element).toggleClass("coveo-facet-empty",!this.isAnyValueCurrentlyDisplayed()),e.$(this.facetHeader.eraserElement).fastToggle(this.values.hasSelectedOrExcludedValues())},i.prototype.initQueryEvents=function(){this.bind.onRoot(e.QueryEvents.duringQuery,this.handleDuringQuery),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.doneBuildingQuery,this.handleDoneBuildingQuery),this.bind.onRoot(e.QueryEvents.deferredQuerySuccess,this.handleDeferredQuerySuccess)},i.prototype.initQueryStateEvents=function(){this.includedAttributeId=e.QueryStateModel.getFacetId(this.options.id),this.excludedAttributeId=e.QueryStateModel.getFacetId(this.options.id,!1),this.operatorAttributeId=e.QueryStateModel.getFacetOperator(this.options.id),this.lookupValueAttributeId=e.QueryStateModel.getFacetLookupValue(this.options.id),this.queryStateModel.registerNewAttribute(this.includedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.excludedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.operatorAttributeId,""),this.queryStateModel.registerNewAttribute(this.lookupValueAttributeId,{});
var t=this.queryStateModel.getEventName(e.Model.eventTypes.change);this.bind.onRoot(t,this.handleQueryStateChanged)},i.prototype.initComponentStateEvents=function(){this.componentStateId=e.QueryStateModel.getFacetId(this.options.id),this.componentStateModel.registerComponent(this.componentStateId,this)},i.prototype.initOmniboxEvents=function(){this.options.includeInOmnibox&&this.bind.onRoot(e.OmniboxEvents.populateOmnibox,this.handlePopulateOmnibox)},i.prototype.initBreadCrumbEvents=function(){this.options.includeInBreadcrumb&&(this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,this.handlePopulateBreadcrumb),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,this.handleClearBreadcrumb))},i.prototype.handleOmniboxWithStaticValue=function(t){var i=this,n=new RegExp("^"+t.completeQueryExpression.regex.source,"i"),o=(t.completeQueryExpression.word,e._.first(e._.filter(this.getDisplayedValues(),function(e){var t=i.getValueCaption(i.facetValuesList.get(e).facetValue);return n.test(t)}),this.options.numberOfValuesInOmnibox)),s=e._.map(o,function(e){return i.facetValuesList.get(e).facetValue}),r=new e.OmniboxValuesList(this,s,t,e.OmniboxValueElement).build();t.rows.push({element:r?r.get(0):void 0,zIndex:this._omniboxZIndex})},i.prototype.processNewGroupByResults=function(t){this.logger.trace("Displaying group by results",t),void 0!=t&&void 0!=t.values&&(this.nbAvailableValues=t.values.length);var i=new e.FacetValues(t);this.updateValues(i),this.canFetchMore=this.numberOfValues<this.nbAvailableValues,this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField?this.triggerUpdateDeltaQuery(e._.filter(this.values.getAll(),function(e){return!e.selected&&!e.excluded})):this.values.getSelected().length>0&&!this.options.useAnd&&this.values.updateDeltaWithFilteredFacetValues(new e.FacetValues),this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField||(this.rebuildValueElements(),this.updateAppearanceDependingOnState(),this.ensurePinnedFacetHasntMoved()),this.keepDisplayedValuesNextTime=!1},i.prototype.updateQueryStateModel=function(){this.listenToQueryStateChange=!1,this.updateExcludedQueryStateModel(),this.updateIncludedQueryStateModel(),this.facetHeader.updateOperatorQueryStateModel(),this.updateLookupValueQueryStateModel(),this.listenToQueryStateChange=!0},i.prototype.rebuildValueElements=function(){this.updateNumberOfValues(),this.facetValuesList.rebuild(this.numberOfValues),this.options.enableMoreLess&&this.updateMoreLess()},i.prototype.updateMoreLess=function(){var e=!1;this.getMinimumNumberOfValuesToDisplay()<this.numberOfValues?(this._lessElement.show(),e=!0):this._lessElement.hide();var t=this.nbAvailableValues>this.numberOfValues;this._moreElement.toggleClass("coveo-active",t),e||t?this.footerElement.removeClass("coveo-facet-empty"):this.footerElement.addClass("coveo-facet-empty")},i.prototype.handleClickMore=function(){this.currentPage++,this.updateNumberOfValues(),this.nbAvailableValues>=this.numberOfValues||!this.canFetchMore?this.rebuildValueElements():this.triggerMoreQuery()},i.prototype.handleClickLess=function(){this._lessElement.hide(),this.currentPage=0,this.updateNumberOfValues(),this._moreElement.addClass("coveo-active"),this.values.sortValuesDependingOnStatus(this.numberOfValues),this.rebuildValueElements()},i.prototype.checkForComputedFieldAndSort=function(){-1!=this.options.sortCriteria.toLowerCase().indexOf("computedfield")&&e.Utils.isNullOrUndefined(this.options.computedField)&&this.logger.warn("Sort criteria is specified as ComputedField, but the facet uses no computed field. Facet will always be empty !",this)},i.prototype.checkForValueCaptionType=function(){this.options.valueCaption&&"function"==typeof this.options.valueCaption&&(this.options.enableFacetSearch=!1,this.options.includeInOmnibox=!1,this.logger.warn("Using a function as valueCaption is now deprecated. Use a json key value pair instead. Facet search and omnibox has been disabled for this facet",this))},i.prototype.checkForCustomSort=function(){void 0==this.options.customSort||e._.contains(this.options.availableSorts,"custom")||this.options.availableSorts.unshift("custom"),"custom"==this.options.availableSorts[0]&&(this.options.sortCriteria="nosort")},i.prototype.initBottomAndTopSpacer=function(){var t=this,i=e.$(this.options.paddingContainer).children(".coveo-bottomSpace"),n=e.$(this.options.paddingContainer).children(".coveo-topSpace");this.options.preservePosition&&(e.$(this.options.paddingContainer).mouseleave(function(){return t.unpinFacetPosition()}),this.pinnedTopSpace=n,this.pinnedBottomSpace=i,0==this.pinnedTopSpace.length&&(this.pinnedTopSpace=e.$("<div />").addClass("coveo-topSpace").prependTo(this.options.paddingContainer)),0==this.pinnedBottomSpace.length&&(this.pinnedBottomSpace=e.$("<div />").addClass("coveo-bottomSpace").appendTo(this.options.paddingContainer)))},i.prototype.updateIncludedQueryStateModel=function(){var e={included:this.getSelectedValues(),title:this.includedAttributeId};this.queryStateModel.set(this.includedAttributeId,e.included)},i.prototype.updateExcludedQueryStateModel=function(){var e={title:this.excludedAttributeId,excluded:this.getExcludedValues()};this.queryStateModel.set(this.excludedAttributeId,e.excluded)},i.prototype.updateLookupValueQueryStateModel=function(){if(this.options.lookupField){var t={};e._.each(this.values.getSelected().concat(this.values.getExcluded()),function(e){t[e.value]=e.lookupValue}),this.queryStateModel.set(this.lookupValueAttributeId,t)}},i.prototype.handleQueryStateChangedOperator=function(e){"and"==e?this.switchToAnd():"or"==e&&this.switchToOr()},i.prototype.handleQueryStateChangedIncluded=function(t){var i=e._.difference(this.getSelectedValues(),t);e.Utils.isNonEmptyArray(i)&&this.deselectMultipleValues(i),e.Utils.arrayEqual(this.getSelectedValues(),t,!1)||this.selectMultipleValues(t)},i.prototype.handleQueryStateChangedExcluded=function(t){var i=e._.difference(this.getExcludedValues(),t);e.Utils.isNonEmptyArray(i)&&this.unexcludeMultipleValues(i),e.Utils.arrayEqual(this.getExcludedValues(),t,!1)||this.excludeMultipleValues(t)},i.prototype.handleLookupvalueChanged=function(t){var i=this;e._.each(t,function(e,t){i.facetValuesList.get(decodeURIComponent(t)).facetValue.lookupValue=decodeURIComponent(e)})},i.prototype.handleQueryStateChanged=function(t,i){e.Assert.exists(i),this.ensureDom();var n=i.attributes,o=n[this.includedAttributeId],s=n[this.excludedAttributeId],r=n[this.operatorAttributeId],a=n[this.lookupValueAttributeId];this.listenToQueryStateChange&&(e.Utils.isNullOrEmptyString(r)||this.handleQueryStateChangedOperator(r),e.Utils.isNullOrUndefined(o)||this.handleQueryStateChangedIncluded(o),e.Utils.isNullOrUndefined(s)||this.handleQueryStateChangedExcluded(s),e.Utils.isNullOrUndefined(a)||this.handleLookupvalueChanged(a))},i.prototype.handlePopulateOmnibox=function(t,i){e.Assert.exists(i),e.Assert.exists(i.completeQueryExpression),this.canFetchMore?this.handleOmniboxWithSearchInFacet(i):this.handleOmniboxWithStaticValue(i)},i.prototype.handleOmniboxWithSearchInFacet=function(t){var i=this,n=new RegExp("^"+t.completeQueryExpression.regex.source,"i"),o=e.$.Deferred();t.rows.push({deferred:o});var s=this.facetQueryController.recursiveFacetSearch(t.completeQueryExpression.word,this.options.numberOfValuesInOmnibox);s.done(function(s){var r=e._.map(e._.filter(s,function(e){return n.test(e.lookupValue)}),function(t){return i.values.get(t.lookupValue)||e.FacetValue.create(t)}),a=new e.OmniboxValuesList(i,r,t,e.OmniboxValueElement).build();o.resolve({element:a?a.get(0):void 0,zIndex:i._omniboxZIndex})}),s.fail(function(){o.resolve({element:void 0})})},i.prototype.handleDuringQuery=function(){this.ensureDom(),this.keepDisplayedValuesNextTime||this.fadeInactiveValuesInMainList(this.options.facetSearchDelay)},i.prototype.handleBuildingQuery=function(t,i){if(e.Assert.exists(i),e.Assert.exists(i.queryBuilder),this.facetQueryController.prepareForNewQuery(),this.values.hasSelectedOrExcludedValues()){var n=this.facetQueryController.computeOurFilterExpression();this.logger.trace("Putting filter in query",n),i.queryBuilder.advancedExpression.add(n)}},i.prototype.handleDoneBuildingQuery=function(t,i){e.Assert.exists(i),e.Assert.exists(i.queryBuilder);var n=i.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(n)},i.prototype.handleClearBreadcrumb=function(t,i){e.Assert.exists(i),this.reset()},i.prototype.updateValues=function(t){e.Assert.exists(t),this.keepDisplayedValuesNextTime?this.values.updateCountsFromNewValues(t):(t.importActiveValuesFromOtherList(this.values),t.sortValuesDependingOnStatus(this.numberOfValues),this.values=t),this.updateNumberOfValues()},i.prototype.ensureFacetValueIsInList=function(t){e.Assert.exists(t),this.values.contains(t.value)||this.values.add(t)},i.prototype.isAnyValueCurrentlyDisplayed=function(){return!this.values.isEmpty()},i.prototype.handleEraserClick=function(){var t=this;this.reset(),this.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title})})},i.prototype.buildFacetContent=function(){this.headerElement=this.buildHeader().appendTo(this.element),this.initFacetValuesList(),this.options.enableFacetSearch&&this.initFacetSearch(),this.options.enableMoreLess&&(this.footerElement=this.buildFooter().appendTo(this.element),this._moreElement=this.buildMore().appendTo(this.footerElement),this._lessElement=this._buildLess().appendTo(this.footerElement))},i.prototype.buildHeader=function(){var t=this;this.facetHeader=new e.FacetHeader({facetElement:e.$(this.element),title:this.options.title,icon:this.options.headerIcon,field:this.options.field,enableClearElement:!0,enableCollapseElement:this.options.enableCollapse,facet:this,settingsKlass:this.options.enableSettings?e.FacetSettings:void 0,sortKlass:e.FacetSort,availableSorts:this.options.availableSorts,onEraserClick:function(){t.handleEraserClick()}});var i=this.facetHeader.build();return this.facetSettings=this.facetHeader.settings,this.facetSort=this.facetHeader.sort,i},i.prototype._buildLess=function(){return e.$('<a class="coveo-facet-less">'+e.l("Less")+"</a>").hide().click(e.$.proxy(this.handleClickLess,this))},i.prototype.unpinFacetPosition=function(){var e=this;this.isFacetPinned()&&(this.pinnedTopSpace.animate({height:0},"fast",function(){void 0!=e.facetSearch&&e.facetSearch.positionSearchResults()}),this.pinnedBottomSpace.animate({height:0},"fast",function(){void 0!=e.facetSearch&&e.facetSearch.positionSearchResults()}),this.pinnedViewportPosition=void 0)},i.prototype.isFacetPinned=function(){return e.Utils.exists(this.pinnedViewportPosition)},i.prototype.ensurePinnedFacetHasntMoved=function(){var t=this;if(this.isFacetPinned()){e.Assert.exists(this.pinnedViewportPosition),this.pinnedTopSpace.height(0),this.pinnedBottomSpace.height(0);var i=this.options.scrollContainer==document.body?window:this.options.scrollContainer,n=this.element.getBoundingClientRect().top,o=n-this.pinnedViewportPosition;e.$(i).scrollTop(e.$(i).scrollTop()+o),n=this.element.getBoundingClientRect().top,o=n-this.pinnedViewportPosition,0>o?this.pinnedTopSpace.height(-1*o):setTimeout(function(){var n=t.element.getBoundingClientRect().top,o=n-t.pinnedViewportPosition;e.$(i).scrollTop(e.$(i).scrollTop()+o);for(var s=0,r=0;o>0&&r++<100;)s+=100,t.pinnedBottomSpace.height(s),n=t.element.getBoundingClientRect().top,o=n-t.pinnedViewportPosition,e.$(i).scrollTop(e.$(i).scrollTop()+o)},0)}},i.prototype.buildFooter=function(){return e.$('<div class="coveo-facet-footer"/>')},i.prototype.buildMore=function(){return e.$('<a class="coveo-facet-more">'+e.l("More")+"</a>").click(e.$.proxy(this.handleClickMore,this))},i.prototype.triggerMoreQuery=function(){var t=this;this.logger.info("Triggering new facet more query"),this.showWaitingAnimation(),this.facetQueryController.fetchMore().done(function(i){var n=new e.FacetValues(i.groupByResults[0]);n.importActiveValuesFromOtherList(t.values),n.sortValuesDependingOnStatus(t.numberOfValues),t.values=n,t.nbAvailableValues=t.values.size(),t.updateNumberOfValues(),t.canFetchMore=t.numberOfValues<t.nbAvailableValues,t.values.hasSelectedOrExcludedValues()&&!t.options.useAnd&&t.options.isMultiValueField?t.triggerUpdateDeltaQuery(e._.filter(t.values.getAll(),function(e){return!e.selected&&!e.excluded})):(t.values.hasSelectedOrExcludedValues()&&!t.options.useAnd?(t.values.updateDeltaWithFilteredFacetValues(new e.FacetValues),t.hideWaitingAnimation()):t.hideWaitingAnimation(),t.rebuildValueElements())}).fail(function(){return t.hideWaitingAnimation()})},i.prototype.triggerUpdateDeltaQuery=function(t){var i=this;this.showWaitingAnimation(),this.facetQueryController.searchInFacetToUpdateDelta(t).done(function(t){var n=new e.FacetValues;e._.each(t.groupByResults,function(t){e._.each(t.values,function(t){n.contains(t.value)||n.add(e.FacetValue.createFromGroupByValue(t))})}),i.values.updateDeltaWithFilteredFacetValues(n),i.rebuildValueElements(),i.hideWaitingAnimation()})},i.prototype.updateNumberOfValues=function(){this.currentPage<=0?(this.currentPage=0,this.numberOfValues=0):this.numberOfValues=this.options.numberOfValues+this.currentPage*this.options.pageSize,this.numberOfValues=Math.max(this.numberOfValues,this.getMinimumNumberOfValuesToDisplay())},i.prototype.getMinimumNumberOfValuesToDisplay=function(){var e=this.values.getExcluded().length+this.values.getSelected().length;if(null!=this.options.customSort&&null!=this.facetSort&&this.options.customSort.length>0){var t=-1;this.facetSort.reorderValues(this.values.getAll()).forEach(function(e,i){e.selected&&(t=i)}),e=t+1}return Math.max(e,this.options.numberOfValues)},i.prototype.updateVisibilityBasedOnDependsOn=function(){e.Utils.isNonEmptyString(this.options.dependsOn)&&e.$(this.element).toggleClass("coveo-facet-dependent",!this.doesParentFacetHasSelectedValue()&&!this.values.hasSelectedOrExcludedValues())},i.prototype.doesParentFacetHasSelectedValue=function(){var t=e.QueryStateModel.getFacetId(this.options.dependsOn),i=this.queryStateModel.get(t);return null!=i&&0!=i.length},i.prototype.debugInfo=function(){var e={};return e[this.constructor.ID]={component:this,groupByRequest:this.facetQueryController.lastGroupByRequest,groupByResult:this.facetQueryController.lastGroupByResult},e},i.ID="Facet",i.omniboxIndex=50,i.options={title:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("NoTitle")}),field:e.ComponentOptions.buildFieldOption({required:!0,groupByField:!0}),headerIcon:e.ComponentOptions.buildIconOption(),id:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),isMultiValueField:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),lookupField:e.ComponentOptions.buildFieldOption(),enableSettings:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableSettingsFacetState:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),availableSorts:e.ComponentOptions.buildListOption({defaultValue:["occurrences","score","alphaAscending","alphaDescending"],values:["Occurrences","Score","AlphaAscending","AlphaDescending","ComputedFieldAscending","ComputedFieldDescending","ChiSquare","NoSort"]}),sortCriteria:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||(t.availableSorts.length>0?t.availableSorts[0]:"occurrences")}}),customSort:e.ComponentOptions.buildListOption(),numberOfValues:e.ComponentOptions.buildNumberOption({defaultValue:5,min:0}),injectionDepth:e.ComponentOptions.buildNumberOption({defaultValue:1e3,min:0}),showIcon:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),useAnd:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),allowTogglingOperator:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableFacetSearch:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),facetSearchDelay:e.ComponentOptions.buildNumberOption({defaultValue:100,min:0}),facetSearchIgnoreAccents:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),numberOfValuesInFacetSearch:e.ComponentOptions.buildNumberOption({defaultValue:15,min:1}),includeInBreadcrumb:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),numberOfValuesInBreadcrumb:e.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:5},min:0}),includeInOmnibox:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),numberOfValuesInOmnibox:e.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:5},min:0}),computedField:e.ComponentOptions.buildFieldOption(),computedFieldOperation:e.ComponentOptions.buildStringOption({defaultValue:"sum"}),computedFieldFormat:e.ComponentOptions.buildStringOption({defaultValue:"c0"}),computedFieldCaption:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("ComputedField")}),preservePosition:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),paddingContainer:e.ComponentOptions.buildSelectorOption({defaultFunction:function(e){return e.parentElement}}),scrollContainer:e.ComponentOptions.buildSelectorOption({defaultFunction:function(){return document.body}}),enableMoreLess:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),pageSize:e.ComponentOptions.buildNumberOption({defaultValue:10,min:1}),enableCollapse:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),allowedValues:e.ComponentOptions.buildListOption(),additionalFilter:e.ComponentOptions.buildStringOption(),dependsOn:e.ComponentOptions.buildStringOption()},i}(e.Component);e.Facet=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.prototype.merge=function(t){return e.$.extend({},this,t)},t.prototype.mergeDeep=function(t){return e.$.extend(!0,{},e.Utils.extendDeep(this,t))},t}();e.Options=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.now=new Date,this.useTodayYesterdayAndTomorrow=!0,this.useWeekdayIfThisWeek=!0,this.omitYearIfCurrentOne=!0,this.useLongDateFormat=!1,this.includeTimeIfToday=!0,this.includeTimeIfThisWeek=!0,this.alwaysIncludeTime=!1,this.predefinedFormat=void 0}return __extends(t,e),t}(e.Options),i=function(){function i(){}return i.convertFromJsonDateIfNeeded=function(t){return e._.isDate(t)?t:null===t||isNaN(Number(t))?e._.isString(t)?new Date(t.replace("@"," ")):void 0:new Date(Number(t))},i.keepOnlyDatePart=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},i.offsetDateByDays=function(e,t){var i=new Date(e.valueOf());return i.setDate(i.getDate()+t),i},i.dateToString=function(n,o){if(e.Utils.isNullOrUndefined(n))return"";if(o=(new t).merge(o),e.Utils.isNullOrUndefined(n))return"";var n=i.keepOnlyDatePart(n),s=i.keepOnlyDatePart(o.now),r=i.offsetDateByDays(s,1),a=i.offsetDateByDays(s,-1),l=Math.abs(e.TimeSpan.fromDates(n,s).getDays())<7;return o.predefinedFormat?Globalize.format(n,o.predefinedFormat):o.useTodayYesterdayAndTomorrow&&n.valueOf()==s.valueOf()?e.l("Today"):o.useTodayYesterdayAndTomorrow&&n.valueOf()==a.valueOf()?e.l("Yesterday"):o.useTodayYesterdayAndTomorrow&&n.valueOf()==r.valueOf()?e.l("Tomorrow"):o.useWeekdayIfThisWeek&&l?n.valueOf()>s.valueOf()?e.l("Next")+" "+Globalize.format(n,"dddd"):e.l("Last")+" "+Globalize.format(n,"dddd"):o.omitYearIfCurrentOne&&n.getFullYear()===s.getFullYear()?Globalize.format(n,"M"):o.useLongDateFormat?Globalize.format(n,"D"):Globalize.format(n,"d")},i.timeToString=function(t){return e.Utils.isNullOrUndefined(t)?"":Globalize.format(t,"t")},i.dateTimeToString=function(i,n){if(e.Utils.isNullOrUndefined(i))return"";n=(new t).merge(n);var o=e.DateUtils.keepOnlyDatePart(n.now),s=Math.abs(e.TimeSpan.fromDates(i,o).getDays())<7,r=e.DateUtils.dateToString(i,n),a=e.DateUtils.keepOnlyDatePart(i);return n.alwaysIncludeTime||n.includeTimeIfThisWeek&&s||n.includeTimeIfToday&&a.valueOf()==o.valueOf()?r+", "+e.DateUtils.timeToString(i):r},i.monthToString=function(e){var t=new Date(1980,e);return Globalize.format(t,"MMMM")},i.isValid=function(e){return e instanceof Date?!isNaN(e.getTime()):!1},i.timeBetween=function(t,i){return e.Utils.isNullOrUndefined(t)||e.Utils.isNullOrUndefined(i)?"":("0"+((i.getTime()-t.getTime())/36e5).toFixed()).slice(-2)+":"+("0"+((i.getTime()-t.getTime())%36e5/6e4).toFixed()).slice(-2)+":"+("0"+((i.getTime()-t.getTime())%6e4/1e3).toFixed()).slice(-2)},i}();e.DateUtils=i}(Coveo||(Coveo={})),Date.prototype.toISOString||!function(){function e(e){return 10>e?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();var Coveo;!function(e){var t=function(t){function i(e){t.call(this,e),this.facet=e}return __extends(i,t),i.prototype.createBasicGroupByRequest=function(i,n){void 0===n&&(n=!0);var o=t.prototype.createBasicGroupByRequest.call(this,null,n);return o.allowedValues=void 0,o=e.Utils.isNonEmptyArray(this.facet.options.ranges)?this.buildGroupByQueryForPredefinedRanges(o):this.buildGroupByQueryForAutomaticRanges(o)},i.prototype.createGroupByAllowedValues=function(){return void 0},i.prototype.buildGroupByQueryForAutomaticRanges=function(e){return e.generateAutomaticRanges=!0,e},i.prototype.buildGroupByQueryForPredefinedRanges=function(e){return e.rangeValues=this.facet.options.ranges,e.maximumNumberOfValues=this.facet.options.ranges.length,e},i.prototype.buildGroupByQueryForSelectedAndExcludedValues=function(t){var i=this;return t.rangeValues=e._.map(this.facet.values.getAll(),function(e){var t=e.value.split(".."),n=t[0],o=t[1];return i.facet.options.dateField&&(n=i.getISOFormat(n),o=i.getISOFormat(o)),{start:n,end:o,endInclusive:!0,label:e.lookupValue}}),t},i.prototype.getISOFormat=function(t){if(t){isNaN(t)||(t=Number(t));var i=new Date(t);return e.DateUtils.isValid(i)||(i=new Date(this.getBrowserCompatibleFormat(t)),e.DateUtils.isValid(i))?i.toISOString():(this.facet.logger.error("Cannot parse this date format.",t,new Date(t)),void 0)}return void 0},i.prototype.getBrowserCompatibleFormat=function(e){return e.replace("@","T").replace(/\//g,"-")},i}(e.FacetQueryController);e.FacetRangeQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,i.ID),this.element=n,this.options.enableFacetSearch=!1,this.options.enableSettings=!1,this.options.includeInOmnibox=!1,this.options.enableMoreLess=!1}return __extends(i,t),i.prototype.getValueCaption=function(i){var n=t.prototype.getValueCaption.call(this,i);if(e.Utils.exists(this.options.valueCaption)&&"string"==typeof this.options.valueCaption){var o=/^(.*)\.\.(.*)$/.exec(i.value);if(null!=o){var s=e.TemplateHelpers.getHelper(this.options.valueCaption);if(null!=s)n=s.call(this,o[1])+" - "+s.call(this,o[2]);else{var r=o[1].match(/^[\+\-]?[0-9]+(\.[0-9]+)?$/)?Number(o[1]):e.DateUtils.convertFromJsonDateIfNeeded(o[1]),a=o[2].match(/^[\+\-]?[0-9]+(\.[0-9]+)?$/)?Number(o[2]):e.DateUtils.convertFromJsonDateIfNeeded(o[2]);n=Globalize.format(r,this.options.valueCaption)+" - "+Globalize.format(a,this.options.valueCaption)}}}return n},i.prototype.initFacetQueryController=function(){this.facetQueryController=new e.FacetRangeQueryController(this)},i.prototype.processNewGroupByResults=function(e){var i=this;null!=e&&(null!=this.options.ranges||this.keepDisplayedValuesNextTime&&!this.values.hasSelectedOrExcludedValues()||(this.keepDisplayedValuesNextTime=!1,e.values.sort(function(e,t){var n=e.value.split(".."),o=t.value.split("..");return i.options.dateField?Date.parse(n[0])-Date.parse(o[0]):Number(n[0])-Number(o[0])}))),t.prototype.processNewGroupByResults.call(this,e)},i.ID="FacetRange",i.parent=e.Facet,i.options={dateField:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Facet);e.FacetRange=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e,t){this.element=e,this.options=t,this.steps=[],this.options.dateField&&(this.options.start=new Date(this.options.start).getTime(),this.options.end=new Date(this.options.end).getTime()),void 0==this.options.rounded&&(this.options.rounded=0),(this.options.steps||this.options.getSteps)&&this.buildSteps(),this.options.graph&&(this.sliderGraph=new r(this)),this.sliderLine=new i(this),this.sliderLine.build().appendTo(this.element),this.options.rangeSlider?(this.sliderRange=new o(this),this.sliderRange.build().appendTo(this.element)):(this.sliderButton=new n(this,1),this.sliderButton.build().addClass("coveo-no-range-button").appendTo(this.element),this.sliderLine.setActiveWidth(this.sliderButton)),this.sliderCaption=new s(this),this.sliderCaption.build().appendTo(this.element)}return e.prototype.onMoving=function(){this.options.rangeSlider?(this.sliderRange.setBoundary(),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):this.sliderLine.setActiveWidth(this.sliderButton),this.options.graph&&this.sliderGraph.draw(),this.displayCaption()},e.prototype.initializeState=function(e){void 0===e&&(e=[this.options.start,this.options.end]),this.currentValues=e,this.options.rangeSlider?(this.sliderRange.initializeSliderRangeState(e),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(void 0==e?this.sliderButton.toEnd():this.sliderButton.setValue(e[1]),this.sliderButton.leftBoundary=0,this.sliderButton.rightBoundary=this.element.width(),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.getPosition=function(){return this.options.rangeSlider?this.sliderRange.getPosition():[0,this.sliderButton.getPosition()]},e.prototype.getPercentPosition=function(){return this.options.rangeSlider?this.sliderRange.getPercentPosition():[0,this.sliderButton.getPercent()]},e.prototype.getValues=function(){return void 0!=this.currentValues?this.currentValues:this.options.rangeSlider?this.sliderRange.getValue():[this.options.start,this.sliderButton.getValue()]},e.prototype.getCaptionFromValue=function(e){return this.sliderCaption.getCaptionFromValues(e)},e.prototype.getCaption=function(){return this.sliderCaption.getCaption()},e.prototype.setValues=function(e){void 0!=e&&(e[0]=Math.max(e[0],this.options.start),e[1]=Math.min(e[1],this.options.end)),this.currentValues=e,this.options.rangeSlider?(this.sliderRange.setValue(e),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(this.sliderButton.setValue(e[1]),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.drawGraph=function(e){this.sliderGraph.draw(e)},e.prototype.displayCaption=function(){void 0!=this.options.valueCaption?this.sliderCaption.setFromString(this.options.valueCaption(this.getValues())):void 0!=this.options.percentCaption?this.sliderCaption.setFromString(this.options.percentCaption(this.getPercentPosition())):void 0!=this.options.displayAsPercent&&void 0!=this.options.displayAsPercent.separator&&this.options.displayAsPercent.enable?this.sliderCaption.setAsPercent():this.sliderCaption.setAsValue()},e.prototype.buildSteps=function(){if(this.options.getSteps)this.steps=this.options.getSteps(this.options.start,this.options.end);else{var e=(this.options.end-this.options.start)/Math.max(1,this.options.steps);if(e>0)for(var t=this.options.start;t<=this.options.end;)this.steps.push(t),t+=e;else this.steps.push(this.options.start),this.steps.push(this.options.end)}},e}();e.Slider=t;var i=function(){function t(e){this.slider=e}return t.prototype.build=function(){return this.backGround=e.$("<div class='coveo-slider-line coveo-background'></div>"),this.activePart=e.$("<div class='coveo-slider-line coveo-active'></div>"),this.backGround.add(this.activePart)},t.prototype.setActiveWidth=function(e,t){if(this.slider.options.rangeSlider){var i=100*(t.getPercent()-e.getPercent());this.activePart.css({width:i+"%",left:100*e.getPercent()+"%",right:100*t.getPercent()+"%"})}else{var i=100*e.getPercent();this.activePart.css({width:i+"%"})}},t}(),n=function(){function t(t,i){this.slider=t,this.which=i,this.eventMouseDown=e.DeviceUtils.isMobileDevice()?"touchstart":"mousedown",this.eventMouseMove=e.DeviceUtils.isMobileDevice()?"touchmove":"mousemove",this.eventMouseUp=e.DeviceUtils.isMobileDevice()?"touchend":"mouseup"}return t.prototype.build=function(){return this.element=e.$("<div class='coveo-slider-button'></div>"),this.bindEvents(),this.element.get(0).CoveoSliderButton=this,this.element},t.prototype.toBeginning=function(){this.element.css({left:"0%"})},t.prototype.toEnd=function(){this.slider.element.width();this.element.css({left:"100%"})},t.prototype.setValue=function(e){var t=this.fromValueToPercent(e);this.element.css("left",Math.round(100*t)+"%")},t.prototype.getPosition=function(){var e=this.element.css("left");return-1!=e.indexOf("%")?parseFloat(e)/100*this.slider.element.width():parseFloat(e)},t.prototype.getPercent=function(e){return void 0===e&&(e=this.getPosition()),0==this.slider.element.width()?0:+(e/this.slider.element.width()).toFixed(2)},t.prototype.getValue=function(){var e=this.getPercent()*(this.slider.options.end-this.slider.options.start)+this.slider.options.start;return e},t.prototype.fromValueToPercent=function(e){return 1-(this.slider.options.end-e)/(this.slider.options.end-this.slider.options.start)},t.prototype.fromPositionToValue=function(e){var t=this.getPercent(e);return this.slider.options.start+t*(this.slider.options.end-this.slider.options.start)},t.prototype.fromValueToPosition=function(e){var t=this.fromValueToPercent(e);return this.slider.element.width()*t},t.prototype.bindEvents=function(){var t=this;e.$(this.element).on(this.eventMouseDown,function(e){t.handleStartSlide(e)});var i=this.slider.options.document||document;e.$(i).on(this.eventMouseMove,function(e){"touchmove"==t.eventMouseMove&&t.isMouseDown&&e.preventDefault(),t.handleMoving(e)}),e.$(i).on(this.eventMouseUp,function(e){t.handleEndSlide(e)})},t.prototype.handleStartSlide=function(t){var i=this.getMousePosition(t);this.isMouseDown=!0,this.startPositionX=i.x,this.lastElementLeft=this.element.css("left"),this.origUserSelect=e.$("body").css("user-select"),this.origCursor=e.$("body").css("cursor"),e.$("body").css("user-select","none"),e.$("body").css("cursor","pointer"),e.$(this.element).addClass("coveo-active"),e.$(this.element).trigger(e.SliderEvents.startSlide,{button:this,slider:this.slider})},t.prototype.handleMoving=function(t){this.isMouseDown&&(this.updatePosition(t),this.slider.onMoving(),this.handleButtonNearEnd(),this.element.trigger(e.SliderEvents.duringSlide,{button:this,slider:this.slider}))},t.prototype.handleEndSlide=function(){this.isMouseDown&&(e.$("body").css("user-select",this.origUserSelect),e.$("body").css("cursor",this.origCursor),e.$(this.element).removeClass("coveo-active"),this.element.trigger(e.SliderEvents.endSlide,{button:this,slider:this.slider})),this.isMouseDown=!1},t.prototype.handleButtonNearEnd=function(){0==this.which&&(void 0==this.origZIndex&&(this.origZIndex=this.element.css("z-index")),this.currentPos>90?this.element.css("z-index",this.origZIndex+1):this.element.css("z-index",this.origZIndex))},t.prototype.getMousePosition=function(e){var t=0,i=0;return"touchmove"==this.eventMouseMove?(t=e.originalEvent.touches[0].pageX,i=e.originalEvent.touches[0].pageY):e.pageX||e.pageY?(t=e.pageX,i=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:i}},t.prototype.updatePosition=function(e){var t=this.getMousePosition(e),i=t.x-this.startPositionX;if(this.currentPos=parseInt(this.lastElementLeft,10)+i,this.slider.options.steps||this.slider.options.getSteps){var n=this.snapToStep(i);
this.currentPos=n.position;var o=n.value}this.currentPos=Math.max(this.leftBoundary,this.currentPos),this.currentPos=Math.min(this.rightBoundary,this.currentPos),this.currentPos=100*this.getPercent(this.currentPos),this.currentPos=Math.min(this.currentPos,100),this.currentPos=Math.max(this.currentPos,0),this.element.css("left",Math.round(this.currentPos)+"%"),this.slider.currentValues[this.which]=this.slider.options.steps||this.slider.options.getSteps?o:this.getValue()},t.prototype.snapToStep=function(){var t=this,i=e._.map(this.slider.steps,function(e,i){return Math.abs(t.currentPos-t.fromValueToPosition(t.slider.steps[i]))}),n=e._.map(this.slider.steps,function(e,i){return Math.abs(t.rightBoundary-t.fromValueToPosition(t.slider.steps[i]))}),o=e._.map(this.slider.steps,function(e,i){return Math.abs(t.leftBoundary-t.fromValueToPosition(t.slider.steps[i]))}),s=e._.min(i),r=e._.min(n),a=e._.min(o),l=this.slider.steps[e._.indexOf(i,s)],u=this.slider.steps[e._.indexOf(n,r)],c=this.slider.steps[e._.indexOf(o,a)];return l=Math.min(l,u),l=Math.max(l,c),{position:this.fromValueToPosition(l),value:l}},t}();e.SliderButton=n;var o=function(){function e(e){this.slider=e,this.firstButton=new n(e,0),this.secondButton=new n(e,1)}return e.prototype.build=function(){var e=this.firstButton.build(),t=this.secondButton.build().addClass("coveo-range-button");return e.add(t)},e.prototype.initializeSliderRangeState=function(e){void 0==e?(this.firstButton.toBeginning(),this.secondButton.toEnd()):(this.firstButton.setValue(e[0]),this.secondButton.setValue(e[1])),this.setBoundary()},e.prototype.setValue=function(e){this.firstButton.setValue(e[0]),this.secondButton.setValue(e[1])},e.prototype.setBoundary=function(){this.firstButton.leftBoundary=0,this.firstButton.rightBoundary=this.secondButton.getPosition(),this.secondButton.leftBoundary=this.firstButton.getPosition(),this.secondButton.rightBoundary=this.slider.element.width()},e.prototype.getPosition=function(){return[this.firstButton.getPosition(),this.secondButton.getPosition()]},e.prototype.getPercentPosition=function(){return[this.firstButton.getPercent(),this.secondButton.getPercent()]},e.prototype.getValue=function(){return[this.firstButton.getValue(),this.secondButton.getValue()]},e}(),s=function(){function t(e){this.slider=e,this.separator="-",this.unitSign="",this.slider.options.displayAsPercent&&this.slider.options.displayAsPercent.enable?this.separator=void 0!=this.slider.options.displayAsPercent.separator?this.slider.options.displayAsPercent.separator:this.separator:this.slider.options.displayAsValue&&this.slider.options.displayAsValue.enable&&(this.separator=void 0!=this.slider.options.displayAsValue.separator?this.slider.options.displayAsValue.separator:this.separator,this.unitSign=void 0!=this.slider.options.displayAsValue.unitSign?this.slider.options.displayAsValue.unitSign:this.unitSign)}return t.prototype.build=function(){return this.caption=e.$("<div class='coveo-slider-caption'></div>"),this.caption},t.prototype.getCaption=function(){return this.caption.text()},t.prototype.getCaptionFromValues=function(e){return this.getValueCaption(e)},t.prototype.getCaptionFromValuesAsPercent=function(e){return this.getValueCaption(e)},t.prototype.setAsValue=function(){this.caption.text(this.getValueCaption())},t.prototype.setAsPercent=function(){var e=this.slider.getPercentPosition();this.caption.text([(100*e[0]).toFixed(this.slider.options.rounded),"%",this.separator,(100*e[1]).toFixed(this.slider.options.rounded),"%"].join(" "))},t.prototype.setFromString=function(e){this.caption.text(e)},t.prototype.getValueCaption=function(e){void 0===e&&(e=this.slider.getValues());var t=e[0],i=e[1];if(this.slider.options.dateField){var n=new Date(t),o=new Date(i);n.setHours(0,0,0,0),o.setHours(0,0,0,0),t=Globalize.format(n,this.slider.options.dateFormat||"MMM dd, yyyy"),i=Globalize.format(o,this.slider.options.dateFormat||"MMM dd, yyyy"),this.unitSign=""}else t=t.toFixed(this.slider.options.rounded),i=i.toFixed(this.slider.options.rounded);return[t,this.unitSign,this.separator,i,this.unitSign].join(" ")},t}(),r=function(){function t(t){var i=this;this.slider=t,this.svg=d3.select(t.element.get(0)).append("svg").append("g"),this.x=d3.scale.ordinal(),this.y=d3.scale.linear(),this.slider.options.graph.margin=e.Utils.extendDeep({top:20,right:0,left:0,bottom:20},this.slider.options.graph.margin||{}),this.slider.options.graph.animationDuration=this.slider.options.graph.animationDuration||500,e.$(window).resize(function(){i.draw()}),this.tooltip=e.$("<div></div>").css({display:"none"}).addClass("coveo-slider-tooltip"),this.slider.element.append(this.tooltip),this.slider.options.graph.steps=this.slider.options.graph.steps||10}return t.prototype.draw=function(e){if(void 0===e&&(e=this.oldData),e){var t=this.slider.element.outerWidth(),i=this.slider.element.outerHeight(),n=t-this.slider.options.graph.margin.left-this.slider.options.graph.margin.right,o=i-this.slider.options.graph.margin.top-this.slider.options.graph.margin.bottom;this.applyTransformOnSvg(n,o),this.setXAndYRange(n,o),this.setXAndYDomain(e);var s=this.svg.selectAll(".coveo-bar").data(e),r=this.slider.getValues();this.renderGraphBars(s,n,o,r),this.setGraphBarsTransition(s,o,r),this.oldData=e}},t.prototype.setXAndYRange=function(e,t){this.x.rangeBands([0,e],.2,0),this.y.range([t-this.slider.options.graph.margin.top,0])},t.prototype.setXAndYDomain=function(t){this.padGraphWithEmptyData(t),this.x.domain(e._.map(t,function(e){return e.start})),this.y.domain([0,d3.max(t,function(e){return e.y})])},t.prototype.padGraphWithEmptyData=function(e){var t=e[0].end-e[0].start;0!=t&&(this.padBeginningOfGraphWithEmptyData(e,t),this.padEndOfGraphWithEmptyData(e,t))},t.prototype.padBeginningOfGraphWithEmptyData=function(e,t){if(e[0].start>this.slider.options.start)for(var i=e[0].start-this.slider.options.start,n=Math.round(i/t),o=e[0].start,s=n;s>0;s--)e.unshift({start:o-t,end:o,y:0}),o-=t},t.prototype.padEndOfGraphWithEmptyData=function(e,t){var i=e.length-1;if(e[i].end<this.slider.options.end)for(var n=this.slider.options.end-e[i].end,o=Math.round(n/t),s=e[i].end,r=0;o>r;r++)e.push({start:s,end:s+t,y:0}),s+=t},t.prototype.applyTransformOnSvg=function(t,i){e.$(this.slider.element).find("svg").attr("width",t).attr("height",i),this.svg.attr("transform","translate("+this.slider.options.graph.margin.left+","+this.slider.options.graph.margin.top+")")},t.prototype.renderGraphBars=function(e,t,i,n){e.enter().append("rect").attr("class",this.getFunctionForClass(n)).attr("width",this.x.rangeBand()).attr("height",this.getFunctionForHeight(i)).attr("x",this.getFunctionForX()).attr("y",this.getFunctionForY()).on("click",this.getFunctionForClick()).on("mouseover",this.getFunctionForMouseOver(i)).on("mouseout",this.getFunctionForMouseOut())},t.prototype.setGraphBarsTransition=function(e,t,i){e.transition().attr("x",this.getFunctionForX()).attr("width",this.x.rangeBand()).attr("class",this.getFunctionForClass(i)).transition().duration(this.slider.options.graph.animationDuration).attr("y",this.getFunctionForY()).attr("height",this.getFunctionForHeight(t))},t.prototype.getBarClass=function(e,t,i){return t.start>=e[0]&&t.end<=e[1]?"coveo-active":e[0]==this.slider.options.start&&0==i?"coveo-active":e[1]==this.slider.options.end&&i==this.slider.options.graph.steps-1?"coveo-active":""},t.prototype.setTooltip=function(e,t){this.tooltip.html("<span class='coveo-caption'>"+this.slider.getCaptionFromValue([e.start,e.end])+"</span><span class='coveo-count'>"+e.y+"</span>"),this.tooltip.css({display:"block",left:this.x(e.start)-.2*this.slider.options.graph.steps,top:this.y(e.y)-t})},t.prototype.getFunctionForX=function(){var e=this;return function(t){return e.x(t.start)}},t.prototype.getFunctionForY=function(){var e=this;return function(t){return e.y(t.y)}},t.prototype.getFunctionForHeight=function(e){var t=this;return function(i){return e-t.y(i.y)}},t.prototype.getFunctionForClass=function(e){var t=this;return function(i,n){return"coveo-bar "+t.getBarClass(e,i,n)}},t.prototype.getFunctionForClick=function(){var t=this;return function(i){t.slider.element.trigger(e.SliderEvents.graphValueSelected,{start:i.start,end:i.end,value:i.y})}},t.prototype.getFunctionForMouseOver=function(e){var t=this;return function(i){d3.event.clientX,d3.event.clientY;t.setTooltip(i,e)}},t.prototype.getFunctionForMouseOut=function(){var e=this;return function(){e.tooltip.css("display","none")}},t}()}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){var i=this;this.facet=t,this.facet.bind.onRoot(e.QueryEvents.querySuccess,function(e,t){return i.handleQuerySuccess(e,t)})}return t.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0},t.prototype.putGroupByIntoQueryBuilder=function(e){this.facet.options.graph&&this.putGroupByForGraphIntoQueryBuilder(e),this.putGroupByForSliderIntoQueryBuilder(e)},t.prototype.createBasicGroupByRequest=function(e,t){void 0===t&&(t=!0);var i={field:this.facet.options.field,completeFacetWithStandardValues:!0};return i.allowedValues=void 0,i=this.facet.options.graph?this.buildGroupByQueryForSlider(i):this.buildGroupByQueryForAutomaticRanges(i)},t.prototype.computeOurFilterExpression=function(t){void 0===t&&(t=[this.facet.startOfSlider,this.facet.endOfSlider]);var i=new e.ExpressionBuilder;return void 0!=t[0]&&void 0!=t[1]&&(this.facet.options.excludeOuterBounds?this.addFilterExpressionWithOuterBoundsExcluded(t[0],t[1],i):this.addFilterExpressionWithOuterBoundsIncluded(t[0],t[1],i)),i.build()},t.prototype.handleQuerySuccess=function(t,i){var n=this;if(this.facet.options&&this.facet.options.graph&&void 0==this.rangeValuesForGraphToUse){this.rangeValuesForGraphToUse=[];var o=i.results.groupByResults[this.graphGroupByQueriesIndex].values;e._.each(o,function(e){var t=e.value.split("..");n.rangeValuesForGraphToUse.push({start:n.facet.options.dateField?n.getISOFormat(t[0].replace("@"," ")):parseInt(t[0],10),end:n.facet.options.dateField?n.getISOFormat(t[1].replace("@"," ")):parseInt(t[1],10)})})}},t.prototype.addFilterExpressionWithOuterBoundsIncluded=function(e,t,i){(e!=this.facet.options.start||t!=this.facet.options.end)&&(this.facet.options.dateField&&(e=this.getFilterDateFormat(e),t=this.getFilterDateFormat(t)),i.addFieldExpression(this.facet.options.field,"==",[e+".."+t]))},t.prototype.addFilterExpressionWithOuterBoundsExcluded=function(e,t,i){var n=this.facet.options.start,o=this.facet.options.end,s=e,r=t;this.facet.options.dateField?(s=this.getFilterDateFormat(e),r=this.getFilterDateFormat(t),n=this.getFilterDateFormat(n),o=this.getFilterDateFormat(o)):(s+="",r+="",n+="",o+=""),s!=n&&r==o?i.addFieldExpression(this.facet.options.field,">=",[s]):s==n&&r!=o?i.addFieldExpression(this.facet.options.field,"<=",[r]):this.addFilterExpressionWithOuterBoundsIncluded(e,t,i)},t.prototype.buildGroupByQueryForSlider=function(e){if(void 0!=this.facet.options.start&&void 0!=this.facet.options.end){var t=this.facet.options.start,i=this.facet.options.end;return(this.facet.options.dateField||this.facet.options.dateField)&&(t=this.getISOFormat(t),i=this.getISOFormat(i)),e.rangeValues=[{start:t,end:i,endInclusive:!0,label:"Slider"}],e}return this.buildGroupByQueryForAutomaticRanges(e)},t.prototype.buildGroupByQueryForAutomaticRanges=function(e){return e.generateAutomaticRanges=!0,e},t.prototype.putGroupByForGraphIntoQueryBuilder=function(e){this.graphGroupByQueriesIndex=e.groupByRequests.length;var t=this.createBasicGroupByRequest();if(t.rangeValues){var i=t.rangeValues[0];t.rangeValues=this.createRangeValuesForGraph(i)}var n=this.computeOurFilterExpression(this.facet.getSliderBoundaryForQuery());if(void 0!=n){var o=e.computeCompleteExpressionPartsExcept(n);t.queryOverride=o.withoutConstant,t.constantQueryOverride=o.constant,void 0==t.queryOverride?t.queryOverride=this.facet.options.queryOverride||"@sysuri":t.queryOverride+=this.facet.options.queryOverride?" "+this.facet.options.queryOverride:""}else if(null!=this.facet.options.queryOverride){var s=e.computeCompleteExpression();t.queryOverride=(null!=s?s+" ":"")+this.facet.options.queryOverride}t.sortCriteria="nosort",t.maximumNumberOfValues=this.facet.options.graph.steps,e.groupByRequests.push(t)},t.prototype.putGroupByForSliderIntoQueryBuilder=function(e){this.lastGroupByRequestIndex=e.groupByRequests.length;var t=this.createBasicGroupByRequest();t.maximumNumberOfValues=null!=this.facet.options.graph?this.facet.options.graph.steps||1:1,t.queryOverride=this.facet.options.queryOverride||"@sysuri",t.sortCriteria="nosort",t.generateAutomaticRanges=!0,t.rangeValues=void 0,e.groupByRequests.push(t)},t.prototype.createRangeValuesForGraph=function(e){return void 0==this.facet.options.graph.steps&&(this.facet.options.graph.steps=10),this.facet.options.dateField&&isNaN(this.facet.options.start)&&(this.facet.options.start=new Date(this.facet.options.start).getTime()),this.facet.options.dateField&&isNaN(this.facet.options.end)&&(this.facet.options.end=new Date(this.facet.options.end).getTime()),void 0!=this.rangeValuesForGraphToUse?this.usePrebuiltRange(e):this.buildRange(e)},t.prototype.usePrebuiltRange=function(t){return e._.map(this.rangeValuesForGraphToUse,function(e){return{start:e.start,end:e.end,endInclusive:t.endInclusive,label:t.label}})},t.prototype.buildRange=function(t){var i=this,n=this.facet.options.start,o=(this.facet.options.end,(this.facet.options.end-this.facet.options.start)/this.facet.options.graph.steps);return e._.map(e._.range(0,this.facet.options.graph.steps,1),function(e){var s=n+e*o,r=n+(e+1)*o;return i.facet.options.dateField&&(s=i.getISOFormat(s),r=i.getISOFormat(r)),{endInclusive:t.endInclusive,label:t.label,start:s,end:r}})},t.prototype.getISOFormat=function(t){if(t){isNaN(t)||(t=Number(t));var i=new Date(t);return e.DateUtils.isValid(i)||(i=new Date(this.getBrowserCompatibleFormat(t)),e.DateUtils.isValid(i))?i.toISOString():(this.facet.logger.error("Cannot parse this date format.",t,new Date(t)),void 0)}return void 0},t.prototype.getFilterDateFormat=function(e){return e?this.getISOFormat(e).replace("T","@").replace(".000Z","").replace(/-/g,"/"):void 0},t.prototype.getBrowserCompatibleFormat=function(e){return e.replace("@","T").replace(/\//g,"-")},t}();e.FacetSliderQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.startSlide="startSlide",e.duringSlide="duringSlide",e.endSlide="endSlide",e.graphValueSelected="graphValueSelected",e}();e.SliderEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}e.supportSVG=t}(t=e.FeatureDetectionUtils||(e.FeatureDetectionUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.isEmpty=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null==this.options.excludeOuterBounds&&(this.options.excludeOuterBounds=!1),this.options.start&&(this.options.start=this.options.dateField?new Date(this.options.start.replace(/-/g,"/")).getTime():Number(this.options.start)),this.options.end&&(this.options.end=this.options.dateField?new Date(this.options.end.replace(/-/g,"/")).getTime():Number(this.options.end)),this.hasAGraph()&&(e.FeatureDetectionUtils.supportSVG()||(this.options.graph=void 0,this.logger.info("Your browser does not support SVG. Cannot add graphic to your facet range",this)),"undefined"==typeof d3&&(this.options.graph=void 0,this.logger.info("Cannot find the required dependencies d3.js. Cannot add graphic to your facet range",this))),this.facetQueryController=new e.FacetSliderQueryController(this),this.initQueryStateEvents(),this.bind.onRoot(e.QueryEvents.newQuery,function(){return r.handleNewQuery()}),this.bind.onRoot(e.QueryEvents.noResults,function(){return r.handleNoresults()}),this.bind.onRoot(e.QueryEvents.deferredQuerySuccess,function(e,t){return r.handleDeferredQuerySuccess(e,t)}),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.onRoot(e.QueryEvents.doneBuildingQuery,function(e,t){return r.handleDoneBuildingQuery(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,function(e,t){return r.handlePopulateBreadcrumb(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,function(){return r.reset()})}return __extends(i,t),i.prototype.createDom=function(){var t=this;this.facetHeader=new e.FacetHeader({field:this.options.field,facetElement:e.$(this.element),title:this.options.title,enableClearElement:!0,enableCollapseElement:!0,onEraserClick:function(){t.reset(),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title}),t.queryController.executeQuery()}}),this.facetHeader.build().appendTo(this.element)},i.prototype.reset=function(){this.slider.initializeState(),this.updateQueryState(),this.updateAppearanceDependingOnState()},i.prototype.getSelectedValues=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider?[this.startOfSlider.toString(),this.endOfSlider.toString()]:["undefined","undefined"]},i.prototype.getSliderBoundaryForQuery=function(){var e=!1;return this.slider?this.slider&&this.sliderIsActive()&&(e=!0):e=!0,e?this.generateBoundary():void 0},i.prototype.handleNoresults=function(){this.isEmpty=!0,this.updateAppearanceDependingOnState()},i.prototype.handleNewQuery=function(){this.isEmpty=!1},i.prototype.handleRangeQueryStateChanged=function(e,t){this.setupSliderIfNeeded(t),this.startOfSlider=void 0==t.value[0]?this.startOfSlider:t.value[0],this.endOfSlider=void 0==t.value[1]?this.endOfSlider:t.value[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},i.prototype.handlePopulateBreadcrumb=function(t,i){var n=this,o=function(){n.sliderIsActive()&&i.breadcrumbs.push({element:n.buildBreadcrumbFacetSlider().get(0)})};this.slider?o():e.$(this.root).one(e.QueryEvents.deferredQuerySuccess,function(){o(),e.$(n.root).trigger(e.BreadcrumbEvents.redrawBreadcrumb)})},i.prototype.sliderIsActive=function(){return!(isNaN(this.startOfSlider)||isNaN(this.endOfSlider)||isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)||this.startOfSlider==this.initialStartOfSlider&&this.endOfSlider==this.initialEndOfSlider)},i.prototype.buildBreadcrumbFacetSlider=function(){var t=this,i=e.$("<div/>").addClass("coveo-facet-slider-breadcrumb");e.$("<span/>").addClass("coveo-facet-slider-breadcrumb-title").text(this.options.title+":").appendTo(i);{var n=e.$("<span/>").addClass("coveo-facet-slider-breadcrumb-values").appendTo(i),o=e.$("<span class='coveo-facet-slider-breadcrumb-value'>"+this.slider.getCaption()+"</span>").appendTo(n);e.$("<span class='coveo-facet-slider-breadcrumb-clear'></span>").appendTo(o)}return o.click(function(){t.reset(),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title}),t.queryController.executeQuery()}),i},i.prototype.initSlider=function(){this.buildSlider(),this.slider.initializeState([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},i.prototype.initQueryStateEvents=function(){var t=this;this.rangeQueryStateAttribute=e.QueryStateModel.getFacetId(this.options.id)+":range",this.queryStateModel.registerNewAttribute(this.rangeQueryStateAttribute,[void 0,void 0]);var i=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+this.rangeQueryStateAttribute);this.bind.onRoot(i,function(e,i){t.slider?t.handleRangeQueryStateChanged(e,i):t.setRangeStateSliderStillNotCreated(e,i)})},i.prototype.setRangeStateSliderStillNotCreated=function(e,t){this.rangeFromUrlState=this.copyValues(t.value)},i.prototype.buildSlider=function(){var t=this,i=e.$("<div class='coveo-facet-values coveo-slider-container'></div>");this.hasAGraph()&&i.addClass("coveo-with-graph");var n=e.$("<div></div>");this.slider=new e.Slider(n,e.$.extend({},this.options,{dateField:this.options.dateField})),n.on(e.SliderEvents.endSlide,function(e,i){t.handleEndSlide(e,i)}),n.on(e.SliderEvents.duringSlide,function(e,i){t.handleDuringSlide(e,i)}),this.hasAGraph()&&n.on(e.SliderEvents.graphValueSelected,function(e,i){t.handleGraphValueSelected(e,i)}),i.append(n),e.$(this.element).append(i),this.updateAppearanceDependingOnState()},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),e.Assert.exists(i.queryBuilder);var n=this.getSliderBoundaryForQuery();if(void 0!=n){this.facetQueryController.prepareForNewQuery();var o=this.facetQueryController.computeOurFilterExpression(n);e.Utils.isNonEmptyString(o)&&(this.logger.trace("Putting filter in query",o),i.queryBuilder.advancedExpression.add(o))}},i.prototype.handleDoneBuildingQuery=function(e,t){var i=t.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(i)},i.prototype.handleDeferredQuerySuccess=function(e,t){this.ensureDom(),this.setupSliderIfNeeded(t);var i=t.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];(void 0==i||void 0==i.values[0])&&(this.isEmpty=!0),this.hasAGraph()&&this.renderToSliderGraph(t),this.updateAppearanceDependingOnState()},i.prototype.handleEndSlide=function(t,i){var n=i.slider.getValues();this.startOfSlider=n[0],this.endOfSlider=n[1],this.updateQueryState(n)&&(this.updateAppearanceDependingOnState(),this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetRangeSlider,{facetId:this.options.id,facetRangeStart:this.startOfSlider.toString(),facetRangeEnd:this.endOfSlider.toString()}),this.queryController.executeQuery())},i.prototype.handleDuringSlide=function(e,t){var i=t.slider.getValues();this.startOfSlider=i[0],this.endOfSlider=i[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},i.prototype.handleGraphValueSelected=function(t,i){(this.options.rangeSlider&&this.startOfSlider!=i.start||this.endOfSlider!=i.end)&&(this.options.rangeSlider&&(this.startOfSlider=i.start),this.endOfSlider=i.end,this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateQueryState(),this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetRangeGraph,{facetId:this.options.id,facetRangeStart:this.startOfSlider.toString(),facetRangeEnd:this.endOfSlider.toString()}),this.queryController.executeQuery())},i.prototype.updateQueryState=function(e,t){void 0===e&&(e=this.slider.getValues()),void 0===t&&(t=!1);var i=this.copyValues(e),n=e[0]+0,o=e[1]+0,s=this.queryStateModel.get(this.rangeQueryStateAttribute);return null==s||i[0]!=s[0]||i[1]!=s[1]?(i[0]=n,i[1]=o,this.queryStateModel.set(this.rangeQueryStateAttribute,i,{silent:t}),!0):!1},i.prototype.copyValues=function(e){var t=[];return t[0]=Number(e[0])+0,t[1]=Number(e[1])+0,t},i.prototype.renderToSliderGraph=function(t){var i,n=this,o=t.results.groupByResults[this.facetQueryController.graphGroupByQueriesIndex],s=0;o&&(i=e._.map(o.values,function(e){s+=e.numberOfResults;var t=e.value.split("..")[0],i=e.value.split("..")[1];n.options.dateField?(t=new Date(t.split("@")[0]).getTime(),i=new Date(i.split("@")[0]).getTime()):(t=Number(t),i=Number(i));var o=e.numberOfResults;return{start:t,y:o,end:i,isDate:n.options.dateField}})),0==s?(this.isEmpty=!0,this.updateAppearanceDependingOnState()):void 0!=i&&this.slider.drawGraph(i)},i.prototype.generateBoundary=function(){if(this.slider){var e=this.generateBoundaryFromSlider();return void 0==e[0]&&void 0==e[1]?this.generateBoundaryFromState():e}return this.generateBoundaryFromState()},i.prototype.generateBoundaryFromSlider=function(){var e,t;return void 0!=this.startOfSlider&&(e=this.startOfSlider),void 0!=this.endOfSlider&&(t=this.endOfSlider),[e,t]},i.prototype.generateBoundaryFromState=function(){var e,t,i=this.queryStateModel.get(this.rangeQueryStateAttribute)[0];void 0!=i&&(e=i);var n=this.queryStateModel.get(this.rangeQueryStateAttribute)[1];return void 0!=n&&(t=n),e!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[0]||t!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[1]?[e,t]:[void 0,void 0]},i.prototype.setupSliderIfNeeded=function(t){if(this.ensureDom(),e.Utils.isNullOrUndefined(this.slider)){this.alreadySetBoundary()||this.trySetSliderBoundaryFromOptions(),this.alreadySetBoundary()||void 0==t||this.trySetSliderBoundaryFromQueryResult(t),this.trySetSliderBoundaryFromState(),this.setupSliderStateVariables();var i=this.verifySetup();i?this.logger.warn("Unable to initialize slider with current values",this):(this.initSlider(),this.updateQueryState())}},i.prototype.verifySetup=function(){var e=0;return e+=void 0==this.initialStartOfSlider?1:0,e+=isNaN(this.initialStartOfSlider)?1:0,e+=void 0==this.initialEndOfSlider?1:0,e+=isNaN(this.initialEndOfSlider)?1:0},i.prototype.setupSliderStateVariables=function(){isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)?this.logger.warn("Cannnot initialize slider with those values : start: "+this.initialStartOfSlider+" end: "+this.initialEndOfSlider):(this.initialStartOfSlider=Number(this.initialStartOfSlider),this.initialEndOfSlider=Number(this.initialEndOfSlider),this.startOfSlider=void 0!=this.startOfSlider?Number(this.startOfSlider):this.initialStartOfSlider,this.endOfSlider=void 0!=this.endOfSlider?Number(this.endOfSlider):this.initialEndOfSlider,this.options.start=this.initialStartOfSlider,this.options.end=this.initialEndOfSlider,this.queryStateModel.setNewDefault(this.rangeQueryStateAttribute,[this.initialStartOfSlider,this.initialEndOfSlider]))},i.prototype.alreadySetBoundary=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider},i.prototype.trySetSliderBoundaryFromOptions=function(){e.Utils.isNullOrUndefined(this.options.start)||this.setupInitialSliderStateStart(this.options.start),e.Utils.isNullOrUndefined(this.options.end)||this.setupInitialSliderStateEnd(this.options.end)},i.prototype.trySetSliderBoundaryFromState=function(){var e=this.rangeFromUrlState||this.queryStateModel.get(this.rangeQueryStateAttribute);e&&void 0!=e[0]&&void 0!=e[1]&&(e[0]=Number(e[0]),e[1]=Number(e[1]),this.setupInitialSliderStateStart(e[0]),this.setupInitialSliderStateEnd(e[1]),this.startOfSlider=e[0],this.endOfSlider=e[1])},i.prototype.trySetSliderBoundaryFromQueryResult=function(e){var t=e.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];t&&t.values.length>0&&(this.setupInitialSliderStateStart(t.values[0].value.split("..")[0]),this.setupInitialSliderStateEnd(t.values[t.values.length-1].value.split("..")[1]))},i.prototype.setupInitialSliderStateStart=function(e){void 0==this.initialStartOfSlider&&(this.initialStartOfSlider=e,this.options.dateField&&isNaN(e)&&(this.initialStartOfSlider=new Date(e.replace("@"," ")).getTime()))},i.prototype.setupInitialSliderStateEnd=function(e){void 0==this.initialEndOfSlider&&(this.initialEndOfSlider=e,this.options.dateField&&isNaN(e)&&(this.initialEndOfSlider=new Date(e.replace("@"," ")).getTime()))},i.prototype.hasAGraph=function(){return void 0!=this.options.graph},i.prototype.updateAppearanceDependingOnState=function(){this.isEmpty&&!this.sliderIsActive()?e.$(this.element).addClass("coveo-disabled-empty"):(e.$(this.element).removeClass("coveo-disabled-empty"),e.$(this.facetHeader.eraserElement).fastToggle(this.sliderIsActive())),this.sliderIsActive()?e.$(this.element).removeClass("coveo-disabled"):e.$(this.element).addClass("coveo-disabled")},i.options={title:e.ComponentOptions.buildStringOption({defaultValue:e.l("NoTitle")}),dateField:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),field:e.ComponentOptions.buildFieldOption({groupByField:!0,required:!0}),id:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),dateFormat:e.ComponentOptions.buildStringOption(),queryOverride:e.ComponentOptions.buildStringOption(),start:e.ComponentOptions.buildStringOption(),end:e.ComponentOptions.buildStringOption(),excludeOuterBounds:e.ComponentOptions.buildBooleanOption(),rounded:e.ComponentOptions.buildNumberOption({min:0}),steps:e.ComponentOptions.buildNumberOption({min:2}),rangeSlider:e.ComponentOptions.buildBooleanOption(),displayAsValue:e.ComponentOptions.buildObjectOption({subOptions:{enable:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),unitSign:e.ComponentOptions.buildStringOption(),separator:e.ComponentOptions.buildStringOption({defaultValue:"-"})}}),displayAsPercent:e.ComponentOptions.buildObjectOption({subOptions:{enable:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),separator:e.ComponentOptions.buildStringOption({defaultValue:"-"})}}),graph:e.ComponentOptions.buildObjectOption({subOptions:{steps:e.ComponentOptions.buildNumberOption({min:2}),animationDuration:e.ComponentOptions.buildNumberOption({min:0}),margin:e.ComponentOptions.buildObjectOption({subOptions:{top:e.ComponentOptions.buildNumberOption({min:0}),bottom:e.ComponentOptions.buildNumberOption({min:0}),left:e.ComponentOptions.buildNumberOption({min:0}),right:e.ComponentOptions.buildNumberOption({min:0})}})}})},i.ID="FacetSlider",i}(e.Component);e.FacetSlider=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(Coveo){function showOnlyWithHelper(e,t){return null==t&&(t={}),t.helpers=e,t}var FieldValue=function(_super){function FieldValue(e,t,i,n,o){var s=this;void 0===o&&(o=FieldValue.ID),_super.call(this,e,o,i),this.element=e,this.options=t,this.result=n,this.options=Coveo.ComponentOptions.initComponentOptions(e,FieldValue,t),this.result=this.result||this.resolveResult(),Coveo.Assert.exists(this.result),this.options.field=this.options.field||"@field";var r=this.getValue();if(null!=r){Coveo._.isArray(r)||Coveo._.isString(r)||(r=r.toString());var a;Coveo._.isString(r)&&this.options.splitValues?(a=r.split(";"),a=Coveo._.map(a,function(e){return Coveo.$.trim(e)})):a=Coveo._.isArray(r)?r:[r],Coveo._.each(a,function(e){void 0!=e&&s.renderOneValue(e).appendTo(s.element)})}else Coveo.$(this.element).detach()}return __extends(FieldValue,_super),FieldValue.prototype.getValue=function(){var e=Coveo.Utils.getFieldValue(this.result,this.options.field);return!Coveo._.isArray(e)&&Coveo._.isObject(e)&&(e=null),e},FieldValue.prototype.getHelperOptions=function(){var inlineOptions=Coveo.ComponentOptions.loadStringOption(this.element,"helperOptions",{});return Coveo.Utils.isNonEmptyString(inlineOptions)?Coveo._.extend({},this.options.helperOptions,eval("("+inlineOptions+")")):this.options.helperOptions},FieldValue.prototype.renderOneValue=function(e){var t=Coveo.$("<span></span>"),i=e;return this.options.helper&&(i=Coveo.TemplateHelpers.getHelper(this.options.helper).call(this,e,this.getHelperOptions())),this.options.htmlValue?t.html(i):t.text(i),this.bindEventOnValue(t,e),t},FieldValue.prototype.bindEventOnValue=function(e,t){var i=this,n=Coveo.QueryStateModel.getFacetId(this.options.facet),o=Coveo._.filter(this.componentStateModel.get(n),function(e){return!e.disabled}),s=o.length>0;if(s){var r=Coveo._.find(o,function(e){var i=e.values.get(t);return i&&i.selected});Coveo.$(e).on("click",function(){null!=r?Coveo._.each(o,function(e){e.deselectValue(t)}):Coveo._.each(o,function(e){e.selectValue(t)}),i.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(Coveo.AnalyticsActionCauseList.documentField,{facetId:i.options.facet,facetValue:t.toLowerCase()})}})}),r&&Coveo.$(e).addClass("coveo-selected"),Coveo.$(e).addClass("coveo-clickable")}},FieldValue.ID="FieldValue",FieldValue.options={field:Coveo.ComponentOptions.buildFieldOption({required:!0}),facet:Coveo.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),htmlValue:Coveo.ComponentOptions.buildBooleanOption({defaultValue:!1}),helper:Coveo.ComponentOptions.buildHelperOption(),helperOptions:Coveo.ComponentOptions.buildObjectOption({subOptions:{text:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["anchor"])),target:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["anchor"])),"class":Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["anchor"])),decimals:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["currency"],{min:0})),symbol:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["currency"])),useTodayYesterdayAndTomorrow:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),useWeekdayIfThisWeek:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),omitYearIfCurrentOne:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),useLongDateFormat:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!1})),includeTimeIfToday:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),includeTimeIfThisWeek:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),alwaysIncludeTime:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!1})),predefinedFormat:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"])),companyDomain:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["email"])),lengthLimit:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["email"],{min:1})),truncateName:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["email"])),alt:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["image"])),height:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["image"])),width:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["image"])),presision:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["size"],{min:0,defaultValue:2})),base:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["size"],{min:0,defaultValue:0}))}}),splitValues:Coveo.ComponentOptions.buildBooleanOption({defaultValue:!1})},FieldValue
}(Coveo.Component);Coveo.FieldValue=FieldValue,Coveo.CoveoJQuery.registerAutoCreateComponent(FieldValue)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,o=e.ComponentOptions.initComponentOptions(n,i,o),s,r,i.ID),this.options=o}return __extends(i,t),i.prototype.getColor=function(t){if(null==this.colors&&null!=this.options.colors){var n=i.parseColors(this.options.colors);this.defaultColor=n.defaultColor,this.colors=n.valueColors}var o=e._.find(e._.keys(this.colors),function(e){return t.toLowerCase()==e.toLowerCase()});return null!=o?this.colors[o]:this.defaultColor},i.parseColors=function(e){var t,i={};if(null!=e)for(var n=0;n<e.length;){var o=/^\s*(?:((?:\\(?:[:;])|[^:;])+)\s*:\s*)?(\w+|#[A-Fa-f0-9]{3}|#[A-Fa-f0-9]{6})\s*(?:;|$)/.exec(e.substr(n));null!=o?(null!=o[1]?i[o[1].replace(/\\(:|;)/g,"$1")]=o[2]:t=o[2],n+=o[0].length):n=e.length}return{defaultColor:t,valueColors:i}},i.prototype.renderOneValue=function(e){var i=t.prototype.renderOneValue.call(this,e),n=this.getColor(e);return null!=n&&i.css("background-color",n),i},i.ID="Badge",i.options={colors:e.ComponentOptions.buildStringOption()},i.parent=e.FieldValue,i}(e.FieldValue);e.Badge=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function n(o,s,r,a){t.call(this,o,i.ID,r),this.element=o,this.options=s,this.options=e.ComponentOptions.initComponentOptions(o,n,s);var l=e.$(this.element).find("tr[data-field]");l.each(function(e,t){new i(t,{},r,a)}),0==e.$(o).find("tr").length&&e.$(o).detach()}return __extends(n,t),n.ID="FieldTable",n.options={},n}(e.Component);e.FieldTable=t,e.CoveoJQuery.registerAutoCreateComponent(t);var i=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=r||this.resolveResult();var a=e.Utils.getFieldValue(this.result,this.options.field);if(null!=a){e.$(n).append('<th class ="CoveoCaption">'+this.options.caption.toLocaleString()+"</th>");var l=e.$("<td />").appendTo(n);new e.FieldValue(l[0],this.options,s,r)}else e.$(n).detach()}return __extends(i,t),i.ID="ValueRow",i.options=e._.extend({caption:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field.substr(1)}})},e.FieldValue.options),i}(e.Component)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),e.Assert.exists(this.result),i.createIcon(this.result,this.options,e.$(n))}return __extends(i,t),i.createIcon=function(t,i,n){if(void 0===i&&(i={}),void 0===n&&(n=e.$("<span />")),null==i.value){var o=e.FileTypes.get(t);n.addClass(o.icon),n.attr("title",o.caption)}else n.addClass("coveo-icon "+i.value);return n},i.ID="Icon",i.options={value:e.ComponentOptions.buildIconOption()},i}(e.Component);e.Icon=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),e.Assert.exists(this.options.maximumExpandedResults),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.preprocessResults,this.handlepreprocessResults)}return __extends(i,t),i.resultNodeToQueryResult=function(t){var n=t.result;return n.attachments=e._.map(e._.sortBy(t.children,"score"),i.resultNodeToQueryResult),n.parentResult=null!=t.parent?t.parent.result:null,n},i.findUniqueId=function(e,t){for(var n=0;n<e.length;n++){if(e[n].result.uniqueId==t)return e[n];var o=i.findUniqueId(e[n].children,t);if(null!=o)return o}return null},i.foldWithParent=function(t){var n={score:Number.NEGATIVE_INFINITY,children:[],result:{raw:!1}};e._.each(t,function(t,o){var s=i.findUniqueId(n.children,t.uniqueId);if(null==t.parentResult||t.parentResult.uniqueId==t.uniqueId)null==s&&(s={result:t,score:o,children:[]},n.children.push(s),s.parent=n);else{null!=s?(s.score=Math.min(o,s.score),s.parent.children=e._.without(s.parent.children,s)):s={result:t,score:o,children:[]};var r=i.findUniqueId(n.children,t.parentResult.uniqueId);null==r&&(r={result:t.parentResult,score:Number.POSITIVE_INFINITY,children:[]},n.children.push(r),r.parent=n),r.children.push(s),s.parent=r;for(var a=r;null!=a&&s.score<a.score;)a.score=s.score,a=a.parent}});var o=i.resultNodeToQueryResult(n);return e._.each(o.attachments,function(e){return e.parentResult=null}),o.attachments},i.defaultGetResult=function(e){var t=e.childResults||[];t.unshift(e),e.childResults=[],t=i.foldWithParent(t);var n=t.shift();return n.childResults=t,n},i.defaultGetMoreResults=function(e){return i.foldWithParent(e)},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),this.disabled||(i.queryBuilder.childField=this.options.childField,i.queryBuilder.parentField=this.options.parentField,i.queryBuilder.filterField=this.options.field,i.queryBuilder.filterFieldRange=this.options.range)},i.prototype.handlepreprocessResults=function(t,n){e.Assert.exists(n),e.Assert.check(!n.results._folded,"Two folding component are active at the same time for the same tab. Can't process result !"),n.results._folded=!0;var o=n.results,s=this.options.getResult||i.defaultGetResult;o.results=e._.map(o.results,s),this.addLoadMoreHandler(o.results,n.query)},i.prototype.addLoadMoreHandler=function(t,i){var n=this;return e._.map(t,function(t){return n.options.enableExpand&&!e.Utils.isNullOrUndefined(e.Utils.getFieldValue(t,n.options.field))&&(t.moreResults=function(){return n.moreResults(t,i)}),t})},i.prototype.moreResults=function(t,i){var n=this,o=e.$.Deferred(),s=new e.QueryBuilder;s.numberOfResults=this.options.maximumExpandedResults;var r=e.Utils.getFieldValue(t,this.options.field);e.Utils.isNonEmptyString(r)&&s.advancedExpression.addFieldExpression(this.options.field,"=",[r]),e.Utils.isNonEmptyString(i.q)&&s.expression.add("("+i.q+") OR @sysuri"),e.Utils.isNonEmptyString(this.options.expandExpression)&&s.constantExpression.add(this.options.expandExpression),null!=this.options.parentField&&(s.parentField=this.options.parentField),null!=this.options.childField&&(s.childField=this.options.childField),this.options.rearrange?this.options.rearrange.putInQueryBuilder(s):(s.sortCriteria=i.sortCriteria,s.sortField=i.sortField);var a=s.build();return this.queryController.getEndpoint().search(a).done(function(e){n.handlePreprocessMoreResults(e),o.resolve(e.results)}),o},i.prototype.handlePreprocessMoreResults=function(e){var t=this.options.getMoreResults||i.defaultGetMoreResults;e.results=t(e.results)},i.ID="Folding",i.options={field:e.ComponentOptions.buildFieldOption({required:!0}),childField:e.ComponentOptions.buildFieldOption({defaultValue:"@systopparentid"}),parentField:e.ComponentOptions.buildFieldOption({defaultValue:"@syscontainsattachment"}),range:e.ComponentOptions.buildNumberOption({defaultValue:2,min:0}),rearrange:e.ComponentOptions.buildCustomOption(function(t){return e.Utils.isNonEmptyString(t)?e.SortCriteria.parse(t):null}),directChildField:e.ComponentOptions.buildFieldOption({defaultValue:"@sysisattachment"}),directParentField:e.ComponentOptions.buildFieldOption({defaultValue:"@syscontainsattachment"}),enableExpand:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),expandExpression:e.ComponentOptions.buildStringOption(),maximumExpandedResults:e.ComponentOptions.buildNumberOption({defaultValue:100,min:1})},i}(e.Component);e.Folding=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,o),this.element=i,this.options=n,this.options.getMoreResults=function(t){return e.Folding.foldWithParent(t)[0].attachments},this.options.getResult=function(t){var i=e.Folding.defaultGetResult(t);return i.childResults=i.attachments,i.attachments=[],i}}return __extends(i,t),i.ID="FoldingForThread",i}(e.Folding);e.FoldingForThread=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,function(e,t){return r.handlePopulateBreadcrumb(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,this.clearHiddenQuery)}return __extends(i,t),i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.hq);e.Utils.isNonEmptyString(n)&&i.queryBuilder.advancedExpression.add(n)},i.prototype.handlePopulateBreadcrumb=function(t,i){var n=this,o=this.getDescription();if(!e._.isEmpty(o)&&!e._.isEmpty(this.queryStateModel.get(e.QueryStateModel.attributesEnum.hq))){var s=e.$("<div></div>").addClass("coveo-hidden-query-breadcrumb");e.$("<span/>").addClass("coveo-hidden-query-breadcrumb-title").text(this.options.title).appendTo(s),e.$("<span/>").addClass("coveo-hidden-query-breadcrumb-values").append(e.$('<span class="coveo-hidden-query-breadcrumb-value" />').text(o)).appendTo(s),e.$("<span/>").addClass("coveo-hidden-query-breadcrumb-clear").appendTo(s),s.click(function(){return n.clearHiddenQuery()}),i.breadcrumbs.push({element:s.get(0)})}},i.prototype.clearHiddenQuery=function(){var t=this,i=this.getDescription();this.queryStateModel.set(e.QueryStateModel.attributesEnum.hd,""),this.queryStateModel.set(e.QueryStateModel.attributesEnum.hq,""),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.contextRemove,{contextName:i})}})},i.prototype.getDescription=function(){var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.hd);return e._.isEmpty(t)&&(t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.hq)),e._.isEmpty(t)||t.length>this.options.maximumDescriptionLength&&(t=t.slice(0,this.options.maximumDescriptionLength)+" ..."),t},i.ID="HiddenQuery",i.options={maximumDescriptionLength:e.ComponentOptions.buildNumberOption({min:0,defaultValue:100}),title:e.ComponentOptions.buildStringOption({defaultValue:e.l("AdditionalFilters")+" : "})},i}(e.Component);e.HiddenQuery=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t){e.call(this,t),this.facet=t}return __extends(t,e),t.prototype._createBasicGroupByRequest=function(){var t=e.prototype.createBasicGroupByRequest.call(this);return t.maximumNumberOfValues=Math.max(this.facet.numberOfValues,1e4),t},t}(e.FacetQueryController);e.HierarchicalFacetQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,i,n){t.call(this,e,i,n),this.facet=e,this.facetValue=i,this.keepDisplayedValueNextTime=n}return __extends(i,t),i.prototype.build=function(){var e=t.prototype.build.call(this);return e.excludeIcon&&e.label.append(e.excludeIcon),e},i.prototype.buildXOfYCountText=function(t){var i=this,n=this.facet.facetQueryController,o=e._.find(n.lastGroupByForCountOf.values,function(t){return e.StringUtils.equalsCaseInsensitive(t.value,i.facetValue.value)});if(o){var s=Globalize.format(o.numberOfResults,"n0");return s!=t?t+" "+e.l("Of")+" "+s:t}return t},i}(e.FacetValueElement);e.HierarchicalFacetValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i){e.call(this,t,i),this.facet=t,this.facetValueElementKlass=i}return __extends(t,e),t.prototype._getValuesToBuildWith=function(){return this.hierarchyFacetValues},t}(e.FacetValuesList);e.HierarchicalFacetValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i,n),this.facet=t,this.facetValue=i,this.eventArg=n}return __extends(t,e),t.prototype._handleSelectValue=function(t){this.facet.open(this.facetValue),e.prototype._handleSelectValue.call(this,t)},t.prototype._handleExcludeClick=function(t){this.facet.open(this.facetValue),e.prototype._handleExcludeClick.call(this,t)},t}(e.OmniboxValueElement);e.OmniboxHierarchicalValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,o,e.OmniboxHierarchicalValueElement),this.facet=i,this.facetValues=n,this.omniboxObject=o}return __extends(i,t),i}(e.OmniboxValuesList);e.OmniboxHierarchicalValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i){e.call(this,t,i),this.facet=t,this.facetValue=i}return __extends(t,e),t.prototype.build=function(){var t=e.prototype.build.call(this);return t.addClass("coveo-hierarchical-facet-value"),t.find(".coveo-facet-value-caption").html(this.facetValue.value.split(this.facet.options.delimitingCharacter).join("<span class='coveo-hierarchical-breadcrumb-separator'></span>")),t},t}(e.BreadcrumbValueElement);e.HierarchicalBreadcrumbValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,e.HierarchicalBreadcrumbValueElement),this.facet=i,this.facetValues=n,this.valueHierarchy=o}return __extends(i,t),i}(e.BreadcrumbValueList);e.HierarchicalBreadcrumbValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i,n),this.facet=t,this.facetValue=i,this.keepDisplayedValueNextTime=n}return __extends(t,e),t.prototype._handleSelectValue=function(t){this.facet.open(this.facetValue),e.prototype._handleSelectValue.call(this,t)},t.prototype._handleExcludeClick=function(t){this.facet.open(this.facetValue),e.prototype._handleExcludeClick.call(this,t)},t}(e.FacetValueElement);e.HierarchicalFacetSearchValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i){t.call(this,i,e.HierarchicalFacetSearchValueElement),this.facet=i}return __extends(i,t),i}(e.FacetSearchValuesList);e.HierarchicalFacetSearchValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,o,s,i.ID),this.element=n,this.bindings=s,this.firstPlacement=!0,this.correctLevels=[],this.options=e.ComponentOptions.initComponentOptions(n,i,this.options),this.numberOfValuesToShow=this.originalNumberOfValuesToShow=this.options.numberOfValues||5,this.numberOfValues=Math.max(this.options.numberOfValues,1e4),this.options.injectionDepth=Math.max(this.options.injectionDepth,1e4),this.logger.info("Hierarchy facet : Set number of values very high in order to build hierarchy",this.numberOfValues,this),this.logger.info("Hierarchy facet : Set injection depth very high in order to build hierarchy",this.options.injectionDepth)}return __extends(i,t),i.prototype.selectValue=function(e,i){void 0===i&&(i=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists([e]);var n=this.getValueFromHierarchy(e);this.options.useAnd||this.selectChilds(n,n.childs),this.flagParentForSelection(n),t.prototype.selectValue.call(this,e)},i.prototype.selectMultipleValues=function(i,n){var o=this;void 0===n&&(n=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists(i),e._.each(i,function(t){var i=o.getValueFromHierarchy(t);o.flagParentForSelection(i),n&&e._.each(i.childs,function(e){o.selectValue(e.facetValue)})}),t.prototype.selectMultipleValues.call(this,i)},i.prototype.deselectValue=function(i,n){var o=this;void 0===n&&(n=!0),this.ensureDom(),this.ensureValueHierarchyExists([i]);var s=this.getValueFromHierarchy(i);if(n){var r=void 0!=s.childs;if(r){var a=e._.filter(s.childs,function(e){var t=o.getFacetValueFromHierarchy(e.facetValue);return t.selected||t.excluded});s.hasChildSelected=!1,a.length==s.childs.length&&this.deselectChilds(s,s.childs)}}this.deselectParent(s.parent),this.unflagParentForSelection(s),t.prototype.deselectValue.call(this,i)},i.prototype.excludeValue=function(e,i){void 0===i&&(i=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists([e]);var n=this.getValueFromHierarchy(e);i?this.excludeChilds(n.childs):(this.deselectChilds(n,n.childs),this.close(n)),this.flagParentForSelection(n),t.prototype.excludeValue.call(this,e)},i.prototype.unexcludeValue=function(e,i){void 0===i&&(i=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists([e]);var n=this.getValueFromHierarchy(e);i&&this.unexcludeChilds(n.childs),this.unflagParentForSelection(n),t.prototype.unexcludeValue.call(this,e)},i.prototype.deselectMultipleValues=function(i,n){var o=this;void 0===n&&(n=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists(i),e._.each(i,function(t){var i=o.getValueFromHierarchy(t);i.hasChildSelected=!1,o.unflagParentForSelection(i),n&&e._.each(i.childs,function(e){var t=o.getValueFromHierarchy(e.facetValue);t.hasChildSelected=!1,o.deselectValue(e.facetValue)})}),t.prototype.deselectMultipleValues.call(this,i)},i.prototype.toggleSelectValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]),0==this.getFacetValueFromHierarchy(e).selected?this.selectValue(e):this.deselectValue(e)},i.prototype.toggleExcludeValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]),0==this.getFacetValueFromHierarchy(e).excluded?this.excludeValue(e):this.unexcludeValue(e)},i.prototype.getValueCaption=function(t){var i=this.getSelf(t),n=i;return e.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(n=this.options.valueCaption[i]||n),"function"==typeof this.options.valueCaption&&(n=this.options.valueCaption.call(this,t))),n},i.prototype.getDisplayedValues=function(){return e._.first(e._.pluck(this.values.getAll(),"value"),this.numberOfValuesToShow)},i.prototype.updateSort=function(e){this.firstPlacement=!0,t.prototype.updateSort.call(this,e)},i.prototype.open=function(t){var i=t instanceof e.FacetValue?this.valueHierarchy[t.value]:t;void 0!=i&&(this.getElementFromFacetValueList(i.facetValue.value).addClass("coveo-open"),this.showChilds(i.childs),void 0!=i.parent&&this.open(this.valueHierarchy[i.facetValue.value].parent),this.valueHierarchy[i.facetValue.value].keepOpened=!0)},i.prototype.close=function(t){var i=this,n=t instanceof e.FacetValue?this.valueHierarchy[t.value]:t;void 0!=n&&(this.getElementFromFacetValueList(n.facetValue).removeClass("coveo-open"),this.hideChilds(n.childs),e._.each(n.childs,function(e){i.close(i.valueHierarchy[e.facetValue.value])}),this.valueHierarchy[n.facetValue.value].keepOpened=!1)},i.prototype.facetValueHasChanged=function(){var t=this;this.updateQueryStateModel(),e.Defer.defer(function(){t.updateAppearanceDependingOnState()})},i.prototype.reset=function(){e._.each(this.valueHierarchy,function(e){e.hasChildSelected=!1}),t.prototype.reset.call(this)},i.prototype.initFacetQueryController=function(){this.facetQueryController=new e.HierarchicalFacetQueryController(this)},i.prototype.initFacetSearch=function(){this.facetSearch=new e.FacetSearch(this,e.HierarchicalFacetSearchValuesList),e.$(this.element).append(this.facetSearch.build())},i.prototype.handleDeferredQuerySuccess=function(e,i){this.updateAppearanceDependingOnState(),t.prototype.handleDeferredQuerySuccess.call(this,e,i)},i.prototype.handlePopulateBreadcrumb=function(t,i){if(e.Assert.exists(i),this.values.hasSelectedOrExcludedValues()){var n=new e.HierarchicalBreadcrumbValuesList(this,this.values.getSelected().concat(this.values.getExcluded()),this.valueHierarchy).build();i.breadcrumbs.push({element:n.get(0)})}},i.prototype.handleOmniboxWithStaticValue=function(t){var i=this,n=t.completeQueryExpression.regex,o=(t.completeQueryExpression.word,e._.first(e._.filter(this.valueHierarchy,function(e){return n.test(i.getValueCaption(e.facetValue))}),this.options.numberOfValuesInOmnibox)),s=e._.compact(e._.map(o,function(e){var t=i.getFromFacetValueList(e.facetValue);return t?t.facetValue:void 0})),r=new e.OmniboxHierarchicalValuesList(this,s,t).build();t.rows.push({element:r?r.get(0):void 0,zIndex:this._omniboxZIndex})},i.prototype.rebuildValueElements=function(){this.numberOfValues=Math.max(this.numberOfValues,1e4),this.processHierarchy(),this.setValueListContent(),t.prototype.rebuildValueElements.call(this),this.buildParentChildRelationship(),this.crop()},i.prototype.initFacetValuesList=function(){this.facetValuesList=new e.HierarchicalFacetValuesList(this,e.HierarchicalFacetValueElement),e.$(this.element).append(this.facetValuesList.build())},i.prototype.updateMoreLess=function(){this._moreElement.toggleClass("coveo-active",this.topLevelHierarchy.length>this.numberOfValuesToShow),this.numberOfValuesToShow>this.originalNumberOfValuesToShow?this._lessElement.show():this._lessElement.hide()},i.prototype.handleClickMore=function(){this.numberOfValuesToShow+=this.originalNumberOfValuesToShow,this.numberOfValuesToShow=Math.min(this.numberOfValuesToShow,this.values.size()),this.rebuildValueElements()},i.prototype.handleClickLess=function(){this.numberOfValuesToShow=this.originalNumberOfValuesToShow,this.rebuildValueElements()},i.prototype.updateNumberOfValues=function(){this.numberOfValues=Math.max(this.numberOfValues,1e4)},i.prototype.ensureValueHierarchyExists=function(t){var i=this;t[0]&&"string"==typeof t[0]&&(t=e._.map(t,function(t){return e.FacetValue.createFromValue(t)}));var n=!1;e._.each(t,function(e){(void 0==i.valueHierarchy||void 0==i.valueHierarchy[e.value])&&(n=!0)}),n&&this.processHierarchy(t)},i.prototype.crop=function(){var t=this,i=e._.partition(this.topLevelHierarchy,function(e){return e.facetValue.selected||e.facetValue.excluded});e._.each(e._.last(i[1],i[1].length-(this.numberOfValuesToShow-i[0].length)),function(e){t.getElementFromFacetValueList(e.facetValue).hide()})},i.prototype.placeChildsUnderTheirParent=function(t,i){var n=this;e._.each(t.childs.reverse(),function(e){if(n.valueHierarchy[e.facetValue.value]){var t=n.getElementFromFacetValueList(e.facetValue);t.insertAfter(i)}}),t.keepOpened?(this.open(t),this.showChilds(t.childs)):this.hideChilds(t.childs)},i.prototype.addCssClassToParentAndChilds=function(t,i){var n=this;i.addClass("coveo-has-childs"),t.hasChildSelected&&i.addClass("coveo-has-childs-selected");var o=e.$("<div class='coveo-has-childs-toggle'></div>").click(function(){i.hasClass("coveo-open")?n.close(t):n.open(t)});i.prepend(o)},i.prototype.buildParentChildRelationship=function(){var t=this,i=e._.chain(this.valueHierarchy).toArray().sortBy("level").value();e._.each(i,function(i){var n=t.getElementFromFacetValueList(i.facetValue);e.Utils.isNonEmptyArray(i.childs)?(t.placeChildsUnderTheirParent(i,n),t.addCssClassToParentAndChilds(i,n)):n.addClass("coveo-no-childs"),n.css("margin-left",t.options.marginByLevel*(i.level-t.options.levelStart))})},i.prototype.setValueListContent=function(){var t=this;this.facetValuesList.hierarchyFacetValues=e._.map(this.correctLevels,function(e){return t.values.contains(e.facetValue.value)||(e.facetValue.occurrences=0,t.values.add(e.facetValue)),e.facetValue})},i.prototype.createHierarchy=function(t){var i=this,n=e._.map(t,function(e){var t=i.getParent(e),n=e.lookupValue||e.value;return{facetValue:e,level:i.getLevel(e),parent:t,self:n}});return this.setInHierarchy(n),e._.each(this.valueHierarchy,function(e){e.facetValue.selected&&i.flagParentForSelection(e)}),n},i.prototype.processHierarchy=function(t){var i=this;void 0===t&&(t=this.values.getAll()),this.valueHierarchy=this.valueHierarchy?this.valueHierarchy:{},e._.each(this.valueHierarchy,function(e){void 0==i.values.get(e.facetValue.value)&&delete i.valueHierarchy[i.getLookupOrValue(e.facetValue)]}),this.createHierarchy(t)},i.prototype.setInHierarchy=function(t){var i=this;this.correctLevels=e._.filter(t,function(e){var t=void 0==i.options.levelStart||e.level>=i.options.levelStart,n=void 0==i.options.levelEnd||e.level<i.options.levelEnd;return t&&n}),e._.each(this.correctLevels,function(t){var n,o=e._.map(e._.filter(i.correctLevels,function(e){return e.parent==t.self}),function(e){return{facetValue:e.facetValue,level:e.level,keepOpened:!1,hasChildSelected:!1}}),s=e._.find(i.correctLevels,function(e){return e.self==t.parent}),r=i.valueHierarchy[t.facetValue.value];s&&(n=i.valueHierarchy[s.facetValue.value]),i.valueHierarchy[t.facetValue.value]={childs:o,parent:void 0==s?void 0:{facetValue:s.facetValue,level:s.level,keepOpened:n?n.keepOpened:!1,hasChildSelected:n?n.hasChildSelected:!1,originalPosition:n?n.originalPosition:void 0},facetValue:t.facetValue,level:t.level,keepOpened:r?r.keepOpened:!1,hasChildSelected:r?r.hasChildSelected:!1,originalPosition:r?r.originalPosition:void 0}}),this.topLevelHierarchy=e._.chain(this.values.getAll()).filter(function(e){var t=i.getValueFromHierarchy(e);return t?t.level==(i.options.levelStart||0):!1}).map(function(e){return i.getValueFromHierarchy(e)}).value()},i.prototype.getParent=function(e){var t=this.getLookupOrValue(e).lastIndexOf(this.options.delimitingCharacter);return-1!=t?this.getLookupOrValue(e).substring(0,t):void 0},i.prototype.getSelf=function(e){var t=this.getParent(e);if(void 0==t)return this.getLookupOrValue(e);var i=this.getLookupOrValue(e).indexOf(t);return this.getLookupOrValue(e).substring(i+t.length+1)},i.prototype.showFacetValue=function(e){this.getElementFromFacetValueList(e.facetValue.value).removeClass("coveo-inactive")},i.prototype.hideFacetValue=function(e){this.getElementFromFacetValueList(e.facetValue.value).addClass("coveo-inactive")},i.prototype.hideChilds=function(t){var i=this;e._.each(t,function(e){i.hideFacetValue(e)})},i.prototype.showChilds=function(t){var i=this;e._.each(t,function(e){i.showFacetValue(e)})},i.prototype.hideParent=function(e){e&&this.hideFacetValue(e)},i.prototype.showParent=function(e){e&&this.showFacetValue(e)},i.prototype.selectChilds=function(t,i){this.flagParentForSelection(t),this.selectMultipleValues(e._.map(i,function(e){return e.facetValue}))},i.prototype.deselectChilds=function(t,i){t.hasChildSelected=!1,this.deselectMultipleValues(e._.map(i,function(e){return e.facetValue}))},i.prototype.excludeChilds=function(t){this.excludeMultipleValues(e._.map(t,function(e){return e.facetValue}))},i.prototype.unexcludeChilds=function(t){this.unexcludeMultipleValues(e._.map(t,function(e){return e.facetValue}))},i.prototype.selectParent=function(e){void 0!=e&&(this.selectValue(e.facetValue),e.parent&&this.selectParent(this.valueHierarchy[e.parent.facetValue.value]))},i.prototype.deselectParent=function(e){void 0!=e&&this.deselectValue(e.facetValue,!1)},i.prototype.flagParentForSelection=function(e){for(var t=e.parent;t;){var i=this.valueHierarchy[t.facetValue.value];i.hasChildSelected=!0,t=i.parent}},i.prototype.unflagParentForSelection=function(t){for(var i=this,n=t.parent;n;){var o=this.valueHierarchy[n.facetValue.value],s=e._.filter(o.childs,function(e){var n=i.valueHierarchy[e.facetValue.value];return void 0!=n?n.facetValue.value!=t.facetValue.value&&(n.facetValue.selected||n.facetValue.excluded||n.hasChildSelected):void 0});0==s.length&&(o.hasChildSelected=!1),n=o.parent}},i.prototype.getValueFromHierarchy=function(t){var i=t instanceof e.FacetValue?t.value:t;return this.valueHierarchy[i]},i.prototype.getFacetValueFromHierarchy=function(e){return this.getValueFromHierarchy(e).facetValue},i.prototype.getLookupOrValue=function(e){return e.lookupValue||e.value},i.prototype.getElementFromFacetValueList=function(t){var i=this.getFromFacetValueList(t);return i?i.listElement:e.$("</div>")},i.prototype.getFromFacetValueList=function(e){var t=this.getValueFromHierarchy(e);return void 0!=t?this.facetValuesList.get(e):void 0},i.prototype.getLevel=function(e){return e.value.split(this.options.delimitingCharacter).length-1},i.ID="HierarchicalFacet",i.options={delimitingCharacter:e.ComponentOptions.buildStringOption({defaultValue:"|"}),levelStart:e.ComponentOptions.buildNumberOption({defaultValue:0,min:0}),levelEnd:e.ComponentOptions.buildNumberOption({min:0}),marginByLevel:e.ComponentOptions.buildNumberOption({defaultValue:10,min:0})},i}(e.Facet);e.HierarchicalFacet=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.buildAttributeString=function(t){var i=[];return e._.each(t,function(e,t){void 0!=e&&i.push(t+"="+JSON.stringify(e.toString()))}),i.join(" ")},t}();e.HTMLUtils=t;var i=function(){function e(){}return e.buildAnchor=function(e,i){var n;return i&&i.text?(n=i.text,i.text=void 0):n=e,"<a href='"+e+"'"+t.buildAttributeString(i)+">"+n+"</a>"},e}();e.AnchorUtils=i;var n=function(){function i(){}return i.buildImage=function(e,i){var n="<img ";return n+=e?"src='"+e+"' ":"",n+=t.buildAttributeString(i)+"/>"},i.selectImageFromResult=function(t){return e.$("img[data-coveo-sys-uri-hash='"+t.raw.sysurihash+"']")},i.buildImageWithDirectSrcAttribute=function(e,t){var n=new Image,o=e.getViewAsDatastreamUri(t.uniqueId,"$Thumbnail$",{contentType:"image/png"});n.onload=function(){i.selectImageFromResult(t).attr("src",o)},n.src=o},i.buildImageWithBase64SrcAttribute=function(e,t){e.getRawDataStream(t.uniqueId,"$Thumbnail$").done(function(e){var n=String.fromCharCode.apply(null,new Uint8Array(e));i.selectImageFromResult(t).attr("src","data:image/png;base64, "+btoa(n))}).fail(function(){i.selectImageFromResult(t).remove()})},i.buildImageFromResult=function(t,n,o){var o=o?o:{},s=i.buildImage(void 0,e.$.extend(o,{"data-coveo-sys-uri-hash":t.raw.sysurihash}));return n.isJsonp()||e.DeviceUtils.isIE8or9()?i.buildImageWithDirectSrcAttribute(n,t):i.buildImageWithBase64SrcAttribute(n,t),s},i}();e.ImageUtils=n}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.splitSemicolonSeparatedListOfEmailAddresses=function(t){var i=t.split(/\s*;\s*/);return e._.filter(i,function(t){return e.Utils.exists(t)&&e.Utils.isNonEmptyString(e.Utils.trim(t))})},t.emailAddressesToHyperlinks=function(i,n,o,s,r){void 0===s&&(s=2),void 0===r&&(r=!1),i=e._.filter(i,function(t){return e.Utils.exists(t)&&e.Utils.isNonEmptyString(e.Utils.trim(t))});var a=e._.map(i,function(i){var s=t.parseEmail(i),a=s[1],l=s[0];if(e.Utils.exists(o)&&a==o&&(l=e.l("Me")),r){var u=l.split(" ");e.Utils.isNullOrUndefined(u[1])||(l=u[0]+" "+u[1].substring(0,1)+".")}var c=a.indexOf("@")>=0?a.indexOf("@")+1:0,p=a.substr(c);return e.Utils.exists(n)&&p!=n&&(l+=" ("+p+")"),'<a title="'+i.replace(/"/g,"&quot;")+'" href="mailto:'+encodeURI(a)+'">'+l+"</a>"}),l=a.length-s,u=l>0?t.buildEmailAddressesAndOthers(e._.last(a,l)):"";return e._.first(a,s).join(", ")+u},t.buildEmailAddressesAndOthers=function(t){return"<span class='coveo-emails-excess-collapsed coveo-active' onclick='Coveo.TemplateHelpers.getHelper(\"excessEmailToggle\")(this);'> "+e.l("AndOthers",t.length.toString(),t.length)+"</span><span class='coveo-emails-excess-expanded'> , "+t.join(" , ")+"</span>"},t.parseEmail=function(e){var e,t,i=e.match(/^\s*(.*)\s+<(.*)>$/);return null!=i?(t=i[1],/^".*"|'.*'$/.test(t)&&(t=t.substr(1,t.length-2)),e=i[2]):(t=e,e=e),[t,e]},t}();e.EmailUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.decimals=0}return __extends(t,e),t}(e.Options),i=function(){function i(){}return i.currencyToString=function(i,n){if(e.Utils.isNullOrUndefined(i))return"";i=Number(i),e.Assert.isNumber(i),n=(new t).merge(n);var o=Globalize.culture().numberFormat.currency,s=o.symbol;e.Utils.isNonEmptyString(n.symbol)&&(o.symbol=n.symbol);var r=Globalize.format(i,"c"+n.decimals.toString());return o.symbol=s,r},i}();e.CurrencyUtils=i}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i){return e._.isEmpty(i)?t:s({value:t,search:i.toLowerCase()})}var i=function(){function e(e,t,i){this.begin=e,this.size=t,this.replacementSize=i}return e}();e.Hole=i;var n=function(){function t(){}return t.replace=function(n,o,s){var r=new t;if(e.Utils.isNullOrEmptyString(n))return r;
var a=n.lastIndexOf(o);if(-1==a)return r.value=n,r;for(var l=[];a>=0;){var u=new i(a,o.length,s.length);l.push(u),n=n.slice(0,a)+s+n.slice(a+o.length),a=n.lastIndexOf(o)}return r.holes=l,r.value=n,r},t.shortenPath=function(n,o){var s=n,r=new t;if(e.Utils.isNullOrEmptyString(s)||s.length<=o)return r.value=s,r;var a=[],l=-1;if(l=e.Utils.stringStartsWith(s,"\\\\")?s.indexOf("\\",l+2):s.indexOf("\\"),-1!=l){for(var u=0,c=s.indexOf("\\",l+1);-1!=c&&s.length-u+t.SHORTEN_END.length>o;)u=c-l-1,c=s.indexOf("\\",c+1);if(u>0){s=s.slice(0,l+1)+t.SHORTEN_END+s.slice(u);var p=new i(l+1,u-t.SHORTEN_END.length,t.SHORTEN_END.length);a.push(p)}}if(s.length>o){var d=s.length-o+t.SHORTEN_END.length,h=s.length-d;s=s.slice(0,h)+t.SHORTEN_END;var p=new i(h,d,t.SHORTEN_END.length);a.push(p)}return r.holes=a,r.value=s,r},t.shortenString=function(n,o,s){void 0===o&&(o=200);var r=n;s=e.Utils.toNotNullString(s);var a=new t;if(e.Utils.isNullOrEmptyString(r)||o<=s.length)return a.value=r,a;if(r.length<=o)return a.value=r,a;var l=r;if(o-=s.length,l=l.slice(0,o)," "!=r.charAt(l.length)){var u=l.lastIndexOf(" ");-1!=u&&l.length-u<t.WORD_SHORTER&&(l=l.slice(0,u))}var c=[];return c[0]=new i(l.length,r.length-l.length,s.length),l+=s,a.value=l,a.holes=c,a},t.shortenUri=function(n,o){var s=new t;if(e.Utils.isNullOrEmptyString(n)||n.length<=o)return s.value=n,s;var r=[],a=n.indexOf("//");if(-1!=a&&(a=n.indexOf("/",a+2)),-1!=a){for(var l=0,u=n.indexOf("/",a+1);-1!=u&&n.length-l+t.SHORTEN_END.length>o;)l=u-a-1,u=n.indexOf("/",u+1);if(l>0){n=n.slice(0,a+1)+t.SHORTEN_END+n.slice(a+1+l);var c=new i(a+1,l,t.SHORTEN_END.length);r.push(c)}}if(n.length>o){var p=n.length-o+t.SHORTEN_END.length,d=n.length-p;n=n.slice(0,d)+t.SHORTEN_END;var c=new i(d,p,t.SHORTEN_END.length);r.push(c)}return s.holes=r,s.value=n,s},t.SHORTEN_END="...",t.WORD_SHORTER=10,t}();e.StringAndHoles=n;var o=function(){function t(){}return t.highlightString=function(e,i,n,o){return t.buildHighlightedString(e,i,n,o)},t.buildHighlightedString=function(t,i,n,o){if(e.Assert.isNotUndefined(i),e.Assert.isNotNull(i),e.Assert.isNonEmptyString(o),e.Utils.isNullOrEmptyString(t))return t;for(var s=0,r=t.length,a="",l=0;l<i.length;l++){var u=i[l],c=u.offset,p=c+u.length;if(null!=n){for(var d=!1,h=0;h<n.length;h++){var f=n[h],m=f.begin,v=m+f.size;if(m>c&&p>=m&&v>p)p=m;else{if(c>=m&&v>p){d=!0;break}if(c>=m&&v>c&&p>=v)c=m+f.replacementSize,p-=f.size-f.replacementSize;else if(m>c&&p>=v)p-=f.size-f.replacementSize;else if(c>=v){var g=f.size-f.replacementSize;c-=g,p-=g}}}if(d||c==p)continue}if(p>r)break;a+=e._.escape(t.slice(s,c)),a+="<span class='"+o+"'",u.dataHighlightGroup&&(a+=" data-highlight-group='"+u.dataHighlightGroup.toString()+"'"),u.dataHighlightGroupTerm&&(a+=" data-highlight-group-term='"+u.dataHighlightGroupTerm+"'"),a+=" >",a+=e._.escape(t.slice(c,p)),a+="</span>",s=p}return s!=r&&(a+=e._.escape(t.slice(s))),a},t}();e.HighlightUtils=o;var s=e._.template('<% var i = 0; var lowercaseValue = value.toLowerCase(); while(i < value.length) { %><% var index = lowercaseValue.indexOf(search, i); if(index != -1) { %><% if(i != index){ %> <span><%- value.substr(i, index) %></span><% } %><span class="coveo-hightlight"><%- value.substr(index, search.length) %></span><% i = index + search.length %></span><% } else { %><span><%- value.substr(i) %></span><% i = value.length; %><% } %><% } %>');e.highlightString=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i,o,r){var a=(new l).merge(r),u=s(t);return u.find("*").each(function(t,s){var r=e.$(s).text();e.$(s).html(e.HighlightUtils.highlightString(r,n(r,i,o,a),[],a.cssClass))}),u.html()}function i(t,i,o,s){var r=(new l).merge(s);return e.HighlightUtils.highlightString(t,n(t,i,o,r),[],r.cssClass)}function n(t,i,n,s){var l=[],u=e._.keys(i).sort(o);return e._.each(u,function(n){var u=e._.compact([n].concat(i[n]).sort(o)),c=a;c+=u.join("|")+")(?=(?:"+r+"|$)+)";var p=e.StringUtils.getHighlights(t,new RegExp(c,s.regexFlags),n);void 0!=p&&e.Utils.isNonEmptyArray(p)&&l.push(p)}),e._.each(n,function(i,n){var o=n.split(" "),u=a;e._.each(o,function(e,t){u+="(?:"+[e].concat(i[e]).join("|")+")",t==o.length-1&&(u+="(?="),u+=r,t==o.length-1&&(u+=")"),t!=o.length-1&&(u+="+")}),u+=")";var c=e.StringUtils.getHighlights(t,new RegExp(u,s.regexFlags),n);void 0!=c&&e.Utils.isNonEmptyArray(c)&&l.push(c)}),e._.chain(l).flatten().compact().uniq(function(e){return e.offset}).sortBy(function(e){return e.offset}).map(function(t){var o=e._.keys(i),s=e._.keys(n),r=o.concat(s),a=e._.indexOf(r,t.dataHighlightGroupTerm)+1;return e._.extend(t,{dataHighlightGroup:a})}).value()}function o(e,t){return e.length-t.length}function s(t){var i=e.$("<div />");return i.get(0).innerHTML=t,i}var r="[\\.\\-\\u2011\\s~=,.\\|\\/:'`â€™;_()]",a="("+r+"|^)(",l=function(e){function t(t,i,n){void 0===t&&(t="coveo-highlight"),void 0===i&&(i=0),void 0===n&&(n="gi"),e.call(this),this.cssClass=t,this.shorten=i,this.regexFlags=n}return __extends(t,e),t}(e.Options);e.highlightStreamHTML=t,e.highlightStreamText=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.buildURI=function(e,t,i){return e.replace(t,i)},e}();e.ChatterUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(){for(var e=arguments.callee.caller,t=e.arguments[0],i=0;void 0!=e&&(void 0==t||void 0==t.uri)&&100>i;)t=e.arguments[0],e=e.caller,i++;return t}e.TemplateHelpers.registerFieldHelper("javascriptEncode",function(t){return e.Utils.exists(t)?e.StringUtils.javascriptEncode(t):void 0}),e.TemplateHelpers.registerTemplateHelper("shorten",function(t,i,n,o){var s=e.StringAndHoles.shortenString(t,i,"...");return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),e.TemplateHelpers.registerTemplateHelper("shortenPath",function(t,i,n,o){var s=e.StringAndHoles.shortenPath(t,i);return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),e.TemplateHelpers.registerTemplateHelper("shortenUri",function(t,i,n,o){var s=e.StringAndHoles.shortenUri(t,i);return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),e.TemplateHelpers.registerTemplateHelper("highlight",function(t,i,n){return e.Utils.exists(t)?e.Utils.exists(i)?e.HighlightUtils.highlightString(t,i,null,n||"highlight"):t:void 0}),e.TemplateHelpers.registerTemplateHelper("highlightStreamText",function(i,n,o,s){return void 0===n&&(n=t().termsToHighlight),void 0===o&&(o=t().phrasesToHighlight),e.Utils.exists(i)?e.Utils.isNonEmptyArray(e._.keys(n))||e.Utils.isNonEmptyArray(e._.keys(o))?e.highlightStreamText(i,n,o,s):i:void 0}),e.TemplateHelpers.registerTemplateHelper("highlightStreamHTML",function(i,n,o,s){return void 0===n&&(n=t().termsToHighlight),void 0===o&&(o=t().phrasesToHighlight),e.Utils.exists(i)?e.Utils.isNonEmptyArray(n)?e.highlightStreamHTML(i,n,o,s):i:void 0}),e.TemplateHelpers.registerFieldHelper("number",function(t,i){var n=Number(t);return e.Utils.exists(t)?e._.isString(i)?e.StringUtils.htmlEncode(Globalize.format(n,i)):e.StringUtils.htmlEncode(n.toString()):void 0}),e.TemplateHelpers.registerFieldHelper("date",function(t,i){return e.DateUtils.dateToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),e.TemplateHelpers.registerFieldHelper("time",function(t,i){return e.DateUtils.timeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),e.TemplateHelpers.registerFieldHelper("dateTime",function(t,i){return e.DateUtils.dateTimeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),e.TemplateHelpers.registerFieldHelper("emailDateTime",function(t,i){var n={};n.includeTimeIfThisWeek=!0;var o=e.$.extend({},n,i);return t?e.DateUtils.dateTimeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),o):void 0}),e.TemplateHelpers.registerFieldHelper("currency",function(t,i){return e.CurrencyUtils.currencyToString(t,i)}),e.TemplateHelpers.registerFieldHelper("timeSpan",function(t,i){return void 0===i&&(i={isMilliseconds:!1}),new e.TimeSpan(t,i.isMilliseconds).getHHMMSS()}),e.TemplateHelpers.registerFieldHelper("email",function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o,s,r,a;if(e._.isObject(i[0])?(o=i[0].companyDomain,s=i[0].me,r=i[0].lengthLimit,a=i[0].truncateName):(o=i[0],s=i[1],r=i[2],a=i[3]),void 0==r&&(r=2),void 0==a&&(a=!1),e._.isString(t)){var l=e.EmailUtils.splitSemicolonSeparatedListOfEmailAddresses(t);return e.EmailUtils.emailAddressesToHyperlinks(l,o,s,r,a)}return e._.isArray(t)?e.EmailUtils.emailAddressesToHyperlinks(t,o,s,r,a):void 0}),e.TemplateHelpers.registerTemplateHelper("excessEmailToggle",function(t){return e.$(t).removeClass("coveo-active"),e.$(t).hasClass("coveo-emails-excess-collapsed")?e.$(t).siblings(".coveo-emails-excess-expanded").addClass("coveo-active"):e.$(t).hasClass("coveo-hide-expanded")&&(e.$(t).parent().addClass("coveo-inactive"),e.$(t).parent().siblings(".coveo-emails-excess-collapsed").addClass("coveo-active")),void 0}),e.TemplateHelpers.registerFieldHelper("anchor",function(t,i){return e.AnchorUtils.buildAnchor(t,i)}),e.TemplateHelpers.registerFieldHelper("image",function(t,i){return e.ImageUtils.buildImage(t,i)}),e.TemplateHelpers.registerTemplateHelper("thumbnail",function(i,n,o){return void 0===i&&(i=t()),void 0===n&&(n="default"),e.QueryUtils.hasThumbnail(i)?e.ImageUtils.buildImageFromResult(i,e.SearchEndpoint.endpoints[n],o):void 0}),e.TemplateHelpers.registerTemplateHelper("fromFileTypeToIcon",function(i,n){return void 0===i&&(i=t()),void 0===n&&(n={}),e.Icon.createIcon(i,n).get(0).outerHTML}),e.TemplateHelpers.registerTemplateHelper("attrEncode",function(e){return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),e.TemplateHelpers.registerTemplateHelper("templateFields",function(i){void 0===i&&(i=t());var n=[];return null!=i.fields&&e._.forEach(i.fields,function(t){var i=e.$(document.createElement("tr"));return e._.forEach(t,function(t,n){e._.isObject(t)?i.attr(e.ComponentOptions.attrNameFromName(n),JSON.stringify(t)):i.attr(e.ComponentOptions.attrNameFromName(n),t)}),n.push(i.get(0).outerHTML)}),n.join("")}),e.TemplateHelpers.registerTemplateHelper("loadTemplates",function(i,n){void 0===n&&(n=!0);var o,s="",r=t(),a=!1,l=i;return e._.each(i,function(e,t){"default"==e&&(o=t)}),void 0!=o&&(l=e._.omit(i,o)),e._.each(l,function(t,i){a&&n||(a=a||t,s+=e.TemplateHelpers.getHelper("loadTemplate")(i,t,r))}),a||void 0==o||(s+=e.TemplateHelpers.getHelper("loadTemplate")(o,!0,r)),s});var i=["B","KB","MB","GB","TB","PB","EB"];e.TemplateHelpers.registerFieldHelper("size",function(e,t){for(var n=Number(e),o=null!=t&&null!=t.presision?t.presision:2,s=null!=t&&null!=t.base?t.base:0;n>1024&&s+1<i.length;)n/=1024,s++;return n=Math.floor(n*Math.pow(10,o))/Math.pow(10,o),n+" "+i[s]}),e.TemplateHelpers.registerTemplateHelper("loadTemplate",function(i,n,o){return void 0===n&&(n=!0),e.Utils.isNullOrUndefined(o)&&(o=t()),n?e.TemplateCache.getTemplate(i).instantiateToString(o,!1):""}),e.TemplateHelpers.registerTemplateHelper("encodeCarriageReturn",function(t){return e.Utils.isNullOrUndefined(t)?void 0:e.StringUtils.encodeCarriageReturn(t)}),e.TemplateHelpers.registerTemplateHelper("isMobileDevice",function(){return e.DeviceUtils.isMobileDevice()?e.DeviceUtils.getDeviceName():null})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.buildMailToString=function(e){var i=e.to?"mailto:"+encodeURIComponent(e.to):"mailto:",n=t.buildMailToParametersString(e.subject,e.cc,e.bcc,e.body,i);return n&&(i+="?"+n),i},t.buildMailToParametersString=function(e,i,n,o,s){var r=[];if(e&&r.push(t.buildMailToParameter("subject",e)),i&&r.push(t.buildMailToParameter("cc",i)),n&&r.push(t.buildMailToParameter("bcc",n)),o){var a=t.getShortenBody(o,s+"?"+r.join("&"));a&&r.push(t.buildMailToParameter("body",a))}return r.join("&")},t.getShortenBody=function(i,n){var o=i;if(n.length<e.MailTo.maxLength){var s=e.MailTo.maxLength-n.length-"&body=".length;o=t.shortenString(i,s)}return o},t.buildMailToParameter=function(e,t){return t?encodeURIComponent(e)+"="+encodeURIComponent(t):""},t.shortenString=function(t,i,n){void 0===n&&(n=!1);var o=n?encodeURIComponent(e.MailTo.shortenBodyIndicator):e.MailTo.shortenBodyIndicator;i-=e.MailTo.shortenBodyIndicator.length;var s=t.length>i?!0:!1,r=t.substring(0,i);return r+=s?o:""},t.appendShortenBodyToMailToString=function(e,i){var n=t.getShortenBody(i,e);return e.indexOf("?")>=0?e+"&body="+n:e+"?body="+n},t.removeCurrentUserEmailFromString=function(t,i){return i&&t?e._.filter(i.split(";"),function(e){return-1==e.indexOf(t)}).join(";"):i},t.buildReplyMailToFromResult=function(t,i){return new e.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,to:t.raw.sysfrom,subject:t.raw.sysconversationsubject})},t.buildReplyAllMailToFromResult=function(t,i){return new e.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,to:t.raw.sysfrom+";"+t.raw.systo,subject:t.raw.sysconversationsubject,cc:t.raw.syscc})},t.buildForwardMailToFromResult=function(t,i){return new e.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,subject:t.raw.sysconversationsubject})},t.encodeMailToBody=function(t){var i=t.split("\n");return e._.each(i,function(e,t){i[t]=encodeURIComponent(i[t])}),i.join(e.MailTo.enter)},t}();e.EmailActionsUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(){t.apply(this,arguments),this.currentUserEmail="",this.originalFrom="",this.to="",this.subject="",this.cc="",this.bcc="",this.body="",this.bodyIsHTML=e.DeviceUtils.isPhonegap()}return __extends(i,t),i}(e.Options);e.DefaultMailToOptions=t;var i=function(){function i(i){this.options=i,this.bodyHeader="",this.options=(new t).merge(i),this.removeCurrentUserFromParameters(),e.DeviceUtils.isPhonegap()&&this.setRecipientsArrays(),this.options.originalFrom&&(this.bodyHeader=this.options.bodyIsHTML?"<p><br/><br/><br/>"+e.l("From")+": "+this.options.originalFrom+"<hr></p>":"\n\n\n"+e.l("From")+": "+this.options.originalFrom+"\n_________________________________\n")}return i.prototype.removeCurrentUserFromParameters=function(){this.options.to=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.to),this.options.cc=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.cc),this.options.bcc=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.bcc)},i.prototype.setRecipientsArrays=function(){this.toArray=this.options.to?this.options.to.split(";"):[],this.ccArray=this.options.cc?this.options.cc.split(";"):[],this.bccArray=this.options.bcc?this.options.bcc.split(";"):[]},i.prototype.open=function(){if(e.DeviceUtils.isPhonegap()){var t=this.options.bodyIsHTML?this.body:e.EmailActionsUtils.shortenString(this.body,i.phonegapMaxLength);window.plugin.email.open(this.getEmailOpenerObject(t))}else this.ensureValueIsSet(),window.location.href=this.value},i.prototype.getEmailOpenerObject=function(e){var t={to:this.toArray,cc:this.ccArray,bcc:this.bccArray,subject:this.options.subject,body:e,isHtml:this.options.bodyIsHTML};return t},i.prototype.ensureValueIsSet=function(){this.value?this.valueBodyIsSet()||this.setValueBody():this.setValue()},i.prototype.setValue=function(){this.value=e.EmailActionsUtils.buildMailToString(this.options),this.value&&!this.valueBodyIsSet()&&this.setValueBody()},i.prototype.setValueBody=function(){this.value=e.EmailActionsUtils.appendShortenBodyToMailToString(this.value,this.body)},i.prototype.setMailToBodyFromText=function(t){void 0===t&&(t=""),this.body=t,e.DeviceUtils.isPhonegap()||(this.body=e.EmailActionsUtils.encodeMailToBody(this.body))},i.prototype.valueBodyIsSet=function(){return this.value.indexOf("body=")>=0},i.prototype.bodyIsSet=function(){return this.body?!0:!1},i.enter="%0D%0A",i.shortenBodyIndicator="\r\n\r\n...",i.maxLength=1e3,i.phonegapMaxLength=15e3,i}();e.MailTo=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=r||this.resolveResult(),this.createAndAppendEmailActions(),this.appendWaitingAnimation()}return __extends(i,t),i.prototype.createAndAppendEmailActions=function(){this.options.reply&&(this.reply=new e.EmailAction(e.$(document.createElement("div"))[0],this,{type:e.EmailAction.reply,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.reply.element)),this.options.replyAll&&(this.replyAll=new e.EmailAction(e.$(document.createElement("div"))[0],this,{type:e.EmailAction.replyAll,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.replyAll.element)),this.options.forward&&(this.forward=new e.EmailAction(e.$(document.createElement("div"))[0],this,{type:e.EmailAction.forward,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.forward.element))},i.prototype.appendWaitingAnimation=function(){this.loadingAnimation=e.JQueryUtils.getBasicLoadingDots().hide(),e.$(this.element).append(this.loadingAnimation)},i.ID="EmailActions",i.options={currentUserEmail:e.ComponentOptions.buildStringOption({defaultValue:""}),reply:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),replyAll:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),forward:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.EmailActions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){var l=this;t.call(this,n,i.ID,r),this.element=n,this.actions=o,this.options=s,this.result=a,this.options=e.ComponentOptions.initComponentOptions(n,e.EmailActions,s),this.result=a||this.resolveResult(),this.setMailToFromResult(),e.$(this.element).click(function(){l.showWaitingAnimation(),l.mailTo.bodyIsSet()?l.openMailTo():l.appendBodyToMailTo(function(){return l.openMailTo()})})}return __extends(i,t),i.prototype.showWaitingAnimation=function(){this.actions.loadingAnimation.show()},i.prototype.hideWaitingAnimation=function(){this.actions.loadingAnimation.hide()},i.prototype.setMailToFromResult=function(){switch(this.options.type){case i.reply:this.mailTo=e.EmailActionsUtils.buildReplyMailToFromResult(this.result,this.options.currentUserEmail),e.$(this.element).append(e.l("Reply"));break;case i.replyAll:this.mailTo=e.EmailActionsUtils.buildReplyAllMailToFromResult(this.result,this.options.currentUserEmail),e.$(this.element).append(e.l("ReplyAll"));break;case i.forward:e.$(this.element).append(e.l("Forward")),this.mailTo=e.EmailActionsUtils.buildForwardMailToFromResult(this.result,this.options.currentUserEmail);break;default:this.mailTo=new e.MailTo({})}},i.prototype.appendBodyToMailTo=function(t){var i=this;if(e.DeviceUtils.isPhonegap()){var n,o=this.queryController.getEndpoint();n=e.DeviceUtils.isAndroid()?o.getDocumentText(this.result.uniqueId).done(function(e){i.doneRetrieveBody(e,t)}):o.getDocumentHtml(this.result.uniqueId).done(function(e){i.doneRetrieveBody(e.getElementsByTagName("body")[0].innerHTML,t)}),n.fail(function(){i.doneRetrieveBody("",t)})}else this.queryController.getEndpoint().getDocumentText(this.result.uniqueId).done(function(e){return i.doneRetrieveBody(e,t)}).fail(function(){return i.doneRetrieveBody("",t)})},i.prototype.doneRetrieveBody=function(e,t){var i=e.content?e.content:e;this.mailTo.setMailToBodyFromText(i),t(e)},i.prototype.openMailTo=function(){this.mailTo.open(),this.hideWaitingAnimation()},i.ID="EmailAction",i.options={type:e.ComponentOptions.buildStringOption({defaultValue:"forward"}),currentUserEmail:e.ComponentOptions.buildStringOption({defaultValue:""})},i.forward="forward",i.reply="reply",i.replyAll="replyAll",i}(e.Component);e.EmailAction=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(i,n){e.$(i).click(function(e){e.preventDefault(),n&&n.indexOf("javascript:")<0&&t.openInPhonegap(n)})}function n(e){window.open(e,"_system","location=yes")}t.bindOpenLinkInPhonegap=i,t.openInPhonegap=n}(t=e.PhonegapUtils||(e.PhonegapUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t="CoveoHighlight",i=function(i){function n(t,o,s,r){i.call(this,t,n.ID,s),this.element=t,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(t,n,o),this.result=r||this.resolveResult(),this.termsToHighlightWereModified=!1,e.Assert.exists(this.result)}return __extends(n,i),n.prototype.createDom=function(){var t=e.$('<div class="coveo-quickview-document"></div>').appendTo(e.$(this.element));this.header=this.buildHeader().appendTo(t),this.iframe=this.buildIFrame().appendTo(t)},n.prototype.open=function(){var t=this;this.ensureDom(),this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentQuickview,{},this.result,this.queryController.element);var i=(new Date).getTime(),n=this.iframe.find("iframe")[0];n.src="about:blank";var o=this.queryController.getEndpoint(),s=e._.keys(this.result.termsToHighlight),r={termsToHighlight:s};e.$(this.element).trigger(e.UserActionEvents.openQuickview,r),this.checkIfTermsToHighlightWereModified(r.termsToHighlight);var a=e.$.extend(!0,{},this.getBindings().queryController.getLastQuery());this.termsToHighlightWereModified&&this.handleTermsToHighlight(r.termsToHighlight,a);var l={queryObject:a,requestedOutputSize:this.options.maximumDocumentSize};o.getDocumentHtml(this.result.uniqueId,l).done(function(e){null!=n.contentDocument&&(t.renderHTMLDocument(n,e),t.triggerQuickviewLoaded(i))}).fail(function(e,s){null!=n.contentDocument&&(0!=s.status?(t.renderErrorReport(n),t.triggerQuickviewLoaded(i)):(n.onload=function(){t.triggerQuickviewLoaded(i)},n.src=o.getViewAsHtmlUri(t.result.uniqueId,l)))})},n.prototype.renderHTMLDocument=function(t,i){var n=this;t.onload=function(){n.computeHighlights(t.contentWindow),n.isNewQuickviewDocument(t.contentWindow)&&(e.$(n.element).parents(".coveo-body").css("padding",0),e.$(n.element).children(".coveo-quickview-header").css("padding-top",10),e.$(n.element).children(".coveo-quickview-header").css("padding-left",10)),""==e.$(n.element).children(".coveo-quickview-header").html()&&e.$(n.element).children(".coveo-quickview-header").css("display","none")},this.writeToIFrame(t,i),this.wrapPreElementsInIframe(t),e.DeviceUtils.isMobileDevice()&&this.bindOpenIframeLinksInPhonegap(t)},n.prototype.renderErrorReport=function(t){var i="<html><body style='font-family: Arimo, \"Helvetica Neue\", Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none;'>"+e.l("OopsError")+"</body></html>";this.writeToIFrame(t,i)},n.prototype.writeToIFrame=function(e,t){var i=t;"object"==typeof t&&(i=t.getElementsByTagName("html")[0].outerHTML),e.contentWindow.document.open(),e.contentWindow.document.write(i),e.contentWindow.document.close()},n.prototype.bindOpenIframeLinksInPhonegap=function(t){try{var i=e.$(t.contentWindow.document).find("a");e._.each(i,function(t){var i=t.href;t.href="javascript:",e.PhonegapUtils.bindOpenLinkInPhonegap(t,i)})}catch(n){}},n.prototype.wrapPreElementsInIframe=function(t){try{var i=document.createElement("style");i.type="text/css";var n="html pre { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; }";n+='body, html { font-family: Arimo, "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none; }',e.DeviceUtils.isIos()&&(n+="body, html { height: 1px !important; min-height: 100%; overflow: scroll; }",e.$(t).attr("scrolling","no"),n+="body, html {margin: auto}",e.$(t).parent().css("margin","0 0 5px 5px"),t.style.position="relative"),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n));var o=t.contentWindow.document.head;o.appendChild(i)}catch(s){}},n.prototype.triggerQuickviewLoaded=function(t){var i=(new Date).getTime(),n={duration:i-t};e.$(this.element).trigger(e.UserActionEvents.quickviewLoaded,n)},n.prototype.computeHighlights=function(i){var n=this;this.header.empty(),this.keywordsState=[];var o={},s=0;e.$(i.document.body).find("[id^="+t+"]").each(function(e,t){var i=n.getHighlightIdParts(t);if(i){var r=i[1],a=parseInt(i[2],10),l=parseInt(i[3],10),u=o[r];if(null==u&&1==l?o[r]=u={text:n.getHighlightInnerText(t),count:1,index:parseInt(r,10),termsCount:"coveotaggedword"==t.nodeName.toLowerCase()?0:1,element:t,occurence:a}:u&&(u.occurence==a&&("coveotaggedword"==t.nodeName.toLowerCase()?u.text+=n.getHighlightInnerText(t):u.termsCount<l&&(u.text+=n.getHighlightInnerText(t),u.termsCount+=1)),u.count=Math.max(u.count,a),s+=1),u&&u.occurence==a&&"span"==t.nodeName.toLowerCase()){var c=n.getHightlightEmbeddedWordIdParts(t),p=c?o[c[1]]:null;p&&p.occurence==parseInt(c[2],10)&&(p.text+=t.childNodes[0].nodeValue||"")}}}),0==s&&this.header.css("min-height",0);var r=[];return e._.each(o,function(e){e.text=n.resolveOriginalTermFromHighlight(e.text);var t={word:e,color:e.element.style.backgroundColor,currentIndex:0,index:e.index};n.keywordsState.push(t),n.header.append(n.buildWordButton(t,i)),r.push(e.text)}),r},n.prototype.getHighlightIdParts=function(e){var i=e.id.substr(t.length+1).match(/^([0-9]+)\.([0-9]+)\.([0-9]+)$/);return i&&i.length>3?i:null},n.prototype.getHighlightInnerText=function(e){return"coveotaggedword"==e.nodeName.toLowerCase()?e.childNodes.length>=1?e.childNodes.item(0).textContent||"":"":e.textContent||""},n.prototype.getHightlightEmbeddedWordIdParts=function(e){var t=e.getElementsByTagName("coveotaggedword")[0];return t?this.getHighlightIdParts(t):null},n.prototype.resolveOriginalTermFromHighlight=function(t){var i=this,n=t;return this.result.termsToHighlight&&(n=e._.find(e._.keys(this.result.termsToHighlight),function(n){return n.toLowerCase()==t.toLowerCase()||void 0!=e._.find(i.result.termsToHighlight[n],function(e){return e.toLowerCase()==t.toLowerCase()})})||n),n},n.prototype.buildWordButton=function(t,i){var n=this,o=e.$("<span/>").addClass("coveo-term-for-quickview");return o.append(e.$("<span/>").addClass("coveo-term-for-quickview-name").html(t.word.text).click(function(){n.navigate(t,!1,i)})),o.append(e.$("<span/>").addClass("coveo-term-for-quickview-down-arrow").append(e.$("<span/>").addClass("coveo-term-for-quickview-down-arrow-icon")).click(function(){n.navigate(t,!1,i)})),o.append(e.$("<span/>").addClass("coveo-term-for-quickview-up-arrow").append(e.$("<span/>").addClass("coveo-term-for-quickview-up-arrow-icon")).click(function(){n.navigate(t,!0,i)})),o.css("background-color",t.color),o.css("border-color",this.getSaturatedColor(t.color)),o.find(".coveo-term-for-quickview-down-arrow").css("border-color",this.getSaturatedColor(t.color)),o},n.prototype.navigate=function(i,n,o){var s,r=i.currentIndex;s=n?1>=r?i.word.count:r-1:r==i.word.count?1:r+1;var a=this.getScrollingElement(o);a.find('[id^="'+t+":"+i.word.index+"."+r+'"]').css("border","");var l=e.$(o.document.body).find('[id^="'+t+":"+i.word.index+"."+s+'."]');if(l.css("border","1px dotted #333"),i.currentIndex=s,this.isNewQuickviewDocument(o)&&l.closest(".pc").addClass("opened"),this.isNewQuickviewDocument(o)||e.DeviceUtils.isMobileDevice())return l[0].scrollIntoView(),this.iframe.closest(".coveo-body").scrollLeft(0).scrollTop(0),void 0;var u=l.offset();a.stop(!0).animate({scrollLeft:u.left-a.get(0).clientWidth/2+l.width()/2,scrollTop:u.top-a.get(0).clientHeight/2+l.height()/2}),this.iframe.stop(!0).animate({scrollLeft:u.left-this.iframe.width()/2+l.width()/2,scrollTop:u.top-this.iframe.height()/2+l.height()/2})},n.prototype.buildHeader=function(){return e.$("<div/>").addClass("coveo-quickview-header")},n.prototype.buildIFrame=function(){return e.$('<div class="coveo-iframeWrapper"><iframe/></div>')},n.prototype.getScrollingElement=function(t){var i;return this.isNewQuickviewDocument(t)&&(i=e.$(t.document.body).find("#page-container")),(void 0==i||0==i.length)&&(i=e.$(t.document.body)),i},n.prototype.isNewQuickviewDocument=function(t){return"pdf2htmlEX"==e.$(t.document.head).find("meta[name='generator']").attr("content")},n.prototype.handleTermsToHighlight=function(t,i){var n=this;for(var o in this.result.termsToHighlight)delete this.result.termsToHighlight[o];var s="";e._.each(t,function(e){s+=e+" ",n.result.termsToHighlight[e]=new Array(e)}),s=s.substring(0,s.length-1),i.q=s},n.prototype.checkIfTermsToHighlightWereModified=function(t){e.Utils.arrayEqual(t,e._.keys(this.result.termsToHighlight))||(this.termsToHighlightWereModified=!0)},n.prototype.getSaturatedColor=function(t){var i=parseInt(t.substring(4,7)),n=parseInt(t.substring(9,12)),o=parseInt(t.substring(14,17)),s=e.ColorUtils.rgbToHsv(i,n,o);s[1]*=2,s[1]>1&&(s[1]=1);var r=e.ColorUtils.hsvToRgb(s[0],s[1],s[2]);return"rgb("+r[0].toString()+", "+r[1].toString()+", "+r[2].toString()+")"},n.ID="QuickviewDocument",n.options={maximumDocumentSize:e.ComponentOptions.buildNumberOption({defaultValue:0,min:0})},n}(e.Component);e.QuickviewDocument=i,e.CoveoJQuery.registerAutoCreateComponent(i)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.instantiateToString=function(){return'<div class="coveo-quick-view-full-height"><div class="CoveoQuickviewDocument"></div></div>'},t}(e.Template);e.DefaultQuickviewTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null==this.options.contentTemplate&&(this.options.contentTemplate=new e.DefaultQuickviewTemplate),""==this.element.innerHTML&&e.$(this.element).append('<div class="coveo-icon-for-quickview">'+"Quickview".toLocaleString()+"</div>"),this.bindClick(r),this.bind.on(e.$(this.bindings.resultElement),e.ResultListEvents.openQuickview,function(){return a.open()})}return __extends(i,t),i.prototype.open=function(){if(null==this.modalbox){e.$(document.activeElement).blur();var t=this.prepareOpenQuickviewObject();this.createModalBox(t),this.bindQuickviewEvents(t),this.animateAndOpen();{this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.quickview)}this.queryStateModel.set(e.QueryStateModel.attributesEnum.quickview,this.getHashId())}},i.prototype.getHashId=function(){return this.result.queryUid+":"+this.result.index},i.prototype.close=function(){null!=this.modalbox&&(this.modalbox.close(),this.modalbox=null,e.DeviceUtils.isAndroid()&&e.DeviceUtils.isPhonegap()&&e.$(document).off("backbutton"),e.$("body").unbind("keyup.quickviewEscape"))},i.prototype.bindClick=function(t){"undefined"==typeof t.hasHtmlVersion||t.hasHtmlVersion||this.options.alwaysShow?e.$(this.element).click(e.$.proxy(this.open,this)):e.$(this.element).css("display","none")},i.prototype.bindQuickviewEvents=function(t){var i=this;e.DeviceUtils.isAndroid()&&e.DeviceUtils.isPhonegap()&&e.$(document).on("backbutton",function(){i.close()}),e.$(this.modalbox.wrapper.find(".coveo-quickview-close-button")).click(function(){i.closeQuickview()}),e.$(this.modalbox.wrapper.find(".coveo-quickview-close-button")).click(function(){return i.close()}),this.modalbox.content.on(e.UserActionEvents.quickviewLoaded,function(){e.$(t.loadingAnimation).remove(),i.bindIFrameEscape()}),this.bindEscape()},i.prototype.animateAndOpen=function(){var t=this,i=this.modalbox.wrapper.css("animation-duration");if(i){var n=/^(.+)(ms|s)$/.exec(i),o=Number(n[1])*("s"==n[2]?1e3:1);setTimeout(function(){null!=t.modalbox&&e.$(t.modalbox.modalBox.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID))).coveo("open")},o)}else e.$(this.modalbox.modalBox.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID))).coveo("open")},i.prototype.createModalBox=function(t){var i=e.$("<div/>").append(t.content);this.modalbox=e.ModalBox.open(i,{overlayClose:!0,title:e.JQueryUtils.getQuickviewHeader(this.result,{showDate:this.options.showDate,title:this.options.title},this.bindings),className:"coveo-quick-view",validation:function(){return!0
},body:this.element.ownerDocument.body}),this.setQuickviewSize()},i.prototype.prepareOpenQuickviewObject=function(){var e=this.options.loadingAnimation;return{loadingAnimation:e,content:this.prepareQuickviewContent(e)}},i.prototype.prepareQuickviewContent=function(t){var i=e.$(this.options.contentTemplate.instantiateToElement(this.result)),n=this.searchInterface.options,o={options:n,bindings:this.getBindings(),result:this.result};return e.CoveoJQuery.automaticallyCreateComponentsInside(i.get(0),o),0!=i.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID)).length&&this.options.enableLoadingAnimation&&i.prepend(t),i},i.prototype.bindEscape=function(){var t=this;e.$("body").on("keyup.quickviewEscape",function(e){27==e.keyCode&&t.closeQuickview()})},i.prototype.bindIFrameEscape=function(){var t=this,i=this.modalbox.content.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID)).find("iframe");e.$(i.contents().find("body")).on("keyup",null,this,function(e){27==e.keyCode&&t.closeQuickview()})},i.prototype.closeQuickview=function(){this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.quickview);this.queryStateModel.set(e.QueryStateModel.attributesEnum.quickview,"")},i.prototype.setQuickviewSize=function(){var e=this.modalbox.modalBox.find(".coveo-wrapper");e.css("width",this.options.size),e.css("height",this.options.size),e.css("max-width",this.options.size),e.css("max-height",this.options.size)},i.ID="Quickview",i.options={alwaysShow:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),title:e.ComponentOptions.buildStringOption(),showDate:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableLoadingAnimation:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),contentTemplate:e.ComponentOptions.buildTemplateOption({selectorAttr:"data-template-selector",idAttr:"data-template-id"}),loadingAnimation:e.ComponentOptions.buildOption(16,function(t){var i=e.$(t).attr("data-loading-animation-selector");if(null!=i){var n=e.$(i);if(0!=n.length)return n.remove().get(0)}var o=e.$(t).attr("data-loading-animation-template-id");if(null!=o){var s=e.ComponentOptions.loadResultTemplateFromId(o);if(s)return s.instantiateToElement({})}return e.JQueryUtils.getBasicLoadingAnimation().get(0)}),size:e.ComponentOptions.buildStringOption({defaultValue:e.DeviceUtils.isMobileDevice()?"100%":"95%"})},i}(e.Component);e.Quickview=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;void 0===r&&(r=i.ID),t.call(this,n,r,s),this.element=n,this.options=o,this.bindings=s,this.currentlyDisplayedResults=[],this.reachedTheEndOfResults=!1,this.resetList=!0,this.pageChanged=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),e.Assert.exists(this.options.resultContainer),e.Assert.exists(this.options.resultTemplate),e.Assert.exists(this.options.waitAnimationContainer),e.Assert.exists(this.options.infiniteScrollContainer),this.showOrHideElementsDependingOnState(!1,!1),e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this.handleNewQuery,this)),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleProcessNewQueryResults,this)),e.$(this.root).on(e.QueryEvents.duringQuery,e.$.proxy(this.handleDuringQuery,this)),e.$(this.root).on(e.QueryEvents.queryError,function(){a.hideWaitingAnimation(),e.$(a.options.resultContainer).empty(),a.currentlyDisplayedResults=[]}),this.options.enableInfiniteScroll&&e.$(this.options.infiniteScrollContainer).scroll(function(e){return a.handleScrollOfResultList(e)});var l=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.first);e.$(this.queryStateModel.element).on(l,e.$.proxy(this.handlePageChanged,this))}return __extends(i,t),i.prototype.handlePageChanged=function(){var t=this;e.$(this.root).one(e.QueryEvents.querySuccess,function(){e.$(t.options.infiniteScrollContainer).scrollTop(0)})},i.prototype.handleNewQuery=function(){this.disabled||e.$(this.element).show()},i.prototype.displayMoreResults=function(t){var i=this;return e.Assert.isLargerOrEqualsThan(1,t),e.Assert.check(this.hasPotentiallyMoreResultsToDisplay()),this.isCurrentlyFetchingMoreResults()?(this.logger.warn("Ignoring request to display more results since we're already doing so"),void 0):this.hasPotentiallyMoreResultsToDisplay()?(this.options.enableInfiniteScrollWaitingAnimation&&this.showWaitingAnimationForInfiniteScrolling(),this.fetchingMoreResults=this.queryController.fetchMore(t),this.fetchingMoreResults.done(function(n){e.Assert.exists(n),i.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.pagerScrolling,{},i.element);var o=n.results;i.reachedTheEndOfResults=t>n.results.length,i._buildResults(n),e._.each(o,function(e){i.currentlyDisplayedResults.push(e)}),e.$(i.element).trigger(e.ResultListEvents.newResultsDisplayed,{})}),this.fetchingMoreResults.always(function(){i.hideWaitingAnimationForInfiniteScrolling(),i.fetchingMoreResults=void 0,e.Defer.defer(function(){return i.handleScrollOfResultList()})}),void 0):(this.logger.warn("Ignoring request to display more results since we know there aren't more to display"),void 0)},i.prototype._triggerNewResultDisplayed=function(t,i){var n={result:t,item:i};e.$(this.element).trigger(e.ResultListEvents.newResultDisplayed,n)},i.prototype._buildResults=function(t){var i=this;e.$.each(t.results,function(t,n){var o=i._instantiateTemplateForResult(n);null!=o&&(e.$(i.options.resultContainer).append(o),i._autoCreateComponentsInsideResult(o,n),i._triggerNewResultDisplayed(n,o))})},i.prototype._instantiateTemplateForResult=function(t){e.Assert.exists(t),e.QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(),t);var i=this.options.resultTemplate.instantiateToElement(t);return null!=i&&e.Component.bindResultToElement(i,t),i},i.prototype._autoCreateComponentsInsideResult=function(t,i){e.Assert.exists(t);var n=this.searchInterface.options.originalOptionsObject,o=e._.extend({},this.getBindings(),{resultElement:t}),s={options:n,bindings:o,result:i};e.CoveoJQuery.automaticallyCreateComponentsInside(t,s)},i.prototype.handleDuringQuery=function(){this.logger.trace("Emptying the result container"),this.currentlyDisplayedResults=[],this.cancelFetchingMoreResultsIfNeeded(),this.showWaitingAnimation(),this.showOrHideElementsDependingOnState(!1,!1)},i.prototype.handleProcessNewQueryResults=function(t,i){if(e.Assert.exists(i),e.Assert.exists(i.results),e.$(this.element).fastToggle(!this.disabled),!this.disabled){var n=i.results;this.logger.trace("Received query results from new query",n),this.hideWaitingAnimation(),this.options.resultContainer.innerHTML="",this.currentlyDisplayedResults=[],this._buildResults(n),this.currentlyDisplayedResults=n.results,this.reachedTheEndOfResults=!1,this.showOrHideElementsDependingOnState(!0,0!=this.currentlyDisplayedResults.length),this.options.enableInfiniteScroll&&n.results.length==i.queryBuilder.numberOfResults&&this.handleScrollOfResultList(),e.DeviceUtils.isMobileDevice()&&void 0!=this.options.mobileScrollContainer&&(this.options.mobileScrollContainer.scrollTop=0),e.$(this.element).trigger(e.ResultListEvents.newResultsDisplayed,{})}},i.prototype.handleScrollOfResultList=function(e){this.isCurrentlyFetchingMoreResults()||this.isScrollingOfResultListAlmostAtTheBottom()&&this.hasPotentiallyMoreResultsToDisplay()&&this.displayMoreResults(this.options.infiniteScrollPageSize,null!=e)},i.prototype.isCurrentlyFetchingMoreResults=function(){return e.Utils.exists(this.fetchingMoreResults)},i.prototype.isScrollingOfResultListAlmostAtTheBottom=function(){var t;try{t=e.$(this.options.infiniteScrollContainer).get(0)instanceof Window}catch(i){t=!1}return t?this.isScrollAtBottomForWindowElement():this.isScrollAtBottomForHtmlElement()},i.prototype.isScrollAtBottomForWindowElement=function(){var t=e.$(window).height(),i=e.$(window).scrollTop(),n=e.$(document).height();return t/2>n-(t+i)},i.prototype.isScrollAtBottomForHtmlElement=function(){var t=e.$(this.options.infiniteScrollContainer).innerHeight(),i=e.$(this.options.infiniteScrollContainer).get(0).scrollHeight,n=e.$(this.options.infiniteScrollContainer).scrollTop()+t;return t/2>i-n},i.prototype.hasPotentiallyMoreResultsToDisplay=function(){return this.currentlyDisplayedResults.length>0&&!this.reachedTheEndOfResults},i.prototype.cancelFetchingMoreResultsIfNeeded=function(){this.isCurrentlyFetchingMoreResults()&&(this.logger.trace("Cancelling fetching more results"),this.fetchingMoreResults.reject(),this.fetchingMoreResults=void 0)},i.prototype.showOrHideElementsDependingOnState=function(t,i){e.$(this.element).find(".coveo-show-if-query").fastToggle(t),e.$(this.element).find(".coveo-show-if-no-query").fastToggle(!t),e.$(this.element).find(".coveo-show-if-results").fastToggle(t&&i),e.$(this.element).find(".coveo-show-if-no-results").fastToggle(t&&!i)},i.prototype.showWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":e.$(this.options.waitAnimationContainer).addClass("coveo-fade-out");break;case"spinner":e.$(this.options.resultContainer).children().hide(),0==e.$(this.options.waitAnimationContainer).find(".coveo-wait-animation").length&&e.$(this.options.waitAnimationContainer).append(e.JQueryUtils.getLoadingSpinner())}},i.prototype.hideWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":e.$(this.options.waitAnimationContainer).removeClass("coveo-fade-out");break;case"spinner":e.$(this.options.waitAnimationContainer).children(".coveo-loading-spinner").detach()}},i.prototype.showWaitingAnimationForInfiniteScrolling=function(){e.$(this.options.waitAnimationContainer).append(e.JQueryUtils.getLoadingSpinner())},i.prototype.hideWaitingAnimationForInfiniteScrolling=function(){e.$(this.options.waitAnimationContainer).children(".coveo-loading-spinner").detach()},i.ID="ResultList",i.options={resultContainer:e.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){return e.$("<div/>").appendTo(t).get(0)}}),resultTemplate:e.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new e.DefaultResultTemplate}}),waitAnimation:e.ComponentOptions.buildStringOption({defaultValue:"none"}),waitAnimationContainer:e.ComponentOptions.buildChildHtmlElementOption({postProcessing:function(e,t){return e||t.resultContainer}}),enableInfiniteScroll:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),infiniteScrollPageSize:e.ComponentOptions.buildNumberOption({defaultValue:10,min:1}),infiniteScrollContainer:e.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){return e.JQueryUtils.findScrollingParent(t)}}),enableInfiniteScrollWaitingAnimation:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),mobileScrollContainer:e.ComponentOptions.buildSelectorOption({defaultFunction:function(){return e.$(".coveo-results-column").get(0)}})},i}(e.Component);e.ResultList=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){void 0===r&&(r=e.ResultList.ID),t.call(this,n,o,s,i.ID),this.element=n,this.options=o,this.columnResultsArray=[],this.imagesInCurrentRow=[],this.imagesLoaded=0,this.resultIndex=0,this.lastRowHeight=0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.lastRowHeight=this.options.heightThreshold,e.$(this.root).on(e.ResultListEvents.newResultsDisplayed,e.$.proxy(this.handleProcessNewResultsDisplayed,this)),this.bindWindowResizeEvent()}return __extends(i,t),i.prototype.getResultsElement=function(){return e.$(this.element).find(".CoveoResult")},i.prototype.getResultsElementImages=function(){return e.$(this.element).find(".CoveoResult img")},i.prototype.getResultsContainerDiv=function(){return e.$(this.element).find("> div")},i.prototype.bindWindowResizeEvent=function(){var t,i=this;e.$(window).on("resize",function(){clearTimeout(t),t=setTimeout(i.retrieveLayoutMethod(),250)})},i.prototype.handleProcessNewResultsDisplayed=function(){this.disabled?e.$(this.element).fadeOut():e.$(this.element).fadeIn(),this.onImageProxy(this.retrieveLayoutMethod())},i.prototype.addTransitionAllToElement=function(t){e._.defer(function(){t.addClass("coveo-transition-all")})},i.prototype.retrieveLayoutMethod=function(){var e=this;if(!this.disabled){if(this.options.layoutType.toLowerCase()==i.columnLayoutTypeStr)return function(){return e.setupColumns()};if(this.options.layoutType.toLowerCase()==i.rowLayoutTypeStr)return function(){return e.setupRows()}}return function(){}},i.prototype.onImageProxy=function(t){var i=(this.getResultsElement().each(function(t,i){0==e.$(i).find("img").length&&e.$(i).detach()}),this.getResultsElementImages()),n=0,o=function(o){e.$(o).height()>0?(null==e.$(o).attr("width")&&null==e.$(o).attr("height")&&(e.$(o).attr("height",e.$(o).height()),e.$(o).attr("width",e.$(o).width())),n++,n==i.length&&t()):(e.$(o).parent().detach(),i=i.not(o),n==i.length&&t())};i.each(function(t,i){this.src&&this.complete||e.$(i).height()>0?o(i):e.$(i).off("load").one("load",function(){o(i)})})},i.prototype.getHorizontalMargin=function(e){return parseInt(e.css("margin-left"))+parseInt(e.css("margin-right"))},i.prototype.getVerticalMargin=function(e){return parseInt(e.css("margin-top"))+parseInt(e.css("margin-bottom"))},i.prototype.setupColumns=function(){var t=this.getResultsContainerDiv().width(),i=this.getResultsElement(),n=this.options.columnWidth,o=this.getHorizontalMargin(i),s=Math.floor(t/(n+o));this.columnResultsArray=[];for(var r=0;s>r;r++)this.columnResultsArray.push(o);this.positionColumns(n,o),e.$(this.element).trigger(e.ImageResultListEvents.imageResultsLayoutComplete,{}),this.options.enableInfiniteScroll&&this.adjustNumberOfResults()},i.prototype.positionColumns=function(t,i){var n=this,o=this.getResultsElement();e._.each(o,function(o){var s=e._.min(n.columnResultsArray),r=e.$.inArray(s,n.columnResultsArray),a=i+r*(t+i);e.$(o).css({left:a+"px",top:s+"px",width:t+"px"}),n.columnResultsArray[r]=s+e.$(o).outerHeight()+i}),this.setResultsContainerHeight(e._.max(this.columnResultsArray)),this.addTransitionAllToElement(o)},i.prototype.setResultsContainerHeight=function(t){e.$(this.element).height(Math.ceil(t)),e.$(this.element).attr("data-height",Math.ceil(t))},i.prototype.setupRows=function(){var t=this.getResultsElement(),i=e.$(this.element).width();this.resultIndex=0;for(var n=0;this.resultIndex<t.length;){this.imagesInCurrentRow=[];var o=this.getCurrentRowHeight(t,i);this.setCurrentRowImagesDimensions(t,o,n),n+=o}this.setResultsContainerHeight(n),e.$(this.element).trigger(e.ImageResultListEvents.imageResultsLayoutComplete,{}),this.addTransitionAllToElement(t),this.options.enableInfiniteScroll&&this.adjustNumberOfResults()},i.prototype.getCurrentRowHeight=function(e,t){for(var i=0,n=null;this.resultIndex<e.length&&(null==n||n>=this.options.heightThreshold);){var o=this.getImageDimensionsFromResult(e.eq(this.resultIndex));null!=o&&(i+=o.width/o.height,n=t/i),this.imagesInCurrentRow.push(this.resultIndex),this.resultIndex++}return n>this.options.heightThreshold&&(n=this.lastRowHeight),this.lastRowHeight=n,n},i.prototype.getImageDimensionsFromResult=function(e){var t=e.find("img"),i=parseInt(t.attr("height")),n=parseInt(t.attr("width"));return{height:i,width:n}},i.prototype.setCurrentRowImagesDimensions=function(t,i,n){var o=this,s=0;e._.each(this.imagesInCurrentRow,function(e){var r=parseInt(t.eq(e).find("img").attr("width")),a=parseInt(t.eq(e).find("img").attr("height")),l=r*i/a,u=o.getHorizontalMargin(t.eq(e)),c=o.getVerticalMargin(t.eq(e));t.eq(e).css({height:Math.round(i-c),width:Math.round(l-u),left:Math.round(s),top:Math.round(n)}),s+=l})},i.prototype.adjustNumberOfResults=function(){var i=Number(e.$(this.element).attr("data-height"));0==e.$.isNumeric(i)&&(i=e.$(this.element).height()),i<e.$(this.options.infiniteScrollContainer).height()&&t.prototype.hasPotentiallyMoreResultsToDisplay.call(this)&&t.prototype.displayMoreResults.call(this,this.options.infiniteScrollPageSize,!1)},i.ID="ImageResultList",i.rowLayoutTypeStr="row",i.columnLayoutTypeStr="column",i.options={layoutType:e.ComponentOptions.buildStringOption({defaultValue:"row",postProcessing:function(e){return e.toLowerCase()}}),heightThreshold:e.ComponentOptions.buildNumberOption({defaultValue:250,min:16}),columnWidth:e.ComponentOptions.buildNumberOption({defaultValue:225,min:16})},i}(e.ResultList);e.ImageResultList=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.ajaxBasicAuth=function(i,n,o,s,r,a){e.$.ajax({type:i,timeout:5e3,url:n,beforeSend:function(i){null!=o&&null!=s&&(i.setRequestHeader("Authorization",t.getBasicAuthBase64(o,s)),e.DeviceUtils.isPhonegap()&&i.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"))}}).fail(function(e){a&&a(e)}).done(function(e){r(e)})},t.getBasicAuthBase64=function(e,t){return"Basic "+btoa(e+":"+t)},t}();e.AjaxUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.loginPanel=t,this.userInputTemplate=e._.template("<div class='coveo-input-container'>          <span class='coveo-username-icon'></span>          <input class='coveo-username' type='text' placeholder='"+e.l("Username")+"' autocorrect='off' autocapitalize='off' />      </div>"),this.passwordInputTemplate=e._.template("<div class='coveo-input-container'>          <span class='coveo-password-icon'></span>          <input class='coveo-password'  type='password' placeholder='"+e.l("Password")+"' autocorrect='off' autocapitalize='off' />      </div>"),this.containerTemplate=e._.template("<div class='coveo-login-credentials-container'></div>")}return t.prototype.buildDom=function(){var t=this;this.credentialContainer=e.$(this.containerTemplate()),this.loginUser=e.$(this.userInputTemplate()),this.loginUser.keypress(function(e){return t.handleInputKeypress(e)}),this.loginPassword=e.$(this.passwordInputTemplate()),this.loginPassword.keypress(function(e){return t.handleInputKeypress(e)}),this.credentialContainer.append(this.loginUser,this.loginPassword),this.loginPanel.getOrCreateContainer().append(this.credentialContainer),this.loginUser.find("input").val(this.getUser()),this.loginPassword.find("input").val(this.getPassword())},t.prototype.show=function(){this.credentialContainer.show()},t.prototype.getUser=function(){return window.localStorage.getItem(this.getLocalStorageKeyUser())},t.prototype.setUser=function(e){this.loginUser.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyUser(),e)},t.prototype.getPassword=function(){return window.localStorage.getItem(this.getLocalStorageKeyPassword())},t.prototype.setPassword=function(e){this.loginPassword.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyPassword(),e)},t.prototype.validate=function(){var t=e.$.Deferred();return this.setPassword(this.getPasswordFromInput()),this.setUser(this.getUserFromInput()),t.resolve(!0),t},t.prototype.submit=function(){var t=e.$.Deferred();return this.setPassword(this.getPasswordFromInput()),this.setUser(this.getUserFromInput()),t.resolve(!0),t},t.prototype.getLocalStorageKeyUser=function(){return"coveo-user-"+this.loginPanel.options.id},t.prototype.getLocalStorageKeyPassword=function(){return"coveo-password-"+this.loginPanel.options.id},t.prototype.getPasswordFromInput=function(){return this.loginPassword.find("input").val()},t.prototype.getUserFromInput=function(){return this.loginUser.find("input").val()},t.prototype.handleInputKeypress=function(e){this.loginPanel.isHidden||13!=e.keyCode||this.loginPanel.submit()},t}();e.LoginCredentials=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.filename=e,this.flags=t}return t.prototype.done=function(e){return this._success=e,this},t.prototype.fail=function(e){return this._error=e,this},t.prototype.tryAccess=function(){this.tryGetFilesystem()},t.prototype._onGotFileEntry=function(){},t.prototype.tryGetFilesystem=function(){window.requestFileSystem(LocalFileSystem.PERSISTENT,0,e.$.proxy(this._gotFileSystem,this),e.$.proxy(this.onError,this))},t.prototype._gotFileSystem=function(t){t.root.getFile(this.filename,this.flags,e.$.proxy(this._onGotFileEntry,this),e.$.proxy(this.onError,this))},t.prototype.onError=function(e){this._error(e)},t}();e.PhonegapFileAccess=t;var i=function(t){function i(e){t.call(this,e,null)}return __extends(i,t),i.prototype.read=function(){return this.tryAccess(),this},i.prototype._onGotFileEntry=function(e){this.gotFileEntry(e)},i.prototype.gotFileEntry=function(t){t.file(e.$.proxy(this.gotFile,this),e.$.proxy(this._error,this))},i.prototype.gotFile=function(e){var t=this,i=new FileReader;i.onloadend=function(e){t._success&&t._success(e.target.result)},i.readAsText(e)},i}(t);e.PhonegapFileReader=i;var n=function(t){function i(e,i){void 0===i&&(i=!1),t.call(this,e,{create:!0,exclusive:!1}),this.append=i}return __extends(i,t),i.prototype.write=function(e){return this.content=e,this.tryAccess(),this},i.prototype._onGotFileEntry=function(t){t.createWriter(e.$.proxy(this.gotFileWriter,this),e.$.proxy(this._error,this))},i.prototype.gotFileWriter=function(e){var t=this;e.onwriteend=function(e){t._success&&t._success(e)},this.append&&e.seek(e.length),e.write(this.content)},i}(t);e.PhonegapFileWriter=n}(Coveo||(Coveo={}));var Coveo;!function(Coveo){var LoginPageSettings=function(){function LoginPageSettings(e){this.loginPanel=e,this.pageSettingsInputTemplate=Coveo._.template("<div class='coveo-input-container'>          <span class='coveo-page-settings-icon'></span>          <input class='coveo-page-settings' type='text' placeholder='"+Coveo.l("PageUrl")+"' autocorrect='off' autocapitalize='off' />    </div>")}return LoginPageSettings.prototype.buildDom=function(){var e=this,t=Coveo.$("<div></div>").addClass("coveo-login-page-settings-container");this.pageSettings=Coveo.$(this.pageSettingsInputTemplate()),this.pageSettings.keypress(function(t){return e.handleInputKeypress(t)}),t.append(this.pageSettings),this.pageSettings.find("input").val(this.getPageSettingsUrl()),this.loginPanel.getOrCreateContainer().append(t)},LoginPageSettings.prototype.getPageSettingsUrl=function(){return window.localStorage.getItem(this.getLocalStorageKeyPageUrl())},LoginPageSettings.prototype.setPageSettingsUrl=function(e){this.pageSettings.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyPageUrl(),e)},LoginPageSettings.prototype.submit=function(e){var t=this.pageSettings.find("input").val();this.setPageSettingsUrl(t);var i=Coveo.$.Deferred();return this.tryToWriteFileToDisc(e,i,!0),i},LoginPageSettings.prototype.validate=function(e){var t=Coveo.$.Deferred();return this.getPageSettingsUrl()?this.tryToReadFileFomDisc(e,t,!1):t.reject(),t},LoginPageSettings.prototype.getLocalStorageKeyPageUrl=function(){return"coveo-page-settings-url-"+this.loginPanel.options.id},LoginPageSettings.prototype.getSearchApiRootUrl=function(){var e=this.getPageSettingsUrl().trim();return/https?:\/\/[^\/]*\/?$/.test(e)?e:e.match(/^(.*)\/[^\/]*$/)[1]},LoginPageSettings.prototype.handleInputKeypress=function(e){this.loginPanel.isHidden||13!=e.keyCode||this.loginPanel.submit()},LoginPageSettings.prototype.loadFromInterfaceEditorUrl=function(e){var t=document.createElement("a");return t.href=e,"/load"==t.pathname?""!=Coveo.Utils.getQueryStringValue("id",t.search)||-1!=e.indexOf("?id")?e:e+"?id":e+"/load?id"},LoginPageSettings.prototype.tryToWriteFileToDisc=function(e,t,i){var n=this;void 0===i&&(i=!1);var o=this.getPageSettingsUrl();Coveo.AjaxUtils.ajaxBasicAuth("GET",this.loadFromInterfaceEditorUrl(o),this.loginPanel.getUser(),this.loginPanel.getPassword(),function(o){Coveo.DeviceUtils.isPhonegap()?new Coveo.PhonegapFileWriter("SearchPage.html").write(JSON.stringify(o)).done(function(){n.loginPanel.logger.info("Found the page and successfully wrote to disc",n.getPageSettingsUrl()),i&&e.done(function(){n.loginPanel.logger.info("Replacing body content with new search page",n.getPageSettingsUrl()),n.writeDocumentContent(o.body)}),t.resolve()}).fail(function(){n.loginPanel.logger.error("Found the file but unable to write",n.getPageSettingsUrl()),t.reject(Coveo.l("ErrorSavingToDevice"))}):(n.loginPanel.logger.info("Found the page",n.getPageSettingsUrl()),i&&n.writeDocumentContent(o.body),t.resolve())},function(){void 0==n.getPageSettingsUrl()||""==n.getPageSettingsUrl()?(n.loginPanel.logger.error("Search page url is empty"),t.reject(Coveo.l("PleaseEnterYourSearchPage"))):(n.loginPanel.logger.error("Unable to find the file",n.getPageSettingsUrl()),t.reject(Coveo.l("CannotConnectSearchPage")))})},LoginPageSettings.prototype.tryToReadFileFomDisc=function(e,t,i){var n=this;void 0===i&&(i=!1),Coveo.DeviceUtils.isPhonegap()?new Coveo.PhonegapFileReader("SearchPage.html").read().done(function(o){n.loginPanel.logger.info("Found the page on disc",n.getPageSettingsUrl()),i&&e.done(function(){var e=JSON.parse(o).body;n.writeDocumentContent(e)}),n.tryToWriteFileToDisc(Coveo.$.Deferred(),Coveo.$.Deferred(),!1),t.resolve()}).fail(function(){n.getPageSettingsUrl()?(n.loginPanel.logger.info("Unable to find the page on disc",n.getPageSettingsUrl()),n.loginPanel.logger.info("Trying to fetch it with GET request and write to disc"),n.tryToWriteFileToDisc(e,t,!1)):t.reject(Coveo.l("ErrorReadingFromDevice"))}):this.tryToWriteFileToDisc(e,t,i)},LoginPageSettings.prototype.writeDocumentContent=function(e){document.body.outerHTML=e,this.appendMissingLoginComponentIfNeeded(),this.configureNewEndpoints(),Coveo.TemplateCache.scanAndRegisterTemplates(),this.initNewSearchInterface()},LoginPageSettings.prototype.appendMissingLoginComponentIfNeeded=function(){var e=Coveo.$("."+Coveo.Component.computeCssClassNameForType(Coveo.Login.ID));if(0==e.length){var t=Coveo.$('<div class="CoveoLogin" data-require-page-settings="true"></div>');this.loginPanel.options.requireLogin?t.attr("data-require-login","true"):t.attr("data-require-login","false"),Coveo.$(".coveo-tab-section").append(t)}else{var i=e.attr("data-require-page-settings");("false"==i||void 0==i)&&e.attr("data-require-page-settings","true")}},LoginPageSettings.prototype.configureNewEndpoints=function(){var scripts=Coveo.$("body").find("script.CoveoEndpoint");Coveo._.each(scripts,function(script){eval(Coveo.$(script).text())});var endpoint=Coveo.SearchEndpoint.endpoints["default"];null!=endpoint&&0==endpoint.options.restUri.indexOf("/rest/search")&&(endpoint.options.restUri=this.getSearchApiRootUrl()+endpoint.options.restUri,endpoint.reset(),this.loginPanel.logger.info("Overrode the REST API uri",endpoint.options.restUri))},LoginPageSettings.prototype.initNewSearchInterface=function(){var scripts=Coveo.$("body").find("script.CoveoInit");if(0!=scripts.length)Coveo.InitializeFromPhonegap=!0,Coveo._.each(scripts,function(script){eval(Coveo.$(script).text())});else{var searchInterface=Coveo.$("."+Coveo.Component.computeCssClassNameForType(Coveo.SearchInterface.ID));0!=searchInterface.length?searchInterface.coveo("init"):Coveo.$("#search").coveo("init")}},LoginPageSettings}();Coveo.LoginPageSettings=LoginPageSettings}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){void 0===r&&(r=i.ID),t.call(this,n,r,s),this.element=n,this.options=o,this.errorMessageTemplate=e._.template("<div class='coveo-login-error-message'></div>"),this.captionTemplate=e._.template("<div class='coveo-login-caption'></div>"),this.tabButtonTemplate=e._.template("<div class='coveo-login-tab'>Login</div>"),this.containerTemplate=e._.template("<div class='coveo-login-form-container'></div>"),this.submitButtonTemplate=e._.template("<button class='coveo-submit'type='submit'><div class='coveo-icon coveo-waiting'></div>"+e.l("GetStarted")+"</button>"),this.combinedTemplate=e._.template("<div class='coveo-login-combined coveo-active'></div>"),this.logoTemplate=e._.template("<div class='coveo-login-logo'></div>"),this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(this.options.id),e.Assert.exists(e.SearchEndpoint.endpoints[this.options.id]),this.isHidden=!0,this.options.requireLogin&&(this.credentials=new e.LoginCredentials(this)),this.options.requirePageSettings&&(this.pageSettings=new e.LoginPageSettings(this)),this.loadingAnimation=e.$(this.searchInterface.options.firstLoadingAnimation),this.bind.onRoot(e.QueryEvents.queryError,this.handleQueryError),this.buildTabButton(),this.ensureDom(),this.updateEndpointWithCredentials(),this.resetErrorMessage(),this.hide(),this.validate()}return __extends(i,t),i.prototype.getPageSettingsUrl=function(){return this.pageSettings?this.pageSettings.getPageSettingsUrl():void 0},i.prototype.setPageSettingsUrl=function(e){this.pageSettings&&this.pageSettings.setPageSettingsUrl(e)},i.prototype.getUser=function(){return this.credentials?this.credentials.getUser():void 0},i.prototype.setUser=function(e){this.credentials&&this.credentials.setUser(e)},i.prototype.getPassword=function(){return this.credentials?this.credentials.getPassword():void 0},i.prototype.setPassword=function(e){this.credentials&&this.credentials.setPassword(e)},i.prototype.setErrorMessage=function(e){this.errorMessage.text(e),this.errorMessage.show(),this.logo.hide()},i.prototype.resetErrorMessage=function(){this.errorMessage.text(""),this.errorMessage.hide(),this.logo.show()},i.prototype.createDom=function(){var t=this;this.logo=e.$(this.logoTemplate()),this.getOrCreateCombined().append(this.logo),this.caption=e.$(this.captionTemplate()),this.options.caption&&this.caption.text(this.options.caption),this.errorMessage=e.$(this.errorMessageTemplate()),this.getOrCreateCombined().append(this.errorMessage),this.getOrCreateContainer().append(this.caption),this.credentials&&this.credentials.buildDom(),this.pageSettings&&this.pageSettings.buildDom(),this.submitButton=e.$(this.submitButtonTemplate()),this.submitButton.click(function(){return t.submit()}),this.getOrCreateContainer().append(this.submitButton)},i.prototype.getOrCreateContainer=function(){return this.container||(this.container=e.$(this.containerTemplate()),this.getOrCreateCombined().append(this.container)),this.container},i.prototype.getOrCreateCombined=function(){return this.combined||(this.combined=e.$(this.combinedTemplate()),e.$(this.root).append(this.combined)),this.combined},i.prototype.hide=function(){this.isHidden=!0,this.getOrCreateCombined().hide()},i.prototype.hideAndExecuteQuery=function(){this.hide(),this.queryController.executeQuery()},i.prototype.validate=function(){this.baseValidationEvent("validate",this.hide)},i.prototype.submit=function(){var e=this,t=function(){e.credentials&&e.updateEndpointWithCredentials(),e.pageSettings||e.hideAndExecuteQuery()};this.baseValidationEvent("submit",t)},i.prototype.isAccessDeniedError=function(e){return 401===e.status||403===e.status},i.prototype.baseValidationEvent=function(t,i){var n=this;e.MobileUtils.hideIOSKeyboard(document.activeElement),this.resetErrorMessage();var o=[],s=e.$.Deferred();this.credentials&&o.push(this.credentials[t](s)),this.pageSettings&&o.push(this.pageSettings[t](s)),e.$.when.apply(this,o).fail(function(t){n.show(),s.reject(!1),n.pageSettings&&e.Utils.isNonEmptyString(n.getPageSettingsUrl())&&n.setErrorMessage(t),n.credentials&&(e.Utils.isNonEmptyString(n.getPassword())||e.Utils.isNonEmptyString(n.getUser()))&&n.setErrorMessage(t)}).always(function(){n.submitButton.removeClass("coveo-waiting")}).done(function(){s.resolve(!0),e.$.proxy(i,n)})},i.prototype.show=function(){this.isHidden=!1,this.ensureDom(),e.MobileUtils.removeToggleClassOnSearchInterface(),this.getOrCreateCombined().show(),e.DeviceUtils.isPhonegap()&&e.$(document).on("backbutton",e.$.proxy(this.handleBackButton,this))},i.prototype.handleBackButton=function(){this.hide(),e.$(document).off("backbutton")},i.prototype.handleQueryError=function(t,i){this.isAccessDeniedError(i.error)&&(this.setErrorMessage(e.l("BadUserPass")),this.show())
},i.prototype.updateEndpointWithCredentials=function(){this.credentials&&void 0!=e.SearchEndpoint.endpoints[this.options.id]&&(e.SearchEndpoint.endpoints[this.options.id].options.password=this.getPassword(),e.SearchEndpoint.endpoints[this.options.id].options.username=this.getUser())},i.prototype.buildTabButton=function(){var t=this;e.$(this.element).append(e.$(this.tabButtonTemplate())),e.$(this.element).click(function(){t.show()})},i.ID="Login",i.options={id:e.ComponentOptions.buildStringOption({defaultValue:"default"}),caption:e.ComponentOptions.buildLocalizedStringOption(),autoTriggerQuery:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),requireLogin:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),requirePageSettings:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.Login=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.listenToQueryStateChange=!0,this.ignoreNextQuerySuccess=!1,this.needToReset=!0,this.listItemTemplate=e._.template('<li class="<%= _class %> coveo-pager-list-item"></li>'),this.listItemValueTemplate=e._.template('<a class="coveo-pager-anchor"><%= listItemValue %></a>'),this.navigationButtonTemplate=e._.template('<li class="<%= _class %> coveo-pager-list-item"><a><span title="<%= buttonValue %>"/></a></li>'),this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.currentPage=1,this.bind.onRoot(e.QueryEvents.newQuery,function(e,t){return r.handleNewQuery(e,t)}),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.onRoot(e.QueryEvents.querySuccess,function(e,t){return r.handleQuerySuccess(e,t)}),this.bind.onRoot(e.QueryEvents.queryError,function(e,t){return r.handleQueryError(e,t)}),this.bind.onRoot(e.QueryEvents.noResults,function(e,t){return r.handleNoResults(e,t)});var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.first);e.$(this.queryStateModel.element).on(a,e.$.proxy(this.handleQueryStateModelChanged,this)),this.list=e.$("<ul></ul>").addClass("coveo-pager-list").appendTo(n)}return __extends(i,t),i.prototype.setPage=function(t,i){void 0===i&&(i=e.AnalyticsActionCauseList.pagerNumber),e.Assert.exists(t),this.currentPage=Math.max(Math.min(t,1e3),1),this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage)),this.usageAnalytics.logCustomEvent(i,{pagerNumber:this.currentPage},this.element),this.queryController.deferExecuteQuery({ignoreWarningSearchEvent:!0,keepLastSearchUid:!0,origin:this})},i.prototype.previousPage=function(){this.setPage(this.currentPage-1,e.AnalyticsActionCauseList.pagerPrevious)},i.prototype.nextPage=function(){this.setPage(this.currentPage+1,e.AnalyticsActionCauseList.pagerNext)},i.prototype.handleNewQuery=function(e,t){var n=t&&t.origin&&t.origin.type==i.ID;this.needToReset&&!n&&(this.currentPage=1,this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage))),this.needToReset=!0},i.prototype.updateQueryStateModel=function(t){this.listenToQueryStateChange=!1,this.queryStateModel.set(e.QueryStateModel.attributesEnum.first,t),this.listenToQueryStateChange=!0},i.prototype.handleQueryError=function(){this.reset()},i.prototype.handleQuerySuccess=function(t,i){var n=this;if(this.reset(),this.ignoreNextQuerySuccess)this.ignoreNextQuerySuccess=!1;else{e.Assert.isNotUndefined(i);var o=i.query.firstResult,s=i.results.totalCountFiltered,r=this.computePagerBoundary(o,s);if(this.currentPage=r.currentPage,r.end-r.start>0){for(var a=r.start;a<=r.end;a++){var l=e.$(this.listItemValueTemplate({listItemValue:a}));!function(t){var i=e.$(n.listItemTemplate({_class:t==n.currentPage?"coveo-active":""})).click(function(){return n.handleClickPage(t)});i.append(l).appendTo(n.list)}(a)}this.options.enableNavigationButton&&r.lastResultPage>1&&this.renderNavigationButton(r,this.list)}}},i.prototype.handleNoResults=function(e,t){var i=this.computePagerBoundary(t.results.totalCountFiltered,t.results.totalCount).lastResultPage;this.currentPage>i&&(this.ignoreNextQuerySuccess=!0,this.setPage(i))},i.prototype.reset=function(){e.$(this.list).empty()},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.getQueryEventArgs();i.queryBuilder.firstResult=n.first,i.queryBuilder.numberOfResults=n.count},i.prototype.computePagerBoundary=function(e,t){var i=this.queryController.options.resultsPerPage,n=Math.floor(e/i)+1,o=Math.ceil(t/i);o=Math.max(o,1);var s=Math.floor(this.options.numberOfPages/2),r=n-s;r=Math.max(r,1);var a=r+this.options.numberOfPages-1;return a=Math.min(a,o),{start:r,end:a,lastResultPage:o,currentPage:n}},i.prototype.renderNavigationButton=function(t,i){var n=this;if(this.currentPage>1){var o=e.$(this.navigationButtonTemplate({_class:"coveo-pager-previous coveo-pager-anchor",buttonValue:e.l("Previous")})).prependTo(i);o.click(function(){return n.handleClickPrevious()})}if(this.currentPage<t.lastResultPage){var s=e.$(this.navigationButtonTemplate({_class:"coveo-pager-next coveo-pager-anchor",buttonValue:e.l("Next")})).appendTo(i);s.click(function(){return n.handleClickNext()})}},i.prototype.handleQueryStateModelChanged=function(t,i){if(this.listenToQueryStateChange){e.Assert.exists(i),this.needToReset=!1;var n=i.value;this.currentPage=this.fromFirstResultsToPageNumber(n)}},i.prototype.handleClickPage=function(t){e.Assert.exists(t),this.setPage(t)},i.prototype.handleClickPrevious=function(){this.previousPage()},i.prototype.handleClickNext=function(){this.nextPage()},i.prototype.fromFirstResultsToPageNumber=function(e){return e/this.queryController.options.resultsPerPage+1},i.prototype.getFirstResultNumber=function(e){return void 0===e&&(e=this.currentPage),(e-1)*this.queryController.options.resultsPerPage},i.prototype.getQueryEventArgs=function(){return{count:this.queryController.options.resultsPerPage,first:this.getFirstResultNumber()}},i.ID="Pager",i.options={numberOfPages:e.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:10},min:1}),enableNavigationButton:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.Pager=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).is("script"))try{this.content=JSON.parse(e.Utils.decodeHTMLEntities(e.$(this.element).text()))}catch(a){try{this.content=JSON.parse(e.$(this.element).text())}catch(a){return}}this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)})}return __extends(i,t),i.prototype.handleBuildingQuery=function(t,i){var n=this;null==i.queryBuilder.context&&(i.queryBuilder.context={});var o=this.getContextKeys();e._.each(o,function(e){i.queryBuilder.context[e]=n.getContextValue(e)})},i.prototype.getContextKeys=function(){return this.content?e._.keys(this.content):[]},i.prototype.getContextValue=function(e){return this.content[e]},i.ID="PipelineContext",i}(e.Component);e.PipelineContext=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n){this.boxInputToBuild=t,this.nameOfInput=i,this.type=n,this.inputs={},this.inputTemplate=e._.template("<div class='coveo-choice-container'>        <div class='coveo-section coveo-section-input'>          <input <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' type='<%= type %>' name='<%= name%>' value='<%= label %>' ></input><span class='coveo-input-icon'></span><label class='coveo-preferences-panel-item-label' for='coveo-<%= label %>'><%= label %></label>        </div>        <div class='coveo-section coveo-section-tab'><%- tab %></div>      <div class='coveo-section coveo-section-expression'><%- expression %></div>      </div>")}return t.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.boxInputToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.nameOfInput,type:t.type,otherAttribute:i.otherAttribute,tab:i.tab,expression:i.expression})),t.inputs[i.label]}),function(e,t){return e.add(t)})},t.prototype.select=function(t){e.Assert.exists(this.inputs[t]),this.inputs[t].find("input").prop("checked",!0),this.inputs[t].find(".coveo-input-icon").addClass("coveo-selected")},t.prototype.unselect=function(t){e.Assert.exists(this.inputs[t]),this.inputs[t].find("input").prop("checked",!1),this.inputs[t].find(".coveo-input-icon").removeClass("coveo-selected")},t.prototype.getSelected=function(){var t=e._.find(this.inputs,function(e){return e.find("input").prop("checked")});return t.find("input").val()},t.prototype.getSelecteds=function(){var t=e._.filter(this.inputs,function(e){return e.find("input").prop("checked")});return e._.map(t,function(e){return e.find("input").val()})},t}();e.PreferencesPanelBoxInput=t;var i=function(e){function t(t,i){e.call(this,t,i,"radio"),this.radioElementToBuild=t,this.name=i}return __extends(t,e),t}(t);e.PreferencesPanelRadioInput=i;var n=function(t){function i(e,i){t.call(this,e,i,"checkbox"),this.checkboxElementToBuild=e,this.name=i}return __extends(i,t),i.prototype.build=function(){var i=t.prototype.build.call(this),n=(i.find("input"),i.find(".coveo-input-icon"));return e._.each(n,function(t){var i=e.$(t).siblings("input"),n=e.$(t);i.change(function(){n.toggleClass("coveo-selected",i.is(":checked"))}),n.click(function(){i.prop("checked",!i.is(":checked")),i.change()})}),i},i}(t);e.PreferencesPanelCheckboxInput=n;var o=function(){function t(t,i){this.textElementToBuild=t,this.name=i,this.inputs={},this.inputTemplate=e._.template("<div class='coveo-choice-container'><input <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' type='<%= type %>' name='<%= name%>' placeholder='<%= placeholder %>' ></input></div>")}return t.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.textElementToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.name,type:"text",otherAttribute:i.otherAttribute,placeholder:i.placeholder||i.label})),t.inputs[i.label]}),function(e,t){return e.add(t)})},t.prototype.getValues=function(){var t=this;return e._.map(this.inputs,function(e,i){return t.getInput(i).val()})},t.prototype.setValue=function(t,i){e.Assert.exists(this.inputs[t]),this.getInput(t).val(i)},t.prototype.reset=function(){e._.each(this.inputs,function(e){e.find("input").val("")})},t.prototype.getInput=function(t){e.Assert.exists(this.inputs[t]);var i=this.inputs[t].find("input");return 0==i.length&&(i=this.inputs[t].find("textarea")),i},t}();e.PreferencesPanelTextInput=o;var s=function(t){function i(){t.apply(this,arguments),this.inputTemplate=e._.template("<div class='coveo-choice-container'><textarea <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' name='<%= name%>' placeholder='<%= placeholder %>' ></textarea></div>")}return __extends(i,t),i.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.textElementToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.name,otherAttribute:i.otherAttribute,placeholder:i.placeholder||i.label})),t.inputs[i.label]}),function(e,t){return e.add(t)})},i}(o);e.PreferencesPanelTextAreaInput=s;var r=function(){function t(e,t,i){this.toBuild=e,this.options=t,this.name=i,this.textInput=new s([{label:e.label,otherAttribute:"readonly"}],i)}return t.prototype.build=function(){var t=this;return this.select=e.$("<select multiple></select>"),e._.each(this.options,function(i){t.select.append(e.$("<option>"+i+"</option>"))}),this.select.change(function(){var i=t.select.val();e.Utils.isNullOrUndefined(i)?t.reset():t.textInput.setValue(t.toBuild.label,i.join(","))}),this.textInput.build().append(this.select)},t.prototype.getValues=function(){return this.textInput.getValues()[0].split(",")},t.prototype.setValues=function(e){this.textInput.setValue(this.toBuild.label,e.join(","))},t.prototype.reset=function(){this.textInput.setValue(this.toBuild.label,"")},t}();e.PreferencePanelMultiSelectInput=r}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.buildCloseButton(),this.buildTitle()}return __extends(i,t),i.prototype.getCssClass=function(){return"coveo-preference-panel"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("Preferences"),onOpen:function(){return t.open()},onClose:function(){return t.close()}}]},i.prototype.open=function(){e.$(this.element).addClass("coveo-active")},i.prototype.close=function(){e.$(this.element).removeClass("coveo-active")},i.prototype.save=function(){e.$(this.element).trigger(e.PreferencesPanelEvents.savePreferences),this.queryController.executeQuery()},i.prototype.closeWithoutSave=function(){e.$(this.element).trigger(e.PreferencesPanelEvents.exitPreferencesWithoutSave)},i.prototype.buildCloseButton=function(){var t=this,i=e.$("<div class='coveo-preferences-panel-close'><span class='coveo-icon'></span></div>");i.click(function(){t.closeWithoutSave(),t.close()}),e.$(this.element).prepend(i)},i.prototype.buildTitle=function(){var t=e.$("<div class='coveo-preferences-panel-title'>"+e.l("Preferences")+"</div>");e.$(this.element).prepend(t)},i.ID="PreferencesPanel",i.options={},i}(e.Component);e.PreferencesPanel=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o);var a=r.raw.sysparents;a?this.renderParentsXml(n,a):this.renderUri(n,r),e.DeviceUtils.isPhonegap()&&e.PhonegapUtils.bindOpenLinkInPhonegap(n,this.uri)}return __extends(i,t),i.prototype.renderParentsXml=function(t,i){for(var n=e.$.parseXML(i),o=n.getElementsByTagName("parent"),s=[],r=[],a=0;a<o.length;a++){if(a>0){var l=this.buildSeperator();r.push(l),t.appendChild(l)}var u=o.item(a),c=this.buildHtmlToken(u.getAttribute("name"),u.getAttribute("uri"));s.push(c),t.appendChild(c)}if(s.length>1){var p=this.buildEllipsis();t.insertBefore(p,r[0]);var d=this.buildSeperator();t.insertBefore(d,p);for(var h=0,f=[],a=0;a<s.length;a++)f[a]=s[a].offsetWidth,h+=f[a];var m=r[0].offsetWidth,v=p.offsetWidth,g=t.offsetWidth;if(h>=g){h+=v+m;for(var y=[],a=1;a<s.length&&h>=g;)t.removeChild(s[a]),t.removeChild(r[a-1]),a>1&&y.push(r[a-1]),y.push(s[a]),h-=f[a]+m,a++;p.onclick=function(){for(var e=0;e<y.length;e++)t.insertBefore(y[e],p);t.removeChild(p)}}else t.removeChild(p),t.removeChild(d)}},i.prototype.renderUri=function(t,i){this.uri=i.clickUri;var n;n=-1==i.printableUri.indexOf("\\")?e.StringAndHoles.shortenUri(i.printableUri,e.$(t).width()/7):e.StringAndHoles.shortenPath(i.printableUri,e.$(t).width()/7);var o=e.HighlightUtils.highlightString(n.value,i.printableUriHighlights,n.holes,"coveo-highlight"),s=e.$("<a>").attr("title",i.printableUri).addClass("coveo-printable-uri").html(o);this.bindLogOpenDocument(s.get(0)),e.DeviceUtils.isPhonegap()||s.attr("href",i.clickUri),s.appendTo(t)},i.prototype.buildSeperator=function(){var e=document.createElement("span");return e.innerText=">",e.className="coveo-printable-uri-separator",e},i.prototype.buildEllipsis=function(){var e=document.createElement("span");return e.innerText="...",e.className="coveo-printable-uri",e},i.prototype.buildHtmlToken=function(t,i){var n=t.charAt(0).toUpperCase()+t.slice(1),o=document.createElement("a");return this.bindLogOpenDocument(o),e.DeviceUtils.isPhonegap()||(o.href=i),this.uri=i,o.className="coveo-printable-uri",o.innerText=n,o},i.prototype.bindLogOpenDocument=function(t){var i=this;e.$(t).on("mousedown touchend",e.$.proxy(function(t){var n=e.$(t.target).attr("href"),o=e.$(t.target).text();i.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentOpen,{documentURL:n,documentTitle:o},i.result,i.root)},this))},i.ID="PrintableUri",i.options={},i}(e.Component);e.PrintableUri=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Component.pointElementsToDummyForm(e.$(n)),e.$(n).change(function(e){r._handleChange(e)}),e.$(n).keyup(function(e){r._handleKeyUp(e)}),e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this._handleNewQuery,this));var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(a,e.$.proxy(this._handleQueryStateChanged,this)),this._clearElement=e.$("<span></span>").addClass("coveo-query-box-clear").hide();e.$("<span></span>").addClass("coveo-icon").appendTo(this._clearElement);if(this._clearElement.click(function(){r.clear(),r._hideClearElement(),r.updateQueryState(),e.DeviceUtils.isMobileDevice()||e.$(r.element).focus(),r.queryController.isStandaloneSearchbox()||r.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return r.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxClear,{})}})}),e.DeviceUtils.isSmallScreenWidth()&&e.$(this.element).focus(function(){e.MobileUtils.removeToggleClassOnSearchInterface()}),e.$(this.element).after(this._clearElement),this.options.autoFocus)try{e.$(this.element).focus()}catch(l){}}return __extends(i,t),i.prototype.clear=function(){e.$(this.element).val(""),this.updateQueryState()},i.prototype.replace=function(t,i){e.$(this.element).val(e.$(this.element).val().replace(t,i)),this.updateQueryState()},i.prototype.replaceCurrentExpression=function(e){this.replace(this.getCurrentQueryExpression(),e),this.updateQueryState()},i.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),""),this.updateQueryState()},i.prototype.getCurrentQueryExpression=function(){var t=e.$(this.element).getCursorPosition(),i=e.$(this.element).val(),n=i.length,o=t,s=t;for(" "==i[o]&&o--;o>0&&" "!=i[o];)o--;for(;n>s&&" "!=i[s];)s++;return i.substring(o,s)},i.prototype.insertAt=function(t,i){var n=e.$(this.element).val(),o=[n.slice(0,t),i,n.slice(t)].join("");e.$(this.element).val(o),this.updateQueryState()},i.prototype._handleChange=function(){return this._addClearElement(),this.updateQueryState(),void 0},i.prototype._handleQueryStateChanged=function(t,i){e.Assert.exists(i);var n=i.value;e.$(this.element).val(n),this._addClearElement()},i.prototype._handleKeyUp=function(t){e.Assert.exists(t),this._addClearElement(),13==t.which?(this.logger.debug("Performing query because user pressed Enter"),this.updateQueryState(),this.enterOnSearchbox(),t.stopPropagation(),e.DeviceUtils.isMobileDevice()&&e.$(this.element).blur()):this.options.enableSearchAsYouType&&e.KeyboardUtils.isAllowedKeyForSearchAsYouType(t)&&this.startNewSearchAsYouTypeTimeout()},i.prototype._addClearElement=function(){""==e.$(this.element).val()?this._hideClearElement():this._showClearElement()},i.prototype._hideClearElement=function(){this._clearElement.hide()},i.prototype._showClearElement=function(){this._clearElement.show()},i.prototype.startNewSearchAsYouTypeTimeout=function(){var t=this;this.cancelAnyPendingSearchAsYouTypeTimeout(),this.searchAsYouTypeTimeout=setTimeout(function(){t.updateQueryState(),t.triggerNewQuery(function(){return t.usageAnalytics.logSearchAsYouType(e.AnalyticsActionCauseList.searchboxAsYouType,{})},!0)},this.options.searchAsYouTypeDelay)},i.prototype._handleNewQuery=function(){i.queryboxIsAlreadyAddedToQuery=!1},i.prototype.handleBuildingQuery=function(t,n){e.Assert.exists(n),e.Assert.exists(n.queryBuilder),this.updateQueryState(),this.options.enableWildcards&&(n.queryBuilder.enableWildcards=!0),this.options.enableQuestionMarks&&(n.queryBuilder.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(n.queryBuilder.enableLowercaseOperators=!0),this.options.enablePartialMatch&&(n.queryBuilder.enablePartialMatch=!0,n.queryBuilder.partialMatchKeywords=this.options.partialMatchKeywords,n.queryBuilder.partialMatchThreshold=this.options.partialMatchThreshold);var o=e.$(this.element).val();e.Utils.isNonEmptyString(o)&&!i.queryboxIsAlreadyAddedToQuery&&(this.options.enableQuerySyntax?n.queryBuilder.expression.add(o):n.queryBuilder.expression.add("<@- "+o+" -@>"),this.logger.trace("Adding query to QueryBuilder",o),i.queryboxIsAlreadyAddedToQuery=!0)},i.prototype.enterOnSearchbox=function(){var t=this;e.$(this.element).trigger(e.UserActionEvents.enterOnSearchbox),this.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})},!1)},i.prototype.triggerNewQuery=function(e,t){this.cancelAnyPendingSearchAsYouTypeTimeout(),this.queryController.deferExecuteQuery({beforeExecuteQuery:e,searchAsYouType:t})},i.prototype.updateQueryState=function(){var t=e.$(this.element).val();this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t)},i.prototype.cancelAnyPendingSearchAsYouTypeTimeout=function(){e.Utils.exists(this.searchAsYouTypeTimeout)&&(clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0)},i.ID="Querybox",i.options={enableSearchAsYouType:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:e.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),enableQuerySyntax:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableWildcards:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),partialMatchThreshold:e.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i.queryboxIsAlreadyAddedToQuery=!1,i}(e.Component);e.Querybox=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleQuerySuccess,this)),e.$(this.root).on(e.QueryEvents.queryError,function(){e.$(r.element).hide()}),e.$(this.element).hide(),this.textContainer=e.$("<span />").appendTo(this.element)}return __extends(i,t),i.prototype.handleQuerySuccess=function(t,i){if(!this.disabled&&i.results.results.length>0){e.Assert.exists(i);var n=e.l("Duration",this.formatQueryDuration(i.results.duration))+"\n"+e.l("IndexDuration",this.formatQueryDuration(i.results.indexDuration))+"\n"+e.l("ProxyDuration",this.formatQueryDuration(i.results.proxyDuration))+"\n"+e.l("ClientDuration",this.formatQueryDuration(i.results.clientDuration));this.textContainer.text(this.formatQueryDuration(i.results.duration)),e.$(this.element).attr("title",n),e.$(this.element).show()}else e.$(this.element).hide()},i.prototype.formatQueryDuration=function(t){if(void 0==t)return e.l("Unavailable");var i=Math.max(t/1e3,.01);return e.l("Seconds",Globalize.format(i,"n2"),i)},i.ID="QueryDuration",i.options={},i}(e.Component);e.QueryDuration=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleQuerySuccess,this)),e.$(this.root).on(e.QueryEvents.queryError,function(){e.$(r.element).hide()}),e.$(this.element).hide(),this.textContainer=e.$("<span />").appendTo(this.element)}return __extends(i,t),i.prototype.handleQuerySuccess=function(t,i){if(!this.disabled)if(e.Assert.exists(i),e.$(this.element).show(),this.options.onlyDisplaySearchTips&&e.$(this.element).hide(),i.results.results.length>0){var n=Globalize.format(i.query.firstResult+1,"n0"),o=Globalize.format(i.query.firstResult+i.results.results.length,"n0"),s=Globalize.format(i.results.totalCountFiltered,"n0");this.textContainer.html(e.l("ShowingResultsOf",'<span class="coveo-highlight">'+n+"</span>",'<span class ="coveo-highlight">'+o+"</span>",'<span class ="coveo-highlight">'+s+"</span>",i.results.results.length))}else if(null!=i.results.exception&&null!=i.results.exception.code){var r=("QueryException"+i.results.exception.code).toLocaleString();this.textContainer.html(e.l("QueryException",r))}else this.displayInfoOnNoResults()},i.prototype.displayInfoOnNoResults=function(){var t=this;e.$(this.element).show(),this.textContainer.empty();var i=e._.escape(this.queryStateModel.get(e.QueryStateModel.attributesEnum.q));if(""!=i)var n=e.$('<div class="coveo-query-summary-no-results-string"></div>').html(e.l("noResultFor","<span class='coveo-highlight'>"+i+"</span>"));var o=e.$('<div class="coveo-query-summary-cancel-last">'+e.l("CancelLastAction")+"</div>").click(function(){t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.noResultsBack,{},t.root),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.noResultsBack,{}),history.back()}),s=e.$('<div class="coveo-query-summary-search-tips-info"></div>').text(e.l("SearchTips")),r=e.$("<ul></ul>");e.$("<li></li>").text(e.l("CheckSpelling")).appendTo(r),e.$("<li></li>").text(e.l("TryUsingFewerKeywords")).appendTo(r),this.queryStateModel.atLeastOneFacetIsActive()&&e.$("<li></li>").text(e.l("SelectFewerFilters")).appendTo(r),this.options.enableSearchTips?this.textContainer.append(n,o,s,r):this.textContainer.append(n,o)},i.ID="QuerySummary",i.options={enableSearchTips:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),onlyDisplaySearchTips:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.QuerySummary=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.instantiateToString=function(){return'<div><span class="CoveoIcon"></span> <a class="CoveoResultLink"></a> <span class="CoveoQuickview"></span></div>'},t}(e.Template);e.DefaultResultAttachmentTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){void 0===a&&(a=0),t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.attachmentLevel=a,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.attachments=r.attachments,e.Utils.isNonEmptyArray(this.attachments)&&this.renderAttachments()}return __extends(i,t),i.prototype.renderAttachments=function(){var t=this;e._.each(this.attachments,function(n){e.QueryUtils.setStateObjectOnQueryResult(t.queryStateModel.get(),n);var o=t.attachmentLevel>0?t.options.subResultTemplate.instantiateToElement(n):t.options.resultTemplate.instantiateToElement(n);if(t.autoCreateComponentsInsideResult(o,e.$.extend({},n,{attachments:[]})),e.$(o).addClass("coveo-results-attachment-container").appendTo(t.element),t.attachmentHasSubAttachment(n)&&t.attachmentLevel<t.options.maximumAttachmentLevel){var s=e.$("<div></div>");e.$(o).append(s),new i(s.get(0),t.options,t.bindings,n,t.attachmentLevel+1)}})},i.prototype.attachmentHasSubAttachment=function(t){return e.Utils.isNonEmptyArray(t.attachments)?!0:e.Utils.isNonEmptyArray(t.childResults)?(t.attachments=t.childResults,!0):!1},i.prototype.autoCreateComponentsInsideResult=function(t,n){e.Assert.exists(t);var o=this.searchInterface.options,s={options:o,bindings:this.getBindings(),result:n};e.CoveoJQuery.automaticallyCreateComponentsInside(t,s,[i.ID])},i.ID="ResultAttachments",i.options={resultTemplate:e.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new e.DefaultResultAttachmentTemplate}}),subResultTemplate:e.ComponentOptions.buildTemplateOption({postProcessing:function(e,t){return null!=e?e:t.resultTemplate}}),maximumAttachmentLevel:e.ComponentOptions.buildNumberOption({defaultValue:5,min:0})},i}(e.Component);e.ResultAttachments=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.instantiateToString=function(){return'<div class="coveo-child-result"><span class="CoveoIcon"></span> <a class="CoveoResultLink"></a> <span class="CoveoQuickview"></span></div>'},t.prototype.getType=function(){return"DefaultFoldingTemplate"},t}(e.Template);e.DefaultFoldingTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.showingMoreResults=!1,this.options=e.ComponentOptions.initComponentOptions(this.element,i,o),e.Assert.exists(r),this.buildElements(),this.displayThoseResults(this.result.childResults),this.updateElementVisibility(),0!=this.result.childResults.length||this.result.moreResults||e.$(this.element).hide()}return __extends(i,t),i.prototype.showMoreResults=function(){var t=this;e.Assert.exists(this.result.moreResults),this.cancelAnyPendingShowMore(),this.moreResultsDeferred=this.result.moreResults(),this.waitAnimation=e.JQueryUtils.getBasicLoadingDots().appendTo(this.results),this.updateElementVisibility(),this.moreResultsDeferred.done(function(e){t.showingMoreResults=!0,t.displayThoseResults(e),t.updateElementVisibility(e.length)}),this.moreResultsDeferred.always(function(){t.moreResultsDeferred=void 0,t.waitAnimation.detach(),t.waitAnimation=void 0})},i.prototype.showLessResults=function(){this.cancelAnyPendingShowMore(),this.showingMoreResults=!1,this.displayThoseResults(this.result.childResults),this.updateElementVisibility(),this.scrollToResultElement()},i.prototype.buildElements=function(){this.buildHeader(),this.buildResults(),this.buildFooter()},i.prototype.buildHeader=function(){var t=e.$("<div/>").addClass("coveo-folding-header").appendTo(this.element);void 0!=this.options.normalCaption&&void 0!=this.options.expandedCaption&&(this.normalCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.normalCaption).appendTo(t),this.expandedCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.expandedCaption).appendTo(t)),this.onlyOneMessageCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.oneResultCaption).appendTo(t)},i.prototype.buildResults=function(){this.results=e.$("<div/>").addClass("coveo-folding-results").appendTo(this.element)},i.prototype.buildFooter=function(){var t=this,i=e.$("<div/>").addClass("coveo-folding-footer").appendTo(this.element.parentElement);if(this.result.moreResults){this.showMore=e.$("<div/>").addClass("coveo-folding-footer-section-for-less").appendTo(i).click(function(){return t.showMoreResults()}),this.showLess=e.$("<div/>").addClass("coveo-folding-footer-section-for-more").appendTo(i).click(function(){return t.showLessResults()});var n=e.$("<div><span class='coveo-folding-footer-icon'></span></div>").addClass("coveo-more"),o=e.$("<div><span class='coveo-folding-footer-icon'></span></div>").addClass("coveo-less"),s=e.$("<a/>").addClass("coveo-folding-show-more").text(this.options.moreCaption),r=e.$("<a/>").addClass("coveo-folding-show-less").text(this.options.lessCaption);this.showMore.append(s),this.showLess.append(r),this.showMore.append(n),this.showLess.append(o)}},i.prototype.updateElementVisibility=function(t){this.normalCaption&&this.normalCaption.fastToggle(!this.showingMoreResults&&this.result.childResults.length>0),this.expandedCaption&&this.expandedCaption.fastToggle(this.showingMoreResults),this.onlyOneMessageCaption.fastToggle(t&&1==t),this.showMore&&(this.showMore.fastToggle(!this.showingMoreResults&&!e.Utils.exists(this.moreResultsDeferred)),this.showLess.fastToggle(this.showingMoreResults)),e.$(this.element).find(".coveo-show-if-normal").fastToggle(!this.showingMoreResults),e.$(this.element).find(".coveo-show-if-expanded").fastToggle(this.showingMoreResults)
},i.prototype.scrollToResultElement=function(){e.$(window).scrollTop(e.$(this.element).closest(".CoveoResult").position().top)},i.prototype.displayThoseResults=function(t){var i=this;this.results.empty(),e._.each(t,function(e){i.renderChildResult(e)})},i.prototype.renderChildResult=function(t){e.QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(),t);var i=e.$(this.options.resultTemplate.instantiateToElement(t)).addClass("coveo-result-folding-child-result").appendTo(this.results);i.toggleClass("coveo-normal-child-result",!this.showingMoreResults),i.toggleClass("coveo-expanded-child-result",this.showingMoreResults),this.autoCreateComponentsInsideResult(i.get(0),t)},i.prototype.autoCreateComponentsInsideResult=function(t,i){e.Assert.exists(t);var n=this.searchInterface.options,o={options:n,bindings:this.getBindings(),result:i};e.CoveoJQuery.automaticallyCreateComponentsInside(t,o)},i.prototype.cancelAnyPendingShowMore=function(){this.moreResultsDeferred&&this.moreResultsDeferred.reject(),e.Assert.doesNotExists(this.moreResultsDeferred),e.Assert.doesNotExists(this.waitAnimation)},i.ID="ResultFolding",i.options={resultTemplate:e.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new e.DefaultFoldingTemplate}}),normalCaption:e.ComponentOptions.buildLocalizedStringOption(),expandedCaption:e.ComponentOptions.buildLocalizedStringOption(),moreCaption:e.ComponentOptions.buildLocalizedStringOption({postProcessing:function(t){return t||e.l("ShowMore")}}),lessCaption:e.ComponentOptions.buildLocalizedStringOption({postProcessing:function(t){return t||e.l("ShowLess")}}),oneResultCaption:e.ComponentOptions.buildLocalizedStringOption({postProcessing:function(t){return t||e.l("DisplayingTheOnlyMessage")}})},i}(e.Component);e.ResultFolding=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(e){void 0===e&&(e=navigator);var t;return t=-1!=e.appVersion.indexOf("Win")?0:-1!=e.appVersion.indexOf("Mac")?1:-1!=e.appVersion.indexOf("X11")?2:-1!=e.appVersion.indexOf("Linux")?3:4}!function(e){e[e.WINDOWS=0]="WINDOWS",e[e.MACOSX=1]="MACOSX",e[e.UNIX=2]="UNIX",e[e.LINUX=3]="LINUX",e[e.UNKNOWN=4]="UNKNOWN"}(e.NAME||(e.NAME={}));e.NAME;e.get=t}(t=e.OSUtils||(e.OSUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){var l=this;if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.os=a,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.options=e.$.extend({},this.options,this.componentOptionsModel.get(e.ComponentOptionsModel.attributesEnum.resultLink)),this.result=r||this.resolveResult(),null==this.options.openQuickview&&(this.options.openQuickview="ExchangeCrawler"==r.raw.sysconnectortype&&e.DeviceUtils.isMobileDevice()),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(this.result),!this.options.openQuickview)if(e.DeviceUtils.isMobileDevice())e.$(n).on("mousedown",function(){l.logOpenDocument()});else{var u=!1;e.$(n).on("mousedown",function(){u=!0}),e.$(document.body).on("mouseup scroll",function(){u=!1}),e.$(n).on("mouseup",function(){u&&l.logOpenDocument()})}/^\s*$/.test(this.element.innerHTML)&&(this.element.innerHTML=this.result.title?e.HighlightUtils.highlightString(this.result.title,this.result.titleHighlights,null,"coveo-highlight"):this.result.clickUri),this.bindEventToOpen()}return __extends(i,t),i.prototype.bindEventToOpen=function(){return this.bindOnClickIfNotUndefined()||this.bindOpenQuickviewIfNotUndefined()||this.setHrefIfNotAlready()||this.openLinkThatIsNotAnAnchor()},i.prototype.bindOnClickIfNotUndefined=function(){var t=this;return void 0!=this.options.onClick?(e.$(this.element).click(function(e){t.options.onClick.call(t,e,t.result)}),!0):!1},i.prototype.bindOpenQuickviewIfNotUndefined=function(){var t=this;return(this.options.openQuickview||this.isUriThatMustBeOpenedInQuickview())&&e.QueryUtils.hasHTMLVersion(this.result)?(e.$(this.element).click(function(i){i.preventDefault(),e.$(t.bindings.resultElement).trigger(e.ResultListEvents.openQuickview)}),!0):!1},i.prototype.openLinkThatIsNotAnAnchor=function(){var t=this;return e.DeviceUtils.isPhonegap()?(e.PhonegapUtils.bindOpenLinkInPhonegap(this.element,this.getResultUri()),!0):this.elementIsAnAnchor()?!1:(e.$(this.element).click(function(){t.options.alwaysOpenInNewWindow?t.options.openInOutlook&&t.hasOutlookField()?window.location.href=t.getResultUri():window.open(t.getResultUri(),"_blank"):window.location.href=t.getResultUri()}),!0)},i.prototype.setHrefIfNotAlready=function(){if(e.DeviceUtils.isPhonegap()&&this.elementIsAnAnchor()){var t=e.$(this.element).attr("href");return(void 0==t||""==t)&&(t=this.getResultUri()),e.$(this.element).removeAttr("href"),e.$(this.element).removeAttr("target"),e.PhonegapUtils.bindOpenLinkInPhonegap(this.element,t),!0}return this.elementIsAnAnchor()&&!e.Utils.isNonEmptyString(e.$(this.element).attr("href"))?(e.$(this.element).attr("href",this.getResultUri()),!this.options.alwaysOpenInNewWindow||this.options.openInOutlook&&this.hasOutlookField()||e.$(this.element).attr("target","_blank"),!0):!1},i.prototype.bindPhonegapClick=function(){e.DeviceUtils.isPhonegap()&&e.PhonegapUtils.bindOpenLinkInPhonegap(this.element,this.getResultUri())},i.prototype.logOpenDocument=function(){this.queryController.saveLastQuery();var t=e.$(this.element).attr("href");(void 0==t||""==t)&&(t=this.result.clickUri),this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentOpen,{documentURL:t,documentTitle:this.result.title},this.result,this.root),e.Defer.flush()},i.prototype.getResultUri=function(){return void 0==this.options.field&&this.options.openInOutlook&&this.setField(),void 0!=this.options.field?e.Utils.getFieldValue(this.result,this.options.field):this.result.clickUri},i.prototype.elementIsAnAnchor=function(){return"A"==this.element.tagName},i.prototype.setField=function(){var t=e.Utils.exists(this.os)?this.os:e.OSUtils.get();1==t&&this.hasOutlookField()?this.options.field="@sysoutlookformacuri":0==t&&this.hasOutlookField()&&(this.options.field="@sysoutlookuri")},i.prototype.hasOutlookField=function(){var t=e.Utils.exists(this.os)?this.os:e.OSUtils.get();return 1==t&&void 0!=this.result.raw.sysoutlookformacuri?!0:0==t&&void 0!=this.result.raw.sysoutlookuri?!0:!1},i.prototype.isUriThatMustBeOpenedInQuickview=function(){return 0==this.result.clickUri.toLowerCase().indexOf("ldap://")},i.ID="ResultLink",i.options={field:e.ComponentOptions.buildFieldOption(),openInOutlook:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),openQuickview:e.ComponentOptions.buildBooleanOption(),alwaysOpenInNewWindow:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.ResultLink=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.isInSalesforce=function(){return void 0!=window.sforce},t.isInSalesforceConsole=function(){return t.isInSalesforce()&&void 0!=window.sforce.console&&window.sforce.console.isInConsole()},t.focusOrOpenTab=function(t,i,n){void 0===n&&(n=!1),t="undefined"!=typeof t?t:"";var o=t;t=t.split("#")[0].split("?")[0];var s=this.getSfIdFromUrl(t),r=function(e,t){return e&&t?-1!==e.indexOf(t,e.length-t.length):!1},a=function(e){return e.success?!1:(d(p,t),!0)},l=0,u=!1,c=0,p=null,d=function(e){window.sforce.console.openSubtab(e,o,!0,i,null,function(e){e.success||window.open(o)})},h=function(i,n){if(!a(i)&&(c++,!u)){var o=e.$.parseJSON(i.pageInfo).url;o=o?o.split("#")[0].split("?")[0]:o;var h=e.$.parseJSON(i.pageInfo).objectId;h=h?h.substr(0,15):o,(h==s||r(t,o)||r(o,t))&&(window.sforce.console.focusSubtabById(n),u=!0),l--,u||0!=l||d(p,t)}},f=function(e){if(!a(e)){l=e.ids.length;for(var t=0;t<e.ids.length;t++)window.sforce.console.getPageInfo(e.ids[t],function(t){h(t,e.ids[c])})}},m=function(e){a(e)||(p=e.id,window.sforce.console.getSubtabIds(e.id,f))};n||window.sforce.console.getFocusedPrimaryTabId(m);var v=0,g=0,y=function(){window.sforce.console.openPrimaryTab(null,o,!0,i,function(e){e.success||window.open(o)})},C=function(i,n){if(!a(i)&&(g++,!u)){var o=e.$.parseJSON(i.pageInfo).url;o=o?o.split("#")[0].split("?")[0]:o;var l=e.$.parseJSON(i.pageInfo).objectId;l=l?l.substr(0,15):o,(l==s||r(t,o)||r(o,t))&&(window.sforce.console.focusPrimaryTabById(n),u=!0),v--,u||0!=v||y(t)}},b=function(e){if(!a(e)){v=e.ids.length;for(var t=0;t<e.ids.length;t++)window.sforce.console.getPageInfo(e.ids[t],function(t){C(t,e.ids[g])})}};n&&window.sforce.console.getPrimaryTabIds(b)},t.getSfIdFromUrl=function(e){var t=e.substr(e.lastIndexOf("/")+1,18),i=/^\w+$/.test(t);return i?t.substr(0,15):e.split("#")[0].split("?")[0]},t.expandStringUsingRecord=function(e,i){if(null!=e){var n=e.match(/\{!(>?)(.*?)\}/g);if(null!=n)for(var o=0;o<n.length;o++){var s=n[o],r=/\{!(>?)(.*?)\}/g.exec(s),a=">"===r[1],l=r[2].toLowerCase(),u="";null!=i[l]&&(u=i[l].toString(),a&&(u=t.cleanSentenceForQuery(u))),e=e.replace(r[0],u)}}return e},t.expandStringUsingExpert=function(i,n){if(null!=i){var o=i.match(/%(\w+)%/g);if(null!=o)for(var s=0;s<o.length;s++){var r=o[s],a=/%(\w+)%/g.exec(r),l=a[1].toLowerCase(),u=e.Utils.getFieldValue(n,l);u=null!=u?t.cleanSentenceForQuery(u):"",i=i.replace(a[0],u)}}return i},t.cleanSentenceForQuery=function(e){return e.replace(/[\[\]"'\(\),\.@=<>:]/g,"")},t}();e.SalesforceUtilities=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,r),this.element=n,this.options=o,this.result=r}return __extends(i,t),i.prototype.bindEventToOpen=function(){var i=this;if(e.SalesforceUtilities.isInSalesforceConsole()){var n=!1;return this.options.openInPrimaryTab?(e.$(this.element).click(function(){e.SalesforceUtilities.focusOrOpenTab(decodeURIComponent(i.result.clickUri),i.result.title,!0)}),n=!0):this.options.openInSubTab&&(e.$(this.element).click(function(){e.SalesforceUtilities.focusOrOpenTab(decodeURIComponent(i.result.clickUri),i.result.title,!1)}),n=!0),n||(n=t.prototype.bindEventToOpen.call(this)),n}return t.prototype.bindEventToOpen.call(this)},i.ID="SalesforceResultLink",i.options=e._.extend({},{openInPrimaryTab:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),openInSubTab:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},e.ResultLink.options),i}(e.ResultLink);e.SalesforceResultLink=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.preferencePanel=e.$(this.element).parents("."+e.Component.computeCssClassNameForType(e.PreferencesPanel.ID)),this.preferencePanelLocalStorage=new e.LocalStorageUtils(i.ID),this.mergeLocalPreferencesWithStaticPreferences(),this.bindPreferencePanelEvent(),this.bindBreadcrumbEvent(),this.bindQueryEvent(),e.$(this.root).one(e.InitializationEvents.afterComponentsInitialization,function(){r.createDom()});var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);e.$(this.root).one(a,function(){r.fromPreferencesToCheckboxInput()})}return __extends(i,t),i.prototype.createDom=function(){this.buildTitle(),this.buildCheckboxesInput(),this.options.showAdvancedFilters&&this.buildAdvancedFilters()},i.prototype.save=function(){this.fromCheckboxInputToPreferences();var t=e._.omit(this.preferences,"tab");this.logger.info("Saving preferences",t),this.preferencePanelLocalStorage.save(t)},i.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput()},i.prototype.bindPreferencePanelEvent=function(){var t=this;this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.savePreferences,function(){return t.save()}),this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return t.exitWithoutSave()})},i.prototype.bindBreadcrumbEvent=function(){this.options.includeInBreadcrumb&&(this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,e.$.proxy(this.handlePopulateBreadcrumb,this)),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,e.$.proxy(this.handleClearBreadcrumb,this)))},i.prototype.bindQueryEvent=function(){this.bind.onRoot(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this))},i.prototype.handleBuildingQuery=function(t,i){e._.each(this.getActiveFilters(),function(e){i.queryBuilder.advancedExpression.add(e.expression)})},i.prototype.handlePopulateBreadcrumb=function(t,i){var n=this.getActiveFilters();if(e.Utils.isNonEmptyArray(n)){var o=e.$("<div/>").addClass("coveo-results-filter-preferences-breadcrumb");e.$("<span/>").addClass("coveo-title").text(e.l("FiltersInYourPreferences")+":").appendTo(o);for(var s=e.$("<span/>").addClass("coveo-values").appendTo(o),r=0;r<n.length;r++)0!=r&&e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(s),this.buildBreadcrumb(n[r]).appendTo(s);i.breadcrumbs.push({element:o.get(0)})}},i.prototype.handleClearBreadcrumb=function(){e._.each(this.getActiveFilters(),function(e){e.selected=!1}),this.fromPreferencesToCheckboxInput()},i.prototype.buildTitle=function(){e.$(this.element).append(e.$("<div class='coveo-title'>"+e.l("ResultsFilteringExpression")+"</div>"))},i.prototype.buildAdvancedFilters=function(){var t=this;this.advancedFilters=e.$("<div>"+e.l("Create")+"</div>").addClass("coveo-advanced-filters"),this.buildAdvancedFilterInput(),this.buildAdvancedFilterFormValidate(),this.advancedFiltersBuilder=e.$("<div class='coveo-advanced-filters-builder'></div>"),this.advancedFiltersBuilder.append(this.advancedFilterFormValidate),this.advancedFilters.click(function(){return t.openAdvancedFilterSectionOrSaveFilters()});var i=e.$("<a href='http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10006' target='_blank' class='coveo-online-help'>?</a>");e.$(this.element).find(".coveo-title").first().after(i,this.advancedFilters),e.$(this.element).append(this.advancedFiltersBuilder)},i.prototype.buildAdvancedFilterInput=function(){this.advancedFiltersTextInputCaption=new e.PreferencesPanelTextAreaInput([{label:e.l("Caption"),placeholder:e.l("EnterExpressionName"),otherAttribute:"required"}],i.ID+"-advanced-caption"),this.advancedFiltersTextInputExpression=new e.PreferencesPanelTextAreaInput([{label:e.l("Expression"),placeholder:e.l("EnterExpressionToFilterWith"),otherAttribute:"required"}],i.ID+"-advanced-expression"),this.advancedFiltersTabSelect=new e.PreferencePanelMultiSelectInput({label:e.l("Tab"),placeholder:e.l("SelectTab")},this.getAllTabs(),i.ID+"-multiselect")},i.prototype.buildAdvancedFilterFormValidate=function(){var t=this;this.advancedFilterFormValidate=e.$("<form></form>");var i=e.$("<input type='submit' />"),n=e.$("<span class='coveo-save'></span>"),o=e.$("<span class='coveo-close'></span>"),s=e.$("<div class='coveo-choice-container coveo-close-and-save'></div>").append(n,o);this.advancedFilterFormValidate.append(this.advancedFiltersTextInputCaption.build().addClass("coveo-caption"),this.advancedFiltersTabSelect.build().addClass("coveo-tab"),this.advancedFiltersTextInputExpression.build().addClass("coveo-expression"),s,i),n.click(function(){i.click()}),o.click(function(){t.advancedFiltersBuilder.toggleClass("coveo-active")}),this.advancedFilterFormValidate.find("textarea").keyup(function(e){13==e.keyCode&&i.click()}),this.advancedFilterFormValidate.submit(function(e){t.validateAndSaveAdvancedFilter(e)})},i.prototype.getAdvancedFiltersTextInputToBuild=function(){return[{label:e.l("Caption"),otherAttribute:"required"},{label:e.l("Expression"),otherAttribute:"required"}]},i.prototype.getAllTabs=function(){var t=e.Component.getComponentRef("Tab");if(t){var i=e.$(this.root).find("."+e.Component.computeCssClassNameForType(t.ID));return e._.map(i,function(t){var i=e.$(t).coveo();return i.options.id})}},i.prototype.getPreferencesBoxInputToBuild=function(){return e._.map(this.preferences,function(e){return{label:e.caption,tab:e.tab,expression:e.expression}})},i.prototype.buildCheckboxesInput=function(){var t=this;void 0!=this.preferenceContainer&&this.preferenceContainer.remove();var n=this.getPreferencesBoxInputToBuild();e.Utils.isNonEmptyArray(n)&&(this.preferencePanelCheckboxInput=new e.PreferencesPanelCheckboxInput(n,i.ID),this.preferenceContainer=e.$("<div class='coveo-choices-container'></div>"),this.preferenceContainer.append(this.preferencePanelCheckboxInput.build()),this.preferenceContainer.find(".coveo-choice-container").append("<div class='coveo-section coveo-section-edit-delete'></div>"),e.$(this.element).append(this.preferenceContainer),this.buildEditAdvancedFilter(),this.buildDeleteAdvancedFilter(),this.fromPreferencesToCheckboxInput(),this.preferenceContainer.find("input").change(function(i){t.save();var n=t.preferences[e.$(i.target).val()];t.fromFilterToAnalyticsEvent(n,n.selected?"selected":"unselected"),t.queryController.executeQuery()}))},i.prototype.buildDeleteAdvancedFilter=function(){var t=this;e._.each(this.preferences,function(i){if(i.custom){var n=e.$("<span class='coveo-delete'><span class='coveo-icon'></span></span>"),o=t.getFilterElementByCaption(i.caption),s=o.closest(".coveo-section").siblings(".coveo-section-edit-delete");n.appendTo(s),n.click(function(){t.confirmDelete(i,o)})}})},i.prototype.buildEditAdvancedFilter=function(){var t=this;e._.each(this.preferences,function(i){if(i.custom){var n=e.$("<span class='coveo-edit'><span class='coveo-icon'></span></span>"),o=t.getFilterElementByCaption(i.caption),s=o.closest(".coveo-section").siblings(".coveo-section-edit-delete");n.appendTo(s),n.click(function(){t.editElement(i,o)})}})},i.prototype.buildBreadcrumb=function(t){var i=this,n=e.$("<span/>").addClass("coveo-value");return e.$("<span/>").addClass("coveo-caption").text(t.caption).appendTo(n),e.$("<span/>").addClass("coveo-clear").appendTo(n),n.click(function(){t.selected=!1,i.fromFilterToAnalyticsEvent(t,"cleared from breadcrumb"),i.fromPreferencesToCheckboxInput(),i.queryController.executeQuery()}),n},i.prototype.confirmDelete=function(t,i){if(confirm(e.l("AreYouSureDeleteFilter",t.caption,t.expression))){var n=t.selected;this.deleteFilterPreference(t,i),n&&(this.fromFilterToAnalyticsEvent(t,"deleted"),this.queryController.executeQuery())}},i.prototype.editElement=function(e,t){var i=this.preferences[e.caption].caption,n=this.preferences[e.caption].tab,o=this.preferences[e.caption].expression;this.deleteFilterPreference(e,t),this.openAdvancedFilterSectionOrSaveFilters(),this.populateEditSection({tab:n,caption:i,expression:o}),this.advancedFiltersBuilder.find("input[type=text]").first().focus()},i.prototype.populateEditSection=function(t){void 0===t&&(t={tab:[""],caption:"",expression:""}),this.advancedFiltersTextInputCaption.setValue(e.l("Caption"),t.caption),this.advancedFiltersTextInputExpression.setValue(e.l("Expression"),t.expression),this.advancedFiltersTabSelect.setValues(t.tab)},i.prototype.deleteFilterPreference=function(e,t){this.preferencePanelLocalStorage.remove(e.caption),delete this.preferences[e.caption],t.closest(".coveo-choice-container").remove()},i.prototype.openAdvancedFilterSectionOrSaveFilters=function(){this.advancedFiltersBuilder.hasClass("coveo-active")?this.advancedFilterFormValidate.find("input[type=submit]").click():(this.populateEditSection(),this.advancedFiltersBuilder.toggleClass("coveo-active"))},i.prototype.validateAndSaveAdvancedFilter=function(t){t.preventDefault(),this.advancedFiltersBuilder.removeClass("coveo-active");var i=this.advancedFiltersTextInputCaption.getValues()[0],n=this.advancedFiltersTextInputExpression.getValues()[0],o=this.advancedFiltersTabSelect.getValues();this.preferences[i]={caption:i,custom:!0,expression:n,tab:o,selected:!0},this.buildCheckboxesInput(),this.save(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.t,this.getActiveTab()),this.advancedFiltersTextInputCaption.reset(),this.advancedFiltersTextInputExpression.reset(),this.advancedFiltersTabSelect.reset(),this.advancedFiltersBuilder.appendTo(this.element),this.fromFilterToAnalyticsEvent(this.preferences[i],"saved"),this.queryController.executeQuery()},i.prototype.fromPreferencesToCheckboxInput=function(){var t=this;e._.each(this.getActiveFilters(),function(e){t.preferencePanelCheckboxInput.select(e.caption)}),e._.each(this.getInactiveFilters(),function(e){t.preferencePanelCheckboxInput.unselect(e.caption)}),e._.each(this.getDormantFilters(),function(e){t.preferencePanelCheckboxInput.select(e.caption)})},i.prototype.fromCheckboxInputToPreferences=function(){var t=this.preferencePanelCheckboxInput.getSelecteds();e._.each(this.preferences,function(i){i.selected=e._.contains(t,i.caption)?!0:!1})},i.prototype.getDormantFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return e.selected&&!t.filterIsInActiveTab(e,i)})},i.prototype.getActiveFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return e.selected&&t.filterIsInActiveTab(e,i)})},i.prototype.getInactiveFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return!e.selected||!t.filterIsInActiveTab(e,i)})},i.prototype.getActiveTab=function(){return this.queryStateModel.get(e.QueryStateModel.attributesEnum.t)},i.prototype.filterIsInActiveTab=function(t,i){return t.tab=e._.compact(t.tab),e._.contains(t.tab,i)||e.Utils.isEmptyArray(t.tab)},i.prototype.getFilterElementByCaption=function(e){return this.preferenceContainer.find("input[value='"+e+"']").parent()},i.prototype.fromResultsFilterOptionToResultsPreferenceInterface=function(t){void 0===t&&(t=this.options.filters);var i={};return e._.each(this.options.filters,function(e,t){i[t]={expression:e.expression,tab:e.tab,selected:!1,custom:!1,caption:t}}),i},i.prototype.mergeLocalPreferencesWithStaticPreferences=function(){var t=this.fromResultsFilterOptionToResultsPreferenceInterface(),i=this.preferencePanelLocalStorage.load(),n=e._.filter(i,function(i){var n=i.custom,o=e._.find(t,function(e){return e.caption==i.caption});return n||void 0!=o}),o={};e._.each(n,function(e){o[e.caption]={expression:e.expression,tab:e.tab,selected:e.selected,custom:e.custom,caption:e.caption}}),this.preferences=e.$.extend(!0,{},t,o)},i.prototype.fromFilterToAnalyticsEvent=function(t,i){this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.customfiltersChange,{customFilterName:t.caption,customFilterExpression:t.expression,customFilterType:i})},i.ID="ResultsFiltersPreferences",i.options={includeInBreadcrumb:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),showAdvancedFilters:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ResultsFiltersPreferences=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.preferencePanel=e.$(this.element).parents("."+e.Component.computeCssClassNameForType(e.PreferencesPanel.ID)),this.preferencePanelLocalStorage=new e.LocalStorageUtils(i.ID),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(window.localStorage),e.Assert.isLargerOrEqualsThan(1,this.preferencePanel.length),this.preferences=this.preferencePanelLocalStorage.load()||{},e.ComponentOptions.initComponentOptions(this.element,i,this.preferences),this.updateComponentOptionsModel(),this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.savePreferences,function(){return r.save()}),this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return r.exitWithoutSave()}),this.buildTitle(),this.buildCheckboxesInput()}return __extends(i,t),i.prototype.save=function(){this.fromCheckboxInputToPreferences(),this.logger.info("Saving preferences",this.preferences),this.preferencePanelLocalStorage.save(this.preferences),this.updateComponentOptionsModel()},i.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput()},i.prototype.updateComponentOptionsModel=function(){this.componentOptionsModel.set(e.ComponentOptionsModel.attributesEnum.resultLink,this.preferences)},i.prototype.buildTitle=function(){e.$(this.element).append(e.$("<div class='coveo-title'>"+e.l("LinkOpeningSettings")+"</div>"))},i.prototype.buildCheckboxesInput=function(){var t=this,n=[];this.options.enableOpenInOutlook&&n.push({label:e.l("OpenInOutlookWhenPossible")}),this.options.enableOpenInNewWindow&&n.push({label:e.l("AlwaysOpenInNewWindow")}),this.preferencePanelCheckboxInput=new e.PreferencesPanelCheckboxInput(n,i.ID);var o=e.$("<div class='coveo-choices-container'></div>");o.append(this.preferencePanelCheckboxInput.build()),o.find("input").change(function(e){t.fromPreferenceChangeEventToUsageAnalyticsLog(e),t.save(),t.queryController.executeQuery()}),e.$(this.element).append(o),this.fromPreferencesToCheckboxInput()},i.prototype.fromCheckboxInputToPreferences=function(){var t=this.preferencePanelCheckboxInput.getSelecteds();this.preferences={openInOutlook:!1,alwaysOpenInNewWindow:!1},e._.contains(t,e.l("OpenInOutlookWhenPossible"))&&(this.preferences.openInOutlook=!0),e._.contains(t,e.l("AlwaysOpenInNewWindow"))&&(this.preferences.alwaysOpenInNewWindow=!0)},i.prototype.fromPreferencesToCheckboxInput=function(){this.preferences.openInOutlook&&this.preferencePanelCheckboxInput.select(e.l("OpenInOutlookWhenPossible")),this.preferences.alwaysOpenInNewWindow&&this.preferencePanelCheckboxInput.select(e.l("AlwaysOpenInNewWindow"))},i.prototype.fromPreferenceChangeEventToUsageAnalyticsLog=function(t){var i=e.$(t.target).is(":checked")?"selected":"unselected",n=e.$(t.target).val();this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.preferencesChange,{preferenceName:n,preferenceType:i})},i.ID="ResultsPreferences",i.options={enableOpenInOutlook:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableOpenInNewWindow:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ResultsPreferences=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.os=a,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.options=e.$.extend({},this.options),this.result=r||this.resolveResult(),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(this.result),this.options.field||this.logger.error("You must specify a field to the ResultTagging component"),this.tags=e.Utils.getFieldValue(this.result,this.options.field)||[],this.tagZone=e.$("<div></div>").addClass("coveo-result-tagging-tag-zone").appendTo(e.$(n)),e.$(n).append(this.buildTagIcon()),this.autoCompleteZone=e.$("<div></div>").addClass("coveo-result-tagging-auto-complete-zone").appendTo(e.$(n)),e.$(this.autoCompleteZone).append(this.buildTextBox()),e.$(this.autoCompleteZone).append(this.buildAddIcon()),e.$(this.autoCompleteZone).append(this.buildClearIcon()),this.buildExistingTags()}return __extends(i,t),i.prototype.buildExistingTags=function(){var t=this;this.tags&&e._.each(this.tags,function(i){e.$(t.tagZone).append(t.buildTagValue(i))})},i.prototype.buildTagIcon=function(){var t=this,i=e.$("<div></div>").addClass("coveo-result-tagging-add-tag"),n=e.$("<span></span>").text(e.l("EnterTag")).addClass("coveo-result-tagging-add-tag-text");return i.append(e.$("<span></span>").addClass("coveo-result-tagging-add-tag-icon").click(function(){return setTimeout(e.$.proxy(t.focusOnTextBox,t),20)})),i.append(n),i.attr("title",e.l("EnterTag")),i},i.prototype.focusOnTextBox=function(){this.textBox.focus()},i.prototype.buildTagValue=function(t){var i=this,n=e.$("<div></div>").addClass("coveo-result-tagging-coveo-tag");this.buildShortenedTagWithTitle(t).appendTo(n);var o=e.$("<span></span>").addClass("coveo-result-tagging-delete-icon").appendTo(n);return o.click(function(){return i.doRemoveTag(n,t.toLowerCase())}),n},i.prototype.buildShortenedTagWithTitle=function(t){var i=e.StringUtils.removeMiddle(t,16,"..."),n=e.$("<a></a>").text(i).attr("title",t).attr("href","javascript:void;");return this.bindFacetEventOnValue(n,t),n},i.prototype.buildTextBox=function(){var t=this;return this.textBox=e.$("<input/>").attr("type","text").addClass("coveo-add-tag-textbox").attr("placeholder",e.l("EnterTag")),this.autoCompletePopup=e.$("<div></div>").addClass(i.AUTO_COMPLETE_CLASS).appendTo(e.$(this.autoCompleteZone)),this.manageAutocompleteAutoHide(),this.textBox.keyup(function(i){38==i.keyCode||40==i.keyCode||13==i.keyCode?t.manageUpDownEnter(i.keyCode):e.KeyboardUtils.isArrowKeyPushed(i.keyCode)||t.populateSuggestions(),e.$(t.element).removeClass("coveo-error")}),this.textBox.click(function(){t.populateSuggestions()}),this.textBox},i.prototype.buildAddIcon=function(){var t=this;return e.$("<div></div>").addClass("coveo-result-tagging-add-tag-tick-icon").append(e.$("<span></span>")).click(function(){return t.doAddTag()})},i.prototype.buildClearIcon=function(){var t=this;return e.$("<div></div>").addClass("coveo-result-tagging-clear-icon").append(e.$("<span></span>")).click(function(){return t.textBox.val("")})},i.prototype.bindFacetEventOnValue=function(t,i){var n=this,o=e.QueryStateModel.getFacetId(this.options.field),s=this.queryStateModel.get(o),r=this.componentStateModel.get(o),a=e._.filter(r,function(e){return!e.disabled}).length>0;null!=s&&a&&(e.$(t).on("click",function(){e._.contains(s,i)?n.queryStateModel.set(o,e._.without(s,i)):n.queryStateModel.set(o,e._.union(s,[i])),n.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.documentTag,{facetId:n.options.field,facetValue:i})}})}),e._.contains(s,i)&&e.$(t).addClass("coveo-selected"),e.$(t).addClass("coveo-clickable"))},i.prototype.clearPopup=function(){this.autoCompletePopup.hide(),this.autoCompletePopup.empty()},i.prototype.showPopup=function(){this.autoCompletePopup.show()},i.prototype.populateSuggestions=function(){var t=this;this.autoCompletePopup.width(this.textBox.innerWidth());{var i=this.queryController.getEndpoint(),n=this.textBox.val(),o={field:this.options.field,ignoreAccents:!0,sortCriteria:"occurences",maximumNumberOfValues:this.options.suggestBoxSize,queryOverride:"@sysuri",pattern:this.buildRegEx(n),patternType:"RegularExpression"};i.listFieldValues(o).done(function(i){t.clearPopup(),e._.each(i,function(e){t.autoCompletePopup.append(t.buildSelectableValue(e.lookupValue))}),t.showPopup()})}},i.prototype.manageAutocompleteAutoHide=function(){var t,n=this;this.textBox.on("mouseover",function(){window.clearTimeout(t)}),this.autoCompletePopup.mouseout(function(o){e.$(o.target).hasClass(i.AUTO_COMPLETE_CLASS)&&(t=window.setTimeout(e.$.proxy(n.clearPopup,n),n.options.autoCompleteTimer))}),this.autoCompletePopup.mouseenter(function(){window.clearTimeout(t)}),e.$(this.element).mouseenter(function(){n.clearPopup(),e.$(n.element).addClass("coveo-opened")}),e.$(this.element).closest(".CoveoResult").mouseleave(function(){n.clearPopup(),""==n.textBox.val()&&e.$(n.element).removeClass("coveo-opened")}),e.$(this.element).closest(".CoveoResult").focusout(function(t){""!=n.textBox.val()&&e.$(t.target).closest(".CoveoResult")!=e.$(n.element).closest(".CoveoResult")&&e.$(n.element).addClass("coveo-error")}),e.$(this.element).closest(".CoveoResult").focusin(function(){e.$(n.element).removeClass("coveo-error")})},i.prototype.buildRegEx=function(t){var i=this;return"(?=.*"+t+")"+e._.map(this.tags,function(e){return i.buildTermToExclude(e)}).join("")+".*"},i.prototype.buildTermToExclude=function(e){return"(?!^"+e+"$)"},i.prototype.manageUpDownEnter=function(t){var i=e.$(this.element).find(".coveo-selectable");if(13==t)return this.doAddTag(),void 0;if(i.length>0){var n=this.computeNextIndex(t,i);n=Math.max(0,n),n=Math.min(i.length-1,n);
var o=e.$(i.get(n));o.addClass("coveo-selected"),this.textBox.val(o.text())}},i.prototype.computeNextIndex=function(t,i){var n=0;return e._.each(i,function(i,o){e.$(i).hasClass("coveo-selected")&&(38==t?n=o-1:40==t&&(n=o+1),e.$(i).removeClass("coveo-selected"))}),n},i.prototype.buildSelectableValue=function(t){var i=this,n=e.$("<div></div>").append(this.buildShortenedTagWithTitle(t));return n.addClass("coveo-selectable"),n.click(function(){i.doAddTagWithValue(t)}),n},i.prototype.doRemoveTag=function(t,i){var n=this,o={fieldName:this.options.field,fieldValue:i,doAdd:!1,uniqueId:this.result.uniqueId},s=this.queryController.getEndpoint().tagDocument(o);s.done(function(){n.tags.splice(e.$.inArray(i,n.tags),1),t.remove()})},i.prototype.doAddTagWithValue=function(t){var i=this;e._.each(t.split(","),function(e){i.doAddSingleTagValue(e)})},i.prototype.doAddSingleTagValue=function(t){var i=this;if(this.clearPopup(),e.$.inArray(t,this.tags)>-1)return e.$(this.element).addClass("coveo-error"),void 0;this.tags.push(t);var n={fieldName:this.options.field,fieldValue:t,doAdd:!0,uniqueId:this.result.uniqueId},o=this.queryController.getEndpoint().tagDocument(n);o.done(function(){i.tagZone.append(i.buildTagValue(t)),i.textBox.val(""),e.$(i.element).removeClass("coveo-error")}).fail(function(){i.tags=e._.without(i.tags,e._.findWhere(i.tags,t))})},i.prototype.doAddTag=function(){var e=this.textBox.val().toLowerCase().trim();this.doAddTagWithValue(e)},i.ID="ResultTagging",i.options={field:e.ComponentOptions.buildFieldOption({match:function(e){return"Tag"==e.type},required:!0}),suggestBoxSize:e.ComponentOptions.buildNumberOption({defaultValue:5,min:0}),autoCompleteTimer:e.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0})},i.AUTO_COMPLETE_CLASS="coveo-result-tagging-auto-complete",i}(e.Component);e.ResultTagging=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bind.click(e.$(n),this.handleClick),""==e.$.trim(e.$(n).text())&&e.$("<span/>").text(e.l("Search")).addClass("coveo-icon").appendTo(n)}return __extends(i,t),i.prototype.handleClick=function(){var t=this;this.logger.debug("Performing query following button click"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})}})},i.ID="SearchButton",i}(e.Component);e.SearchButton=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,o,s),this.element=n,this.options=o,this.omniboxHeaderSearchForTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-omnibox-section coveo-omnibox-header'><div class='coveo-text'>"+e.l("SearchFor","<strong><%- data %></strong>")+"</div></div>"),this.omniboxIsOpen=!1,this.isLoadingData=!1,this.headerIsCurrentlyRendered=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(n).keyup(function(e){return r._handleKeyUp(e)}),this.renderOmniboxDiv(),this.omniboxDiv.hide(),this.prepareThrottledCall(),e.$("body").click(function(t){r.omniboxIsOpen&&!e.$.contains(r.omniboxDiv.get(0),e.$(t.target).get(0))&&r.close()});var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(a,e.$.proxy(this._handleQueryStateChanged,this)),e.$(window).on("resize",function(){r.omniboxIsOpen&&r.setWidthOnOmniboxDiv()})}return __extends(i,t),i.prototype.close=function(){this.wasClosed=!0,this.clearLastOmniboxRows(),e.$(this.root).trigger(e.OmniboxEvents.closeOmnibox),this.omniboxDiv&&(this.omniboxDiv.children().remove(),this.omniboxDiv.hide()),this.clearLastOmniboxRows(),e.Utils.isNullOrUndefined(this.lastOmniboxData)||this.rejectAllPendingDeferred(this.lastOmniboxData),this.resetOmniboxInternalData(),this.omniboxIsOpen=!1,this.removeSearchAnimation()},i.prototype.open=function(){this.wasClosed=!1,""!=e.$(this.element).val()?(this.throttledCallForOmniboxBody(),e.$(this.root).trigger(e.OmniboxEvents.openOmnibox)):this.close()},i.prototype.getDataForOmniboxBody=function(){if(this.addSearchAnimation(),this.isCurrentlyBeingRendered)this.throttledCallForOmniboxBody();else{var e=this.buildOmniboxRequestObject(),t=this.requestOmniboxData(e);this.processNewOmniboxData(t)}},i.prototype.buildOmniboxRequestObject=function(){var t=this,i=this.getCurrentQueryExpression(),n={completeQueryExpression:{word:e.$(this.element).val(),regex:this.getRegexToSearch()},currentQueryExpression:{word:i,regex:this.getRegexToSearch(i)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:e.$(this.element).getCursorPosition(),clear:function(){t.clear()},clearCurrentExpression:function(){t.clearCurrentExpression()},replace:function(e,i){t.replace(e,i)},replaceCurrentExpression:function(e){t.replaceCurrentExpression(e)},insertAt:function(e,i){t.insertAt(e,i)},closeOmnibox:function(){t.close()}};return n},i.prototype.prepareThrottledCall=function(){this.throttledCallForOmniboxBody=e.Utils.throttle(this.getDataForOmniboxBody,this.options.omniboxDelay,void 0,this)},i.prototype.requestOmniboxData=function(t){e.Assert.exists(t),this.logger.info("Requesting omnibox data to all components");var i=e.$.extend({rows:[]},t);return e.$(this.root).trigger(e.OmniboxEvents.populateOmnibox,i),i},i.prototype.getQueryExpressionBreakDown=function(){var t=this,i=[],n=e.$(this.element).val().split(" ");return e._.each(n,function(e){i.push({word:e,regex:t.getRegexToSearch(e)})}),i},i.prototype._handleNewQuery=function(e,i){t.prototype._handleNewQuery.call(this,e,i),this.omniboxIsOpen&&e.stopPropagation()},i.prototype._handleKeyUp=function(t){var i=this;t.stopImmediatePropagation();var n=e.$(this.element).val().length;!e.Utils.isNullOrUndefined(this.lastOmniboxData)&&!e.Utils.isNullOrUndefined(this.lastNumberOfLettersInOmnibox)&&Math.abs(n-this.lastNumberOfLettersInOmnibox)>this.options.omniboxChangeLimit&&(this.rejectAllPendingDeferred(this.lastOmniboxData),this.prepareThrottledCall()),e.KeyboardUtils.keysEqual(t,27)&&this.omniboxIsOpen?this.close():e.KeyboardUtils.keysEqual(t,13)?this.omniboxIsOpen?this.selectionEvent():(this.close(),this.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})})):e.KeyboardUtils.isArrowKeyPushed(t.keyCode)&&this.omniboxIsOpen?this.navigationEvent(t):e.KeyboardUtils.isAllowedKeyForOmnibox(t)&&(""==e.$(this.element).val()?this.close():this.open())},i.prototype._handleChange=function(e){return e.stopImmediatePropagation(),!1},i.prototype.handleHover=function(e){var t=this.getCorrectTarget(e);t&&this.toggleSelected(t)},i.prototype.bindHoverEvent=function(){var t=this;e.$(this.omniboxDiv).find(".coveo-omnibox-selectable").hover(function(e){t.handleHover(e)})},i.prototype.selectionEvent=function(){var t=this;this.isFirstValueSelected(this.findSelected())?(this.close(),this.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})})):this.keyBoardSelection()},i.prototype.navigationEvent=function(e){var t=this.findSelected();0==t.length?this.navigationEventWhenNoSelection(e):this.navigationEventWhenSelection(e,t)},i.prototype.navigationEventWhenNoSelection=function(t){e.KeyboardUtils.keysEqual(t,40)&&this.findSelectable().first().addClass("coveo-omnibox-selected")},i.prototype.navigationEventWhenSelection=function(e,t){if(!this.isLoadingData)switch(e.keyCode){case 38:this.isFirstValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueBeforeAlreadySelected(t));break;case 40:this.isLastValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueAfterAlreadySelected(t))}},i.prototype.keyBoardSelection=function(){this.logger.trace("Selecting facet value because of omnibox selection");var e=this.findSelected();e.trigger("keyboardSelect"),this.close()},i.prototype.triggerNewQuery=function(t){this.logger.info("Triggering new query because of omnibox selection"),this.close(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,e.$(this.element).val()),this.queryController.deferExecuteQuery({beforeExecuteQuery:t})},i.prototype.processNewOmniboxData=function(e){this.logger.trace("Processing omnibox data"),this.isCurrentlyBeingRendered=!0,this.numberOfPendingQueries=0,this.renderOmniboxBody(e),this.omniboxIsOpen=!0},i.prototype.renderHeader=function(){this.buildHeader(),this.setWidthOnOmniboxDiv(),this.omniboxDiv.show(),this.findSelectable().first().addClass("coveo-omnibox-selected"),this.headerIsCurrentlyRendered=!0},i.prototype.renderOmniboxDiv=function(){this.omniboxDiv=e.$("<div class='coveo-omnibox'></div>"),e.$(this.element).after(this.omniboxDiv)},i.prototype.setWidthOnOmniboxDiv=function(){this.omniboxDiv.width(this.getWidth())},i.prototype.buildHeader=function(){var t=this;void 0!=this.omniboxHeader&&this.omniboxHeader.remove(),this.omniboxHeader=e.$(this.omniboxHeaderSearchForTemplate({data:e.$(this.element).val()})),this.omniboxHeader.click(function(){t.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})})}),this.omniboxDiv.prepend(this.omniboxHeader)},i.prototype.renderOmniboxBody=function(t){var i=this;if(this.wasClosed)this.close();else{this.omniboxRows=[],this.lastOmniboxData=t,this.lastNumberOfLettersInOmnibox=e.$(this.element).val().length;var n=(e._.find(t.rows,function(t){return!e.Utils.isNullOrUndefined(t.element)}),e._.partition(t.rows,function(t){return e.Utils.isNullOrUndefined(t.deferred)}));e._.each(n[0],function(e){i.renderOmniboxForOneElement(e)}),this.numberOfPendingQueries=n[1].length,0==this.numberOfPendingQueries?this.allDeferredHaveArrived():e._.each(n[1],function(e){i.renderOmniboxForOneElementDeferred(e)}),setTimeout(function(){i.rejectAllPendingDeferred(t)},this.options.omniboxTimeout)}},i.prototype.rejectAllPendingDeferred=function(t){e._.each(t.rows,function(t){e.Utils.isNullOrUndefined(t.deferred)||t.deferred.reject()})},i.prototype.allDeferredHaveArrived=function(){this.appendOmniboxSections(),this.resetOmniboxInternalData(),this.removeSearchAnimation()},i.prototype.clearLastOmniboxRows=function(){void 0!=this.lastOmniboxRows&&e._.each(this.lastOmniboxRows,function(t){e.$(t.element).remove()})},i.prototype.appendOmniboxSections=function(){if(this.omniboxRows.length>0&&""!=e.$(this.element).val()){this.renderHeader(),this.clearLastOmniboxRows(),this.omniboxRows=e._.sortBy(this.omniboxRows,function(e){return e.zIndex}).reverse();for(var t=0;t<this.omniboxRows.length;t++)this.omniboxDiv.append(this.omniboxRows[t].element);this.bindHoverEvent(),this.resetOmniboxInternalData()}else this.close()},i.prototype.resetOmniboxInternalData=function(){this.lastOmniboxRows=this.omniboxRows,this.isCurrentlyBeingRendered=!1,this.headerIsCurrentlyRendered=!1},i.prototype.renderOmniboxForOneElement=function(t){var i=t.zIndex||-1;e.$(t.element).addClass("coveo-omnibox-section"),this.omniboxRows.push({zIndex:i,element:t.element})},i.prototype.renderOmniboxForOneElementDeferred=function(t){var i=this;t.deferred.done(function(t){i.headerIsCurrentlyRendered||void 0==t.element||i.renderHeader(),i.numberOfPendingQueries--,e.Utils.isNullOrUndefined(t.element)||i.renderOmniboxForOneElement(t),0==i.numberOfPendingQueries&&i.allDeferredHaveArrived()}),t.deferred.fail(function(){i.numberOfPendingQueries--,0==i.numberOfPendingQueries&&i.allDeferredHaveArrived()})},i.prototype.isFirstValueSelected=function(e){return e.get(0)==this.findSelectable().first().get(0)},i.prototype.isLastValueSelected=function(e){return e.get(0)==this.findSelectable().last().get(0)},i.prototype.unselectValueInOmnibox=function(e){e.removeClass("coveo-omnibox-selected")},i.prototype.selectValueBeforeAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)-1)).addClass("coveo-omnibox-selected")},i.prototype.selectValueAfterAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)+1)).addClass("coveo-omnibox-selected")},i.prototype.findPosOfAlreadySelected=function(t){var i=-1,n=this.findSelectable();return e._.find(n,function(e){return i++,e==t.get(0)}),i},i.prototype.findSelectable=function(){return this.omniboxDiv.find(".coveo-omnibox-selectable")},i.prototype.findSelected=function(){return this.findSelectable().closest(".coveo-omnibox-selected")},i.prototype.toggleSelected=function(e){this.omniboxDiv.find(".coveo-omnibox-selected").removeClass("coveo-omnibox-selected"),e.addClass("coveo-omnibox-selected")},i.prototype.getWidth=function(){var t=e.$(this.element);return t.outerWidth()+this.getSearchButtonWidth()},i.prototype.getSearchButtonWidth=function(){var t=e.$(this.element).closest("."+e.Component.computeCssClassNameForType(e.Searchbox.ID));if(0!=t.length){var i=t.coveo(e.Searchbox);if(i.searchButton&&"absolute"!=e.$(i.searchButton.element).css("position"))return e.$(i.searchButton.element).outerWidth()}return 0},i.prototype.getRegexToSearch=function(t){return void 0===t&&(t=e.$(this.element).val()),new RegExp(e.Utils.escapeRegexCharacter(t),"i")},i.prototype.getCorrectTarget=function(t){var i=e.$(t.target);return i.closest(".coveo-omnibox-selectable")},i.prototype.addSearchAnimation=function(){this._hideClearElement(),e.$(this.element).addClass("coveo-omnibox-loading"),this.isLoadingData=!0},i.prototype.removeSearchAnimation=function(){e.$(this.element).removeClass("coveo-omnibox-loading"),this._addClearElement(),this.isLoadingData=!1},i.ID="Omnibox",i.options={omniboxDelay:e.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),omniboxTimeout:e.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0}),omniboxChangeLimit:e.ComponentOptions.buildNumberOption({defaultValue:3,min:1}),omniboxMinimumLetters:e.ComponentOptions.buildNumberOption({defaultValue:1,min:1})},i.parent=e.Querybox,i}(e.Querybox);e.Omnibox=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.structure=e,this.onSelect=t}return t.prototype.buildOmniboxElement=function(t,i){var n;if(0!=t.length){n=e.$("<div></div>");var o=this.buildElementHeader();n.append(o);var s=this.buildRowElements(t,i);e._.each(s,function(e){n.append(e)})}return n},t.prototype.buildElementHeader=function(){return e.$(this.structure.header.template({headerTitle:this.structure.header.title}))},t.prototype.buildRowElements=function(t,i){var n=this,o=[];return e._.each(t,function(t){var s=e.$(n.structure.row({rawValue:t.value,data:e.JQueryUtils.highlightElement(t.value,i.completeQueryExpression.word)}));s.click(function(){n.onSelect.call(n,t.value,i)}),s.on("keyboardSelect",function(){n.onSelect.call(n,t.value,i)}),o.push(s)}),o},t}();e.SuggestionForOmnibox=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,o,s,i.ID),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.setupOptions(),this.bind.onRoot(e.OmniboxEvents.populateOmnibox,this.handlePopulateOmnibox),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleQueryOverride)}return __extends(i,t),i.prototype._buildResults=function(t){var i=this;if(this.lastOmniboxRequest){var n=e.$("<div></div>");n.append("<div class='coveo-omnibox-result-list-header'>              <span class='coveo-icon-omnibox-result-list'></span>               <span class='coveo-caption'>"+(this.options.headerTitle||e.l("SuggestedResults"))+"</span>         </div>"),e._.each(t.results,function(t){var o=i._instantiateTemplateForResult(t);e.$(o).addClass("coveo-omnibox-selectable").appendTo(n),e.$(o).on("keyboardSelect",function(){i.options.onSelect.call(i,t,e.$(o),i.lastOmniboxRequest.omniboxObject)}),i._autoCreateComponentsInsideResult(o,t),i._triggerNewResultDisplayed(t,o)}),this.lastOmniboxRequest.deferred.resolve({element:n.get(0),zIndex:this.options.omniboxZIndex})}},i.prototype.setupOptions=function(){this.logger.info("Disabling infinite scroll for OmniboxResultList",this),this.options.enableInfiniteScroll=!1,this.options.onSelect=this.options.onSelect||this.onRowSelection},i.prototype.handlePopulateOmnibox=function(t,i){var n=this,o=e.$.Deferred();i.rows.push({deferred:o}),this.lastOmniboxRequest={omniboxObject:i,deferred:o},this.queryController.executeQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchAsYouType(e.AnalyticsActionCauseList.searchboxSubmit,{})},searchAsYouType:!0})},i.prototype.handleQueryOverride=function(t,i){e.Assert.exists(i),e.Utils.isNonEmptyString(this.options.queryOverride)&&i.queryBuilder.constantExpression.add(this.options.queryOverride)},i.prototype.onRowSelection=function(t){this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentOpen,{},t,this.root),window.location.href=t.clickUri},i.ID="OmniboxResultList",i.options={omniboxZIndex:e.ComponentOptions.buildNumberOption({defaultValue:51,min:16}),headerTitle:e.ComponentOptions.buildStringOption(),queryOverride:e.ComponentOptions.buildStringOption()},i}(e.ResultList);e.OmniboxResultList=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.InitializationEvents.afterInitialization,e.$.proxy(this.init,this))}return __extends(i,t),i.prototype.init=function(){var t=this;this.menu=this.buildMenu(),e.$("<span/>").addClass("coveo-settings-icon").appendTo(this.element),e.$(this.element).click(function(){t.toggleMenu()}),this.settingsButton=e.$(this.element);var i;e.$([this.settingsButton[0],this.menu[0]]).mouseleave(function(){i=setTimeout(function(){t.menu.detach()},t.options.menuDelay)}).mouseenter(function(){clearTimeout(i)})},i.prototype.buildMenu=function(){var t=e.$("<div/>").addClass("coveo-settings-advanced-menu"),i=e._.map(this.options.includeInMenu,function(t){return e.$(t).coveo()});return t.append(this.buildSection(i)),t},i.prototype.buildSection=function(t){var i=this,n=e._.map(t,function(n){var o=e._.filter(t,function(t){return!e.Utils.objectEqual(t,n)});if(void 0!=n){var s=e.$("<div/>").addClass("coveo-settings-section").addClass(n.getCssClass());e.$("<div/>").addClass("coveo-icon").appendTo(s);var r=e.$("<div>").addClass("coveo-settings-items").appendTo(s);e._.each(n.getMenuItems(),function(t){var s=e._.filter(n.getMenuItems(),function(e){return e.text!=t.text});r.append(i.buildLine(t.text,t.onOpen,o,s,t.tooltip))})}return s});return e._.reduce(n,function(e,t){return e.add(t)},e.$())},i.prototype.buildLine=function(t,i,n,o,s){var r=this,a=o.concat(e._.compact(e._.flatten(e._.map(n,function(e){return e?e.getMenuItems():void 0}),!0))),l=e.$("<div/>").addClass("coveo-settings-item").text(t).click(function(){r.menu.detach(),i(),e._.invoke(a,"onClose")});return s&&l.prop("title",s),l},i.prototype.toggleMenu=function(){this.menu.is(":visible")?this.menu.detach():e.JQueryUtils.positionPopup(this.menu,e.$(this.element),e.$(this.root),e.$(this.root),this.getPopupPositioning())},i.prototype.getPopupPositioning=function(){return{horizontal:4,vertical:2,verticalOffset:8}},i.ID="Settings",i.options={includeInMenu:e.ComponentOptions.buildListOption({defaultValue:[]}),menuDelay:e.ComponentOptions.buildNumberOption({defaultValue:300,min:0})},i}(e.Component);e.Settings=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.dialogBoxContent=this.buildContent(),e.$(n).append(this.dialogBoxContent),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleProcessNewQueryResults,this))}return __extends(i,t),i.prototype.open=function(){e.$(this.element).addClass("coveo-share-query-opened")},i.prototype.close=function(){e.$(this.element).removeClass("coveo-share-query-opened")},i.prototype.getCssClass=function(){return"coveo-share-query"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("ShareQuery"),onOpen:function(){return t.open()},onClose:function(){return t.close()}}]},i.prototype.handleProcessNewQueryResults=function(t,i){e.Assert.exists(i),e.Assert.exists(i.results);var n=i.query;this.linkToThisQuery.val(window.location.href),this.completeQuery.val(e.$.trim(this.outputIfNotNull(n.q)+" "+this.outputIfNotNull(n.aq)+" "+this.outputIfNotNull(n.cq))),this.logger.trace("Received query results from new query",n)},i.prototype.outputIfNotNull=function(e){return e?"("+e+")":""},i.prototype.buildContent=function(){var t=this,i=e.$("<div/>").addClass("coveo-share-query-summary-info");i.append(e.$("<span/>").addClass("coveo-query-summary-info-title").text(e.l("ShareQuery")));var n=e.$("<div/>").addClass("coveo-share-query-summary-info-close").append("<span/>");n.click(function(){return t.close()}),i.append(n);var o=e.$("<div/>").addClass("coveo-share-query-summary-info-boxes");return this.linkToThisQuery=e.$("<input/>").attr("type","text").addClass("coveo-share-query-summary-info-input"),this.linkToThisQuery.click(function(){return t.linkToThisQuery.select()}),this.completeQuery=e.$("<input/>").attr("type","text").addClass("coveo-share-query-summary-info-input"),o.append(this.buildTextBoxWithLabel(e.l("Link")+":",this.linkToThisQuery)),o.append(this.buildTextBoxWithLabel(e.l("CompleteQuery")+":",this.completeQuery)),o.appendTo(i),e.Component.pointElementsToDummyForm(i),i},i.prototype.buildTextBoxWithLabel=function(t,i){var n=e.$("<span/>").addClass("coveo-share-query-summary-info-label").text(t);return e.$("<div/>").append(n).append(i)},i.create=function(t,n,o){return e.Assert.exists(t),new i(t,n,o)},i.ID="ShareQuery",i.options={},i}(e.Component);e.ShareQuery=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.isLargerOrEqualsThan(1,this.options.sortCriteria.length);var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne)+e.QueryStateModel.attributesEnum.sort;this.bind.onRoot(a,function(e,t){return r.handleQueryStateChanged(e,t)}),this.bind.onRoot(e.QueryEvents.querySuccess,function(e,t){return r.handleQuerySuccess(e,t)}),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.click(e.$(this.element),this.handleClick),e.Utils.isNonEmptyString(this.options.caption)&&e.$(this.element).text(this.options.caption),this.isToggle()&&e.$(this.element).append('<span class="coveo-icon" />'),this.updateAppearance()}return __extends(i,t),i.prototype.select=function(t,i){if(void 0===i&&(i=!1),t)this.currentCriteria=e._.find(this.options.sortCriteria,function(e){return e.direction==t});else if(e.Utils.exists(this.currentCriteria)){var n=e._.indexOf(this.options.sortCriteria,this.currentCriteria);e.Assert.check(n>=0),this.currentCriteria=this.options.sortCriteria[(n+1)%this.options.sortCriteria.length]}else this.currentCriteria=this.options.sortCriteria[0];this.queryStateModel.set(e.QueryStateModel.attributesEnum.sort,this.currentCriteria.toString(),{silent:i})},i.prototype.disable=function(){e.$(this.element).addClass("coveo-tab-disabled"),t.prototype.disable.call(this)},i.prototype.enable=function(){e.$(this.element).removeClass("coveo-tab-disabled"),t.prototype.enable.call(this)},i.prototype.getCurrentCriteria=function(){return this.currentCriteria},i.prototype.handleQueryStateChanged=function(){var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.sort);if(e.Utils.isNonEmptyString(t)){var i=e.SortCriteria.parse(t);this.currentCriteria=e._.find(this.options.sortCriteria,function(e){return i.equals(e)})}else this.currentCriteria=null;this.updateAppearance()},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.sort);(n==e.QueryStateModel.defaultAttributes.sort||this.isSelected())&&this.currentCriteria&&this.currentCriteria.putInQueryBuilder(i.queryBuilder)},i.prototype.handleQuerySuccess=function(t,i){0==i.results.results.length?e.$(this.element).hide():e.$(this.element).show()},i.prototype.handleClick=function(){var t=this,i=this.currentCriteria;this.select(),i!=this.currentCriteria&&this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.resultsSort,{resultsSortBy:t.currentCriteria.sort+t.currentCriteria.direction})}})},i.prototype.isToggle=function(){return this.options.sortCriteria.length>1},i.prototype.isSelected=function(){return e.Utils.exists(this.currentCriteria)},i.prototype.updateAppearance=function(){if(e.$(this.element).toggleClass("coveo-selected",this.isSelected()),this.isToggle()){var t=this.currentCriteria?this.currentCriteria.direction:this.options.sortCriteria[0].direction;e.$(this.element).toggleClass("coveo-ascending","ascending"==t)}},i.prototype.match=function(t){return e._.any(this.options.sortCriteria,function(e){return t==e.toString()})},i.ID="Sort",i.options={sortCriteria:e.ComponentOptions.buildCustomListOption(function(t){return e._.map(t,function(t){return e.SortCriteria.parse(t)})},{required:!0}),caption:e.ComponentOptions.buildLocalizedStringOption({required:!0})},i}(e.Component);e.Sort=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,i.ID),this.element=n,this.options=o,e.$(this.element).hide(),this.options.includeDemoSection&&this.buildAllDemo(),this.submit()}return __extends(i,t),i.prototype.getOrCreateContainerForDemo=function(){return this.demoContainer||(this.demoContainer=e.$("<div class='coveo-demo-section-container'></div>"),e.$(this.root).append(this.demoContainer)),this.demoContainer},i.prototype.buildAllDemo=function(){this.buildNewToCoveoSection(),this.buildDemoSection(),this.hideDemoSection()},i.prototype.buildDemoSection=function(){var t=this;this.demoCoveoSection=e.$("<div class='coveo-demo-section'></div>"),this.hideDemoSection();var i=e.$("<div class='coveo-demo-section-back-to-login'><span class='coveo-demo-section-arrow-backward'></span>"+e.l("GoBack")+"</div>");i.click(function(){t.hideDemoSection()});var n=e.$("<div class='coveo-demo-section-logo'></div>"),o=e.$("<div class='coveo-demo-section-explanation'>"+e.l("AppIntro")+"</div>"),s=e.$("<button class='coveo-demo-section-try-it'>"+e.l("TryDemo")+"</button>");s.click(function(){window.location.href="demo.html"});var r=e.$("<button class='coveo-demo-section-contact'>"+e.l("ContactUs")+"</button>");r.click(function(){window.open("http://www.coveo.com/company/contact-us","_system")}),this.demoCoveoSection.append(i,n,o,s,r),this.getOrCreateContainerForDemo().append(this.demoCoveoSection)},i.prototype.buildNewToCoveoSection=function(){var t=this;this.newToCoveoSection=e.$("<div class='coveo-new-to-coveo-section'><h2>"+e.l("NewToCoveo")+"</h2><h3>"+e.l("LetUsHelpGetStarted")+"</h3><span class='coveo-demo-section-arrow-forward'></span></div>"),this.newToCoveoSection.click(function(){return t.showDemoSection()}),e.DeviceUtils.isAndroid()&&(window.addEventListener("native.keyboardshow",function(i){var n=e.$(window).height()-i.keyboardHeight,o=e.$(":focus").get(0).getBoundingClientRect();if(o.top>n){var s=o.top-n+o.height;t.getOrCreateCombined().css("top","-"+s+"px")}}),window.addEventListener("native.keyboardhide",function(){t.getOrCreateCombined().css("top","0")})),this.getOrCreateCombined().append(this.newToCoveoSection)},i.prototype.showDemoSection=function(){this.getOrCreateContainerForDemo().addClass("coveo-active"),this.getOrCreateCombined().removeClass("coveo-active")},i.prototype.hideDemoSection=function(){this.getOrCreateContainerForDemo().removeClass("coveo-active"),this.getOrCreateCombined().addClass("coveo-active")},i.ID="StandaloneLogin",i.options={requirePageSettings:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),includeDemoSection:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Login);e.StandaloneLogin=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n){this.searchInterface=t,this.result=n,this.element=i.instantiateToElement(n),e.$(this.element).data("CoveoResult",n),e.Component.bindResultToElement(this.element,n)}return t.prototype.initialize=function(){var t=this.searchInterface.options,i={options:t,bindings:this.searchInterface.getBindings(),result:this.result};e.CoveoJQuery.automaticallyCreateComponentsInside(this.element,i)},t}();e.StandaloneResult=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){void 0===e&&(e=0),this.previewActive=!1,this.html=t,this.value=e}return t.prototype.getValue=function(){return this.value},t.prototype.getHTML=function(){return this.html},t.prototype.setValue=function(e){this.value=e},t.prototype.setHTML=function(e){this.html=e},t.prototype.addPreview=function(t,i){this.previewActive=!0;var n=e.$('<div class="matrix-results-preview-container"></div>');n.css("min-width",t),n.css("max-width",i),n.click(function(e){e.stopPropagation()}),e.$(this.html).append(n),e.$(this.html).children(".matrix-results-preview-container").hide()},t.prototype.removePreview=function(){this.previewActive=!1,e.$(this.html).find(".matrix-results-preview-container").remove()},t.prototype.updatePreview=function(t){if(this.previewActive){var i=e.$(this.html).find(".matrix-results-preview-container");i.append(t),i.show()}},t}();e.Cell=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,i){t.call(this),this.computedField=e,this.format=i}return __extends(i,t),i.prototype.instantiateToString=function(e){var t='<div class="coveo-result-frame"><div class="coveo-result-row"><div class="coveo-result-cell" style="width: 20px; padding-right:5px"><a class="CoveoIcon"></a></div><div class="coveo-result-cell" style="font-size:13px"><a class="CoveoResultLink"></a></div><div class="coveo-result-cell" style="width:80px; text-align:right; font-size:13px; padding-right: 5px; padding-left: 5px">'+Globalize.format(parseInt(e.raw[this.computedField.slice(1)]),this.format)+"</div></div></div>";return t},i.prototype.instantiateToElement=function(t){return e.$(this.instantiateToString(t)).get(0)},i}(e.Template);e.DefaultMatrixResultPreviewTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.groupByIndex=[],this.rowId="",this.columnId="",this.selectedRowValue=void 0,this.selectedColumnValue=void 0,this.numberOfRows=0,this.numberOfColumns=0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.options.previewTemplate||(this.options.previewTemplate=new e.DefaultMatrixResultPreviewTemplate(this.options.computedField,this.options.computedFieldFormat)),this.options.previewSortField||(this.options.previewSortField=this.options.computedField),this.options.columnFieldValues.length!=this.options.columnLabels.length&&(this.options.columnLabels=this.options.columnFieldValues),this.buildMatrix(),null==this.options.rowField?this.logger.error('"rowField" option is required in the Matrix component'):null==this.options.columnField?this.logger.error('"columnField" option is required in the Matrix component'):null==this.options.computedField?this.logger.error('"computedField" option is required in the Matrix component'):(this.bindEvents(),this.initQueryState())}return __extends(i,t),i.prototype.bindEvents=function(){this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.doneBuildingQuery,this.handleDoneBuildingQuery),this.bind.onRoot(e.QueryEvents.deferredQuerySuccess,this.handleDeferredQuerySuccess)
},i.prototype.initQueryState=function(){this.rowId=e.QueryStateModel.getFacetId(this.options.rowField),this.columnId=e.QueryStateModel.getFacetId(this.options.columnField),this.queryStateModel.registerNewAttribute(this.rowId,[]),this.queryStateModel.registerNewAttribute(this.columnId,[])},i.prototype.buildMatrix=function(){this.buildTitle(),this.buildBody(),this.data=new Array,this.addHeaderRow()},i.prototype.buildTitle=function(){var t=this.options.title?this.options.title:"",i="<div class=coveo-matrix-title>"+t+"</div>";e.$(this.element).append(i)},i.prototype.buildBody=function(){var t="<div class='coveo-matrix'></div>";e.$(this.element).append(t)},i.prototype.handleBuildingQuery=function(e,t){this.areFacetsPresent()||(this.selectedRowValue&&!this.isRowFacetPresent()&&t.queryBuilder.advancedExpression.addFieldExpression(this.options.rowField,"=",[this.selectedRowValue]),this.selectedColumnValue&&!this.isColumnFacetPresent()&&t.queryBuilder.advancedExpression.addFieldExpression(this.options.columnField,"=",[this.selectedColumnValue]))},i.prototype.handleDoneBuildingQuery=function(e,t){this.addMainGroubByRequest(t.queryBuilder),this.addColumnsGroupByRequests(t.queryBuilder)},i.prototype.addMainGroubByRequest=function(e){var t={field:this.options.rowField,sortCriteria:this.options.sortCriteria,computedFields:this.getComputedFields(),maximumNumberOfValues:this.options.maximumNumberOfRows};this.groupByIndex.push(e.groupByRequests.length),e.groupByRequests.push(t)},i.prototype.addColumnsGroupByRequests=function(e){for(var t=0;t<this.options.columnFieldValues.length;t++){var i={field:this.options.rowField,sortCriteria:this.options.sortCriteria,computedFields:this.getComputedFields(),queryOverride:"("+this.buildExpression(e)+")("+this.options.columnField+"='"+this.options.columnFieldValues[t]+"')",maximumNumberOfValues:this.options.maximumNumberOfValuesInGroupBy};this.groupByIndex.push(e.groupByRequests.length),e.groupByRequests.push(i)}},i.prototype.buildExpression=function(e){var t=e.expression.build(),i=e.advancedExpression.build(),n=e.constantExpression.build(),o="";return t&&(o+=" "+t),i&&(o+=" "+i),n&&(o+=" "+n),o},i.prototype.getComputedFields=function(){var e=[{field:this.options.computedField,operation:this.options.computedFieldOperation}];return e},i.prototype.handleDeferredQuerySuccess=function(e,t){this.reset(),this.parseResults(t.results),this.addTotals(),this.drawMatrix(),this.formatCells(),this.selectedRowValue=void 0,this.selectedColumnValue=void 0},i.prototype.getCellResult=function(e,t,i){for(var n=this.getRowValue(t),o=this.getColumnValue(i),s=0,r=0;r<e.values.length;r++)if(e.values[r].value===n){s=e.values[r].computedFieldResults[0];break}return this.isAColumnSelected()&&!this.isColumnSelected(o)&&(s=0),s},i.prototype.addTotals=function(){this.options.enableRowTotals&&this.addRowTotals(),this.options.enableColumnTotals&&this.addColumnTotals()},i.prototype.addRowTotals=function(){var e=this;this.addColumn("<div class='coveo-matrix-cell matrix-total-column'></div>"),this.setValue("Total",0,this.numberOfColumns-1);for(var t=1;t<this.numberOfRows;t++){var i=this.computeRowTotal(t);this.setValue(i,t,this.numberOfColumns-1)}"ComputedFieldDescending"==this.options.sortCriteria&&this.data.sort(function(t,i){return i[e.numberOfColumns-1].getValue()-t[e.numberOfColumns-1].getValue()}),"ComputedFieldAscending"==this.options.sortCriteria&&this.data.sort(function(t,i){return t[e.numberOfColumns-1].getValue()-i[e.numberOfColumns-1].getValue()})},i.prototype.addColumnTotals=function(){this.addRow(),this.setValue("Total",this.numberOfRows-1,0);for(var e=1;e<this.numberOfColumns;e++){var t=this.computeColumnTotal(e);this.setValue(t,this.numberOfRows-1,e)}},i.prototype.computeRowTotal=function(e){for(var t=0,i=1;i<this.numberOfColumns-1;i++)t+=parseInt(this.getCellValue(e,i));return t},i.prototype.computeColumnTotal=function(e){for(var t=0,i=1;i<this.numberOfRows-1;i++)t+=parseInt(this.getCellValue(i,e));return t},i.prototype.formatCells=function(){for(var e=1;e<this.numberOfRows;e++)for(var t=1;t<this.numberOfColumns;t++){var i=this.getCellValue(e,t);i=Globalize.format(parseInt(i),this.options.computedFieldFormat),this.setValue(i,e,t)}},i.prototype.addHeaderRow=function(){this.addRow(),this.addColumn(),this.setValue(this.options.columnHeader,0,0);for(var e=0;e<this.options.columnLabels.length;e++)this.addColumn(),this.setValue(this.options.columnLabels[e],0,e+1)},i.prototype.addRow=function(){this.data.push(new Array);for(var e=0;e<this.numberOfColumns;e++)this.addCellToRow(this.numberOfRows,e);this.numberOfRows++},i.prototype.addColumn=function(e){void 0===e&&(e="<div class='coveo-matrix-cell'></div>");for(var t=0;t<this.numberOfRows;t++)this.addCellToRow(t,this.numberOfColumns);this.numberOfColumns++},i.prototype.addCellToRow=function(t,i){var n=e.$("<div class='coveo-matrix-cell'></div>");0==i&&n.addClass("matrix-first-column"),this.data[t].push(new e.Cell(0,n.get(0)))},i.prototype.setValue=function(e,t,i){var n=this.getCell(t,i);n.text(e),this.isCellSelected(this.getRowValue(t),this.getColumnValue(i))&&n.addClass("matrix-selected"),this.isAColumnSelected()&&!this.isColumnSelected(this.getColumnValue(i))&&0!=i&&0!=t&&n.addClass("matrix-unimportant"),this.data[t][i].setValue(e)},i.prototype.getCell=function(t,i){return e.$(this.data[t][i].getHTML())},i.prototype.getCellValue=function(e,t){var i=this.getCell(e,t);return i.text()},i.prototype.handleClick=function(e,t){if(0!==e&&e!==this.numberOfRows-1)var i=this.getRowValue(e);if(0!==t&&t!==this.numberOfColumns-1)var n=this.getColumnValue(t);i&&this.isRowFacetPresent()?this.queryStateModel.set(this.rowId,[i]):(this.selectedRowValue=i,this.queryStateModel.set(this.rowId,[])),n&&this.isColumnFacetPresent()?this.queryStateModel.set(this.columnId,[n]):(this.selectedColumnValue=n,this.queryStateModel.set(this.columnId,[])),this.queryController.deferExecuteQuery()},i.prototype.getRowValue=function(e){return this.data[e][0].getValue()},i.prototype.getColumnValue=function(e){return this.options.columnFieldValues[e-1]},i.prototype.isAColumnSelected=function(){var e=this.queryStateModel.get(this.columnId)||[];return 0!==e.length||void 0!=this.selectedColumnValue},i.prototype.isColumnSelected=function(e){if(this.isAColumnSelected()&&e)for(var t=this.queryStateModel.attributes[this.columnId]||[],i=0;i<t.length;i++)if(t[i].toLowerCase()===e.toLowerCase())return!0;return this.selectedColumnValue==e},i.prototype.isARowSelected=function(){var e=this.queryStateModel.get(this.rowId)||[];return 0!==e.length||void 0!==this.selectedRowValue},i.prototype.isRowSelected=function(e){if(this.isARowSelected()&&e)for(var t=this.queryStateModel.get(this.rowId)||[],i=0;i<t.length;i++)if(t[i].toLowerCase()===e.toLowerCase())return!0;return this.selectedRowValue==e},i.prototype.isCellSelected=function(e,t){return this.isAColumnSelected()&&this.isARowSelected()?this.isRowSelected(e)&&this.isColumnSelected(t):this.isAColumnSelected()?this.isColumnSelected(t):!1},i.prototype.areFacetsPresent=function(){return this.isRowFacetPresent()&&this.isColumnFacetPresent()},i.prototype.isRowFacetPresent=function(){var e=this.componentStateModel.get(this.rowId);return e&&!e[0].disabled},i.prototype.isColumnFacetPresent=function(){var e=this.componentStateModel.get(this.columnId);return e&&!e[0].disabled},i.prototype.reset=function(){e.$(this.element).html(""),this.numberOfRows=0,this.numberOfColumns=0,this.data=new Array,this.buildMatrix()},i.prototype.parseResults=function(e){for(var t=e.groupByResults[this.groupByIndex[0]],i=0;i<t.values.length;i++){var n=t.values[i].value;this.addRow(),this.setValue(n,i+1,0)}for(var i=1;i<this.numberOfRows;i++)for(var o=1;o<this.numberOfColumns;o++){var s=e.groupByResults[this.groupByIndex[o]],r=this.getCellResult(s,i,o);this.setValue(r,i,o)}},i.prototype.drawMatrix=function(){var t=e.$("<div class='coveo-matrix-row matrix-header-row'></div>");this.drawRow(t,0);for(var i=this.options.enableColumnTotals?this.numberOfRows-1:this.numberOfRows,n=1;i>n;n++){var o=e.$("<div class='coveo-matrix-row'></div>");this.drawRow(o,n)}if(this.options.enableColumnTotals){var s=e.$("<div class='coveo-matrix-row matrix-total-row'></div>");this.drawRow(s,this.numberOfRows-1)}""!==this.options.cellFontSize&&e.$(".coveo-matrix-cell").css("font-size",this.options.cellFontSize)},i.prototype.drawRow=function(t,i){for(var n=e.$(this.element).find(".coveo-matrix"),o=0;o<this.numberOfColumns;o++){var s=this.data[i][o].getHTML();e.$(s).click(e.$.proxy(this.handleClick,this,i,o)),this.options.enableHoverPreview&&e.$(s).hover(e.$.proxy(this.handleHoverIn,this,i,o),e.$.proxy(this.handleHoverOut,this,i,o)),t.append(s)}n.append(t)},i.prototype.handleHoverIn=function(e,t){var i=this;this.isHoverWorkingOnRow(e)&&this.isHoverWorkingOnColumn(t)&&(this.previewTimeout=setTimeout(function(){i.displayResultsPreview(e,t)},this.options.previewDelay))},i.prototype.handleHoverOut=function(e,t){clearTimeout(this.previewTimeout);var i=this.data[e][t];i.removePreview()},i.prototype.displayResultsPreview=function(t,i){var n=this,o=this.createPreviewQuery(t,i),s=this.data[t][i];s.addPreview(this.options.previewMinWidth,this.options.previewMaxWidth);var r=this.queryController.getEndpoint();r.search(o).done(e.$.proxy(function(o){if(n.isDataAvailable(t,i)){for(var s=n.data[t][i],r=[],a=0;a<o.results.length;a++)r.push(n.instanciateTemplate(o.results[a]));var l="";e._.each(r,function(e){l+=e.outerHTML}),s.updatePreview(l)}},this))},i.prototype.instanciateTemplate=function(t){var i=this.options.previewTemplate.instantiateToElement(t,!1),n=(this.searchInterface.options.originalOptionsObject,{options:this.options,bindings:this.getBindings(),result:t});return e.CoveoJQuery.automaticallyCreateComponentsInside(i,n),i},i.prototype.createPreviewQuery=function(t,i){var n="("+e.QueryUtils.buildFieldExpression(this.options.rowField,"=",[this.getRowValue(t)])+")",o="("+e.QueryUtils.buildFieldExpression(this.options.columnField,"=",[this.getColumnValue(i)])+")",s=this.queryController.getLastQuery();return s.aq=n,s.aq+=o,s.sortCriteria=this.options.previewSortCriteria,s.sortField=this.options.previewSortField,s},i.prototype.isHoverWorkingOnRow=function(e){return this.options.enableColumnTotals?0!==e&&e!==this.numberOfRows-1:0!==e},i.prototype.isHoverWorkingOnColumn=function(e){return this.options.enableRowTotals?0!==e&&e!==this.numberOfColumns-1:0!==e},i.prototype.isDataAvailable=function(e,t){return void 0!==this.data[e]&&void 0!==this.data[e][t]},i.ID="Matrix",i.options={title:e.ComponentOptions.buildStringOption(),rowField:e.ComponentOptions.buildFieldOption({required:!0}),sortCriteria:e.ComponentOptions.buildStringOption({defaultValue:"ComputedFieldDescending"}),maximumNumberOfRows:e.ComponentOptions.buildNumberOption({defaultValue:10,min:0}),enableRowTotals:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),columnField:e.ComponentOptions.buildFieldOption({required:!0}),columnFieldValues:e.ComponentOptions.buildListOption({defaultValue:[]}),columnLabels:e.ComponentOptions.buildListOption({defaultValue:[]}),columnHeader:e.ComponentOptions.buildStringOption(),maximumNumberOfValuesInGroupBy:e.ComponentOptions.buildNumberOption({defaultValue:100,min:0}),enableColumnTotals:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),computedField:e.ComponentOptions.buildFieldOption({required:!0}),computedFieldOperation:e.ComponentOptions.buildStringOption({defaultValue:"sum"}),computedFieldFormat:e.ComponentOptions.buildStringOption({defaultValue:"c0"}),cellFontSize:e.ComponentOptions.buildStringOption({defaultValue:""}),enableHoverPreview:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),previewSortCriteria:e.ComponentOptions.buildStringOption({defaultValue:"FieldDescending"}),previewSortField:e.ComponentOptions.buildFieldOption(),previewMaxWidth:e.ComponentOptions.buildStringOption({defaultValue:"300px"}),previewMinWidth:e.ComponentOptions.buildStringOption({defaultValue:"0"}),previewDelay:e.ComponentOptions.buildNumberOption({defaultValue:500}),previewTemplate:e.ComponentOptions.buildTemplateOption()},i}(e.Component);e.Matrix=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.options=o,this.menuIsOpen=!1,this.menuItemsContainerTemplate=e._.template("<div class='coveo-menu-item-container'></div>"),this.activeMenuItemTemplate=e._.template("<a class='coveo-menu-item-active'><%= itemIcon %><%= caption %><%= showMoreIcon %> </a>"),this.activeMenuItemIconTemplate=e._.template("<span class='coveo-icon <%= _class %>'></span>"),this.activeMenuItemCaptionTemplate=e._.template("<span class='coveo-caption'><%= text %></span>"),this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.initQueryStateEvents(),this.initMiscEvents()}return __extends(i,t),i.prototype.open=function(){this.renderMenu(),this.menuItemsContainer.css("min-width",this.activeMenuItemDisplay.outerWidth()),this.menuItemsContainer.show(),this.activeMenuItemDisplay.addClass("coveo-menu-open"),this.menuIsOpen=!0},i.prototype.close=function(){this.menuItemsContainer.hide(),this.activeMenuItemDisplay.removeClass("coveo-menu-open"),this.menuIsOpen=!1},i.prototype.handleClick=function(e){this.targetIsAMenuItem(e)?this.handleClickOnMenuItem(e):this.handleClickOnMenu()},i.prototype.handleClickOnMenuItem=function(t){var i=e.Component.get(this.getCorrectTarget(t).get(0),e.TabGroup);this.selectMenuItem(this.getItemInMenuById(i.getId())),this.close(),this.queryController.deferExecuteQuery()},i.prototype.handleClickOnMenu=function(){this.menuIsOpen?this.close():this.open()},i.prototype.handleMouseLeave=function(){this.close()},i.prototype.handleAfterInitialization=function(){this.initMenuItems();var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.tg);this.selectMenuItem(this.getItemInMenuById(t))},i.prototype.handleQueryStateChange=function(t,i){e.Assert.exists(i),this.selectMenuItem(this.getItemInMenuById(i.value))},i.prototype.initMenuItems=function(){var t=this;this.menuItemsContainer=e.$(this.menuItemsContainerTemplate()).hide(),this.activeMenuItemDisplay=e.$("<div></div>"),e.$(this.element).append(this.activeMenuItemDisplay,this.menuItemsContainer),this.menuItems=e._.map(e.$(this.element).find("."+e.Component.computeCssClassNameForType(e.TabGroup.ID)),function(i){return t.menuItemsContainer.append(i),{tabGroup:e.$(i).coveo(),element:e.$(i)}})},i.prototype.initQueryStateEvents=function(){var t=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.tg);e.$(this.root).on(t,e.$.proxy(this.handleQueryStateChange,this))},i.prototype.initMiscEvents=function(){var t=this;e.$(this.root).on(e.InitializationEvents.afterInitialization,function(){return t.handleAfterInitialization()}),e.$(this.element).click(function(e){t.handleClick(e)}),e.$(this.element).mouseleave(function(e){setTimeout(function(){t.handleMouseLeave(e)},t.options.menuDelay)})},i.prototype.renderDisplayActiveMenuItem=function(){this.activeMenuItemDisplay.empty(),this.activeMenuItemDisplay.html(this.activeMenuItemTemplate({itemIcon:this.activeMenuItemIconTemplate({_class:this.activeMenuItem.tabGroup.getIcon()}),caption:this.activeMenuItemCaptionTemplate({text:this.activeMenuItem.tabGroup.getTitle()}),showMoreIcon:this.activeMenuItemIconTemplate({_class:"coveo-show-more"})}))},i.prototype.renderMenu=function(){e._.each(this.getInactiveMenuItems(),function(e){e.element.show()}),this.activeMenuItem.element.hide()},i.prototype.selectMenuItem=function(e){void 0!=this.menuItems&&(void 0==e&&(e=this.menuItems[0]),this.activeMenuItem=e,this.activeMenuItem.tabGroup.select(),this.renderDisplayActiveMenuItem())},i.prototype.getItemInMenuById=function(t){return e._.find(this.menuItems,function(e){return e.tabGroup.getId()==t})},i.prototype.getItemInMenuByElement=function(t){return e._.find(this.menuItems,function(i){return e.Utils.objectEqual(t,i.element)})},i.prototype.getInactiveMenuItems=function(){var t=this;return e._.reject(this.menuItems,function(i){return e.Utils.objectEqual(i,t.activeMenuItem)})},i.prototype.getItemMenuClass=function(){return e.Component.computeCssClassNameForType(e.TabGroup.ID)},i.prototype.getCorrectTarget=function(t){return e.$(t.target).parent().hasClass(this.getItemMenuClass())?e.$(t.target).parent():e.$(t.target)},i.prototype.targetIsAMenuItem=function(e){return this.getCorrectTarget(e).hasClass(this.getItemMenuClass())},i.ID="TabGroupMenu",i.options={menuDelay:e.ComponentOptions.buildNumberOption({defaultValue:300,min:0})},i}(e.Component);e.TabGroupMenu=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.options=o,this.isSelected=!1,this.iconTemplate=e._.template("<span class='coveo-icon <%= _class %>'></span>"),this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.title=e.$(this.element).text(),this.initQueryEvents(),this.initQueryStateEvents(),e.$(this.element).prepend(this.iconTemplate({_class:this.options.icon}))}return __extends(i,t),i.prototype.select=function(){this.actionOnSelect(),this.updateQueryStateModel()},i.prototype.getTitle=function(){return this.title},i.prototype.getIcon=function(){return this.options.icon},i.prototype.getId=function(){return this.options.id},i.prototype.actionOnSelect=function(){this.hideTabsNotInThisGroup(),this.isSelected=!0},i.prototype.actionOnUnSelect=function(){this.isSelected=!1},i.prototype.updateQueryStateModel=function(){this.queryStateModel.set(e.QueryStateModel.attributesEnum.tg,this.options.id)},i.prototype.initQueryEvents=function(){e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQueryEvents,this))},i.prototype.initQueryStateEvents=function(){var t=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.tg);e.$(this.root).on(t,e.$.proxy(this.handleQueryStateChange,this))},i.prototype.handleBuildingQueryEvents=function(t,i){e.Assert.exists(i),this.isSelected&&e.Utils.isNonEmptyString(this.options.expression)&&i.queryBuilder.advancedExpression.add(this.options.expression)},i.prototype.handleQueryStateChange=function(t,i){e.Assert.exists(i),i.value==this.options.id?this.actionOnSelect():this.actionOnUnSelect()},i.prototype.hideTabsNotInThisGroup=function(){var t=this,i=this.getAllTabs();e._.each(i,function(e){t.isElementIncludedInTabGroup(e.element)?e.enable():e.disable()})},i.prototype.getAllVisibleTab=function(){return e._.filter(this.getAllTabs(),function(t){return e.$(t.element).is(":visible")})},i.prototype.getAllTabs=function(){return this.searchInterface.components(e.Tab.ID)},i.prototype.isElementIncludedInTabGroup=function(t){var i=e.$(t).attr("data-tab-group");return void 0==i||e._.contains(i.split(","),this.options.id)},i.ID="TabGroup",i.options={id:e.ComponentOptions.buildStringOption(),icon:e.ComponentOptions.buildIconOption(),expression:e.ComponentOptions.buildStringOption()},i}(e.Component);e.TabGroup=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),e.Assert.exists(this.result),null!=this.options.condition){var a=new Function("obj","with(obj||{}){return "+this.options.condition+"}");a(this.result)&&this.initialize()}else this.initialize()}return __extends(i,t),i.prototype.initialize=function(){var t=this;if(null!=this.options.template){var n=this.searchInterface.options,o={options:n,bindings:this.bindings,result:this.result},s=e.$(this.element).parents("."+e.Component.computeCssClassNameForType(i.ID));e._.each(s,function(i){var n=e.$(i).clone().children().remove().end().get(0).outerHTML;e.Assert.check(-1===n.indexOf(t.element.outerHTML),"TemplateLoader cannot load a template into itself.")}),this.element.innerHTML=this.options.template.instantiateToString(this.result,!1),e.CoveoJQuery.automaticallyCreateComponentsInside(this.element,o)}},i.ID="TemplateLoader",i.options={template:e.ComponentOptions.buildTemplateOption(),condition:e.ComponentOptions.buildStringOption()},i}(e.Component);e.TemplateLoader=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.classToToggle=this.options.toggleClass,this.target=this.options.target,this.activateGlass=this.options.activateGlass,this.activateGlass&&this.buildGlass(),e.$(n).click(function(){return r.handleClick()}),"A"==n.tagName&&e.$(n).attr("href","javascript:");var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);this.bind.onRoot(a,this.handleTabChanged)}return __extends(i,t),i.prototype.handleClick=function(){e.$("."+this.target).hasClass(this.classToToggle)?this.removeToggleClass():this.addToggleClass()},i.prototype.handleTabChanged=function(){this.removeToggleClass()},i.prototype.addToggleClass=function(){e.MobileUtils.addToggleClassOnSearchInterface(this.classToToggle.substr(6),e.DeviceUtils.isPhonegap())},i.prototype.removeToggleClass=function(){e.MobileUtils.removeToggleClassOnSearchInterface(e.DeviceUtils.isPhonegap())},i.prototype.getGlass=function(){return e.$(".coveo-glass")},i.prototype.buildGlass=function(){if(0==this.getGlass().length){var t=e.$("<div></div>").addClass("coveo-glass");t.click(function(){e.MobileUtils.removeToggleClassOnSearchInterface()});var i=e.$("."+e.Component.computeCssClassNameForType(e.SearchInterface.ID));e.$(i).append(t)}},i.ID="ToggleButton",i.options={toggleClass:e.ComponentOptions.buildStringOption(),target:e.ComponentOptions.buildStringOption(),activateGlass:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ToggleButton=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.options=o,this.partialQueries=[],this.lastSuggestions=[],this.topAnalyticsElementHeaderTemplate=e._.template("<div class='coveo-top-analytics-suggestion-header'>          <span class='coveo-icon-top-analytics'></span>           <span class='coveo-caption'><%= headerTitle %></span>         </div>"),this.topAnalyticsElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-analytics-suggestion-row'>           <%= data %>         </div>"),this.resultsToBuildWith=[],"omniboxSuggestionOptions"in this.options&&(this.options=e._.extend(this.options,this.options.omniboxSuggestionOptions)),e.ComponentOptions.initComponentOptions(n,i,this.options),this.options.onSelect=this.options.onSelect||this.onRowSelection;var a={header:{template:this.topAnalyticsElementHeaderTemplate,title:this.options.headerTitle},row:this.topAnalyticsElementRowTemplate};this.suggestionForOmnibox=new e.SuggestionForOmnibox(a,e.$.proxy(this.options.onSelect,this)),e.$(this.root).on(e.OmniboxEvents.populateOmnibox,e.$.proxy(this.handlePopulateOmnibox,this)),this.bind.onRoot(e.QueryEvents.querySuccess,function(){return r.partialQueries=[]})}return __extends(i,t),i.prototype.handlePopulateOmnibox=function(t,i){var n=this;if(e.Assert.exists(i),!this.disabled){var o=e.$.Deferred(),s=this.usageAnalytics.getTopQueries({pageSize:this.options.numberOfSuggestions,queryText:i.completeQueryExpression.word});s.done(function(t){n.resultsToBuildWith=e._.map(t,function(e){return{value:e}}),n.lastSuggestions=t,e._.isEmpty(n.resultsToBuildWith)||""==i.completeQueryExpression.word||n.partialQueries.push(i.completeQueryExpression.word);var s=n.suggestionForOmnibox.buildOmniboxElement(n.resultsToBuildWith,i);o.resolve({element:void 0==s?void 0:s.get(0),zIndex:n.options.omniboxZIndex})}),s.fail(function(){n.resolveWithUndefined(o)}),i.rows.push({deferred:o})}},i.prototype.onRowSelection=function(t,i){var n=this;i.clear(),i.closeOmnibox(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){n.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.omniboxAnalytics,{partialQueries:n.cleanCustomData(n.partialQueries),suggestionRanking:e._.indexOf(e._.pluck(n.resultsToBuildWith,"value"),t),suggestions:n.cleanCustomData(n.lastSuggestions),partialQuery:i.completeQueryExpression.word})}})},i.prototype.cleanCustomData=function(t,i){void 0===i&&(i=256),t=e._.filter(t,function(e,t,i){return 0===t||e!==i[t-1]}),t=e._.map(t,function(e){return e.replace(/;/g,"")});var n=[];e._.reduceRight(t,function(e,t){var o=e+t.length;return i>=o&&n.push(t),o},0),t=n.reverse();var o=t.join(";");return o.length>=256?this.cleanCustomData(t,i-10):t.join(";")},i.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},i.ID="AnalyticsSuggestions",i.options={omniboxZIndex:e.ComponentOptions.buildNumberOption({defaultValue:52,min:0}),headerTitle:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("SuggestedQueries")}),numberOfSuggestions:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1})},i}(e.Component);e.AnalyticsSuggestions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.options=o,this.topFieldElementHeaderTemplate=e._.template("<div class='coveo-top-field-suggestion-header'>          <span class='coveo-icon-top-field'></span>           <span class='coveo-caption'><%= headerTitle %></span>         </div>"),this.topFieldElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-field-suggestion-row'>           <%= data %>         </div>"),"omniboxSuggestionOptions"in this.options&&(this.options=e._.extend(this.options,this.options.omniboxSuggestionOptions)),this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),this.options.onSelect=this.options.onSelect||this.onRowSelection;var r={header:{template:this.topFieldElementHeaderTemplate,title:this.options.headerTitle},row:this.topFieldElementRowTemplate};this.suggestionForOmnibox=new e.SuggestionForOmnibox(r,e.$.proxy(this.options.onSelect,this)),e.$(this.root).on(e.OmniboxEvents.populateOmnibox,e.$.proxy(this.handlePopulateOmnibox,this))}return __extends(i,t),i.prototype.handlePopulateOmnibox=function(t,i){var n=this;if(e.Assert.exists(i),!this.disabled){var o=i.completeQueryExpression.word,s=e.$.Deferred(),r=this.queryController.getEndpoint().listFieldValues(this.buildListFieldValueRequest(o));r.done(function(e){var t=n.suggestionForOmnibox.buildOmniboxElement(e,i);s.resolve({element:void 0==t?void 0:t.get(0),zIndex:n.options.omniboxZIndex})}),r.fail(function(){n.resolveWithUndefined(s)}),i.rows.push({deferred:s})}},i.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},i.prototype.onRowSelection=function(t,i){var n=this;i.clear(),i.closeOmnibox(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.omniboxField,{})}})},i.prototype.buildListFieldValueRequest=function(e){return{field:this.options.field,ignoreAccents:!0,sortCriteria:"occurrences",maximumNumberOfValues:this.options.numberOfSuggestions,patternType:"Wildcards",pattern:"*"+e+"*",queryOverride:this.options.queryOverride}},i.ID="FieldSuggestions",i.options={field:e.ComponentOptions.buildFieldOption({required:!0}),queryOverride:e.ComponentOptions.buildStringOption({defaultValue:""}),omniboxZIndex:e.ComponentOptions.buildNumberOption({defaultValue:51,min:0}),headerTitle:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("SuggestedResults")}),numberOfSuggestions:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1})},i}(e.Component);e.FieldSuggestions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this._window=r,this._window=this._window||window,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.bind.onRoot(e.QueryEvents.querySuccess,this.handleProcessNewQueryResults),this.skipRedirects=!0}return __extends(i,t),i.prototype.handleProcessNewQueryResults=function(t,i){var n=this;e.Assert.exists(i),e.Assert.exists(i.results),e.$(this.element).empty();var o=!1;return void 0===i.results.triggers?(e.$(this.element).toggleClass("coveo-visible",o),void 0):(this.executeTriggers(i.results.triggers,"notify",function(t){n.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.triggerNotify,{notification:t.content},n.element),e.$("<div/>").addClass("coveo-trigger-notify").text(t.content).appendTo(n.element),o=!0}),this.executeTriggers(i.results.triggers,"redirect",function(t){n.skipRedirects?n.logger.debug("Redirect to '"+t.content+"' skipped on first query."):(n.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.triggerRedirect,{redirectedTo:t.content},n.element),n._window.location.replace(t.content))},!0),this.executeTriggers(i.results.triggers,"execute",function(t){try{var o=window[t.content.name];if("function"==typeof o){var s=e._.object(e._.map(t.content.params,function(e,t){return["param"+(t+1),e]}));s.element=n.element,n.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.triggerExecute,{executed:t.content.name},n.element),o.apply(window,[s])}else n.logger.error("A trigger tried to call the function '"+t.content.name+"' which doesn't exist.",n,i.query,t)}catch(r){n.logger.error("A trigger called the function '"+t.content.name+"' which thrown an error.",n,i.query,t)}}),e.$(this.element).toggleClass("coveo-visible",o),this.skipRedirects=!1,void 0)},i.prototype.executeTriggers=function(t,i,n,o){void 0===o&&(o=!1);var s=e._.filter(t,function(e){return e.type==i}),r=e._.take(s,o?1:Number.MAX_VALUE);e._.each(r,n)},i.ID="Triggers",i.options={},i}(e.Component);e.Triggers=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null!=r.raw.syssfcreatedby&&(e.$("<span>").text((this.options.useFromInstead?e.l("From"):e.l("PostedBy"))+" ").appendTo(n),e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfcreatedbyid)).text(r.raw.syssfcreatedby).appendTo(n),!this.options.enablePostedOn||e.Utils.isNullOrUndefined(r.raw.sfparentname)||e.Utils.isNullOrUndefined(r.raw.sfparentid)||(e.Utils.isNullOrUndefined(r.raw.sfuserid)||r.raw.sfuserid==r.raw.sfinsertedbyid?e.Utils.isNullOrUndefined(r.raw.sfuserid)&&(e.$("<span>").text(" "+e.l("On").toLowerCase()+" ").appendTo(n),e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfparentid)).text(r.raw.sfparentname).appendTo(n)):e.$("<span>").html(" "+e.l("OnFeed",e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfparentid)).text(r.raw.sfparentname).prop("outerHTML"))).appendTo(n)))}return __extends(i,t),i.ID="ChatterPostedBy",i.options={enablePostedOn:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),useFromInstead:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.ChatterPostedBy=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),!e.Utils.isNullOrUndefined(r.raw.sflikedby)&&!e.Utils.isNullOrUndefined(r.raw.sflikedbyid)){var a=r.raw.sflikedby.split(";"),l=r.raw.sflikedbyid.split(";"),u=e.$("<div>").addClass("coveo-chatter-result-box-row").appendTo(n);
e.$("<div>").addClass("coveo-sprites-common-thumbup_inactive").addClass("coveo-chatter-result-box-icon").appendTo(u);var c=e.$("<div>").addClass("coveo-chatter-result-likes").appendTo(u);this.renderLikesList(c[0],r,a,l,this.options.nbLikesToRender)}}return __extends(i,t),i.prototype.renderLikesList=function(t,i,n,o,s){for(var r=this,a=e.$("<div>"),l=0;l<o.length-1&&(0==s||s>l);l++)this.renderLikeLink(i,n[l],o[l]).appendTo(a),(0==s||s-1>l)&&l<o.length-2?e.$("<span>").text(", ").appendTo(a):l<o.length-1&&e.$("<span>").text(" "+e.l("And").toLowerCase()+" ").appendTo(a);if(0==s||o.length<=s)this.renderLikeLink(i,n[o.length-1],o[o.length-1]).appendTo(a);else{var u=o.length-s;e.$("<a>").click(function(s){s.preventDefault(),e.$(t).empty(),r.renderLikesList(t,i,n,o,0)}).text(" "+e.l("Others",u.toString(),u)).appendTo(a)}o.length>0&&e.$("<span>").html(e.l("LikesThis",a.html(),o.length)).appendTo(t)},i.prototype.renderLikeLink=function(t,i,n){return e.$("<a>").attr("href",e.ChatterUtils.buildURI(t.raw.sysclickableuri,t.raw.sffeeditemid,n)).text(i)},i.ID="ChatterLikedBy",i.options={nbLikesToRender:e.ComponentOptions.buildNumberOption({defaultValue:2,min:0})},i}(e.Component);e.ChatterLikedBy=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,!e.Utils.isNullOrUndefined(r.raw.coveochatterfeedtopics)){var a=e.$("<div>").addClass("coveo-chatter-result-box-row"),l=r.raw.coveochatterfeedtopics.split(";");e.$("<div>").addClass("coveo-sprites-common-tagging_tag").addClass("coveo-chatter-result-box-icon").appendTo(a);for(var u=0;u<l.length;u++)e.$("<span>").text(l[u]).appendTo(a),u<l.length-1&&e.$("<span>").text(", ").appendTo(a);a.appendTo(n)}}return __extends(i,t),i.ID="ChatterTopic",i}(e.Component);e.ChatterTopic=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,!e.Utils.isNullOrUndefined(r.raw.sfcontentversionid)){var a=e.$("<div>").addClass("coveo-chatter-result-box-row").appendTo(n);e.$("<div>").addClass("coveo-sprites-common-system").addClass("coveo-chatter-result-box-icon").appendTo(a);var l=e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfcontentversionid)).appendTo(a);e.Utils.isNullOrUndefined(r.raw.sfcontentfilename)?l.text(e.l("ShowAttachment")):l.text(r.raw.sfcontentfilename)}}return __extends(i,t),i.ID="ChatterPostAttachment",i}(e.Component);e.ChatterPostAttachment=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).attr("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),e.QueryUtils.hasThumbnail(r)?this.buildThumbnailImage():this.setEmptyThumbnailClass()}return __extends(i,t),i.prototype.buildThumbnailImage=function(){var t=this.bindings.queryController.getEndpoint();t.isJsonp()||e.DeviceUtils.isIE8or9()?this.buildImageWithDirectSrcAttribute(t):this.buildImageWithBase64SrcAttribute(t)},i.prototype.buildImageWithDirectSrcAttribute=function(t){var i=t.getViewAsDatastreamUri(this.result.uniqueId,"$Thumbnail$",{contentType:"image/png"});e.$(this.element).attr("src",i)},i.prototype.buildImageWithBase64SrcAttribute=function(t){var i=this;t.getRawDataStream(this.result.uniqueId,"$Thumbnail$").done(function(t){var n=String.fromCharCode.apply(null,new Uint8Array(t));e.$(i.element).attr("src","data:image/png;base64, "+btoa(n))}).fail(function(){i.setEmptyThumbnailClass()})},i.prototype.setEmptyThumbnailClass=function(){e.$(this.element).addClass(this.options.noThumbnailClass)},i.ID="Thumbnail",i.options={noThumbnailClass:e.ComponentOptions.buildStringOption({defaultValue:"coveo-no-thumbnail"})},i}(e.Component);e.Thumbnail=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o);var l=e.$('<a class="'+e.Component.computeCssClassNameForType(e.ResultLink.ID)+'" />'),u=e.$("<div />").addClass("coveo-youtube-thumbnail-container").appendTo(l);e.$("<img />").css({width:this.options.width}).attr("src",r.raw.ytthumbnailurl).addClass("coveo-youtube-thumbnail-img").appendTo(u),e.$("<span></span>").addClass("coveo-youtube-thumbnail-play-button").appendTo(u),e.$(this.element).append(l),this.options.embed&&(this.options=e._.extend(this.options,{onClick:function(){return a.handleOnClick()}}));var c=this.searchInterface.options.originalOptionsObject,p=e._.extend({},this.getBindings(),{resultElement:n}),d={options:e._.extend({},{initOptions:{ResultLink:o}},c),bindings:p,result:r};e.CoveoJQuery.automaticallyCreateComponentsInside(n,d)}return __extends(i,t),i.prototype.handleOnClick=function(){var t=this,i=e.$("<iframe />"),n=e.$("<div></div>");i.attr({src:"https://www.youtube.com/embed/"+this.extractVideoId()+"?autoplay=1",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",width:"100%",height:"100%"}),n.append(i),this.modalbox=e.ModalBox.open(n,{overlayClose:!0,title:e.JQueryUtils.getQuickviewHeader(this.result,{showDate:!0,title:this.result.title},this.bindings),className:"coveo-quick-view coveo-youtube-player",validation:function(){return!0},body:this.element.ownerDocument.body}),e.$(this.modalbox.wrapper.find(".coveo-quickview-close-button")).click(function(){t.modalbox.close()})},i.prototype.extractVideoId=function(){return this.result.clickUri.split("watch?v=")[1]},i.ID="YouTubeThumbnail",i.options={width:e.ComponentOptions.buildStringOption({defaultValue:"200px"}),embed:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.YouTubeThumbnail=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Lowest=1]="Lowest",e[e.Low=2]="Low",e[e.Average=3]="Average",e[e.Good=4]="Good",e[e.Best=5]="Best"}(e.RatingValues||(e.RatingValues={}));var t=e.RatingValues,i=function(i){function n(t,o,s,r){i.call(this,t,n.ID,s),this.element=t,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(t,n,o),e.Utils.isNullOrUndefined(r.rating)||this.renderComponent(t,r.rating)}return __extends(n,i),n.prototype.renderComponent=function(e,t){for(var i=1;5>=i;i++)this.renderStars(e,t>=i,i)},n.prototype.renderStars=function(t,i,n){var o=this,s=e.$(t).find('a[rating-value="'+n+'"]');0==s.length&&(s=e.$("<a>").appendTo(t),this.bindings.searchInterface.options.enableCollaborativeRating&&(s.click(function(t){o.rateDocument(+e.$(t.currentTarget).attr("rating-value"))}),s.mouseover(function(i){o.renderComponent(t,parseInt(e.$(i.currentTarget).attr("rating-value"),10))}),s.mouseout(function(){o.renderComponent(t,o.result.rating)})),s.attr("rating-value",n)),s.toggleClass("coveo-sprites-common-star_placeholder",!i),s.toggleClass("coveo-sprites-common-star_active",i)},n.prototype.rateDocument=function(e){var i=this,n={rating:t[e],uniqueId:this.result.uniqueId},o=this.queryController.getEndpoint().rateDocument(n);o.done(function(){i.result.rating=e,i.renderComponent(i.element,e)}),o.fail(function(){i.logger.error("An error occurred while rating the document")})},n.ID="ResultRating",n}(e.Component);e.ResultRating=i,e.CoveoJQuery.registerAutoCreateComponent(i)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).text(this.options.value),e.$(this.element).css("font-size",this.options.size),e.$(this.element).css("font-style",this.options.style),e.$(this.element).css("font-weight",this.options.weight),e.$(this.element).css("text-align",this.options.textAlign),e.$(this.element).css("margin-top",this.options.marginTop),e.$(this.element).css("margin-bottom",this.options.marginBottom),e.$(this.element).css("margin-right",this.options.marginRight),e.$(this.element).css("margin-left",this.options.marginLeft),e.$(this.element).css("padding-top",this.options.paddingTop),e.$(this.element).css("padding-bottom",this.options.paddingBottom),e.$(this.element).css("padding-left",this.options.paddingLeft),e.$(this.element).css("padding-right",this.options.paddingRight)}return __extends(i,t),i.ID="Text",i.options={value:e.ComponentOptions.buildLocalizedStringOption(),size:e.ComponentOptions.buildStringOption(),style:e.ComponentOptions.buildStringOption(),weight:e.ComponentOptions.buildStringOption(),textAlign:e.ComponentOptions.buildStringOption(),marginTop:e.ComponentOptions.buildStringOption(),marginBottom:e.ComponentOptions.buildStringOption(),marginLeft:e.ComponentOptions.buildStringOption(),marginRight:e.ComponentOptions.buildStringOption(),paddingTop:e.ComponentOptions.buildStringOption(),paddingBottom:e.ComponentOptions.buildStringOption(),paddingLeft:e.ComponentOptions.buildStringOption(),paddingRight:e.ComponentOptions.buildStringOption()},i}(e.Component);e.Text=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),"undefined"!=typeof userActionsHandler&&this.setHandler(userActionsHandler),this.render(),this.options.enableBindOnBox&&e.$(n).closest(".CoveoBoxPopup").on("onPopupOpen",function(){r.open()})}return __extends(i,t),i.prototype.setHandler=function(e){this.handler=e},i.prototype.setFilters=function(e){this.options.filters=e},i.prototype.render=function(){var t=this;if(this.options.showButton){this.renderButton().appendTo(this.element).click(function(){t.toggle()})}this.renderPlaceholder().appendTo(this.element),this.loadingBox=e.JQueryUtils.getBasicLoadingDots().hide().appendTo(this.element),this.eventListBox=e.$("<div>").addClass("coveo-useractions-events-list").hide().appendTo(this.element)},i.prototype.open=function(){var t=this;this.eventListBox.is(":empty")&&null!=this.handler?(this.loadingBox.show(),this.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.getUserHistory,null,this.element),this.handler.getDataFromUA(function(e){t.renderEvents(e)})):this.eventListBox.slideDown()},i.prototype.toggle=function(){this.eventListBox.is(":visible")?this.close():this.open()},i.prototype.close=function(){this.eventListBox.is(":visible")&&this.eventListBox.slideUp()},i.prototype.renderEvents=function(t){var i=this;this.eventListBox.empty(),null!=t.message?"NoVisitIdError"==t.type?(this.logger.info(t.message,t.type,t),e.$("<span>").text(e.l("UserActionsNoVisitId")).addClass("coveo-useractions-nodata").appendTo(this.eventListBox)):(this.logger.error(t.message,t.type,t),e.$("<span>").text(e.l("UserActionsErrorOccured")).addClass("coveo-useractions-nodata").appendTo(this.eventListBox)):t.totalNumberOfVisits>0?t.visits[0].numberOfEvents>0&&(this.renderHeaderBox(t.visits[0]).appendTo(this.eventListBox),e._.each(t.visits[0].events,function(t){(e._.contains(i.options.filters,t.eventMetadata.actionCause)||e._.contains(i.options.filters,t.eventMetadata.customEventValue))&&i.renderEvent(t).appendTo(i.eventListBox)})):e.$("<span>").text(e.l("NoData")).addClass("coveo-useractions-nodata").appendTo(this.eventListBox),this.loadingBox.hide(),this.eventListBox.slideToggle()},i.prototype.renderPlaceholder=function(){return e.$("<div>").addClass("coveo-box-popup-toggle").addClass("coveo-useractions-placeholder").append(e.$("<span>").addClass("coveo-box-popup-title").append(e.$("<span>").text(e.l(i.ID))))},i.prototype.renderEvent=function(t){var i=e.$("<div>").addClass("coveo-useractions-event"),n=e.$("<div>").addClass("coveo-useractions-event-right").appendTo(i),o=e.$("<div>").addClass("coveo-useractions-event-left").appendTo(i);return this.renderField(e.l("Time"),new Date(t.dateTime).toLocaleTimeString()).appendTo(o),t.eventMetadata.documentTitle&&t.eventMetadata.documentURL&&this.renderLinkField(e.l("Document"),t.eventMetadata.documentTitle,t.eventMetadata.documentURL).appendTo(n),t.eventMetadata.queryExpression&&this.renderField(e.l("UserQuery"),t.eventMetadata.queryExpression).appendTo(n),"pageView"==t.eventMetadata.customEventValue?this.renderLinkField(t.type,t.eventMetadata.originLevel3,t.eventMetadata.originLevel3).appendTo(n):t.eventMetadata.customEventValue&&this.renderField(t.type,t.eventMetadata.customEventValue).appendTo(n),n.is(":empty")&&this.renderField(e.l("EventType"),t.type+(t.eventMetadata.actionCause?", "+t.eventMetadata.actionCause:"")).appendTo(n),i},i.prototype.renderField=function(t,i){var n=e.$("<div>");return i&&(e.$("<span>").addClass("coveo-useractions-event-title").text(t).appendTo(n),e.$("<span>").addClass("coveo-useractions-event-value-expand").text(i).appendTo(n)),n},i.prototype.renderLinkField=function(t,i,n){var o=e.$("<div>");return i&&(e.$("<span>").addClass("coveo-useractions-event-title").text(t).appendTo(o),e.$("<a>").addClass("coveo-useractions-event-value-expand CoveoResultLink").text(i).attr("href",n).attr("target","_blanc").appendTo(o)),o},i.prototype.renderHeaderBox=function(t){var i=e.$("<div>").addClass("coveo-useractions-event").addClass("coveo-useractions-event-header"),n=e.$("<div>").addClass("coveo-useractions-event-right").appendTo(i),o=e.$("<div>").addClass("coveo-useractions-event-left").appendTo(i),s=new Date(t.events[0].dateTime).toDateString(),r=new Date(t.events[0].dateTime).toLocaleTimeString(),a=e.DateUtils.timeBetween(new Date(t.events[0].dateTime),new Date(t.events[t.numberOfEvents-1].dateTime));return this.renderField(e.l("StartDate"),s).appendTo(o),this.renderField(e.l("StartTime"),r).css("float","left").appendTo(n),this.renderField(e.l("DurationTitle"),a).css("float","right").appendTo(n),i},i.prototype.renderButton=function(){return e.$("<div>").addClass("coveo-useractions-button").append(e.$("<span>").text(e.l("ShowUserActions").toUpperCase()))},i.ID="UserActions",i.DEFAULT_FILTERS=["searchboxSubmit","documentOpen","documentQuickView","pageVisit","pageView","createCase"],i.options={showButton:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableBindOnBox:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),filters:e.ComponentOptions.buildListOption({defaultValue:i.DEFAULT_FILTERS})},i}(e.Component);e.UserActions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),this.searchInterface=this.searchInterface||this.resolveSearchInterface(),e.Assert.exists(this.result),"undefined"!=typeof attachToCaseInitDefer&&void 0!=attachToCaseInitDefer&&"undefined"!=typeof attachToCaseInitDefer_LEGACY&&void 0!=attachToCaseInitDefer_LEGACY&&void 0!=attachToCaseHandler?(e.$.when(attachToCaseInitDefer,attachToCaseInitDefer_LEGACY).done(function(){return a.buildAttachToCaseButton()}),e.$(this.element).show()):e.$(this.element).hide()}return __extends(i,t),i.prototype.buildAttachToCaseButton=function(){var t=this;attachToCaseHandler.attachedResults[this.result.raw.sysurihash]?e.$(this.element).text(e.l("Detach")):(e.$(this.element).text(e.l("Attach")),null!=this.result.raw.sfkbid&&(attachToCaseHandler.attachedResults[this.result.raw.sfkbid]?e.$(this.element).text(e.l("Detach")):e.$(this.element).text(e.l("Attach")))),e.$(this.element).click(function(){t.attachToCase()})},i.prototype.isAttached=function(){return"undefined"!=typeof attachToCaseHandler?null!=attachToCaseHandler.attachedResults[this.result.raw.sysurihash]:!1},i.prototype.attachToCase=function(){var t=attachToCaseHandler.attachedResults[this.result.raw.sysurihash];null==t&&null!=this.result.raw.sfkbid&&(t=attachToCaseHandler.attachedResults[this.result.raw.sfkbid]);var i={articleID:this.result.raw.sfkbid,caseID:attachToCaseHandler.caseId,resultUriHash:this.result.raw.sysurihash};e.Utils.isNullOrUndefined(t)?attachToCaseHandler.attachToCase(this.result)?(this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.caseAttach,{documentTitle:this.result.title,documentURL:this.result.clickUri},this.result,this.root),this.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.caseAttach,i,this.searchInterface.element),e.$(this.element).text(e.l("Detach"))):alert("Unable to attach the article to the case"):attachToCaseHandler.detachFromCase(attachToCaseHandler.attachedResults[this.result.raw.sysurihash],this.result.raw.sysurihash,this.result.raw.sfkbid)?(this.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.caseDetach,i,this.searchInterface.element),e.$(this.element).text(e.l("Attach"))):alert("Unable to detach the article from the case")},i.ID="AttachToCase",i}(e.Component);e.AttachToCase=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.searchButton=new e.SearchButton(e.$("<a/>").appendTo(this.element).get(0),void 0,s);var r=e.$("<div/>").appendTo(this.element),a=this.buildInputTag();a.appendTo(r),this.searchbox=this.options.enableOmnibox?new e.Omnibox(a.get(0),this.options,s):new e.Querybox(a.get(0),this.options,s)}return __extends(i,t),i.prototype.buildInputTag=function(){var t=this;return e.$('<input type="text" autocapitalize="off" autocorrect="off" />').blur(function(i){t.queryStateModel.set(e.QueryStateModel.attributesEnum.q,e.$(i.target).val())})},i.ID="Searchbox",i.parent=e.Omnibox,i.options=e._.extend({},{enableOmnibox:e.ComponentOptions.buildBooleanOption({defaultValue:!1,postProcessing:function(t,i){return i.enableSearchAsYouType?(t&&new e.Logger(document).warn("Cannot initialize omnibox and search as you type at the same time : Disabling omnibox functionnality"),!1):t}}),enableSearchAsYouType:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:e.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),enableQuerySyntax:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableWildcards:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),partialMatchThreshold:e.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},e.Omnibox.options),i}(e.Component);e.Searchbox=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,n,o,s){t.call(this,e,i.ID,o),this.element=e,this.options=n,this.bindings=o,this._window=s,this._window=this._window||window}return __extends(i,t),i.prototype.getCssClass=function(){return"coveo-export-to-excel"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("ExportToExcel"),tooltip:e.l("ExportToExcelDescription"),onOpen:function(){return t.open()},onClose:function(){}}]},i.prototype.open=function(){var t=this.queryController.getLastQuery();if(t){this.logger.debug('Performing query following "Export to Excel" click');var i=this.queryController.getEndpoint();this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.exportToExcel,{}),this._window.location.replace(i.getExportToExcelLink(t))}},i.create=function(e,t,n){return new i(e,t,n)},i.ID="ExportToExcel",i.options={},i}(e.Component);e.ExportToExcel=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));
Coveo.Logger.disable();
if( window.jstz === undefined) {
(function(e){var t=function(){"use strict";var e="s",n=2011,r=function(e){var t=-e.getTimezoneOffset();return t!==null?t:0},i=function(e,t,n){var r=new Date;return e!==undefined&&r.setFullYear(e),r.setDate(n),r.setMonth(t),r},s=function(e){return r(i(e,0,2))},o=function(e){return r(i(e,5,2))},u=function(e){var t=e.getMonth()>7?o(e.getFullYear()):s(e.getFullYear()),n=r(e);return t-n!==0},a=function(){var t=s(n),r=o(n),i=t-r;return i<0?t+",1":i>0?r+",1,"+e:t+",0"},f=function(){var e=a();return new t.TimeZone(t.olson.timezones[e])},l=function(e){var t=new Date(2010,6,15,1,0,0,0),n={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,10,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":t,"Asia/Yekaterinburg":t,"Asia/Omsk":t,"Asia/Krasnoyarsk":t,"Asia/Irkutsk":t,"Asia/Yakutsk":t,"Asia/Vladivostok":t,"Asia/Kamchatka":t,"Europe/Minsk":t,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return n[e]};return{determine:f,date_is_dst:u,dst_start_for:l}}();t.TimeZone=function(e){"use strict";var n={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Pacific/Tongatapu":["Pacific/Apia"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},r=e,i=function(){var e=n[r],i=e.length,s=0,o=e[0];for(;s<i;s+=1){o=e[s];if(t.date_is_dst(t.dst_start_for(o))){r=o;return}}},s=function(){return typeof n[r]!="undefined"};return s()&&i(),{name:function(){return r}}},t.olson={},t.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},typeof exports!="undefined"?exports.jstz=t:e.jstz=t})(this);
}
if( window.Coveo === undefined) {
/*! jQuery v1.9.1 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery.min.map
*/(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p="1.9.1",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,E=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,j=/^-ms-/,D=/-([\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(o.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===b.type(e)},isArray:Array.isArray||function(e){return"array"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,"@").replace(A,"]").replace(E,"")))?Function("return "+n)():(b.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,"ms-").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call("\ufeff\u00a0")?function(e){return null==e?"":v.call(e)}:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if("object"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),"complete"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{o.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e="string"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);"function"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*"),r=d.getElementsByTagName("a")[0],!n||!r||!n.length)return{};s=o.createElement("select"),l=s.appendChild(o.createElement("option")),a=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip,b(function(){var n,r,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=d.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(o.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)}),n=s=u=l=r=a=null,t}();var O=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u="string"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),("object"==typeof n||"function"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(" "));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,"parsedAttrs"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(B,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if(("data"!==t||!b.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),o.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=b._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\t\r\n]/g,U=/\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u="string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?b.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?"addClass":"removeClass"](o)}else(n===i||"boolean"===n)&&(this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o="":"number"==typeof o?o+="":b.isArray(o)&&(o=b.map(o,function(e){return null==e?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(U,""):null==n?"":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&b.nodeName(n.parentNode,"optgroup"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&"get"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&"set"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&"radio"===t&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),o="boolean"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,"input")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,""===t?!1:t,n)}},b.each(["width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(w)||[""],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,"events"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),u=0>g.indexOf(":")&&"on"+g,n=n[b.expando]?n:new b.Event(g,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,"events")||{})[n.type]&&b._data(l,"handle"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||"click"===g&&b.nodeName(i,"a")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,"events")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;
return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,"form")?!1:(b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,"form")?!1:(b.event.remove(this,"._submit"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(b.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)})),!1):(b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x="sizzle"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=F.replace("w","w#"),B="([*^$|!~]?=)",P="\\["+_+"*("+F+")"+_+"*(?:"+B+_+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+O+")|)|)"+_+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+P.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),$=RegExp("^"+_+"*,"+_+"*"),I=RegExp("^"+_+"*([\\x20\\t\\r\\n\\f>+~])"+_+"*"),z=RegExp(R),X=RegExp("^"+O+"$"),U={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),NAME:RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:RegExp("^("+F.replace("w","w*")+")"),ATTR:RegExp("^"+P),PSEUDO:RegExp("^"+R),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),needsContext:RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},V=/[\x20\t\r\n\f]*[+~]/,Y=/^[^{]+\{\s*\[native code/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute("id"))?g=f.replace(K,"\\$&"):t.setAttribute("id",g),g="[id='"+g+"'] ",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(",")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute("id")}}}return wt(e.replace(W,"$1"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),T.attributes=at(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),T.getByClassName=at(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[":focus"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+_+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||h.push(":checked")}),at(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&h.push("[*^$]="+_+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||h.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),h.push(",.*:")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",R)}),h=RegExp(h.join("|")),g=RegExp(g.join("|")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,"='$1']"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+" "];return t||(t=RegExp("(^|"+_+")"+e+"("+_+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[x]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,"$1"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W," ")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&"parentNode"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+" "+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,"$1"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG("*",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&"ID"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[":"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\[\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||"string"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?"string"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(o),Dt=jt.appendChild(o.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||"string"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||"string"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,"tr"),s=b.map(Ot(l,"script"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,"script"))),r.call(n&&b.nodeName(this[c],"table")?Lt(this[c],"tbody"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(St,"")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,"script"),r.length>0&&Mt(r,!u&&Ot(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),u=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o="table"!==u||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],"tbody")&&!l.childNodes.length&&o.removeChild(l)
}b.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),"script"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+x+")(.*)$","i"),Yt=RegExp("^("+x+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+x+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===b.css(e,"display")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=b._data(r,"olddisplay",un(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||b.cssNumber[u]||(r+="px"),b.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(""!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left="fontSize"===n?"1em":u,u=l.pixelLeft+"px",l.left=i,a&&(o.left=a)),""===u?"auto":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=b.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=b.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=b.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=b.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),"none"!==n&&n||(Pt=(Pt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}b.each(["height","width"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===b.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+"px":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||b.css(e,"display"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==b.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=a.href}catch(Ln){yn=o.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return"string"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o["*"]&&s("*")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(" ");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&b.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks("once memory"),m=p.statusCode||{},y={},v={},x=0,T="canceled",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||"*").toLowerCase().match(w)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?80:443))==(mn[3]||("http:"===mn[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader("If-Modified-Since",b.lastModified[o]),b.etag[o]&&N.setRequestHeader("If-None-Match",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader("Content-Type",p.contentType),N.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T="abort";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger("ajaxSend",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort("timeout")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||"",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader("Last-Modified"),T&&(b.lastModified[o]=T),T=N.getResponseHeader("etag"),T&&(b.etag[o]=T)),204===e?(c=!0,C="nocontent"):304===e?(c=!0,C="notmodified"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+"",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?"ajaxSuccess":"ajaxError",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger("ajaxComplete",[N,p]),--b.active||b.event.trigger("ajaxStop")))}return N},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while("*"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+" "+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if("*"!==r){if("*"!==l&&l!==r){if(i=a[l+" "+r]||a["* "+r],!i)for(n in a)if(o=n.split(" "),o[1]===r&&(i=a[l+" "+o[0]]||a["* "+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+l+" to "+r}}}l=r}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||b("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=On.pop()||b.expando+"_"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||b.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&"withCredentials"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),"string"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+x+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?"":"px"),"px"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||".5",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn["*"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&"expand"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===b.css(e,"display")&&"none"===b.css(e,"float")&&(b.support.inlineBlockNeedsLayout&&"inline"!==un(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||"toggle"===a,a===(m?"hide":"show"))continue;g.push(i)}if(o=g.length){s=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,"fxshow");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");"static"===r&&(e.style.position="relative");var i=b(e),o=i.offset(),a=b.css(e,"top"),s=b.css(e,"left"),u=("absolute"===r||"fixed"===r)&&b.inArray("auto",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),"using"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===b.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,"html")&&"static"===b.css(e,"position"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return b})})(window);
}
if( window._ === undefined) {
//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);
}
if( window.Globalize === undefined) {
/*! globalize - v0.1.1 - 2013-04-30
* https://github.com/jquery/globalize
* Copyright 2013 ; Licensed MIT */
var Globalize = (function(e,r){var t,n,a,s,u,l,i,c,o,f,d,p,h,g,b,m,y,M,v,k,z,F,A,x;t=function(e){return new t.prototype.init(e)},"undefined"!=typeof require&&"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=t:e.Globalize=t,t.cultures={},t.prototype={constructor:t,init:function(e){return this.cultures=t.cultures,this.cultureSelector=e,this}},t.prototype.init.prototype=t.prototype,t.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},t.cultures["default"].calendar=t.cultures["default"].calendars.standard,t.cultures.en=t.cultures["default"],t.cultureSelector="en",n=/^0x[a-f0-9]+$/i,a=/^[+\-]?infinity$/i,s=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,u=/^\s+|\s+$/g,l=function(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0,n=e.length;n>t;t++)if(e[t]===r)return t;return-1},i=function(e,r){return e.substr(e.length-r.length)===r},c=function(){var e,t,n,a,s,u,l=arguments[0]||{},i=1,p=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[1]||{},i=2),"object"==typeof l||f(l)||(l={});p>i;i++)if(null!=(e=arguments[i]))for(t in e)n=l[t],a=e[t],l!==a&&(h&&a&&(d(a)||(s=o(a)))?(s?(s=!1,u=n&&o(n)?n:[]):u=n&&d(n)?n:{},l[t]=c(h,u,a)):a!==r&&(l[t]=a));return l},o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},f=function(e){return"[object Function]"===Object.prototype.toString.call(e)},d=function(e){return"[object Object]"===Object.prototype.toString.call(e)},p=function(e,r){return 0===e.indexOf(r)},h=function(e){return(e+"").replace(u,"")},g=function(e){return isNaN(e)?0/0:Math[0>e?"ceil":"floor"](e)},b=function(e,r,t){var n;for(n=e.length;r>n;n+=1)e=t?"0"+e:e+"0";return e},m=function(e,r){for(var t=0,n=!1,a=0,s=e.length;s>a;a++){var u=e.charAt(a);switch(u){case"'":n?r.push("'"):t++,n=!1;break;case"\\":n&&r.push("\\"),n=!n;break;default:r.push(u),n=!1}}return t},y=function(e,r){r=r||"F";var t,n=e.patterns,a=r.length;if(1===a){if(t=n[r],!t)throw"Invalid date format string '"+r+"'.";r=t}else 2===a&&"%"===r.charAt(0)&&(r=r.charAt(1));return r},M=function(e,r,t){function n(e,r){var t,n=e+"";return r>1&&r>n.length?(t=v[r-2]+n,t.substr(t.length-r,r)):t=n}function a(){return h||g?h:(h=A.test(r),g=!0,h)}function s(e,r){if(b)return b[r];switch(r){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw"Invalid part value "+r}}var u,l=t.calendar,i=l.convert;if(!r||!r.length||"i"===r){if(t&&t.name.length)if(i)u=M(e,l.patterns.F,t);else{var c=new Date(e.getTime()),o=z(e,l.eras);c.setFullYear(F(e,l,o)),u=c.toLocaleString()}else u=""+e;return u}var f=l.eras,d="s"===r;r=y(l,r),u=[];var p,h,g,b,v=["0","00","000"],A=/([^d]|^)(d|dd)([^d]|$)/g,x=0,I=k();for(!d&&i&&(b=i.fromGregorian(e));;){var S=I.lastIndex,w=I.exec(r),C=r.slice(S,w?w.index:r.length);if(x+=m(C,u),!w)break;if(x%2)u.push(w[0]);else{var D=w[0],H=D.length;switch(D){case"ddd":case"dddd":var O=3===H?l.days.namesAbbr:l.days.names;u.push(O[e.getDay()]);break;case"d":case"dd":h=!0,u.push(n(s(e,2),H));break;case"MMM":case"MMMM":var N=s(e,1);u.push(l.monthsGenitive&&a()?l.monthsGenitive[3===H?"namesAbbr":"names"][N]:l.months[3===H?"namesAbbr":"names"][N]);break;case"M":case"MM":u.push(n(s(e,1)+1,H));break;case"y":case"yy":case"yyyy":N=b?b[0]:F(e,l,z(e,f),d),4>H&&(N%=100),u.push(n(N,H));break;case"h":case"hh":p=e.getHours()%12,0===p&&(p=12),u.push(n(p,H));break;case"H":case"HH":u.push(n(e.getHours(),H));break;case"m":case"mm":u.push(n(e.getMinutes(),H));break;case"s":case"ss":u.push(n(e.getSeconds(),H));break;case"t":case"tt":N=12>e.getHours()?l.AM?l.AM[0]:" ":l.PM?l.PM[0]:" ",u.push(1===H?N.charAt(0):N);break;case"f":case"ff":case"fff":u.push(n(e.getMilliseconds(),3).substr(0,H));break;case"z":case"zz":p=e.getTimezoneOffset()/60,u.push((0>=p?"+":"-")+n(Math.floor(Math.abs(p)),H));break;case"zzz":p=e.getTimezoneOffset()/60,u.push((0>=p?"+":"-")+n(Math.floor(Math.abs(p)),2)+":"+n(Math.abs(e.getTimezoneOffset()%60),2));break;case"g":case"gg":l.eras&&u.push(l.eras[z(e,f)].name);break;case"/":u.push(l["/"]);break;default:throw"Invalid date format pattern '"+D+"'."}}}return u.join("")},function(){var e;e=function(e,r,t){var n=t.groupSizes,a=n[0],s=1,u=Math.pow(10,r),l=Math.round(e*u)/u;isFinite(l)||(l=e),e=l;var i=e+"",c="",o=i.split(/e/i),f=o.length>1?parseInt(o[1],10):0;i=o[0],o=i.split("."),i=o[0],c=o.length>1?o[1]:"",f>0?(c=b(c,f,!1),i+=c.slice(0,f),c=c.substr(f)):0>f&&(f=-f,i=b(i,f+1,!0),c=i.slice(-f,i.length)+c,i=i.slice(0,-f)),c=r>0?t["."]+(c.length>r?c.slice(0,r):b(c,r)):"";for(var d=i.length-1,p=t[","],h="";d>=0;){if(0===a||a>d)return i.slice(0,d+1)+(h.length?p+h+c:c);h=i.slice(d-a+1,d+1)+(h.length?p+h:""),d-=a,n.length>s&&(a=n[s],s++)}return i.slice(0,d+1)+p+h+c},v=function(r,t,n){if(!isFinite(r))return 1/0===r?n.numberFormat.positiveInfinity:r===-1/0?n.numberFormat.negativeInfinity:n.numberFormat.NaN;if(!t||"i"===t)return n.name.length?r.toLocaleString():""+r;t=t||"D";var a,s=n.numberFormat,u=Math.abs(r),l=-1;t.length>1&&(l=parseInt(t.slice(1),10));var i,c=t.charAt(0).toUpperCase();switch(c){case"D":a="n",u=g(u),-1!==l&&(u=b(""+u,l,!0)),0>r&&(u="-"+u);break;case"N":i=s;case"C":i=i||s.currency;case"P":i=i||s.percent,a=0>r?i.pattern[0]:i.pattern[1]||"n",-1===l&&(l=i.decimals),u=e(u*("P"===c?100:1),l,i);break;default:throw"Bad number format specifier: "+c}for(var o=/n|\$|-|%/g,f="";;){var d=o.lastIndex,p=o.exec(a);if(f+=a.slice(d,p?p.index:a.length),!p)break;switch(p[0]){case"n":f+=u;break;case"$":f+=s.currency.symbol;break;case"-":/[1-9]/.test(u)&&(f+=s["-"]);break;case"%":f+=s.percent.symbol}}return f}}(),k=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},z=function(e,r){if(!r)return 0;for(var t,n=e.getTime(),a=0,s=r.length;s>a;a++)if(t=r[a].start,null===t||n>=t)return a;return 0},F=function(e,r,t,n){var a=e.getFullYear();return!n&&r.eras&&(a-=r.eras[t].offset),a},function(){var e,r,t,n,a,s,u;e=function(e,r){if(100>r){var t=new Date,n=z(t),a=F(t,e,n),s=e.twoDigitYearMax;s="string"==typeof s?(new Date).getFullYear()%100+parseInt(s,10):s,r+=a-a%100,r>s&&(r-=100)}return r},r=function(e,r,t){var n,a=e.days,i=e._upperDays;return i||(e._upperDays=i=[u(a.names),u(a.namesAbbr),u(a.namesShort)]),r=s(r),t?(n=l(i[1],r),-1===n&&(n=l(i[2],r))):n=l(i[0],r),n},t=function(e,r,t){var n=e.months,a=e.monthsGenitive||e.months,i=e._upperMonths,c=e._upperMonthsGen;i||(e._upperMonths=i=[u(n.names),u(n.namesAbbr)],e._upperMonthsGen=c=[u(a.names),u(a.namesAbbr)]),r=s(r);var o=l(t?i[1]:i[0],r);return 0>o&&(o=l(t?c[1]:c[0],r)),o},n=function(e,r){var t=e._parseRegExp;if(t){var n=t[r];if(n)return n}else e._parseRegExp=t={};for(var a,s=y(e,r).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),u=["^"],l=[],i=0,c=0,o=k();null!==(a=o.exec(s));){var f=s.slice(i,a.index);if(i=o.lastIndex,c+=m(f,u),c%2)u.push(a[0]);else{var d,p=a[0],h=p.length;switch(p){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":d="(\\D+)";break;case"tt":case"t":d="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":d="(\\d{"+h+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":d="(\\d\\d?)";break;case"zzz":d="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":d="([+-]?\\d\\d?)";break;case"/":d="(\\/)";break;default:throw"Invalid date format pattern '"+p+"'."}d&&u.push(d),l.push(a[0])}}m(s.slice(i),u),u.push("$");var g=u.join("").replace(/\s+/g,"\\s+"),b={regExp:g,groups:l};return t[r]=b},a=function(e,r,t){return r>e||e>t},s=function(e){return e.split("\u00a0").join(" ").toUpperCase()},u=function(e){for(var r=[],t=0,n=e.length;n>t;t++)r[t]=s(e[t]);return r},A=function(s,u,l){s=h(s);var i=l.calendar,c=n(i,u),o=RegExp(c.regExp).exec(s);if(null===o)return null;for(var f,d=c.groups,g=null,b=null,m=null,y=null,M=null,v=0,k=0,z=0,F=0,A=null,x=!1,I=0,S=d.length;S>I;I++){var w=o[I+1];if(w){var C=d[I],D=C.length,H=parseInt(w,10);switch(C){case"dd":case"d":if(y=H,a(y,1,31))return null;break;case"MMM":case"MMMM":if(m=t(i,w,3===D),a(m,0,11))return null;break;case"M":case"MM":if(m=H-1,a(m,0,11))return null;break;case"y":case"yy":case"yyyy":if(b=4>D?e(i,H):H,a(b,0,9999))return null;break;case"h":case"hh":if(v=H,12===v&&(v=0),a(v,0,11))return null;break;case"H":case"HH":if(v=H,a(v,0,23))return null;break;case"m":case"mm":if(k=H,a(k,0,59))return null;break;case"s":case"ss":if(z=H,a(z,0,59))return null;break;case"tt":case"t":if(x=i.PM&&(w===i.PM[0]||w===i.PM[1]||w===i.PM[2]),!x&&(!i.AM||w!==i.AM[0]&&w!==i.AM[1]&&w!==i.AM[2]))return null;break;case"f":case"ff":case"fff":if(F=H*Math.pow(10,3-D),a(F,0,999))return null;break;case"ddd":case"dddd":if(M=r(i,w,3===D),a(M,0,6))return null;break;case"zzz":var O=w.split(/:/);if(2!==O.length)return null;if(f=parseInt(O[0],10),a(f,-12,13))return null;var N=parseInt(O[1],10);if(a(N,0,59))return null;A=60*f+(p(w,"-")?-N:N);break;case"z":case"zz":if(f=H,a(f,-12,13))return null;A=60*f;break;case"g":case"gg":var T=w;if(!T||!i.eras)return null;T=h(T.toLowerCase());for(var j=0,$=i.eras.length;$>j;j++)if(T===i.eras[j].name.toLowerCase()){g=j;break}if(null===g)return null}}}var P,G=new Date,E=i.convert;if(P=E?E.fromGregorian(G)[0]:G.getFullYear(),null===b?b=P:i.eras&&(b+=i.eras[g||0].offset),null===m&&(m=0),null===y&&(y=1),E){if(G=E.toGregorian(b,m,y),null===G)return null}else{if(G.setFullYear(b,m,y),G.getDate()!==y)return null;if(null!==M&&G.getDay()!==M)return null}if(x&&12>v&&(v+=12),G.setHours(v,k,z,F),null!==A){var Y=G.getMinutes()-(A+G.getTimezoneOffset());G.setHours(G.getHours()+parseInt(Y/60,10),Y%60)}return G}}(),x=function(e,r,t){var n,a=r["-"],s=r["+"];switch(t){case"n -":a=" "+a,s=" "+s;case"n-":i(e,a)?n=["-",e.substr(0,e.length-a.length)]:i(e,s)&&(n=["+",e.substr(0,e.length-s.length)]);break;case"- n":a+=" ",s+=" ";case"-n":p(e,a)?n=["-",e.substr(a.length)]:p(e,s)&&(n=["+",e.substr(s.length)]);break;case"(n)":p(e,"(")&&i(e,")")&&(n=["-",e.substr(1,e.length-2)])}return n||["",e]},t.prototype.findClosestCulture=function(e){return t.findClosestCulture.call(this,e)},t.prototype.format=function(e,r,n){return t.format.call(this,e,r,n)},t.prototype.localize=function(e,r){return t.localize.call(this,e,r)},t.prototype.parseInt=function(e,r,n){return t.parseInt.call(this,e,r,n)},t.prototype.parseFloat=function(e,r,n){return t.parseFloat.call(this,e,r,n)},t.prototype.culture=function(e){return t.culture.call(this,e)},t.addCultureInfo=function(e,r,t){var n={},a=!1;"string"!=typeof e?(t=e,e=this.culture().name,n=this.cultures[e]):"string"!=typeof r?(t=r,a=null==this.cultures[e],n=this.cultures[e]||this.cultures["default"]):(a=!0,n=this.cultures[r]),this.cultures[e]=c(!0,{},n,t),a&&(this.cultures[e].calendar=this.cultures[e].calendars.standard)},t.findClosestCulture=function(e){var r;if(!e)return this.findClosestCulture(this.cultureSelector)||this.cultures["default"];if("string"==typeof e&&(e=e.split(",")),o(e)){var t,n,a=this.cultures,s=e,u=s.length,l=[];for(n=0;u>n;n++){e=h(s[n]);var i,c=e.split(";");t=h(c[0]),1===c.length?i=1:(e=h(c[1]),0===e.indexOf("q=")?(e=e.substr(2),i=parseFloat(e),i=isNaN(i)?0:i):i=1),l.push({lang:t,pri:i})}for(l.sort(function(e,r){return e.pri<r.pri?1:e.pri>r.pri?-1:0}),n=0;u>n;n++)if(t=l[n].lang,r=a[t])return r;for(n=0;u>n;n++)for(t=l[n].lang;;){var f=t.lastIndexOf("-");if(-1===f)break;if(t=t.substr(0,f),r=a[t])return r}for(n=0;u>n;n++){t=l[n].lang;for(var d in a){var p=a[d];if(p.language===t)return p}}}else if("object"==typeof e)return e;return r||null},t.format=function(e,r,t){var n=this.findClosestCulture(t);return e instanceof Date?e=M(e,r,n):"number"==typeof e&&(e=v(e,r,n)),e},t.localize=function(e,r){return this.findClosestCulture(r).messages[e]||this.cultures["default"].messages[e]},t.parseDate=function(e,r,t){t=this.findClosestCulture(t);var n,a,s;if(r){if("string"==typeof r&&(r=[r]),r.length)for(var u=0,l=r.length;l>u;u++){var i=r[u];if(i&&(n=A(e,i,t)))break}}else{s=t.calendar.patterns;for(a in s)if(n=A(e,s[a],t))break}return n||null},t.parseInt=function(e,r,n){return g(t.parseFloat(e,r,n))},t.parseFloat=function(e,r,t){"number"!=typeof r&&(t=r,r=10);var u=this.findClosestCulture(t),l=0/0,i=u.numberFormat;if(e.indexOf(u.numberFormat.currency.symbol)>-1&&(e=e.replace(u.numberFormat.currency.symbol,""),e=e.replace(u.numberFormat.currency["."],u.numberFormat["."])),e.indexOf(u.numberFormat.percent.symbol)>-1&&(e=e.replace(u.numberFormat.percent.symbol,"")),e=e.replace(/ /g,""),a.test(e))l=parseFloat(e);else if(!r&&n.test(e))l=parseInt(e,16);else{var c=x(e,i,i.pattern[0]),o=c[0],f=c[1];""===o&&"(n)"!==i.pattern[0]&&(c=x(e,i,"(n)"),o=c[0],f=c[1]),""===o&&"-n"!==i.pattern[0]&&(c=x(e,i,"-n"),o=c[0],f=c[1]),o=o||"+";var d,p,h=f.indexOf("e");0>h&&(h=f.indexOf("E")),0>h?(p=f,d=null):(p=f.substr(0,h),d=f.substr(h+1));var g,b,m=i["."],y=p.indexOf(m);0>y?(g=p,b=null):(g=p.substr(0,y),b=p.substr(y+m.length));var M=i[","];g=g.split(M).join("");var v=M.replace(/\u00A0/g," ");M!==v&&(g=g.split(v).join(""));var k=o+g;if(null!==b&&(k+="."+b),null!==d){var z=x(d,i,"-n");k+="e"+(z[0]||"+")+z[1]}s.test(k)&&(l=parseFloat(k))}return l},t.culture=function(e){return e!==r&&(this.cultureSelector=e),this.findClosestCulture(e)||this.cultures["default"]}; return Globalize;}(this));
}
if( window.Coveo === undefined) {
!function(){"use strict";var t,e,n="undefined",r="string",i=self.navigator,o=String,a=Object.prototype.hasOwnProperty,l={},u={},s=!1,f=!0,c=/^\s*application\/(?:vnd\.oftn\.|x-)?l10n\+json\s*(?:$|;)/i,p="locale",g="defaultLocale",h="toLocaleString",y="toLowerCase",v=Array.prototype.indexOf||function(t){for(var e=this.length,n=0;e>n;n++)if(n in this&&this[n]===t)return n;return-1},d=function(e){var n=new t;return n.open("GET",e,s),n.send(null),200!==n.status?(setTimeout(function(){var t=new Error("Unable to load localization data: "+e);throw t.name="Localization Error",t},0),{}):JSON.parse(n.responseText)},m=o[h]=function(t){if(arguments.length>0&&"number"!=typeof t)if(typeof t===r)m(d(t));else if(t===s)u={};else{var e,n,i;for(e in t)if(a.call(t,e)){if(n=t[e],e=e[y](),e in u&&n!==s||(u[e]={}),n===s)continue;if(typeof n===r){if(0!==o[p][y]().indexOf(e)){e in l||(l[e]=[]),l[e].push(n);continue}n=d(n)}for(i in n)a.call(n,i)&&(u[e][i]=n[i])}}return Function.prototype[h].apply(o,arguments)},w=function(t){for(var e,n=l[t],r=0,i=n.length;i>r;r++)e={},e[t]=d(n[r]),m(e);delete l[t]},b=o.prototype[h]=function(){var t,n=e,r=o[n?g:p],i=r[y]().split("-"),a=i.length,c=this.valueOf();e=s;do if(t=i.slice(0,a).join("-"),t in l&&w(t),t in u&&c in u[t])return u[t][c];while(a-->1);return!n&&o[g]?(e=f,b.call(c)):c};if(typeof XMLHttpRequest===n&&typeof ActiveXObject!==n){var L=ActiveXObject;t=function(){try{return new L("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new L("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new L("Msxml2.XMLHTTP")}catch(n){}throw new Error("XMLHttpRequest not supported by this browser.")}}else t=XMLHttpRequest;if(o[g]=o[g]||"",o[p]=i&&(i.language||i.userLanguage)||"",typeof document!==n)for(var T,M=document.getElementsByTagName("link"),O=M.length;O--;){var X=M[O],x=(X.getAttribute("rel")||"")[y]().split(/\s+/);c.test(X.type)&&(-1!==v.call(x,"localizations")?m(X.getAttribute("href")):-1!==v.call(x,"localization")&&(T={},T[(X.getAttribute("hreflang")||"")[y]()]=X.getAttribute("href"),m(T)))}}();
}
if( window.$.jsonp === undefined) {
// jquery.jsonp 2.4.0 (c)2012 Julian Aubourg | MIT License
// https://github.com/jaubourg/jquery-jsonp
(function(e){function t(){}function n(e){C=[e]}function r(e,t,n){return e&&e.apply&&e.apply(t.context||t,n)}function i(e){return/\?/.test(e)?"&":"?"}function O(c){function Y(e){z++||(W(),j&&(T[I]={s:[e]}),D&&(e=D.apply(c,[e])),r(O,c,[e,b,c]),r(_,c,[c,b]))}function Z(e){z++||(W(),j&&e!=w&&(T[I]=e),r(M,c,[c,e]),r(_,c,[c,e]))}c=e.extend({},k,c);var O=c.success,M=c.error,_=c.complete,D=c.dataFilter,P=c.callbackParameter,H=c.callback,B=c.cache,j=c.pageCache,F=c.charset,I=c.url,q=c.data,R=c.timeout,U,z=0,W=t,X,V,J,K,Q,G;return S&&S(function(e){e.done(O).fail(M),O=e.resolve,M=e.reject}).promise(c),c.abort=function(){!(z++)&&W()},r(c.beforeSend,c,[c])===!1||z?c:(I=I||u,q=q?typeof q=="string"?q:e.param(q,c.traditional):u,I+=q?i(I)+q:u,P&&(I+=i(I)+encodeURIComponent(P)+"=?"),!B&&!j&&(I+=i(I)+"_"+(new Date).getTime()+"="),I=I.replace(/=\?(&|$)/,"="+H+"$1"),j&&(U=T[I])?U.s?Y(U.s[0]):Z(U):(E[H]=n,K=e(y)[0],K.id=l+N++,F&&(K[o]=F),L&&L.version()<11.6?(Q=e(y)[0]).text="document.getElementById('"+K.id+"')."+p+"()":K[s]=s,A&&(K.htmlFor=K.id,K.event=h),K[d]=K[p]=K[v]=function(e){if(!K[m]||!/i/.test(K[m])){try{K[h]&&K[h]()}catch(t){}e=C,C=0,e?Y(e[0]):Z(a)}},K.src=I,W=function(e){G&&clearTimeout(G),K[v]=K[d]=K[p]=null,x[g](K),Q&&x[g](Q)},x[f](K,J=x.firstChild),Q&&x[f](Q,J),G=R>0&&setTimeout(function(){Z(w)},R)),c)}var s="async",o="charset",u="",a="error",f="insertBefore",l="_jqjsp",c="on",h=c+"click",p=c+a,d=c+"load",v=c+"readystatechange",m="readyState",g="removeChild",y="<script>",b="success",w="timeout",E=window,S=e.Deferred,x=e("head")[0]||document.documentElement,T={},N=0,C,k={callback:l,url:location.href},L=E.opera,A=!!e("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;O.setup=function(t){e.extend(k,t)},e.jsonp=O})(jQuery)
}
if( window.Coveo === undefined || window.Coveo['ModalBox'] === undefined) {
var Coveo;!function(o){var e;!function(e){function n(e,n){void 0===n&&(n={});var a=n.body||document.body;o.$(a).addClass("coveo-modalBox-opened");var l=o.$('<div class="coveo-modalBox" />').appendTo(a);n.fullscreen===!0&&l.addClass("coveo-fullscreen");var c=o.$('<div class="coveo-overlay" />').appendTo(l),d=o.$('<div class="coveo-wrapper" />').appendTo(l);if(null!=n.title){var v=o.$('<div class="coveo-title" />').appendTo(d);n.title instanceof o.$?v.append(n.title):v.html(n.title),n.titleClose===!0&&v.click(function(){return s()})}e.length>1&&(e=o.$("<div />").append(e)),d.append(e.addClass("coveo-body"));var i,s=function(e,c){void 0===e&&(e=0),void 0===c&&(c=!1);var d=null==n.validation||n.validation(e);if(d!==!1||c){l.detach();var v=o.$.inArray(s,t);return v>=0&&t.splice(v,1),0==o.$(a).find(".coveo-modalBox").length&&o.$(a).removeClass("coveo-modalBox-opened"),!0}return!1};if(null!=n.buttons){var r=function(o){return function(){return s(o)}};i=o.$('<div class="coveo-buttons" />').appendTo(d),1&n.buttons&&o.$('<div class="coveo-button">Ok</div>').click(r(1)).appendTo(i),2&n.buttons&&o.$('<div class="coveo-button">Apply</div>').click(r(2)).appendTo(i),4&n.buttons&&o.$('<div class="coveo-button">Yes</div>').click(r(4)).appendTo(i),8&n.buttons&&o.$('<div class="coveo-button">No</div>').click(r(8)).appendTo(i),16&n.buttons&&o.$('<div class="coveo-button">Cancel</div>').click(r(16)).appendTo(i)}return t.push(s),n.overlayClose===!0&&c.click(function(){return s()}),null!=n.className&&l.addClass(n.className),{modalBox:l,overlay:c,wrapper:d,buttons:i,content:e,close:s}}function a(o){void 0===o&&(o=!1);for(var e=0;t.length>e;){var n=t[e](0,o);n||e++}}!function(o){o[o.OK=1]="OK",o[o.APPLY=2]="APPLY",o[o.YES=4]="YES",o[o.NO=8]="NO",o[o.CANCEL=16]="CANCEL"}(e.BUTTON||(e.BUTTON={}));var t=(e.BUTTON,[]);e.open=n,e.close=a}(e=o.ModalBox||(o.ModalBox={}))}(Coveo||(Coveo={}));
}
if( window.fastclick === undefined) {
!function(){"use strict";function t(e,o){function i(t,e){return function(){return t.apply(e,arguments)}}var r;if(o=o||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=o.touchBoundary||10,this.layer=e,this.tapDelay=o.tapDelay||200,this.tapTimeout=o.tapTimeout||700,!t.notNeeded(e)){for(var a=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],c=this,s=0,u=a.length;u>s;s++)c[a[s]]=i(c[a[s]],c);n&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,o){var i=Node.prototype.removeEventListener;"click"===t?i.call(e,t,n.hijacked||n,o):i.call(e,t,n,o)},e.addEventListener=function(t,n,o){var i=Node.prototype.addEventListener;"click"===t?i.call(e,t,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),o):i.call(e,t,n,o)}),"function"==typeof e.onclick&&(r=e.onclick,e.addEventListener("click",function(t){r(t)},!1),e.onclick=null)}}var e=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!e,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,i=o&&/OS 4_\d(_\d)?/.test(navigator.userAgent),r=o&&/OS [6-7]_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(o&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var n,o;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),o=e.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},t.prototype.determineEventType=function(t){return n&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(t){var e;o&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,n;if(e=t.fastClickScrollParent,!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,n,r;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],o){if(r=window.getSelection(),r.rangeCount&&!r.isCollapsed)return!0;if(!i){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},t.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n?!0:!1},t.prototype.onTouchMove=function(t){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},t.prototype.onTouchEnd=function(t){var e,a,c,s,u,l=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,a=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,r&&(u=t.changedTouches[0],l=document.elementFromPoint(u.pageX-window.pageXOffset,u.pageY-window.pageYOffset)||l,l.fastClickScrollParent=this.targetElement.fastClickScrollParent),c=l.tagName.toLowerCase(),"label"===c){if(e=this.findControl(l)){if(this.focus(l),n)return!1;l=e}}else if(this.needsFocus(l))return t.timeStamp-a>100||o&&window.top!==window&&"input"===c?(this.targetElement=null,!1):(this.focus(l),this.sendClick(l,t),o&&"select"===c||(this.targetElement=null,t.preventDefault()),!1);return o&&!i&&(s=l.fastClickScrollParent,s&&s.fastClickLastScrollTop!==s.scrollTop)?!0:(this.needsClick(l)||(t.preventDefault(),this.sendClick(l,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return this.targetElement?t.forwardedTouchEvent?!0:t.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0:!0:!0},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail?!0:(e=this.onMouse(t),e||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;n&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,o,i,r;if("undefined"==typeof window.ontouchstart)return!0;if(o=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(o>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(a&&(i=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),i[1]>=10&&i[2]>=3&&(e=document.querySelector("meta[name=viewport]")))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction?!0:(r=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],r>=27&&(e=document.querySelector("meta[name=viewport]"),e&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===t.style.touchAction||"manipulation"===t.style.touchAction?!0:!1)},t.attach=function(e,n){return new t(e,n)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}();
}
var secretFeatureVariable1309=!1,Coveo;!function(e){e.version={lib : "1.0.176.50",product:"1.0.139.0",supportedApiVersion:2}}(Coveo||(Coveo={}));var Coveo;!function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];return e.L10N.format.apply(this,arguments)}e.l=t}(Coveo||(Coveo={})),function(){var e={Unknown:"Unknown",And:"AND",Authenticating:"Authenticating {0}...",Clear:"Clear {0}",CompleteQuery:"Complete Query",Exclude:"Exclude {0}",EnterTag:"Add Tag",Next:"Next",Last:"Last",Link:"Link",Or:"OR",Previous:"Previous",QueryDidntMatchAnyDocuments:"Your query did not match any documents.",QueryException:"Your query has an error: {0}.",Me:"Me",Remove:"Remove",Search:"Search",SearchFor:"Search for {0}",ShareQuery:"Share Query",Preferences:"Preferences",LinkOpeningSettings:"Link Opening Settings",Reauthenticate:"Reauthenticate {0}",ResultsFilteringExpression:"Results Filtering Expressions",FiltersInYourPreferences:"Filters in your preferences",Create:"Create",SearchIn:"Search in {0}",Seconds:"in {0} second<pl>s</pl>",ShowingResultsOf:"Result<pl>s</pl> {0}<pl>-{1}</pl> of {2}",SwitchTo:"Switch to {0}",Unexclude:"Unexclude {0}",ClearAllFilters:"Clear All Filters",SkipLogin:"Skip login",LoginInProgress:"Login in progress, please wait ...",Login:"Log In",GetStarted:"Get Started",More:"More",Less:"Fewer",Settings:"Settings",Score:"Score",ScoreDescription:"The score is computed from the number of occurrences as well as from the position in the result set.",Occurrences:"Occurrences",OccurrencesDescription:"Sort by number of occurrences, with values having the highest number appearing first.",Label:"Label",Of:"of",LabelDescription:"Sort alphabetically on the field values.",Value:"Value",ValueDescription:"Sort on the values of the first computed field",AlphaAscending:"Value Ascending",AlphaDescending:"Value Descending",ChiSquare:"Chi Square",Nosort:"No Sort",RelativeFrequency:"Relative Frequency",RelativeFrequencyDescription:"Sort based on the relative frequency of values. Less common values will appear higher.",DateDistribution:"Date distribution",Custom:"Custom",CustomDescription:"Sort based on a custom order",ComputedField:"Computed Field",Ascending:"Ascending",Descending:"Descending",noResultFor:"No results for {0}",autoCorrectedQueryTo:"Query was automatically corrected to {0}",didYouMean:"Did you mean: {0}",SuggestedResults:"Suggested Results",SuggestedQueries:"Suggested Queries",MostRelevantItems:"Most relevant items:",AllItems:"All items:",ShowLess:"Show less",ShowMore:"Show more",HideFacet:"Hide Facet",ShowFacet:"Show Facet",AndOthers:"and {0} other<pl>s</pl>",Others:"{0} other<pl>s</pl>",MostRelevantPosts:"Most Relevant Posts:",CompleteThread:"Complete Thread:",ShowCompleteThread:"Show Complete Thread",ShowOnlyTopMatchingPosts:"Show Only Top Matching Posts",MostRelevantReplies:"Most Relevant Replies:",AllConversation:"All Conversation:",ShowAllConversation:"Show All Conversation",ShowAllReplies:"Show All Replies",ShowOnlyMostRelevantReplies:"Show Only Most Relevant Replies",Close:"Close",Open:"Open",OpenInOutlookWhenPossible:"Open in Outlook (when possible)",AlwaysOpenInNewWindow:"Always open results in new window",Quickview:"Quick View",ErrorReport:"Error Report",OopsError:"Something went wrong.",ProblemPersists:"If the problem persists contact the administrator.",GoBack:"Go Back",Reset:"Reset",Retry:"Retry",MoreInfo:"More Information",Username:"Username",Password:"Password",PostedBy:"Posted by",CannotConnect:"Cannot connect to the server address.",BadUserPass:"Password does not match with username.",PleaseEnterYourCredentials:"Please enter your credentials for {0}.",PleaseEnterYourSearchPage:"Please enter your search page URL",Collapse:"Collapse",Collapsable:"Collapsible",Expand:"Expand",Today:"Today",Yesterday:"Yesterday",Tomorrow:"Tomorrow",Duration:"Duration: {0}",IndexDuration:"Index Duration: {0}",ProxyDuration:"Proxy Duration: {0}",ClientDuration:"Client Duration: {0}",Unavailable:"Unavailable",Reply:"Reply",ReplyAll:"Reply All",Forward:"Forward",From:"From",Caption:"Caption",Expression:"Expression",Tab:"Tab",Tabs:"Tabs",EnterExpressionName:"Enter expression name",EnterExpressionToFilterWith:"Enter expression to filter results with",SelectTab:"Select Tab",SelectAll:"Select All",PageUrl:"Search page URL",ErrorSavingToDevice:"Error while saving the information to your device",ErrorReadingFromDevice:"Error while reading the information from your device",AppIntro:"Speak with a product specialist who can answer your questions about Coveo and help you decide which Coveo solution is right for you. Or, try a live demo !",TryDemo:"Try the demo",ContactUs:"Contact us",NewToCoveo:"New to Coveo?",LetUsHelpGetStarted:"Let us help you get started",LikesThis:"{0} like<sn>s</sn> this.",CannotConnectSearchPage:"Cannot connect to your search page",AreYouSureDeleteFilter:"Are you sure you want to delete the filter {0} with the expression {1}",OnlineHelp:"Online Help",Done:"Done",SaveFacetState:"Save this facet state",ClearFacetState:"Clear facet state",DisplayingTheOnlyMessage:"Displaying the only message in this conversation",NoNetworkConnection:"No network connection",UnknownConnection:"Unknown connection",EthernetConnection:"Ethernet connection",WiFi:"WiFi connection",CELL:"Cellular connection",CELL_2G:"Cellular 2G connection",CELL_3G:"Cellular 3G connection",CELL_4G:"Cellular 4G connection",Relevance:"Relevance",Date:"Date",Amount:"Amount",QueryExceptionNoException:"No exception",QueryExceptionInvalidSyntax:"Invalid syntax",QueryExceptionInvalidCustomField:"Invalid custom field",QueryExceptionInvalidDate:"Invalid date",QueryExceptionInvalidExactPhrase:"Invalid exact phrase",QueryExceptionInvalidDateOp:"Invalid date operator",QueryExceptionInvalidNear:"Invalid NEAR operator",QueryExceptionInvalidWeightedNear:"Invalid weighted NEAR",QueryExceptionInvalidTerm:"Invalid term",QueryExceptionTooManyTerms:"Too many terms",QueryExceptionWildcardTooGeneral:"Wildcard too general",QueryExceptionInvalidSortField:"Invalid sort field",QueryExceptionInvalidSmallStringOp:"Invalid small string operator",QueryExceptionRequestedResultsMax:"Requested results maximum",QueryExceptionAggregatedMirrorDead:"Aggregated mirror is offline",QueryExceptionAggregatedMirrorQueryTimeOut:"Aggregated mirror query timeout",QueryExceptionAggregatedMirrorInvalidBuildNumber:"Aggregated mirror invalid build number",QueryExceptionAggregatedMirrorCannotConnect:"Aggregated mirror cannot connect",QueryExceptionNotEnoughLeadingCharsWildcard:"Not enough leading character wildcard",QueryExceptionSecurityInverterNotFound:"Security inverter not found",QueryExceptionSecurityInverterAccessDenied:"Security inverter access denied",QueryExceptionAggregatedMirrorCannotImpersonate:"Aggregated mirror cannot impersonate",QueryExceptionUnexpected:"Unexpected",QueryExceptionAccessDenied:"Access denied",QueryExceptionSuperUserTokenInvalid:"Super user token invalid",QueryExceptionSuperUserTokenExpired:"Super user token is expired",QueryExceptionLicenseQueriesExpired:"Queries license expired",QueryExceptionLicenseSuperUserTokenNotSupported:"License super user token not supported",QueryExceptionInvalidSession:"Invalid session",QueryExceptionInvalidDocument:"Invalid document",QueryExceptionSearchDisabled:"Search disabled",FileType:"File type",ShowAttachment:"Show attachment",OnFeed:"on {0}'s feed.",Author:"Author",NoTitle:"No title",CurrentSelections:"Current selections",AllContent:"All content",CancelLastAction:"Cancel last action",SearchTips:"Search tips",CheckSpelling:"Check the spelling of your keywords.",TryUsingFewerKeywords:"Try using fewer, different or more general keywords.",SelectFewerFilters:"Select fewer filters to broaden your search.",Document:"Document",Time:"Time",StartDate:"Start Date",StartTime:"Start Time",DurationTitle:"Duration",UserQuery:"User query",ShowUserActions:"Show User Actions",NoData:"No data available",EventType:"Event type",GoToFullSearch:"Full search",GoToEdition:"Customize Panel",RemoveContext:"Remove context",BoxAttachToCase:"Attach to Case",AttachToCase:"Attach to Case",Attach:"Attach",Detach:"Detach",AdditionalFilters:"Additional filters",SelectNonContextualSearch:"Remove the context from the current record to broaden your search",CopyPasteToSupport:"Copy paste this message to Coveo Support team for more information.",StartTypingCaseForSuggestions:"Describe your problem to see possible solutions",ExportToExcel:"Export to Excel",ExportToExcelDescription:"Export search results to Excel",CaseCreationNoResults:"No recommended solutions were found",objecttype_people:"People",objecttype_message:"Message",objecttype_feed:"RSS Feed",objecttype_thread:"Thread",objecttype_file:"File",objecttype_board:"",objecttype_category:"",objecttype_account:"Account",objecttype_campaign:"Campaign",objecttype_case:"Case",objecttype_contact:"Contact",objecttype_contract:"Contract",objecttype_event:"Event",objecttype_lead:"Lead",objecttype_solution:"Solution",objecttype_task:"Task",objecttype_user:"User",objecttype_attachment:"Attachment",objecttype_casecomment:"Case Comment",objecttype_opportunity:"Opportunity",objecttype_feeditem:"Chatter",objecttype_feedcomment:"Chatter",objecttype_note:"Note",objecttype_product:"Product",objecttype_partner:"Partner",objecttype_kbdocumentation:"Documentation",objecttype_kbsolution:"Solution",objecttype_kbknowledgearticle:"Knowledge Article",objecttype_kbattachment:"Attachment",sysfiletype_html:"HTML File",sysfiletype_image:"Image",sysfiletype_folder:"Folder",sysfiletype_txt:"Text",sysfiletype_zip:"Zip File",sysfiletype_pdf:"PDF File",sysfiletype_xml:"XML File",sysfiletype_doc:"Word Document",sysfiletype_xls:"Excel Document",sysfiletype_ppt:"PowerPoint Document",sysfiletype_video:"Video",sysfiletype_youtube:"YouTube video",sysfiletype_saleforceitem:"Salesforce",sysfiletype_exchangemessage:"Message",sysfiletype_exchangeappointment:"Appointment",sysfiletype_exchangenote:"Note",sysfiletype_exchangetask:"Task",sysfiletype_exchangeperson:"Exchange user",sysfiletype_activedirperson:"Active Directory user",sysfiletype_exchangeactivity:"Activity",sysfiletype_exchangecalendarmessage:"Calendar message",sysfiletype_exchangedocument:"Exchange document",sysfiletype_exchangerssfeed:"RSS Feed",sysfiletype_exchangejunkmessage:"Junk email",sysfiletype_exchangeofficecom:"Communications",sysfiletype_lithiummessage:"Message",sysfiletype_lithiumthread:"Thread",sysfiletype_lithiumboard:"Board",sysfiletype_lithiumcategory:"Category",sysfiletype_lithiumcommunity:"Community",sysfiletype_spportal:"Portal",sysfiletype_spsite:"Site",sysfiletype_spuserprofile:"SharePoint User",sysfiletype_sparea:"Area",sysfiletype_spannouncement:"Announcement",sysfiletype_spannouncementlist:"Announcements",sysfiletype_spcontact:"Contact",sysfiletype_spcontactlist:"Contacts",sysfiletype_spcustomlist:"Custom Lists",sysfiletype_spdiscussionboard:"Discussion Board",sysfiletype_spdiscussionboardlist:"Discussion Boards",sysfiletype_spdocumentlibrarylist:"Document Library",sysfiletype_spevent:"Event",sysfiletype_speventlist:"Events",sysfiletype_spformlibrarylist:"Form Library",sysfiletype_spissue:"Issue",sysfiletype_spissuelist:"Issues",sysfiletype_splink:"Link",sysfiletype_splinklist:"Links",sysfiletype_sppicturelibrarylist:"Picture Library",sysfiletype_spsurvey:"Survey",sysfiletype_spsurveylist:"Surveys",sysfiletype_sptask:"Task",sysfiletype_sptasklist:"Tasks",sysfiletype_spagenda:"Agenda",sysfiletype_spagendalist:"Agendas",sysfiletype_spattendee:"Attendee",sysfiletype_spattendeelist:"Attendees",sysfiletype_spcustomgridlist:"Custom Grids",sysfiletype_spdecision:"Decision",sysfiletype_spdecisionlist:"Decisions",sysfiletype_spobjective:"Objective",sysfiletype_spobjectivelist:"Objectives",sysfiletype_sptextbox:"Textbox",sysfiletype_sptextboxlist:"Textbox list",sysfiletype_spthingstobring:"Thing To Bring",sysfiletype_spthingstobringlist:"Things To Bring",sysfiletype_sparealisting:"Area Listing",sysfiletype_spmeetingserie:"Meeting series",sysfiletype_spmeetingserielist:"Meeting Series List",sysfiletype_spsitedirectory:"Site Directory Item",sysfiletype_spsitedirectorylist:"Site Directory",sysfiletype_spdatasource:"Data Source",sysfiletype_spdatasourcelist:"Data Source List",sysfiletype_splisttemplatecataloglist:"List Template Catalog List",sysfiletype_spwebpartcataloglist:"WebPart catalog list",sysfiletype_spwebtemplatecataloglist:"Web Template Catalog List",sysfiletype_spworkspacepagelist:"Workspace Page List",sysfiletype_spunknownlist:"Custom List",sysfiletype_spadministratortask:"Administrator Task",sysfiletype_spadministratortasklist:"Administrator Tasks",sysfiletype_spareadocumentlibrarylist:"Area Document Library",sysfiletype_spblogcategory:"Blog Category",sysfiletype_spblogcategorylist:"Blog Category",sysfiletype_spblogcomment:"Blog Comment",sysfiletype_spblogcommentlist:"Blog Comments",sysfiletype_spblogpost:"Blog Post",sysfiletype_spblogpostlist:"Blog Posts",sysfiletype_spdataconnectionlibrarylist:"Data Connection Library",sysfiletype_spdistributiongroup:"Distribution Group",sysfiletype_spdistributiongrouplist:"Distribution Groups",sysfiletype_spipfslist:"InfoPath Form Servers",sysfiletype_spkeyperformanceindicator:"Key Performance Indicator",sysfiletype_spkeyperformanceindicatorlist:"Key Performance Indicators",sysfiletype_splanguagesandtranslator:"Languages and Translator",sysfiletype_splanguagesandtranslatorlist:"Languages and Translators",sysfiletype_spmasterpagescataloglist:"Master Pages Library",sysfiletype_spnocodeworkflowlibrarylist:"No Code Workflow Library",sysfiletype_spprojecttask:"Project Task",sysfiletype_spprojecttasklist:"Project Tasks",sysfiletype_sppublishingpageslibrarylist:"Page Library",sysfiletype_spreportdocumentlibrarylist:"Report Document Library",sysfiletype_spreportlibrarylist:"Report Library",sysfiletype_spslidelibrarylist:"Slide Library",sysfiletype_sptab:"Tabs",sysfiletype_sptablist:"Tabs List",sysfiletype_sptranslationmanagementlibrarylist:"Translation Management Library",sysfiletype_spuserinformation:"User Information",sysfiletype_spuserinformationlist:"User Information List",sysfiletype_spwikipagelibrarylist:"Wiki Page Library",sysfiletype_spworkflowhistory:"Workflow History",sysfiletype_spworkflowhistorylist:"Workflow Histories",sysfiletype_spworkflowprocess:"Custom Workflow Process",sysfiletype_spworkflowprocesslist:"Custom Workflow Processes",sysfiletype_sppublishingimageslibrarylist:"Publishing Image Library",sysfiletype_spcirculation:"Circulation",sysfiletype_spcirculationlist:"Circulations",sysfiletype_spdashboardslibrarylist:"Dashboard Library",sysfiletype_spdataconnectionforperformancepointlibrarylist:"Data Connection for Performance Point Library",sysfiletype_sphealthreport:"Health Report",sysfiletype_sphealthreportlist:"Health Reports",sysfiletype_sphealthrule:"Health Rule",sysfiletype_sphealthrulelist:"Health Rules",sysfiletype_spimedictionary:"IME Dictionary",sysfiletype_spimedictionarylist:"IME Dictionaries",sysfiletype_spperformancepointcontent:"Performance Point Content",sysfiletype_spperformancepointcontentlist:"Performance Point Contents",sysfiletype_spphonecallmemo:"Phone Call Memo",sysfiletype_spphonecallmemolist:"Phone Call Memos",sysfiletype_sprecordlibrarylist:"Record Library",sysfiletype_spresource:"Resource",sysfiletype_spresourcelist:"Resources",sysfiletype_spprocessdiagramslibrarylist:"Process Diagram Library",sysfiletype_spsitethemeslibrarylist:"Site Theme Library",sysfiletype_spsolutionslibrarylist:"Solution Library",sysfiletype_spwfpublibrarylist:"WFPUB Library",sysfiletype_spwhereabout:"Whereabout",sysfiletype_spwhereaboutlist:"Whereabouts",sysfiletype_spdocumentlink:"Link to a Document",sysfiletype_spdocumentset:"Document Set",sysfiletype_spmicrofeedpost:"Microfeed Post",sysfiletype_spmicrofeedlist:"Microfeed",sysfiletype_splistfolder:"List Folder"},t=String.locales||(String.locales={});t.en=_.extend({},t.en,e),String.toLocaleString.call(this,{en:e}),String.locale="en",String.defaultLocale="en"}(),function(e){var t;t="undefined"!=typeof e.require&&"undefined"!=typeof e.exports&&"undefined"!=typeof e.module?e.require("globalize"):e.Globalize,t.addCultureInfo("en-US","default",{name:"en-US",englishName:"English (United States)"})}(this);var Coveo;!function(e){var t=/<pl>(((?!<\/pl>).)*)<\/pl>/g,i=/<sn>(((?!<\/sn>).)*)<\/sn>/g;e.L10N={format:function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t.toLocaleString();if(i.length>0){var s=e._.last(i);e._.isNumber(s)&&(i.pop(),o=e.L10N.formatPlSn(o,s));for(var r in i)o=o.replace("{"+r+"}",i[r])}return o},formatPlSn:function(e,n){return e=n>1?e.replace(t,"$1").replace(i,""):e.replace(t,"").replace(i,"$1")}}}(Coveo||(Coveo={}));var Coveo;!function(e){window.console||(console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},assert:function(){},clear:function(){},count:function(){},dir:function(){},dirxml:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},msIsIndependentlyComposed:function(){},profile:function(){},profileEnd:function(){},select:function(){},time:function(){},timeEnd:function(){},trace:function(){}});var t=function(){function e(e){this.owner=e}return e.prototype.trace=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.TRACE&&this.log("TRACE",t)},e.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.DEBUG&&this.log("DEBUG",t)},e.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.INFO&&this.log("INFO",t)},e.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.WARN&&this.log("WARN",t)},e.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.ERROR&&this.log("ERROR",t)},e.prototype.log=function(t,i){window.console&&console.log&&(console.log([t,this.owner].concat(i)),e.executionTime&&(console.timeEnd("Execution time"),console.time("Execution time")))},e.enable=function(){e.level=e.TRACE},e.disable=function(){e.level=e.NOTHING},e.TRACE=1,e.DEBUG=2,e.INFO=3,e.WARN=4,e.ERROR=5,e.NOTHING=6,e.level=e.INFO,e.executionTime=!1,e}();e.Logger=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.fail=function(e){t.failureHandler(e)},t.check=function(e,i){e||t.fail(i)},t.isUndefined=function(i){t.check(e.Utils.isUndefined(i),"Value should be undefined.")},t.isNotUndefined=function(i){t.check(!e.Utils.isUndefined(i),"Value should not be undefined.")},t.isNull=function(i){t.check(e.Utils.isNull(i),"Value should be null.")},t.isNotNull=function(i){t.check(!e.Utils.isNull(i),"Value should not be null.")},t.exists=function(i){t.check(!e.Utils.isNullOrUndefined(i),"Value should not be null or undefined")},t.doesNotExists=function(i){t.check(e.Utils.isNullOrUndefined(i),"Value should be null or undefined")},t.isString=function(i){t.check(e._.isString(i),"Value should be a string.")},t.stringStartsWith=function(e,i){t.isNonEmptyString(e),t.isNonEmptyString(i),t.check(0==e.indexOf(i),"Value should start with "+i)},t.isNonEmptyString=function(i){t.check(e.Utils.isNonEmptyString(i),"Value should be a non-empty string.")},t.isNumber=function(i){t.check(e._.isNumber(i),"Value should be a number.")},t.isLargerThan=function(e,i){t.check(i>e,"Value "+i+" should be larger than "+e)},t.isLargerOrEqualsThan=function(e,i){t.check(i>=e,"Value "+i+" should be larger or equal than "+e)},t.isSmallerThan=function(e,i){t.check(e>i,"Value "+i+" should be smaller than "+e)},t.isSmallerOrEqualsThan=function(e,i){t.check(e>=i,"Value "+i+" should be smaller or equal than "+e)},t.logger=new e.Logger("Assert"),t.failureHandler=function(n){throw t.logger.error("Assertion Failed!",n),window.console&&console.trace&&console.trace(),e.Utils.isNonEmptyString(n)?new i(n):new i("Assertion Failed!")},t}();e.Assert=t;var i=function(){function e(e){this.message=e}return e.prototype.toString=function(){return this.message},e}();e.PreconditionFailedException=i}(Coveo||(Coveo={}));var Coveo;!function(e){e.$=jQuery}(Coveo||(Coveo={}));var Coveo;!function(e){e._=window._}(Coveo||(Coveo={})),Coveo.$.fn.getCursorPosition=function(){var e=this.get(0);if(e){if("selectionStart"in e)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-i}}};var Coveo;!function(e){var t=function(){function t(){}return t.defer=function(e){t.functions.push(e),t.arm()},t.flush=function(){for(;t.popOne(););},t.arm=function(){e._.defer(function(){t.popOne()&&t.arm()})},t.popOne=function(){if(t.functions.length>0){var i=t.functions[0];return t.functions=e._.rest(t.functions),i(),t.functions.length>0}return!1},t.functions=[],t}();e.Defer=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.onEmpty=e,this.cache=[]}return e.prototype.get=function(){return 0==this.cache.length?this.onEmpty():this.cache.pop()},e.prototype.push=function(e){this.cache.push(e)},e}();e.Cache=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){return"undefined"==typeof e}function n(e){return null===e}function o(e){return t.isUndefined(e)||t.isNull(e)}function s(e){return!t.isNullOrUndefined(e)}function r(t){return e._.isString(t)?t:""}function a(e){return e?e.toString():""}function l(e){return t.isNullOrUndefined(e)||!t.isNonEmptyString(e)}function u(t){return e._.isString(t)&&""!==t}function c(e){return!u(e)}function p(e,t){return e.slice(0,t.length)==t}function d(t){return e._.isArray(t)&&t.length>0}function h(e){return!t.isNonEmptyArray(e)}function f(e){return void 0!=window.HTMLElement?e instanceof HTMLElement:e&&e.nodeType&&1==e.nodeType}function m(e){return t.isNonEmptyString(e)?parseInt(e,10):void 0}function v(e){return t.isNonEmptyString(e)?parseFloat(e):void 0}function g(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function y(e){if(!t.isNonEmptyString(e))return void 0;switch(e.toLowerCase()){case"true":case"1":case"yes":return!0;case"false":case"0":case"no":return!1;default:return void 0}}function C(e){return null==e?null:e.replace(/^\s+|\s+$/g,"")}function b(e){for(var t=[],i=e.length-1;i>=0;i--)t.unshift(["&#",e.charCodeAt(i),";"].join(""));return t.join("")}function S(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})}function x(t,i,n){if(void 0===n&&(n=!0),n)return e._.isEqual(t,i);var o=[t,i];return e._.all(o,function(t){return t.length==o[0].length&&0==e._.difference(t,o[0]).length})}function O(t,i){return e._.isEqual(t,i)}function T(e){return/^@[a-zA-Z0-9_\.]+$/.test(e)}function E(e){var t=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");return t}function A(t,i){var n=t[i];if(null==n){var o=i.toLowerCase();if(n=t[o],null==n){var s=e._.find(e._.keys(t),function(e){return e.toLowerCase()==o});null!=s&&(n=t[s])}}return n}function w(t,n){if(null==n)return void 0;if(n=n.trim(),"@"==n[0]&&(n=n.substr(1)),""==n)return void 0;e.Assert.check(T("@"+n));for(var o=n.split(".").reverse(),s=t.raw;o.length>1;)if(s=A(s,o.pop()),i(s))return void 0;var r=A(s,o[0]);return null==r&&(r=A(t,n)),r}function I(e,t,i,n,o){void 0===i&&(i={});var s,r=null,a=0,l=function(){a=i.leading===!1?0:(new Date).getTime(),r=null,s=e.apply(n,o)};return function(){var u=(new Date).getTime();a||i.leading!==!1||(a=u);var c=t-(u-a);return n=this,o=arguments,0>=c?(clearTimeout(r),r=null,a=u,s=e.apply(n,o)):r||i.trailing===!1||(r=setTimeout(l,c)),s}}function F(t,i){var n=this,o=e._.isArray(i),s=o&&[]||{};return o?(t=t||[],s=s.concat(t),e._.each(i,function(e,i){"undefined"==typeof t[i]?s[i]=e:"object"==typeof e?s[i]=n.extendDeep(t[i],e):-1===t.indexOf(e)&&s.push(e)})):(t&&"object"==typeof t&&e._.each(e._.keys(t),function(e){s[e]=t[e]}),e._.each(e._.keys(i),function(e){s[e]="object"==typeof i[e]&&i[e]?t[e]?n.extendDeep(t[e],i[e]):i[e]:i[e]})),s}function D(e,t){return void 0===t&&(t=window.location.search),t.replace(new RegExp("^(?:.*[&\\?]"+e.replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")}function _(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)}function R(e,t){var i,n;return function(){for(var o=this,s=[],r=0;r<arguments.length;r++)s[r-0]=arguments[r];null==i?(i=setTimeout(function(){i=null},t),n=setTimeout(function(){e.apply(o,s),n=null})):null==n&&(clearTimeout(i),i=setTimeout(function(){e.apply(o,s),i=null},t))}}function V(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}t.isUndefined=i,t.isNull=n,t.isNullOrUndefined=o,t.exists=s,t.toNotNullString=r,t.anyTypeToString=a,t.isNullOrEmptyString=l,t.isNonEmptyString=u,t.isEmptyString=c,t.stringStartsWith=p,t.isNonEmptyArray=d,t.isEmptyArray=h,t.isHtmlElement=f,t.parseIntIfNotUndefined=m,t.parseFloatIfNotUndefined=v,t.round=g,t.parseBooleanIfNotUndefined=y,t.trim=C,t.encodeHTMLEntities=b,t.decodeHTMLEntities=S,t.arrayEqual=x,t.objectEqual=O,t.isCoveoField=T,t.escapeRegexCharacter=E,t.getCaseInsensitiveProperty=A,t.getFieldValue=w,t.throttle=I,t.extendDeep=F,t.getQueryStringValue=D,t.isValidUrl=_,t.debounce=R,t.readCookie=V}(t=e.Utils||(e.Utils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){void 0===t&&(t=!0),this.milliseconds=t?e:1e3*e}return t.prototype.getMilliseconds=function(){return this.milliseconds},t.prototype.getSeconds=function(){return this.getMilliseconds()/1e3},t.prototype.getMinutes=function(){return this.getSeconds()/60},t.prototype.getHours=function(){return this.getMinutes()/60},t.prototype.getDays=function(){return this.getHours()/24},t.prototype.getWeeks=function(){return this.getDays()/7},t.prototype.getHHMMSS=function(){var e,t,i,n=Math.floor(this.getHours()),o=Math.floor(this.getMinutes())%60,s=Math.floor(this.getSeconds())%60;e=0==n?"":10>n?"0"+n.toString():n.toString(),t=10>o?"0"+o.toString():o.toString(),i=10>s?"0"+s.toString():s.toString();var r=(""!=e?e+":":"")+t+":"+i;return r},t.fromDates=function(i,n){return e.Assert.exists(i),e.Assert.exists(n),new t(n.valueOf()-i.valueOf())},t}();e.TimeSpan=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){var e=navigator.userAgent;return e.match(/Android/i)?"Android":e.match(/BlackBerry/i)?"BlackBerry":e.match(/iPhone/i)?"iPhone":e.match(/iPad/i)?"iPad":e.match(/iPod/i)?"iPod":e.match(/Opera Mini/i)?"Opera Mini":e.match(/IEMobile/i)?"IE Mobile":e.match(/Chrome/i)?"Chrome":e.match(/MSIE/i)||e.match(/Trident/i)?"IE":e.match(/Opera/i)?"Opera":e.match(/Firefox/i)?"Firefox":e.match(/Safari/i)?"Safari":"Others"}function i(){return"Android"==t()}function n(){var e=t();return"iPhone"==e||"iPad"==e||"iPod"==e}function o(){var e=navigator.userAgent.toLowerCase();return-1==e.indexOf("msie")?!1:parseInt(e.split("msie")[1])<10}function s(){return u}function r(){return c}function a(){return screen.width<=480}function l(){return screen.height<=640}var u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),c=/^file:\/\/\/.*_asset/i.test(document.URL)||/^file:\/\/\/.*var\/mobile/i.test(document.URL)||/^file:\/\/\/.*\/CoreSimulator/.test(document.URL);e.getDeviceName=t,e.isAndroid=i,e.isIos=n,e.isIE8or9=o,e.isMobileDevice=s,e.isPhonegap=r,e.isSmallScreenWidth=a,e.isSmallScreenHeight=l}(t=e.DeviceUtils||(e.DeviceUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.createGuid=function(){return"undefined"!=typeof crypto&&"undefined"!=typeof crypto.getRandomValues?t.generateWithCrypto():t.generateWithRandom()},t.generateWithRandom=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},t.generateWithCrypto=function(){var e=new Uint16Array(8);crypto.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])},t.setStateObjectOnQueryResults=function(e,i){t.setPropertyOnResults(i,"state",e)},t.setStateObjectOnQueryResult=function(e,i){t.setPropertyOnResult(i,"state",e)},t.setIndexAndUidOnQueryResults=function(i,n,o,s,r){e.Assert.exists(i),e.Assert.exists(n);var a=i.firstResult;t.setPropertyOnResults(n,"queryUid",o),t.setPropertyOnResults(n,"pipeline",s),t.setPropertyOnResults(n,"splitTestRun",r),t.setPropertyOnResults(n,"index",a,function(){return++a})},t.setTermsToHighlightOnQueryResults=function(e,i){t.setPropertyOnResults(i,"termsToHighlight",i.termsToHighlight),t.setPropertyOnResults(i,"phrasesToHighlight",i.phrasesToHighlight)},t.splitFlags=function(t,i){return void 0===i&&(i=";"),e.Assert.exists(t),t.split(i)},t.isAttachment=function(i){return e._.contains(t.splitFlags(i.flags),"IsAttachment")},t.containsAttachment=function(i){return e._.contains(t.splitFlags(i.flags),"ContainsAttachment")},t.hasHTMLVersion=function(i){return e._.contains(t.splitFlags(i.flags),"HasHtmlVersion")},t.hasThumbnail=function(i){return e._.contains(t.splitFlags(i.flags),"HasThumbnail")},t.quoteAndEscapeIfNeeded=function(i){return e.Assert.isString(i),t.isAtomicString(i)||t.isRangeString(i)||t.isRangeWithoutOuterBoundsString(i)?i:t.quoteAndEscape(i)},t.quoteAndEscape=function(i){return e.Assert.isString(i),'"'+t.escapeString(i)+'"'},t.escapeString=function(t){return e.Assert.isString(t),t.replace(/"/g," ")},t.isAtomicString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^[\d\w]+$/.test(t)},t.isRangeString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?\.\.\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}\.\.\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.isRangeWithoutOuterBoundsString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.buildFieldExpression=function(i,n,o){return e.Assert.isNonEmptyString(i),e.Assert.stringStartsWith(i,"@"),e.Assert.isNonEmptyString(n),e.Assert.isLargerOrEqualsThan(1,o.length),1==o.length?i+n+t.quoteAndEscapeIfNeeded(o[0]):i+n+"("+e._.map(o,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")"},t.buildFieldNotEqualExpression=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.stringStartsWith(i,"@"),e.Assert.isLargerOrEqualsThan(1,n.length);var o;return o=1==n.length?i+"=="+t.quoteAndEscapeIfNeeded(n[0]):i+"==("+e._.map(n,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")","(NOT "+o+")"},t.mergeQueryString=function(e,t){var i=e.indexOf("?");return e+=-1!=i?"&"+t:"?"+t},t.mergePath=function(e,t){var i=e.split("?");return i[0]+t+"?"+(i[1]||"")},t.setPropertyOnResults=function(i,n,o,s){e._.each(i.results,function(e){t.setPropertyOnResult(e,n,o),o=s?s():o})},t.setPropertyOnResult=function(t,i,n){t[i]=n,e._.each(t.childResults,function(e){e[i]=n}),e.Utils.isNullOrUndefined(t.parentResult)||(t.parentResult[i]=n)},t.getUrlParameter=function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},t}();e.QueryUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.javascriptEncode=function(t){return e.Assert.isString(t),t=t.replace(/\\/g,"\\\\"),t=t.replace(/'/g,"\\'"),t=t.replace(/"/g,'\\"')},t.htmlEncode=function(t){return e.Assert.isString(t),e.$("<div/>").text(t).html()},t.splice=function(e,t,i,n){return e.slice(0,t)+n+e.slice(t+Math.abs(i))},t.removeMiddle=function(e,i,n){if(e.length<i)return e;var o=e.length-i,s=Math.floor(i/2);return t.splice(e,s,o,n)},t.regexEncode=function(t){return e.Assert.isString(t),t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.stringToRegex=function(i,n){void 0===n&&(n=!1),e.Assert.isString(i);var o=t.regexEncode(i);return n?e._.map(o,function(i){var n=e._.find(t.accented,function(e){return null!=i.match(e)
});return n?n.source:i}).join(""):o},t.wildcardsToRegex=function(i,n){void 0===n&&(n=!1),e.Assert.isString(i);var o=t.stringToRegex(i,n);return o=o.replace(/\\\*/,".*"),o=o.replace(/\\\?/,".")},t.getHighlights=function(t,i,n){for(var o,s=[];o=i.exec(t);){var r=o[2],a=o[1],l=o.index+a.length;if(s.push({offset:l,length:r.length,dataHighlightGroupTerm:n}),!i.global)break}return e._.isEmpty(s)?void 0:s},t.encodeCarriageReturn=function(t){return e.Assert.isString(t),t.replace(/\n/g,"<br/>")},t.equalsCaseInsensitive=function(e,t){return e.toLowerCase()==t.toLowerCase()},t.match=function(e,t){for(var i,n=[];null!==(i=t.exec(e));)n.push(i);return n},t.removePunctuation=function(e){var t=/[\u2000-\u206F\u2E00-\u2E7F\\'!"#\$%&\(\)\*\+,\-\.\/:;<=>\?@\[\]\^_`\{\|\}~]/g,i=/\s+/g;return e.replace(t,"").replace(i," ")},t.accented={A:/[Aa\xaa\xc0-\xc5\xe0-\xe5\u0100-\u0105\u01cd\u01ce\u0200-\u0203\u0226\u0227\u1d2c\u1d43\u1e00\u1e01\u1e9a\u1ea0-\u1ea3\u2090\u2100\u2101\u213b\u249c\u24b6\u24d0\u3371-\u3374\u3380-\u3384\u3388\u3389\u33a9-\u33af\u33c2\u33ca\u33df\u33ff\uff21\uff41]/g,B:/[Bb\u1d2e\u1d47\u1e02-\u1e07\u212c\u249d\u24b7\u24d1\u3374\u3385-\u3387\u33c3\u33c8\u33d4\u33dd\uff22\uff42]/g,C:/[Cc\xc7\xe7\u0106-\u010d\u1d9c\u2100\u2102\u2103\u2105\u2106\u212d\u216d\u217d\u249e\u24b8\u24d2\u3376\u3388\u3389\u339d\u33a0\u33a4\u33c4-\u33c7\uff23\uff43]/g,D:/[Dd\u010e\u010f\u01c4-\u01c6\u01f1-\u01f3\u1d30\u1d48\u1e0a-\u1e13\u2145\u2146\u216e\u217e\u249f\u24b9\u24d3\u32cf\u3372\u3377-\u3379\u3397\u33ad-\u33af\u33c5\u33c8\uff24\uff44]/g,E:/[Ee\xc8-\xcb\xe8-\xeb\u0112-\u011b\u0204-\u0207\u0228\u0229\u1d31\u1d49\u1e18-\u1e1b\u1eb8-\u1ebd\u2091\u2121\u212f\u2130\u2147\u24a0\u24ba\u24d4\u3250\u32cd\u32ce\uff25\uff45]/g,F:/[Ff\u1da0\u1e1e\u1e1f\u2109\u2131\u213b\u24a1\u24bb\u24d5\u338a-\u338c\u3399\ufb00-\ufb04\uff26\uff46]/g,G:/[Gg\u011c-\u0123\u01e6\u01e7\u01f4\u01f5\u1d33\u1d4d\u1e20\u1e21\u210a\u24a2\u24bc\u24d6\u32cc\u32cd\u3387\u338d-\u338f\u3393\u33ac\u33c6\u33c9\u33d2\u33ff\uff27\uff47]/g,H:/[Hh\u0124\u0125\u021e\u021f\u02b0\u1d34\u1e22-\u1e2b\u1e96\u210b-\u210e\u24a3\u24bd\u24d7\u32cc\u3371\u3390-\u3394\u33ca\u33cb\u33d7\uff28\uff48]/g,I:/[Ii\xcc-\xcf\xec-\xef\u0128-\u0130\u0132\u0133\u01cf\u01d0\u0208-\u020b\u1d35\u1d62\u1e2c\u1e2d\u1ec8-\u1ecb\u2071\u2110\u2111\u2139\u2148\u2160-\u2163\u2165-\u2168\u216a\u216b\u2170-\u2173\u2175-\u2178\u217a\u217b\u24a4\u24be\u24d8\u337a\u33cc\u33d5\ufb01\ufb03\uff29\uff49]/g,J:/[Jj\u0132-\u0135\u01c7-\u01cc\u01f0\u02b2\u1d36\u2149\u24a5\u24bf\u24d9\u2c7c\uff2a\uff4a]/g,K:/[Kk\u0136\u0137\u01e8\u01e9\u1d37\u1d4f\u1e30-\u1e35\u212a\u24a6\u24c0\u24da\u3384\u3385\u3389\u338f\u3391\u3398\u339e\u33a2\u33a6\u33aa\u33b8\u33be\u33c0\u33c6\u33cd-\u33cf\uff2b\uff4b]/g,L:/[Ll\u0139-\u0140\u01c7-\u01c9\u02e1\u1d38\u1e36\u1e37\u1e3a-\u1e3d\u2112\u2113\u2121\u216c\u217c\u24a7\u24c1\u24db\u32cf\u3388\u3389\u33d0-\u33d3\u33d5\u33d6\u33ff\ufb02\ufb04\uff2c\uff4c]/g,M:/[Mm\u1d39\u1d50\u1e3e-\u1e43\u2120\u2122\u2133\u216f\u217f\u24a8\u24c2\u24dc\u3377-\u3379\u3383\u3386\u338e\u3392\u3396\u3399-\u33a8\u33ab\u33b3\u33b7\u33b9\u33bd\u33bf\u33c1\u33c2\u33ce\u33d0\u33d4-\u33d6\u33d8\u33d9\u33de\u33df\uff2d\uff4d]/g,N:/[Nn\xd1\xf1\u0143-\u0149\u01ca-\u01cc\u01f8\u01f9\u1d3a\u1e44-\u1e4b\u207f\u2115\u2116\u24a9\u24c3\u24dd\u3381\u338b\u339a\u33b1\u33b5\u33bb\u33cc\u33d1\uff2e\uff4e]/g,O:/[Oo\xba\xd2-\xd6\xf2-\xf6\u014c-\u0151\u01a0\u01a1\u01d1\u01d2\u01ea\u01eb\u020c-\u020f\u022e\u022f\u1d3c\u1d52\u1ecc-\u1ecf\u2092\u2105\u2116\u2134\u24aa\u24c4\u24de\u3375\u33c7\u33d2\u33d6\uff2f\uff4f]/g,P:/[Pp\u1d3e\u1d56\u1e54-\u1e57\u2119\u24ab\u24c5\u24df\u3250\u3371\u3376\u3380\u338a\u33a9-\u33ac\u33b0\u33b4\u33ba\u33cb\u33d7-\u33da\uff30\uff50]/g,Q:/[Qq\u211a\u24ac\u24c6\u24e0\u33c3\uff31\uff51]/g,R:/[Rr\u0154-\u0159\u0210-\u0213\u02b3\u1d3f\u1d63\u1e58-\u1e5b\u1e5e\u1e5f\u20a8\u211b-\u211d\u24ad\u24c7\u24e1\u32cd\u3374\u33ad-\u33af\u33da\u33db\uff32\uff52]/g,S:/[Ss\u015a-\u0161\u017f\u0218\u0219\u02e2\u1e60-\u1e63\u20a8\u2101\u2120\u24ae\u24c8\u24e2\u33a7\u33a8\u33ae-\u33b3\u33db\u33dc\ufb06\uff33\uff53]/g,T:/[Tt\u0162-\u0165\u021a\u021b\u1d40\u1d57\u1e6a-\u1e71\u1e97\u2121\u2122\u24af\u24c9\u24e3\u3250\u32cf\u3394\u33cf\ufb05\ufb06\uff34\uff54]/g,U:/[Uu\xd9-\xdc\xf9-\xfc\u0168-\u0173\u01af\u01b0\u01d3\u01d4\u0214-\u0217\u1d41\u1d58\u1d64\u1e72-\u1e77\u1ee4-\u1ee7\u2106\u24b0\u24ca\u24e4\u3373\u337a\uff35\uff55]/g,V:/[Vv\u1d5b\u1d65\u1e7c-\u1e7f\u2163-\u2167\u2173-\u2177\u24b1\u24cb\u24e5\u2c7d\u32ce\u3375\u33b4-\u33b9\u33dc\u33de\uff36\uff56]/g,W:/[Ww\u0174\u0175\u02b7\u1d42\u1e80-\u1e89\u1e98\u24b2\u24cc\u24e6\u33ba-\u33bf\u33dd\uff37\uff57]/g,X:/[Xx\u02e3\u1e8a-\u1e8d\u2093\u213b\u2168-\u216b\u2178-\u217b\u24b3\u24cd\u24e7\u33d3\uff38\uff58]/g,Y:/[Yy\xdd\xfd\xff\u0176-\u0178\u0232\u0233\u02b8\u1e8e\u1e8f\u1e99\u1ef2-\u1ef9\u24b4\u24ce\u24e8\u33c9\uff39\uff59]/g,Z:/[Zz\u0179-\u017e\u01f1-\u01f3\u1dbb\u1e90-\u1e95\u2124\u2128\u24b5\u24cf\u24e9\u3390-\u3394\uff3a\uff5a]/g},t}();e.StringUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e,t,a,c,p,d){void 0===d&&(d=0),e.appendTo(a),p.verticalOffset=p.verticalOffset?p.verticalOffset:0,p.horizontalOffset=p.horizontalOffset?p.horizontalOffset:0;var h=t.offset();o(h,e,t,p),s(h,e,t,p),n(e.offset(),h,e,p);var f=l(e),m=l(c);if(2>d){var v=u(f,m);if("ok"!=v.vertical||"ok"!=v.horizontal){var g=r(p,v);i(e,t,a,c,g,d+1)}}}function n(e,t,i,n){var o=i.position();i.css({position:"absolute",top:o.top+n.verticalOffset-(e.top-t.top)+"px",left:o.left+n.horizontalOffset-(e.left-t.left)+"px"})}function o(e,t,i,n){switch(n.vertical){case 0:e.top-=t.outerHeight();break;case 2:e.top+=i.outerHeight();break;case 1:e.top-=t.outerHeight()/3;case 3:break;case 4:e.top-=t.outerHeight()-i.outerHeight()}}function s(e,t,i,n){switch(n.horizontal){case 0:e.left-=t.outerWidth();break;case 2:e.left+=i.outerWidth();break;case 1:e.left+=a(t,i);break;case 3:break;case 4:e.left-=t.outerWidth()-i.outerWidth()}}function r(e,t){var i=e;return"left"==t.horizontal&&(i.horizontal=2),"right"==t.horizontal&&(i.horizontal=0),"top"==t.vertical&&(i.vertical=2),"bottom"==t.vertical&&(i.vertical=0),i}function a(e,t){return(t.outerWidth()-e.outerWidth())/2}function l(e){var t=e.offset();return{top:t.top,left:t.left,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight()}}function u(e,t){var i={vertical:"ok",horizontal:"ok"};return e.top<t.top&&(i.vertical="top"),e.bottom>t.bottom&&(i.vertical="bottom"),e.left<t.left&&(i.horizontal="left"),e.right>t.right&&(i.horizontal="right"),i}function c(t,i,n){var o="";i.showDate&&(o=e.DateUtils.dateTimeToString(new Date(t.raw.sysdate)));var s=e.FileTypes.get(t),r=e.$("<div class='coveo-quickview-right-header'>\n        <span class='coveo-quickview-time'>"+o+"</span>\n        <span class='coveo-quickview-close-button'>\n          <span class='coveo-icon coveo-sprites-common-clear'></span>\n        </span>\n      </div>\n      <div class='coveo-quickview-left-header'>\n        <span class='coveo-quickview-icon "+s.icon+"'></span>\n        <span class='coveo-quickview-pop-up-reminder'> "+(i.title||"")+"</span>\n      </div>");return new e.ResultLink(r.find(".coveo-quickview-pop-up-reminder").get(0),void 0,n,t),r}function p(e,t){return"<span class='coveo-close-button'><span class='coveo-icon coveo-sprites-quickview-close'></span>"+e+"</span><span class='coveo-pop-up-reminder' >"+t+"</span>"}function d(){var t="coveo-loading-dot";return e.$("<div class='coveo-first-loading-animation' ><div class='coveo-logo' ></div><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function h(){var t="coveo-loading-dot";return e.$("<div class='coveo-generic-loading-animation coveo-loading-animation'><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function f(){return e.$('<div class="coveo-loading-spinner"/>')}function m(t,i){var n=new RegExp(e.Utils.escapeRegexCharacter(i),"i"),o=t.search(n),s=o+i.length;return e.StringUtils.htmlEncode(t.slice(0,o))+"<span class='coveo-highlight'>"+e.StringUtils.htmlEncode(t.slice(o,s))+"</span>"+e.StringUtils.htmlEncode(t.slice(s))}function v(t){for(var i=e.$(t);!i.is(document)&&0!=i.length;){if(g(i))return i.is("body")?e.$(window).get(0):i.get(0);i=i.parent()}return e.$(window).get(0)}function g(e){return"scroll"==e.css("overflow-y")}function y(t){var i=e.$("<div>").html(t);return 1==i.children().length?i.children().get(0):i.get(0)}!function(e){e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.innerTop=3]="innerTop",e[e.innerBottom=4]="innerBottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalAlignment;!function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right",e[e.innerLeft=3]="innerLeft",e[e.innerRight=4]="innerRight"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.HorizontalAlignment;t.positionPopup=i,t.getQuickviewHeader=c,t.getPopUpCloseButton=p,t.getBasicLoadingAnimation=d,t.getBasicLoadingDots=h,t.getLoadingSpinner=f,t.highlightElement=m,t.findScrollingParent=v,t.htmlToDom=y,e.$.fn.fastToggle=function(e){return this.css("display",e?"":"none")}}(t=e.JQueryUtils||(e.JQueryUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.getHash=function(i){void 0===i&&(i=window),e.Assert.exists(i);var n="#"+(i.location.href.split("#")[1]||"");return t.getAjaxcrawlableHash(n)},t.getValue=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),n=t.getAjaxcrawlableHash(n);var o=t.getRawValue(i,n);return void 0!=o&&(o=t.getValueDependingOnType(o)),o},t.encodeValues=function(i){var n=[];return e._.each(i,function(i,o){var s="";s=e.Utils.isNonEmptyArray(i)?t.encodeArray(i):e._.isObject(i)&&e.Utils.isNonEmptyArray(e._.keys(i))?t.encodeObject(i):encodeURIComponent(i.toString()),""!=s&&n.push(o+"="+s)}),n.join("&")},t.getAjaxcrawlableHash=function(e){return void 0!=e[1]&&"!"==e[1]?e.substring(0,1)+e.substring(2):e},t.getRawValue=function(t,i){e.Assert.exists(t),e.Assert.exists(i),e.Assert.check(0==i.indexOf("#")||""==i);for(var n=i.substr(1).split("&"),o=0,s=!0,r=void 0;s;){var a=n[o].split("=");a[0]==t?(s=!1,r=a[1]):(o++,o>=n.length&&(o=void 0,s=!1))}return r},t.getValueDependingOnType=function(e){var i,n=t.getValueType(e);return i="object"==n?t.decodeObject(e):"array"==n?t.decodeArray(e):decodeURIComponent(e)},t.getValueType=function(e){return t.isObject(e)?"object":t.isArray(e)?"array":"other"},t.isArrayStartNotEncoded=function(e){return e.substr(0,1)==t.Delimiter.arrayStart},t.isArrayStartEncoded=function(e){return 0==e.indexOf(encodeURIComponent(t.Delimiter.arrayStart))},t.isArrayEndNotEncoded=function(e){return e.substr(e.length-1)},t.isArrayEndEncoded=function(e){return e.indexOf(encodeURIComponent(t.Delimiter.arrayEnd))==e.length-encodeURIComponent(t.Delimiter.arrayEnd).length},t.isObjectStartNotEncoded=function(e){return e.substr(0,1)==t.Delimiter.objectStart},t.isObjectStartEncoded=function(e){return 0==e.indexOf(encodeURIComponent(t.Delimiter.objectStart))},t.isObjectEndNotEncoded=function(e){return e.substr(e.length-1)==t.Delimiter.objectEnd},t.isObjectEndEncoded=function(e){return e.indexOf(encodeURIComponent(t.Delimiter.objectEnd))==e.length-encodeURIComponent(t.Delimiter.objectEnd).length},t.isObject=function(e){var i=t.isObjectStartNotEncoded(e)||t.isObjectStartEncoded(e),n=t.isObjectEndNotEncoded(e)||t.isObjectEndEncoded(e);return i&&n},t.isArray=function(e){var i=t.isArrayStartNotEncoded(e)||t.isArrayStartEncoded(e),n=t.isArrayEndNotEncoded(e)||t.isArrayEndEncoded(e);return i&&n},t.encodeArray=function(i){var n=[];return e._.each(i,function(e){n.push(encodeURIComponent(e))}),t.Delimiter.arrayStart+n.join(",")+t.Delimiter.arrayEnd},t.encodeObject=function(i){var n=t.Delimiter.objectStart,o=[];return e._.each(i,function(i,n){var s="";s+='"'+encodeURIComponent(n)+'" : ',s+=e._.isArray(i)?t.encodeArray(i):e._.isObject(i)?t.encodeObject(i):e._.isNumber(i)||e._.isBoolean(i)?encodeURIComponent(i):'"'+encodeURIComponent(i)+'"',o.push(s)}),n+=o.join(" , "),n+t.Delimiter.objectEnd},t.decodeObject=function(e){return t.isObjectStartEncoded(e)&&t.isObjectEndEncoded(e)&&(e=e.replace(/encodeURIComponent(HashUtils.Delimiter.objectStart)/,t.Delimiter.objectStart),e=e.replace(encodeURIComponent(t.Delimiter.objectEnd),t.Delimiter.objectEnd)),JSON.parse(decodeURIComponent(e))},t.decodeArray=function(i){t.isArrayStartEncoded(i)&&t.isArrayEndEncoded(i)&&(i=i.replace(encodeURIComponent(t.Delimiter.arrayStart),t.Delimiter.arrayStart),i=i.replace(encodeURIComponent(t.Delimiter.arrayEnd),t.Delimiter.arrayEnd)),i=i.substr(1),i=i.substr(0,i.length-1);var n=i.split(",");return e._.map(n,function(e){return decodeURIComponent(e)})},t.Delimiter={objectStart:"{",objectEnd:"}",arrayStart:"[",arrayEnd:"]",objectStartRegExp:"^{",objectEndRegExp:"}+$",arrayStartRegExp:"^[",arrayEndRegExp:"]+$"},t}();e.HashUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){c.addClass("active"),setTimeout(function(){c.removeClass("active")},e)}function n(e,t){e.addClass("coveo-clicked"),setTimeout(function(){e.removeClass("coveo-clicked")},t)}function o(i,n){void 0===n&&(n=!1);var o="."+e.Component.computeCssClassNameForType(e.SearchInterface.ID);e.$(o+",.coveo-glass").addClass("coveo-"+i),e.$(".coveo-glass").addClass("coveo-active-glass"),n&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).on("backbutton",e.$.proxy(t.removeToggleClassOnSearchInterface,this,!0))}function s(t){void 0===t&&(t=!1);var i="."+e.Component.computeCssClassNameForType(e.SearchInterface.ID);e.$(i+",.coveo-glass").removeClass("coveo-slide-right").removeClass("coveo-slide-left").removeClass("coveo-active-glass").removeClass("coveo-active-glass-for-current-tab"),e.$(".coveo-tab-section").removeClass("coveo-opened-by-current-tab");var n=e.Component.getComponentRef("CurrentTab");if(n){var o="."+e.Component.computeCssClassNameForType(n.ID);e.$(o).removeClass("coveo-opening-tab-section")}t&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).off("backbutton")}function r(){e.$("."+e.Component.computeCssClassNameForType(e.SearchInterface.ID)).append(c)}function a(t){e.$(window).focus(),e.$(t).blur()}function l(){e.DeviceUtils.isIos()&&e.$(window).on("touchstart",function(i){!e.$(i.target).is("input")&&e.$(document.activeElement).is("input")&&t.hideIOSKeyboard(document.activeElement)})}function u(){e.DeviceUtils.isMobileDevice()&&(e.$(function(){return r()}),l())}var c=e.$(document.createElement("div")).addClass("coveo-click-canceling-overlay");t.showClickCancelingOverlay=i,t.showClickFeedback=n,t.addToggleClassOnSearchInterface=o,t.removeToggleClassOnSearchInterface=s,t.hideIOSKeyboard=a,u()}(t=e.MobileUtils||(e.MobileUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(e,t,i){var n,o,s,r=Math.floor(6*e),a=6*e-r,l=i*(1-t),u=i*(1-a*t),c=i*(1-(1-a)*t);switch(r%6){case 0:n=i,o=c,s=l;break;case 1:n=u,o=i,s=l;break;case 2:n=l,o=i,s=c;break;case 3:n=l,o=u,s=i;break;case 4:n=c,o=l,s=i;break;case 5:n=i,o=l,s=u}return[Math.round(255*n),Math.round(255*o),Math.round(255*s)]}function i(e,t,i){e/=255,t/=255,i/=255;var n,o,s=Math.max(e,t,i),r=Math.min(e,t,i),a=s,l=s-r;if(o=0==s?0:l/s,s==r)n=0;else{switch(s){case e:n=(t-i)/l+(i>t?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return[n,o,a]}e.hsvToRgb=t,e.rgbToHsv=i}(t=e.ColorUtils||(e.ColorUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){this.message=t,this.status=i,e.Assert.exists(t),e.Assert.exists(i),this.type="Ajax Error (status: "+i+")"}return t}();e.AjaxError=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.provider=e,this.isMissingAuthentication=!0,this.type=this.message="Missing Authentication (provider: "+e+")"}return e}();e.MissingAuthenticationError=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.status=t.statusCode,this.message=t.data.message,this.type=t.data.type,this.queryExecutionReport=t.data.executionReport,e.Assert.isNumber(this.status),e.Assert.isNonEmptyString(this.message),e.Assert.isNonEmptyString(this.type)}return t}();e.QueryError=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){e[e.OPENED=XMLHttpRequest.OPENED||1]="OPENED",e[e.DONE=XMLHttpRequest.DONE||4]="DONE"}(t||(t={}));var i=function(){function i(t){void 0===t&&(t={}),this.options=t,this.useJsonp=!1,this.logger=new e.Logger(this)}return i.prototype.call=function(t){e.Assert.isNonEmptyString(t.url);var n={url:t.url,queryString:t.errorsAsSuccess?t.queryString.concat(["errorsAsSuccess=1"]):t.queryString,requestData:t.requestData,deferred:e.$.Deferred(),begun:new Date,method:t.method};this.logger.trace("Performing REST request",n);var o=i.parseURL(n.url),s=window.location.hostname===o.hostname||""===o.hostname,r=""!=window.location.port?window.location.port:"https:"==window.location.protocol?"443":"80",a=r==o.port,l=!(s&&a);return this.useJsonp?this.callUsingAjaxJsonP(n):this.isCORSSupported()||!l?this.callUsingXMLHttpRequest(n,t.responseType):this.isXDomainRequestSupported()?this.callUsingXDomainRequest(n):this.callUsingAjaxJsonP(n),n.deferred},i.parseURL=function(e){var t=document.createElement("a");return t.href=e,t},i.convertJsonToQueryString=function(t){e.Assert.exists(t);var i=[];return e._.each(t,function(t,n){null!=t&&(e._.isObject(t)?i.push(n+"="+encodeURIComponent(JSON.stringify(t))):i.push(n+"="+encodeURIComponent(t.toString())))}),i},i.convertJsonToFormBody=function(e){return i.convertJsonToQueryString(e).join("&")},i.prototype.callUsingXMLHttpRequest=function(n,o){var s=this;void 0===o&&(o="text");var r=new XMLHttpRequest,a=!1;r.onreadystatechange=function(){if(r.readyState!=t.OPENED||a){if(r.readyState==t.DONE){var l,u=r.status;"text"==o?l=s.tryParseResponseText(r.responseText,r.getResponseHeader("Content-Type")):(l=r.response,void 0==l&&(l=s.tryParseResponseText(r.responseText,r.getResponseHeader("Content-Type")))),s.isSuccessHttpStatus(u)?s.handleSuccessfulResponseThatMightBeAnError(n,l):s.handleError(n,r.status,void 0)}}else a=!0,r.withCredentials=!0,s.options.accessToken?r.setRequestHeader("Authorization","Bearer "+s.options.accessToken):s.options.username&&s.options.password&&r.setRequestHeader("Authorization","Basic "+btoa(s.options.username+":"+s.options.password)),e.DeviceUtils.isPhonegap()&&r.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"),"GET"==n.method?r.send():(r.setRequestHeader("Content-Type",'application/x-www-form-urlencoded; charset="UTF-8"'),r.send(i.convertJsonToFormBody(n.requestData))),r.responseType=o};var l=n.queryString;"GET"==n.method&&(l=l.concat(i.convertJsonToQueryString(n.requestData))),r.open(n.method,this.combineUrlAndQueryString(n.url,l))},i.prototype.callUsingXDomainRequest=function(t){var n=this,o=t.queryString.concat([]);this.options.accessToken&&o.push("access_token="+encodeURIComponent(this.options.accessToken));var s=new XDomainRequest;"GET"==t.method&&(o=o.concat(i.convertJsonToQueryString(t.requestData))),s.open(t.method,this.combineUrlAndQueryString(t.url,o)),s.onload=function(){var e=n.tryParseResponseText(s.responseText,s.contentType);n.handleSuccessfulResponseThatMightBeAnError(t,e)},s.onerror=function(){var e=n.tryParseResponseText(s.responseText,s.contentType);n.handleError(t,0,e)},s.ontimeout=function(){return n.logger.error("Request timeout",s,t.requestData)},s.onprogress=function(){return n.logger.trace("Request progress",s,t.requestData)},e._.defer(function(){"GET"==t.method?s.send():s.send(i.convertJsonToFormBody(t.requestData))})},i.prototype.callUsingAjaxJsonP=function(t){var n=this,o=t.queryString.concat(i.convertJsonToQueryString(t.requestData));this.options.accessToken&&o.push("access_token="+encodeURIComponent(this.options.accessToken)),o.push("callback=?"),e.$.jsonp({url:this.combineUrlAndQueryString(t.url,o),success:function(e){return n.handleSuccessfulResponseThatMightBeAnError(t,e)},error:function(){return n.handleError(t,0,void 0)}})},i.prototype.handleSuccessfulResponseThatMightBeAnError=function(e,t){this.isErrorResponseBody(t)?this.handleError(e,t.statusCode,t):this.handleSuccess(e,t)},i.prototype.handleSuccess=function(t,i){var n={duration:e.TimeSpan.fromDates(t.begun,new Date).getMilliseconds(),data:i};this.logger.trace("REST request successful",i,t),t.deferred.resolve(n)},i.prototype.handleError=function(e,t,i){var n={statusCode:t,data:i};this.logger.error("REST request failed",t,i,e),e.deferred.reject(n)},i.prototype.combineUrlAndQueryString=function(e,t){return e+(t.length>0?"?"+t.join("&"):"")},i.prototype.isXDomainRequestSupported=function(){return"XDomainRequest"in window},i.prototype.isCORSSupported=function(){return"withCredentials"in new XMLHttpRequest},i.prototype.isSuccessHttpStatus=function(e){return e>=200&&300>e||304===e},i.prototype.tryParseResponseText=function(t,i){if(null==i||-1==i.indexOf("application/json"))return t;if(!e.Utils.isNonEmptyString(t))return void 0;try{return JSON.parse(t)}catch(n){return void 0}},i.prototype.isErrorResponseBody=function(e){return e&&e.statusCode?!this.isSuccessHttpStatus(e.statusCode):!1},i}();e.EndpointCaller=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){this.queryStringArguments={},this.anonymous=!1,this.isOldRestAPI=!1}return e}();e.DefaultSearchEndpointOptions=t;var i=function(){function i(i){this.options=i,this._batchListFieldValues=[],e.Assert.exists(i);var n=new t;n.anonymous=0==window.location.href.indexOf("file://")&&e.Utils.isNonEmptyString(i.accessToken),this.options=e.$.extend({},n,i),e.SearchEndpoint.isDebugArgumentPresent()&&(this.options.queryStringArguments.debug=1),e.$(window).on("beforeunload",e.$.proxy(this.handleUnload,this)),this.logger=new e.Logger(this),this.createEndpointCaller()}return i.configureSampleEndpoint=function(){i.endpoints["default"]=i.isUseLocalArgumentPresent()?new i({restUri:"http://localhost:8100/rest/search"}):new i({restUri:"https://cloudplatform.coveo.com/rest/search",accessToken:"52d806a2-0f64-4390-a3f2-e0f41a4a73ec"})},i.configureCloudEndpoint=function(e,t,n,o){void 0===n&&(n="https://cloudplatform.coveo.com/rest/search");var s=i.mergeConfigOptions({restUri:n,accessToken:t,queryStringArguments:{workgroup:e}},o);i.endpoints["default"]=new i(i.removeUndefinedConfigOption(s))},i.configureOnPremiseEndpoint=function(e,t,n){var o=i.mergeConfigOptions({restUri:e,accessToken:t},n);i.endpoints["default"]=new i(i.removeUndefinedConfigOption(o))},i.removeUndefinedConfigOption=function(t){return e._.each(e._.keys(t),function(e){void 0==t[e]&&delete t[e]}),t},i.mergeConfigOptions=function(t,n){return t=i.removeUndefinedConfigOption(t),n=i.removeUndefinedConfigOption(n),e.$.extend({},t,n)},i.prototype.reset=function(){this.createEndpointCaller()},i.isDebugArgumentPresent=function(){return/[?&]debug=1([&]|$)/.test(window.location.search)},i.isUseLocalArgumentPresent=function(){return/[?&]useLocal=1([&]|$)/.test(window.location.search)},i.prototype.handleUnload=function(){this.isRedirecting=!0},i.prototype.getBaseUri=function(){return this.options.restUri},i.prototype.getAuthenticationProviderUri=function(t,i,n){var o=this.buildBaseUri("/login/"+t)+"?";return e.Utils.isNonEmptyString(i)?o+="redirectUri="+encodeURIComponent(i):e.Utils.isNonEmptyString(n)&&(o+="message="+encodeURIComponent(n)),o},i.prototype.isJsonp=function(){return this.caller.useJsonp},i.prototype.search=function(t,i){var n=this;e.Assert.exists(t),this.logger.info("Performing REST query",t),i=e._.extend({},i);var o={url:this.buildBaseUri("/"),queryString:this.buildBaseQueryString(i),requestData:t,errorsAsSuccess:!0,responseType:"text",method:"POST"},s=this.callWithErrorHandling(o);return s.done(function(i){n.logger.info("REST query successful",i,t),null==i.apiVersion&&(i.apiVersion=1),i.apiVersion<e.version.supportedApiVersion&&n.logger.error("Please update your REST Search API"),e.Utils.isNullOrEmptyString(i.searchUid)&&(i.searchUid=e.QueryUtils.createGuid()),e.QueryUtils.setIndexAndUidOnQueryResults(t,i,i.searchUid,i.pipeline,i.splitTestRun),e.QueryUtils.setTermsToHighlightOnQueryResults(t,i)}),s},i.prototype.getExportToExcelLink=function(t,i){var n=this.buildBaseUri("/"),o=this.buildCompleteQueryString(i,null,t);return e.Utils.isNonEmptyString(this.options.accessToken)&&o.push("access_token="+encodeURIComponent(this.options.accessToken)),o.push("format=xlsx"),n+"?"+o.join("&")},i.prototype.getRawDataStream=function(t,i,n){var o=this;e.Assert.exists(t),n=e._.extend({},n);var s={url:this.buildBaseUri("/datastream"),queryString:this.buildViewAsHtmlQueryString(t,n).concat(["dataStream="+i]),requestData:{},errorsAsSuccess:!1,method:"GET",responseType:"arraybuffer"},r=this.callWithErrorHandling(s);return this.logger.info("Performing REST query for datastream "+i+" on document uniqueID"+t),r.done(function(e){return o.logger.info("REST query successful",e,t)}),r},i.prototype.getDocumentText=function(t,i){i=e._.extend({},i);var n={url:this.buildBaseUri("/text"),queryString:this.buildViewAsHtmlQueryString(t,i),method:"GET",requestData:{},responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(n)},i.prototype.getDocumentHtml=function(t,i){i=e._.extend({},i);var n={url:this.buildBaseUri("/html"),queryString:this.buildViewAsHtmlQueryString(t,i),method:"GET",requestData:{},responseType:"document",errorsAsSuccess:!0};return this.callWithErrorHandling(n)},i.prototype.getViewAsHtmlUri=function(t,i){return i=e._.extend({},i),this.buildViewAsHtmlUri("/html",t,i)},i.prototype.getViewAsDatastreamUri=function(t,i,n){return n=e._.extend({},n),this.buildViewAsHtmlUri("/datastream",t,n)+"&dataStream="+encodeURIComponent(i)},i.prototype.batchFieldValues=function(t,i){var n=this;e.Assert.exists(t),i=e._.extend({},i),this.logger.info("Listing field values",t);var o=e.$.Deferred(),s={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(s).done(function(e){return o.resolve(e.values)}).fail(function(e,t){return o.reject(null,t)}),o.done(function(e){return n.logger.info("REST list field values successful",e,t)}),o},i.prototype.listFieldValues=function(t,i){var n=this;e.Assert.exists(t),i=e._.extend({},i),this.logger.info("Listing field values",t);var o=e.$.Deferred(),s={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(s).done(function(e){return o.resolve(e.values)}).fail(function(e,t){return o.reject(null,t)}),o.done(function(e){return n.logger.info("REST list field values successful",e,t)}),o},i.prototype.listFields=function(t){t=e._.extend({},t),this.logger.info("Listing fields");var i=e.$.Deferred(),n={url:this.buildBaseUri("/fields"),queryString:this.buildBaseQueryString(t),requestData:{},method:"GET",responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(n).done(function(e){return i.resolve(e.fields)}).fail(function(e,t){return i.reject(null,t)}),i},i.prototype.extensions=function(t){t=e._.extend({},t),this.logger.info("Listing extensions");var i={url:this.buildBaseUri("/extensions"),queryString:this.buildBaseQueryString(t),requestData:{},method:"GET",responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(i)},i.prototype.rateDocument=function(t,i){i=e._.extend({},i),this.logger.info("Rating a document",t);var n=e.$.Deferred(),o={url:this.buildBaseUri("/rating"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!1,responseType:"text"};return this.callWithErrorHandling(o).done(function(){return n.resolve(!0)}).fail(function(){return n.reject(!1)}),n},i.prototype.tagDocument=function(t,i){i=e._.extend({},i),this.logger.info("Tagging a document",t);var n=e.$.Deferred(),o={url:this.buildBaseUri("/tag"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!1,responseType:"text"};return this.callWithErrorHandling(o).done(function(){return n.resolve(!0)}).fail(function(){return n.reject(!1)}),n},i.prototype.createEndpointCaller=function(){this.caller=new e.EndpointCaller(this.options)},i.prototype.buildBaseUri=function(t){e.Assert.isString(t);var i=this.options.restUri;return i=this.removeTrailingSlash(i),i+=t,this.options.isOldRestAPI&&(i=this.addTrailingSlash(i)),i},i.prototype.buildBaseQueryString=function(t){var i=[];for(var n in this.options.queryStringArguments)i.push(n+"="+encodeURIComponent(this.options.queryStringArguments[n]));return e._.isArray(t.authentication)&&0!=t.authentication.length&&i.push("authentication="+t.authentication.join(",")),i},i.prototype.buildCompleteQueryString=function(t,i,n){var o=this.buildBaseQueryString(t);return n?(n.q,n.aq,n.cq,n.dq,n.searchHub,n.tab,n.language,n.pipeline,n.lowercaseOperators,e._.each(["q","aq","cq","dq","searchHub","tab","language","pipeline","lowercaseOperators"],function(e){n[e]&&o.push(e+"="+encodeURIComponent(n[e]))}),e._.each(n.context,function(e,t){o.push("context["+t+"]="+encodeURIComponent(e))})):i&&o.push("q="+encodeURIComponent(i)),o},i.prototype.buildViewAsHtmlUri=function(t,i,n){e.Assert.isNonEmptyString(i);var o=this.buildViewAsHtmlQueryString(i,n);e.Utils.isNonEmptyString(this.options.accessToken)&&o.push("access_token="+encodeURIComponent(this.options.accessToken));var s=this.buildBaseUri(t);return s+"?"+o.join("&")},i.prototype.buildViewAsHtmlQueryString=function(e,t){var i=this.buildCompleteQueryString(t,t.query,t.queryObject);return i.push("uniqueId="+encodeURIComponent(e)),(t.query||t.queryObject)&&i.push("enableNavigation=true"),t.requestedOutputSize&&i.push("requestedOutputSize="+encodeURIComponent(t.requestedOutputSize.toString())),t.contentType&&i.push("contentType="+encodeURIComponent(t.contentType)),i},i.prototype.callWithErrorHandling=function(t){var i=e.$.Deferred();return this.performOneCall(t,i,!0),i},i.prototype.performOneCall=function(t,i,n){var o=this;this.caller.call(t).done(function(e){e.data.clientDuration=e.duration,i.resolve(e.data,t.requestData)}).fail(function(s){n&&o.canRenewAccessToken()&&o.isAccessTokenExpiredStatus(s.statusCode)?o.renewAccessToken().done(function(){return o.performOneCall(t,i,!1)}).fail(function(){return o.handleErrorResponse(s,i)}):0==s.statusCode&&o.isRedirecting?e._.defer(function(){i.resolve()}):o.handleErrorResponse(s,i)})},i.prototype.handleErrorResponse=function(t,i){this.isMissingAuthenticationProviderStatus(t.statusCode)?i.reject(null,new e.MissingAuthenticationError(t.data.provider)):t.data&&t.data.message?i.reject(null,new e.QueryError(t)):i.reject(null,new e.AjaxError("Request Error",t.statusCode))},i.prototype.canRenewAccessToken=function(){return e.Utils.isNonEmptyString(this.options.accessToken)&&e._.isFunction(this.options.renewAccessToken)},i.prototype.isAccessTokenExpiredStatus=function(e){return 419==e},i.prototype.renewAccessToken=function(){var t=this;return this.logger.info("Renewing expired access token"),this.options.renewAccessToken().done(function(i){e.Assert.isNonEmptyString(i),t.options.accessToken=i,t.createEndpointCaller()}).fail(function(e){t.logger.error("Failed to renew access token",e)})},i.prototype.isMissingAuthenticationProviderStatus=function(e){return 402==e},i.prototype.addTrailingSlash=function(e){return this.hasTrailingSlash(e)||(e+="/"),e},i.prototype.removeTrailingSlash=function(e){return this.hasTrailingSlash(e)&&(e=e.substr(0,e.length-1)),e},i.prototype.hasTrailingSlash=function(e){return"/"==e.charAt(e.length-1)},i.endpoints={},i}();e.SearchEndpoint=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.endpoint=e,this.callOptions=t,this.options=e.options}return t.prototype.getBaseUri=function(){return this.endpoint.getBaseUri()},t.prototype.getAuthenticationProviderUri=function(e,t,i){return this.endpoint.getAuthenticationProviderUri(e,t,i)
},t.prototype.isJsonp=function(){return this.endpoint.isJsonp()},t.prototype.search=function(e,t){return this.endpoint.search(e,this.enrichCallOptions(t))},t.prototype.getExportToExcelLink=function(e,t){return this.endpoint.getExportToExcelLink(e,this.enrichCallOptions(t))},t.prototype.tagDocument=function(e){return this.endpoint.tagDocument(e,this.enrichCallOptions(e))},t.prototype.rateDocument=function(e,t){return this.endpoint.rateDocument(e,this.enrichCallOptions(t))},t.prototype.getRawDataStream=function(e,t,i){return this.endpoint.getRawDataStream(e,t,this.enrichCallOptions(i))},t.prototype.getDocumentText=function(e,t){return this.endpoint.getDocumentText(e,this.enrichCallOptions(t))},t.prototype.getDocumentHtml=function(e,t){return this.endpoint.getDocumentHtml(e,this.enrichCallOptions(t))},t.prototype.getViewAsHtmlUri=function(e,t){return this.endpoint.getViewAsHtmlUri(e,this.enrichCallOptions(t))},t.prototype.getViewAsDatastreamUri=function(e,t,i){return this.endpoint.getViewAsDatastreamUri(e,t,this.enrichCallOptions(i))},t.prototype.listFieldValues=function(e,t){return this.endpoint.listFieldValues(e,this.enrichCallOptions(t))},t.prototype.listFields=function(e){return this.endpoint.listFields(this.enrichCallOptions(e))},t.prototype.enrichCallOptions=function(t){return e._.extend({},t,this.callOptions)},t}();e.SearchEndpointWithDefaultCallOptions=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.registerDefaultOptions=function(t,i){var n=e.$(t).data("CoveoDefaultOptions")||{},o=e.$.extend(!0,{},n,i);e.$(t).data("CoveoDefaultOptions",o)},t.resolveDefaultOptions=function(i,n){var o,s=e.$(i).data("CoveoDefaultOptions");return o=e.Utils.exists(s)?e.$.extend(!0,{},s,n):n,i.parentElement?t.resolveDefaultOptions(i.parentElement,o):o},t.registerAutoCreateComponent=function(i){e.Assert.exists(i),e.Assert.exists(i.ID),e.Assert.doesNotExists(t.autoCreateComponents[i.ID]),e.Assert.doesNotExists(t.namedMethods[i.ID]),t.autoCreateComponents[i.ID]=i},t.isComponentClassIdRegistered=function(i){return e.Utils.exists(t.autoCreateComponents[i])},t.getListOfRegistredComponents=function(){return e._.keys(t.autoCreateComponents)},t.getRegistredComponent=function(e){return t.autoCreateComponents[e]},t.initializeFramework=function(i,n,o){e.Assert.exists(i),this.logger.info("Internal Coveo JQuery version",e.$.fn.jquery),e.DeviceUtils.isIE8or9()&&e.$("html").addClass("ie8or9"),n=t.resolveDefaultOptions(i,n),t.performInitFunctionsOption(n,e.InitializationEvents.beforeInitialization),e.$(i).trigger(e.InitializationEvents.beforeInitialization),o(i,n),t.initExternalComponents(i,n),t.performInitFunctionsOption(n,e.InitializationEvents.afterComponentsInitialization),e.$(i).trigger(e.InitializationEvents.afterComponentsInitialization),e.$(i).trigger(e.InitializationEvents.restoreHistoryState),t.performInitFunctionsOption(n,e.InitializationEvents.afterInitialization),e.$(i).trigger(e.InitializationEvents.afterInitialization);var s=e.Component.get(i,e.SearchInterface);e.$(".coveo-hide-until-loaded").removeClass("coveo-hide-until-loaded").addClass("coveo-show-after-loaded"),s.options.autoTriggerQuery&&(t.logFirstQueryCause(s),e.Component.get(i,e.QueryController).executeQuery())},t.logFirstQueryCause=function(t){var i=e.HashUtils.getValue("firstQueryCause",e.HashUtils.getHash());if(null!=i){var n=e.HashUtils.getValue("firstQueryMeta",e.HashUtils.getHash())||{};t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList[i],n)}else e.Utils.isNonEmptyString(t.getBindings().queryStateModel.get("q"))?t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchFromLink,{}):t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.interfaceLoad,{})},t.performInitFunctionsOption=function(i,n){e.Utils.exists(i)&&t.performFunctions(i[n])},t.performPreInitFunctions=function(i){e.Utils.exists(i)&&t.performFunctions(i[e.InitializationEvents.beforeInitialization])},t.performPostInitFunction=function(i){e.Utils.exists(i)&&t.performFunctions(i[e.InitializationEvents.afterInitialization])},t.performFunctions=function(t){e.Utils.exists(t)&&e._.each(t,function(e){"function"==typeof e&&e()})},t.initSearchInterface=function(i,n){void 0===n&&(n={}),n=t.resolveDefaultOptions(i,n);var o=new e.SearchInterface(i,n.SearchInterface,n.Analytics);o.options.originalOptionsObject=n;var s={options:n,bindings:o.getBindings()};t.automaticallyCreateComponentsInside(i,s)},t.initStandaloneSearchInterface=function(i,n){void 0===n&&(n={}),n=t.resolveDefaultOptions(i,n);var o=new e.StandaloneSearchInterface(i,n.StandaloneSearchInterface,n.Analytics);o.options.originalOptionsObject=n;var s={options:n,bindings:o.getBindings()};t.automaticallyCreateComponentsInside(i,s)},t.initBoxInterface=function(i,n,o,s){void 0===n&&(n={}),void 0===o&&(o="Standard"),void 0===s&&(s=!0),n=t.resolveDefaultOptions(i,n);var r="Box";"Standard"!=o&&(r+="For"+o);var a=e.Component.getComponentRef(r);if(a){new e.Logger(i).info("Initializing box of type "+r);var l=s?a.getInjection:function(){},u=new a(i,n[r],n.Analytics,l,n);u.options.originalOptionsObject=n;var c={options:n,bindings:u.getBindings()};t.automaticallyCreateComponentsInside(i,c)}else new e.Logger(i).error("Trying to initialize box of type : "+r+" but not found in code (not compiled)!"),e.Assert.fail("Cannot initialize unknown type of box")},t.initExternalComponents=function(i,n){if(n&&n.externalComponents){var o=e.$(i).coveo(e.SearchInterface),s=e.$(i).coveo(e.QueryStateModel),r=e.$(i).coveo(e.ComponentStateModel),a=e.$(i).coveo(e.QueryController),l=e.$(i).coveo(e.ComponentOptionsModel),u=o.usageAnalytics;e.Assert.exists(o),e.Assert.exists(s),e.Assert.exists(a),e.Assert.exists(r),e.Assert.exists(u);var c={options:n,bindings:{searchInterface:o,queryStateModel:s,queryController:a,usageAnalytics:u,componentStateModel:r,componentOptionsModel:l,root:i}};e._.each(n.externalComponents,function(i){var n=i;n instanceof e.$&&(n=e.$(n).get(0)),e.Utils.isHtmlElement(n)&&t.automaticallyCreateComponentsInside(n,c)})}},t.automaticallyCreateComponentsInside=function(i,n,o){e.Assert.exists(i);var s=[];for(var r in t.autoCreateComponents)if(!e._.contains(o,r)){var a=t.autoCreateComponents[r],l=e.Component.computeCssClassNameForType(a.ID),u=e.$(i).find("."+l);e.$(i).hasClass(l)&&(u=u.add(i)),0!=u.length&&s.push(t.createFunctionThatInitializesComponentOnElements(u,r,a,n))}e._.each(s,function(e){return e()})},t.createFunctionThatInitializesComponentOnElements=function(i,n,o,s){return function(){i.each(function(i,r){if(null==e.Component.get(r,n)){var a=void 0;if(e.Utils.exists(s.options)){var l=s.options[n],u=s.options[r.id],c=s.options.initOptions?s.options.initOptions[n]:{};a=e.$.extend({},l,u,c)}var p=e.$.extend({},s,{options:a});t.createComponentOfThisClassOnElement(o.ID,r,p)}})}},t.createComponentOfThisClassOnElement=function(i,n,o){e.Assert.isNonEmptyString(i),e.Assert.exists(n);var s=t.autoCreateComponents[i];e.Assert.exists(s);var r={},a={},l=void 0;return void 0!=o&&(e._.each(o.bindings,function(e,t){r[t]=e}),a=o.options,l=o.result),t.logger.trace("Creating component of class "+i,n,a),new s(n,a,r,l)},t.registerNamedMethod=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.doesNotExists(t.autoCreateComponents[i]),e.Assert.doesNotExists(t.namedMethods[i]),e.Assert.exists(n),t.namedMethods[i]=n},t.isNamedMethodRegistered=function(i){return e.Utils.exists(t.namedMethods[i])},t.dispatchNamedMethodCall=function(i,n,o){e.Assert.isNonEmptyString(i),e.Assert.exists(n);var s=t.namedMethods[i];return e.Assert.exists(s),t.logger.trace("Dispatching named method call of "+i,n,o),s.apply(null,[n].concat(o))},t.isThereASingleComponentBoundToThisElement=function(t){return e.Assert.exists(t),e.Utils.exists(e.Component.get(t))},t.dispatchMethodCallOnBoundComponent=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.exists(i);var o=e.Component.get(i);e.Assert.exists(o);var s=o[t];return e.Utils.exists(s)?s.apply(o,n):(e.Assert.fail("No method named "+t+" exist on component "+o.type),void 0)},t.dispatchNamedMethodCallOrComponentCreation=function(i,n,o){return e.Assert.isNonEmptyString(i),e.Assert.exists(n),t.isNamedMethodRegistered(i)?t.dispatchNamedMethodCall(i,n,o):t.isComponentClassIdRegistered(i)?t.createComponentOfThisClassOnElement(i,n,o[0]):t.isThereASingleComponentBoundToThisElement(n)?t.dispatchMethodCallOnBoundComponent(i,n,o):(e.Assert.fail("No method or component named "+i+" are registered."),void 0)},t.monkeyPatchComponentMethod=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.exists(n);var o;if(t.indexOf(".")>0){var s=t.split(".");e.Assert.check(2==s.length,"Invalid method name, correct syntax is CoveoComponent.methodName."),o=s[0],t=s[1]}var r=e.Component.get(i,o);e.Assert.exists(r),e.Assert.exists(r[t]);var a="__"+t;e.Utils.exists(r[a])||(r[a]=r[t]),r[t]=n},t.noConflict=function(){e.$=jQuery.noConflict(!0),window.$.fn.coveo=e.$.fn.coveo},t.logger=new e.Logger("JQuery"),t.autoCreateComponents={},t.namedMethods={},t}();e.CoveoJQuery=t}(Coveo||(Coveo={})),$.fn.coveo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var i;return this.each(function(t,n){var o;if(_.isString(e[0])){var s=e[0];o=Coveo.CoveoJQuery.dispatchNamedMethodCallOrComponentCreation(s,n,e.slice(1))}else o=Coveo.CoveoJQuery.dispatchNamedMethodCall("get",n,e);i=i||o}),i},Coveo.CoveoJQuery.registerNamedMethod("options",function(e,t){void 0===t&&(t={}),Coveo.CoveoJQuery.registerDefaultOptions(e,t)}),Coveo.CoveoJQuery.registerNamedMethod("init",function(e,t){void 0===t&&(t={}),Coveo.CoveoJQuery.initializeFramework(e,t,function(){Coveo.CoveoJQuery.initSearchInterface(e,t)})}),Coveo.CoveoJQuery.registerNamedMethod("initBox",function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n,o,s={};0==t.length?(n="Standard",o=!1):1==t.length?"string"==typeof t[0]?(n=t[0],o=!0):"object"==typeof t[0]?(n="Standard",o=!1,s=t[0]):Coveo.Assert.fail("Invalid parameters to init a box"):2==t.length&&(n=t[0],s=t[1],o=!0);var r={};r[n||"Container"]=_.extend({},s.SearchInterface,s[n]),s=_.extend({},s,r),Coveo.CoveoJQuery.initializeFramework(e,s,function(){Coveo.CoveoJQuery.initBoxInterface(e,s,n,o)})}),Coveo.CoveoJQuery.registerNamedMethod("initSearchbox",function(e,t,i){void 0===i&&(i={}),Coveo.Assert.isNonEmptyString(t);var n={};n.searchPageUri=t,n.autoTriggerQuery=!1,n.hideUntilFirstQuery=!1,n.enableHistory=!1,i=_.extend({},i,{StandaloneSearchInterface:n}),Coveo.CoveoJQuery.initializeFramework(e,i,function(){Coveo.CoveoJQuery.initStandaloneSearchInterface(e,i)})}),Coveo.CoveoJQuery.registerNamedMethod("patch",function(e,t,i){Coveo.CoveoJQuery.monkeyPatchComponentMethod(t,e,i)}),Coveo.CoveoJQuery.registerNamedMethod("noConflict",function(){Coveo.CoveoJQuery.noConflict()});var Coveo;!function(e){var t=function(){function t(i,n,o){var s=this;void 0===o&&(o={}),this.element=i,this.type=n,this.disabled=!1,this.bind=new e.ComponentEvents(this),e.Assert.exists(i),e.Assert.isNonEmptyString(n),t.bindComponentToElement(this.element,this),this.logger=new e.Logger(this),this.root=o.root||this.resolveRoot(),this.queryStateModel=o.queryStateModel||this.resolveQueryStateModel(),this.componentStateModel=o.componentStateModel||this.resolveComponentStateModel(),this.queryController=o.queryController||this.resolveQueryController(),this.searchInterface=o.searchInterface||this.resolveSearchInterface(),this.usageAnalytics=o.usageAnalytics||this.resolveUA(),this.componentOptionsModel=o.componentOptionsModel||this.resolveComponentOptionsModel(),this.ensureDom=e._.once(function(){return s.createDom()}),this.initDebugInfo(),null!=this.searchInterface&&this.searchInterface.attachComponent(n,this)}return t.prototype.getBindings=function(){return{root:this.root,queryStateModel:this.queryStateModel,queryController:this.queryController,searchInterface:this.searchInterface,componentStateModel:this.componentStateModel,componentOptionsModel:this.componentOptionsModel,usageAnalytics:this.usageAnalytics}},t.prototype.initDebugInfo=function(){var t=this;e.$(this.element).dblclick(function(i){if(i.altKey){var n=t.debugInfo();null!=n&&e.$(t.root).trigger(e.DebugEvents.showDebugPanel,t.debugInfo())}})},t.prototype.debugInfo=function(){var e={};return e[this.constructor.ID]=this,e},t.prototype.enable=function(){this.disabled=!1},t.prototype.disable=function(){this.disabled=!0},t.prototype.createDom=function(){},t.prototype.resolveSearchInterface=function(){return t.resolveBinding(this.element,e.SearchInterface)},t.prototype.resolveRoot=function(i){var n=t.resolveBinding(this.element,e.SearchInterface);return n?n.element:i},t.prototype.resolveQueryController=function(i){return t.resolveBinding(this.element,e.QueryController)||i},t.prototype.resolveComponentStateModel=function(i){return t.resolveBinding(this.element,e.ComponentStateModel)||i},t.prototype.resolveQueryStateModel=function(i){return t.resolveBinding(this.element,e.QueryStateModel)||i},t.prototype.resolveComponentOptionsModel=function(i){return t.resolveBinding(this.element,e.ComponentOptionsModel)||i},t.prototype.resolveUA=function(){var t=this.resolveSearchInterface();return t&&t.usageAnalytics?t.usageAnalytics:new e.NoopAnalyticsClient},t.prototype.resolveResultElement=function(){return e.$(this.element).closest(".CoveoResult")},t.prototype.resolveResult=function(){var t=this.resolveResultElement();return e.Assert.check(1==t.length),t.data("CoveoResult")},t.prototype.isInstanceOf=function(i){return t.getComponentRef(i)&&this instanceof e[i]},t.getComponentRef=function(t){return e[t]},t.get=function(i,n,o){if(e.Assert.exists(i),e._.isString(n))return i[t.computeMemberNameForType(n)];if(e.Utils.exists(n))return e.Assert.exists(n.ID),i[t.computeMemberNameForType(n.ID)];var s=t.getBoundComponentsForElement(i);return o||e.Assert.check(s.length<=1,"More than one component is bound to this element. You need to specify the component type."),s[0]},t.bindComponentToElement=function(i,n){e.Assert.exists(i),e.Assert.exists(n),e.Assert.isNonEmptyString(n.type),i[t.computeMemberNameForType(n.type)]=n,e.$(i).addClass(t.computeCssClassNameForType(n.type)),t.getBoundComponentsForElement(i).push(n)},t.bindResultToElement=function(t,i){e.Assert.exists(t),e.Assert.exists(i),e.$(t).addClass("CoveoResult").data("CoveoResult",i),t.CoveoResult=i},t.resolveBinding=function(i,n){e.Assert.exists(i),e.Assert.exists(n),e.Assert.exists(n.ID);var o=e.$(i).closest("."+t.computeCssClassNameForType(n.ID));return 0==o.length?void 0:o.get(0)[t.computeMemberNameForType(n.ID)]},t.computeCssClassNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},t.computeSelectorForType=function(i){return e.Assert.isNonEmptyString(i),"."+t.computeCssClassNameForType(i)},t.computeMemberNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},t.pointElementsToDummyForm=function(e){e.add(e.find("*")).filter("input").attr("form","coveo-dummy-form")},t.getBoundComponentsForElement=function(t){return e.Assert.exists(t),null==t.CoveoBoundComponents&&(t.CoveoBoundComponents=[]),t.CoveoBoundComponents},t}();e.Component=t,e.CoveoJQuery.registerNamedMethod("get",function(i,n){return e.Assert.exists(i),t.get(i,n)})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.owner=t,e.Assert.exists(t)}return t.prototype.on=function(e,t,i){e.on(t,this.wrapToCallIfEnabled(i))},t.prototype.onRoot=function(t,i){this.on(e.$(this.owner.root),t,i)},t.prototype.click=function(e,t){e.click(this.wrapToCallIfEnabled(t)),"A"==e.prop("tagName")&&null==e.attr("href")&&e.attr("href","javascript:")},t.prototype.trigger=function(e,t,i){this.wrapToCallIfEnabled(function(){e.trigger(t,i)})},t.prototype.wrapToCallIfEnabled=function(e){var t=this;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];return t.owner.disabled?void 0:e.apply(t.owner,i)}},t}();e.ComponentEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){return g(0,w,e)}function n(e){return g(1,A,e)}function o(e){return g(2,O,e)}function s(e){return g(9,O,e)}function r(e){return g(12,O,e)}function a(e){return g(14,O,e)}function l(e){return g(3,E,e)}function u(e){return g(8,T,e)}function c(e){return g(4,I,e)}function p(e){return g(5,D,e)}function d(e){return g(6,_,e)}function h(e){return g(7,$,e)}function f(e,t){var i=function(t,i,n){var o=O(t,i,n);return e(o)};return g(2,i,t)}function m(e,t){var i=function(t,i,n){var o=I(t,i,n);return e(o)};return g(4,i,t)}function v(t){var i=function(i,n){for(var o=e._.keys(t.subOptions),s={},r={},a=0;a<o.length;a++){var l=o[a],u=b(n,l);s[u]=t.subOptions[l]}x(i,s,r);for(var c={},a=0;a<o.length;a++){var l=o[a],u=b(n,l);null!=r[u]&&(c[l]=r[u])}return e._.keys(c).length>0?c:null};return g(10,i,t)}function g(e,t,i){void 0===i&&(i={});var n=i;return n.type=e,n.load=t,n}function y(e,t){return t&&t.attrName?t.attrName:"data-"+C(e)}function C(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function b(e,t){return e+t.substr(0,1).toUpperCase()+t.substr(1)}function S(e,t,i){return x(e,t.options,i)}function x(t,i,n){null==n&&(n={});for(var o=e._.keys(i),s=0;s<o.length;s++){var r,a=o[s],l=i[a],u=(l.attrName||y(a,l),l.load);null!=u&&(r=u(t,a,l)),null==r&&void 0==n[a]&&(null!=l.defaultValue?r=4==l.type?e._.extend([],l.defaultValue):10==l.type?e._.extend({},l.defaultValue):l.defaultValue:null!=l.defaultFunction&&(r=l.defaultFunction(t))),null!=r&&(n[a]=10==l.type&&null!=n[a]?e._.extend(n[a],r):r)}for(var s=0;s<o.length;s++){var a=o[s],l=i[a];l.postProcessing&&(n[a]=l.postProcessing(n[a],n))}return n}function O(t,i,n){return e.$(t).attr(y(i,n))}function T(t,i,n){var o=O(t,i,n);return e.Assert.check(!e.Utils.isNonEmptyString(o)||e.Utils.isCoveoField(o),o+" is not a valid field"),o}function E(t,i,n){var o=O(t,i,n),s=String.locale||String.defaultLocale;if(null!=s&&null!=o){var r=s.toLowerCase().split("-"),a=e._.map(r,function(e,t){return r.slice(0,t+1).join("-")}),l=o.match(P);if(null!=l)for(var u=0;u<l.length;u++){var c=P.exec(l[u]);if(null!=c){var p=c[1].toLowerCase();if(e._.contains(a,p))return c[2].replace(/^\s+|\s+$/g,"")}}return null!=o?o.toLocaleString():null}return o}function A(t,i,n){var o=O(t,i,n);if(null==o)return null;var s=n.float===!0?e.Utils.parseFloatIfNotUndefined(o):e.Utils.parseIntIfNotUndefined(o);return null!=n.min&&n.min>s&&(s=n.min),null!=n.max&&n.max<s&&(s=n.max),s}function w(t,i,n){return e.Utils.parseBooleanIfNotUndefined(O(t,i,n))}function I(t,i,n){var o=n.separator||/\s*,\s*/,s=O(t,i,n);return e.Utils.isNonEmptyString(s)?s.split(o):null}function F(e,t,i,n){var o=O(e,t,i);return null!=o?n[o]:null}function D(t,i,n){var o=O(t,i,n);return e.Utils.isNonEmptyString(o)?e.$(o).get(0):null}function _(t,i,n){var o,s=n.selectorAttr||y(i,n)+"-selector",r=e.$(t).attr(s);if(o=e.$(r).get(0),null==o){var a=n.childSelector;null==a&&(a="."+i),o=R(t,a)}return o}function R(t,i){if(e.Assert.isNonEmptyString(i),e.$(t).is(i))return t;var n=e.$(t).find(i);return 0!=n.length?n.get(0):null}function V(t,i){return e.Assert.isNonEmptyString(i),e.$(t).find(i).toArray()}function $(t,i,n){if(n.lazy)return new e.LazyTemplate(t,i,n);var o,s=n.selectorAttr||y(i,n)+"-selector",r=e.$(t).attr(s),a=e.$(r).get(0);if(null!=a&&(o=B(a)),null==o){var l=n.idAttr||y(i,n)+"-id",u=e.$(t).attr(l);null!=u&&(o=Q(u))}if(null==o){var c=n.childSelector;null==c&&(c="."+i.replace(/([A-Z])/g,"-$1").toLowerCase()),o=U(t,c)}return o}function Q(t){return e.Utils.isNonEmptyString(t)?e.TemplateCache.getTemplate(t):null}function U(t,i){var n=V(t,i);return n.length>0?new e.TemplateList(e._.compact(e._.map(n,function(e){return B(e)}))):null}function M(t){for(var i=e.$(t);!i.is(document)&&0!=i.length;){if(N(i))return i.is("body")?e.$(window).get(0):i.get(0);i=i.parent()}return e.$(window).get(0)}function N(e){return"scroll"==e.css("overflow-y")}function B(t){e.Assert.exists(t);var i=e.$(t).attr("type"),n="You must specify the type of template. Valid values are : "+e.UnderscoreTemplate.mimeTypes.toString()+" "+e.HtmlTemplate.mimeTypes.toString();return e.Assert.check(e.Utils.isNonEmptyString(i),n),-1!=e._.indexOf(e.UnderscoreTemplate.mimeTypes,i)?e.UnderscoreTemplate.create(t):-1!=e._.indexOf(e.HtmlTemplate.mimeTypes,i)?new e.HtmlTemplate(t):(e.Assert.fail("Cannot guess template type from attribute: "+i+". Valid values are "+n),void 0)}!function(e){e[e.BOOLEAN=0]="BOOLEAN",e[e.NUMBER=1]="NUMBER",e[e.STRING=2]="STRING",e[e.LOCALIZED_STRING=3]="LOCALIZED_STRING",e[e.LIST=4]="LIST",e[e.SELECTOR=5]="SELECTOR",e[e.CHILD_HTML_ELEMENT=6]="CHILD_HTML_ELEMENT",e[e.TEMPLATE=7]="TEMPLATE",e[e.FIELD=8]="FIELD",e[e.ICON=9]="ICON",e[e.OBJECT=10]="OBJECT",e[e.QUERY=11]="QUERY",e[e.HELPER=12]="HELPER",e[e.LONG_STRING=13]="LONG_STRING",e[e.JSON=14]="JSON",e[e.JAVASCRIPT=15]="JAVASCRIPT",e[e.NONE=16]="NONE"}(t.Type||(t.Type={}));t.Type;t.buildBooleanOption=i,t.buildNumberOption=n,t.buildStringOption=o,t.buildIconOption=s,t.buildHelperOption=r,t.buildJsonOption=a,t.buildLocalizedStringOption=l,t.buildFieldOption=u,t.buildListOption=c,t.buildSelectorOption=p,t.buildChildHtmlElementOption=d,t.buildTemplateOption=h,t.buildCustomOption=f,t.buildCustomListOption=m,t.buildObjectOption=v,t.buildOption=g,t.attrNameFromName=y,t.camelCaseToHyphen=C,t.mergeCamelCase=b,t.initComponentOptions=S,t.initOptions=x,t.loadStringOption=O,t.loadFieldOption=T;var P=/([a-zA-Z\-]+)\s*:\s*(([^,]|,\s*(?!([a-zA-Z\-]+)\s*:))+)/g;t.loadLocalizedStringOption=E,t.loadNumberOption=A,t.loadBooleanOption=w,t.loadListOption=I,t.loadEnumOption=F,t.loadSelectorOption=D,t.loadChildHtmlElementOption=_,t.loadChildHtmlElementFromSelector=R,t.loadChildrenHtmlElementFromSelector=V,t.loadTemplateOption=$,t.loadResultTemplateFromId=Q,t.loadChildrenResultTemplateFromSelector=U,t.findParentScrolling=M,t.isElementScrollable=N,t.createResultTemplateFromElement=B}(t=e.ComponentOptions||(e.ComponentOptions={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.expression=new e.ExpressionBuilder,this.advancedExpression=new e.ExpressionBuilder,this.constantExpression=new e.ExpressionBuilder,this.disjunctionExpression=new e.ExpressionBuilder,this.firstResult=0,this.numberOfResults=10,this.enableDidYouMean=!1,this.enableDebug=!1,this.sortCriteria="relevancy",this.retrieveFirstSentences=!0,this.queryUid=e.QueryUtils.createGuid(),this.queryFunctions=[],this.rankingFunctions=[],this.groupByRequests=[],this.enableDuplicateFiltering=!1}return t.prototype.build=function(){var e={q:this.expression.build(),aq:this.advancedExpression.build(),cq:this.constantExpression.build(),dq:this.disjunctionExpression.build(),searchHub:this.searchHub,tab:this.tab,language:this.language,pipeline:this.pipeline,wildcards:this.enableWildcards,questionMarks:this.enableQuestionMarks,lowercaseOperators:this.enableLowercaseOperators,partialMatch:this.enablePartialMatch,partialMatchKeywords:this.partialMatchKeywords,partialMatchThreshold:this.partialMatchThreshold,firstResult:this.firstResult,numberOfResults:this.numberOfResults,excerptLength:this.excerptLength,filterField:this.filterField,filterFieldRange:this.filterFieldRange,parentField:this.parentField,childField:this.childField,fieldsToInclude:this.fieldsToInclude,fieldsToExclude:this.fieldsToExclude,enableDidYouMean:this.enableDidYouMean,sortCriteria:this.sortCriteria,sortField:this.sortField,queryFunctions:this.queryFunctions,rankingFunctions:this.rankingFunctions,groupBy:this.groupByRequests,retrieveFirstSentences:this.retrieveFirstSentences,timezone:this.timezone,enableDuplicateFiltering:this.enableDuplicateFiltering,enableCollaborativeRating:this.enableCollaborativeRating,debug:this.enableDebug,context:this.context};return e},t.prototype.computeCompleteExpression=function(){return this.computeCompleteExpressionParts().full},t.prototype.computeCompleteExpressionParts=function(){var t=e.ExpressionBuilder.merge(this.expression,this.advancedExpression);return{full:e.ExpressionBuilder.mergeUsingOr(e.ExpressionBuilder.merge(t,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:e.ExpressionBuilder.mergeUsingOr(t,this.disjunctionExpression).build(),constant:e.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},t.prototype.computeCompleteExpressionExcept=function(e){return this.computeCompleteExpressionPartsExcept(e).full},t.prototype.computeCompleteExpressionPartsExcept=function(t){var i=e.ExpressionBuilder.merge(this.expression,this.advancedExpression);return i.remove(t),{full:e.ExpressionBuilder.mergeUsingOr(e.ExpressionBuilder.merge(i,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:e.ExpressionBuilder.mergeUsingOr(i,this.disjunctionExpression).build(),constant:e.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},t.prototype.addContextValue=function(e,t){null==this.context&&(this.context={}),this.context[e]=t},t.prototype.addContext=function(t){null==this.context&&(this.context={}),e._.extend(this.context,t)},t}();e.QueryBuilder=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.parts=[],this.wrapParts=!0}return t.prototype.add=function(t){e.Assert.isNonEmptyString(t),this.parts.push(t)},t.prototype.fromExpressionBuilder=function(e){this.parts=this.parts.concat(e.parts)},t.prototype.addFieldExpression=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isNonEmptyString(i),e.Assert.isLargerOrEqualsThan(1,n.length),this.add(e.QueryUtils.buildFieldExpression(t,i,n))},t.prototype.addFieldNotEqualExpression=function(t,i){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isLargerOrEqualsThan(1,i.length),this.add(e.QueryUtils.buildFieldNotEqualExpression(t,i))},t.prototype.remove=function(t){e.Assert.isNonEmptyString(t);var i=e._.indexOf(this.parts,t);-1!=i&&this.parts.splice(e._.indexOf(this.parts,t),1)},t.prototype.isEmpty=function(){return 0==this.parts.length},t.prototype.build=function(){return 0==this.parts.length?void 0:1==this.parts.length?this.parts[0]:this.wrapParts?"("+this.parts.join(") (")+")":this.parts.join(" ")},t.merge=function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];var o=new t;return e._.each(i,function(e){o.parts=o.parts.concat(e.parts)}),o},t.mergeUsingOr=function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];var o=e._.filter(i,function(e){return!e.isEmpty()}),s=new t;if(1==o.length)s.parts=[].concat(o[0].parts);else if(o.length>1){var r=e._.map(o,function(e){return e.build()});s.add("("+r.join(") OR (")+")")}return s},t}();e.ExpressionBuilder=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){this.dataToString=t,this.condition=i,this.logger=new e.Logger(this)}return t.prototype.instantiateToString=function(e,t){return void 0===t&&(t=!0),!this.dataToString||t&&null!=this.condition&&!this.condition(e)?null:this.dataToString(e)},t.prototype.instantiateToElement=function(t,i){void 0===i&&(i=!0);var n=this.instantiateToString(t,i);if(null!=n){var o=e.JQueryUtils.htmlToDom(n);return this.logger.trace("Instantiated result template",t,o),e.$(o).data("template",this),o}return null},t.prototype.toHtmlElement=function(){return null},t.prototype.getType=function(){return"Template"},t}();e.Template=t}(Coveo||(Coveo={}));var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},Coveo;!function(e){var t=function(t){function i(){t.call(this)}return __extends(i,t),i.prototype.instantiateToString=function(t){e.Assert.exists(t),t=e._.extend({},t,e.UnderscoreTemplate.templateHelpers);var i=e._.map(e.TemplateCache.getDefaultTemplates(),function(t){return e.TemplateCache.getTemplate(t)});i.sort(function(e,t){return null==e.condition&&null!=t.condition?1:null!=e.condition&&null==t.condition?-1:0});for(var n=0;n<i.length;n++){var o=i[n].instantiateToString(t);if(null!=o)return o}return e._.template('<div><div class="coveo-title"><a class="CoveoResultLink"><%= title?highlight(title, titleHighlights):clickUri %></a></div><% if(excerpt){ %><div class="coveo-excerpt"><%= highlight(excerpt, excerptHighlights) %></div><% } %><table class="CoveoFieldTable"><%= templateFields() %></table></div>')(t)},i.prototype.getType=function(){return"DefaultResultTemplate"},i}(e.Template);e.DefaultResultTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){e._.templateSettings={evaluate:/(?:<%|{{)([\s\S]+?)(?:%>|}})/g,interpolate:/(?:<%|{{)=([\s\S]+?)(?:%>|}})/g,escape:/(?:<%|{{)-([\s\S]+?)(?:%>|}})/g};var t=function(t){function i(n){var o=this;t.call(this),this.element=n,e.Assert.exists(n);var s=e.$(n).html();this.template=e._.template(s);var r=e.$(n).data("condition");null!=r&&(this.condition=new Function("obj","with(obj||{}){return "+r+"}")),this.dataToString=function(t){var n=e._.extend({},t,i.templateHelpers);return o.template(n)}}return __extends(i,t),i.prototype.toHtmlElement=function(){var t=document.createElement("script");return e.$(t).attr("type",e._.first(i.mimeTypes)).attr("data-condition",e.$(this.element).data("condition")).text(this.element.innerHTML),t},i.prototype.getType=function(){return"UnderscoreTemplate"},i.create=function(t){return e.Assert.exists(t),new i(t)},i.fromString=function(t,n){var o=document.createElement("script");return o.text=t,null!=n&&e.$(o).attr("data-condition",n),new i(o)},i.registerTemplateHelper=function(e,t){i.templateHelpers[e]=t},i.isLibraryAvailable=function(){return e.Utils.exists(window._)},i.templateHelpers={},i.mimeTypes=["text/underscore","text/underscore-template","text/x-underscore","text/x-underscore-template"],i}(e.Template);e.UnderscoreTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i){t.call(this,function(){return i.innerHTML}),this.element=i;var n=e.$(i).data("condition");null!=n&&(n=n.replace(/&quot;/g,'"'),this.condition=new Function("obj","with(obj||{}){return "+n+"}"))}return __extends(i,t),i.prototype.toHtmlElement=function(){var t=document.createElement("script");return e.$(t).attr("type",e._.first(i.mimeTypes)).attr("data-condition",e.$(this.element).data("condition")).text(this.element.innerHTML),t},i.prototype.getType=function(){return"HtmlTemplate"},i.create=function(t){return e.Assert.exists(t),new i(t)},i.fromString=function(t,n){var o=document.createElement("script");return o.text=t,null!=n&&e.$(o).attr("data-condition",n),new i(o)},i.mimeTypes=["text/html"],i}(e.Template);e.HtmlTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.registerTemplate=function(i,n,o,s){void 0===o&&(o=!0),void 0===s&&(s=!1),e.Assert.isNonEmptyString(i),e.Assert.exists(n),n instanceof e.Template||(n=new e.Template(n)),null==n.name&&(n.name=i),t.templates[i]=n,o&&!e._.contains(t.templateNames,i)&&t.templateNames.push(i),s&&(t.defaultTemplates[i]=n)},t.getTemplate=function(i){return e.Assert.exists(t.templates[i]),t.templates[i]},t.getTemplates=function(){return t.templates},t.getTemplateNames=function(){return t.templateNames},t.getDefaultTemplates=function(){return e._.keys(t.defaultTemplates)},t.getDefaultTemplate=function(i){return e.Assert.exists(t.defaultTemplates[i]),t.defaultTemplates[i]},t.scanAndRegisterTemplates=function(){e.UnderscoreTemplate.isLibraryAvailable()&&t.scanAndRegisterUnderscoreTemplates(),t.scanAndRegisterHtmlTemplates()},t.scanAndRegisterUnderscoreTemplates=function(){e._.each(e.UnderscoreTemplate.mimeTypes,function(i){e.$("script[id][type='"+i+"']").each(function(i,n){var o=new e.UnderscoreTemplate(n);t.registerTemplate(e.$(n).attr("id"),o)})})},t.scanAndRegisterHtmlTemplates=function(){e._.each(e.HtmlTemplate.mimeTypes,function(i){e.$("script[id][type='"+i+"']").each(function(i,n){var o=new e.HtmlTemplate(n);t.registerTemplate(e.$(n).attr("id"),o)})})},t.templates={},t.templateNames=[],t.defaultTemplates={},t}();e.TemplateCache=t,e.$(function(){t.scanAndRegisterTemplates()})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,i,n){t.call(this),this.element=e,this.attrName=i,this.option=n
}return __extends(i,t),i.prototype.instantiateToString=function(t,i){return void 0===i&&(i=!0),void 0===this.template&&(this.template=this.option.load(this.element,this.attrName,e._.extend({},this.option,{lazy:!1})),null==this.template&&(null!=this.option.defaultValue?this.template=this.option.defaultValue:null!=this.option.defaultFunction&&(this.template=this.option.defaultFunction(this.element)))),null!=this.template?this.template.instantiateToString(t,i):null},i.prototype.getType=function(){return"LazyTemplate"},i}(e.Template);e.LazyTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t){e.call(this),this.templates=t}return __extends(t,e),t.prototype.instantiateToString=function(e,t){for(var i=0;i<this.templates.length;i++){var n=this.templates[i].instantiateToString(e,t);if(null!=n)return n}return null},t.prototype.instantiateToElement=function(e,t){void 0===t&&(t=!0);for(var i=0;i<this.templates.length;i++){var n=this.templates[i].instantiateToElement(e,t);if(null!=n)return n}return null},t.prototype.getType=function(){return"TemplateList"},t}(e.Template);e.TemplateList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.registerFieldHelper=function(e,i){t.fieldHelpers.push(e),t.registerTemplateHelper(e,i)},t.registerTemplateHelper=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),e.UnderscoreTemplate.isLibraryAvailable()&&t.registerTemplateHelperInUnderscore(i,n),t.helpers[i]=n},t.getHelper=function(e){return t.helpers[e]},t.getHelpers=function(){return t.helpers},t.registerTemplateHelperInUnderscore=function(t,i){e.Assert.isNonEmptyString(t),e.Assert.exists(i),e.Assert.check(e.UnderscoreTemplate.isLibraryAvailable()),e.UnderscoreTemplate.registerTemplateHelper(t,i)},t.helpers={},t.fieldHelpers=[],t}();e.TemplateHelpers=t}(Coveo||(Coveo={}));var Coveo;!function(e){e.AnalyticsActionCauseList={interfaceLoad:{name:"interfaceLoad",type:"interface"},interfaceChange:{name:"interfaceChange",type:"interface",metaMap:{interfaceChangeTo:1}},contextRemove:{name:"contextRemove",type:"misc",metaMap:{contextName:1}},didyoumeanAutomatic:{name:"didyoumeanAutomatic",type:"misc"},didyoumeanClick:{name:"didyoumeanClick",type:"misc"},resultsSort:{name:"resultsSort",type:"misc",metaMap:{resultsSortBy:1}},searchboxSubmit:{name:"searchboxSubmit",type:"search box"},searchboxClear:{name:"searchboxClear",type:"search box"},searchboxAsYouType:{name:"searchboxAsYouType",type:"search box"},breadcrumbFacet:{name:"breadcrumbFacet",type:"breadcrumb",metaMap:{facetId:1,facetValue:2,facetTitle:3}},breadcrumbResetAll:{name:"breadcrumbResetAll",type:"breadcrumb"},documentTag:{name:"documentTag",type:"document",metaMap:{facetId:1,facetValue:2,facetTitle:3}},documentField:{name:"documentField",type:"document",metaMap:{facetId:1,facetValue:2,facetTitle:3}},documentQuickview:{name:"documentQuickview",type:"document",metaMap:{documentTitle:1,documentURL:2}},documentOpen:{name:"documentOpen",type:"document",metaMap:{documentTitle:1,documentURL:2}},omniboxFacet:{name:"omniboxFacet",type:"omnibox",metaMap:{facetId:1,facetValue:2,facetTitle:3}},omniboxAnalytics:{name:"omniboxAnalytics",type:"omnibox",metaMap:{partialQuery:1,suggestionRanking:2,partialQueries:3,suggestions:4}},omniboxField:{name:"omniboxField",type:"omnibox"},facetClearAll:{name:"facetClearAll",type:"facet",metaMap:{facetId:1}},facetSearch:{name:"facetSearch",type:"facet",metaMap:{facetId:1}},facetToggle:{name:"facetToggle",type:"facet",metaMap:{facetId:1,facetOperatorBefore:2,facetOperatorAfter:3}},facetRangeSlider:{name:"facetRangeSlider",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetRangeGraph:{name:"facetRangeGraph",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetSelect:{name:"facetSelect",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetSelectAll:{name:"facetSelectAll",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetDeselect:{name:"facetDeselect",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetExclude:{name:"facetExclude",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetUnexclude:{name:"facetUnexclude",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},errorBack:{name:"errorBack",type:"errors"},errorClearQuery:{name:"errorClearQuery",type:"errors"},errorRetry:{name:"errorRetry",type:"errors"},noResultsBack:{name:"noResultsBack",type:"noResults"},expandToFullUI:{name:"expandToFullUI",type:"interface"},caseCreationInputChange:{name:"inputChange",type:"caseCreation"},caseCreationSubmitButton:{name:"submitButton",type:"caseCreation"},caseCreationCancelButton:{name:"cancelButton",type:"caseCreation"},caseCreationUnloadPage:{name:"unloadPage",type:"caseCreation"},casecontextAdd:{name:"casecontextAdd",type:"casecontext",metaMap:{caseID:5}},casecontextRemove:{name:"casecontextRemove",type:"casecontext",metaMap:{caseID:5}},preferencesChange:{name:"preferencesChange",type:"preferences",metaMap:{preferenceName:1,preferenceType:2}},getUserHistory:{name:"getUserHistory",type:"userHistory"},caseAttach:{name:"caseAttach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},caseDetach:{name:"caseDetach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},customfiltersChange:{name:"customfiltersChange",type:"customfilters",metaMap:{customFilterName:1,customFilterType:2,customFilterExpression:3}},pagerNumber:{name:"pagerNumber",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerNext:{name:"pagerNext",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerPrevious:{name:"pagerPrevious",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerScrolling:{name:"pagerScrolling",type:"getMoreResults"},searchFromLink:{name:"searchFromLink",type:"interface"},triggerNotify:{name:"notify",type:"queryPipelineTriggers"},triggerExecute:{name:"execute",type:"queryPipelineTriggers"},triggerRedirect:{name:"redirect",type:"queryPipelineTriggers"},queryError:{name:"query",type:"errors",metaMap:{query:1,aq:2,cq:3,dq:4,errorType:5,errorMessage:6}},exportToExcel:{name:"exportToExcel",type:"misc"}}}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.isContextual=!1}return t.prototype.isActivated=function(){return!1},t.prototype.getCurrentEventCause=function(){return null},t.prototype.getCurrentEventMeta=function(){return{}},t.prototype.logSearchEvent=function(){},t.prototype.logSearchAsYouType=function(){},t.prototype.logClickEvent=function(){},t.prototype.logCustomEvent=function(){},t.prototype.getTopQueries=function(){var t=e.$.Deferred();return t.resolve([]),t},t.prototype.getCurrentVisitId=function(){return e.$.Deferred().resolve(null)},t.prototype.sendAllPendingEvents=function(){},t.prototype.warnAboutSearchEvent=function(){},t}();e.NoopAnalyticsClient=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o,s){t.call(this,i,n,s),this.eventNameSpace=n,this.defaultAttributes=e.$.extend(!0,{},this.defaultAttributes,o),this.attributes=o,this.logger.debug("Creating model")}return __extends(i,t),i.prototype.set=function(e,t,i){var n={};n[e]=t,this.setMultiple(n,i)},i.prototype.getAttributes=function(){var t=this,i={};return e._.each(this.attributes,function(n,o){e._.isObject(n)?e.Utils.objectEqual(n,t.defaultAttributes[o])||(i[o]=n):n!=t.defaultAttributes[o]&&(i[o]=n)}),i},i.prototype.setMultiple=function(t,i){var n=this,o=!1;this.preprocessEvent(t),e._.each(t,function(e,t){i&&i.customAttribute||n.checkIfAttributeExists(t),e=n.parseToCorrectType(t,e),(!i||i.validateType)&&n.validateType(t,e),n.checkIfAttributeChanged(t,e)&&(n.attributes[t]=e,o=!0,null!=i&&i.silent||n.attributeHasChangedEvent(t))}),!o||null!=i&&i.silent||(this.attributesHasChangedEvent(),this.anyEvent())},i.prototype.setNewDefault=function(e,t,i){i&&i.customAttribute||this.checkIfAttributeExists(e),this.defaultAttributes[e]=t},i.prototype.setDefault=function(e){this.set(e,this.defaultAttributes[e])},i.prototype.get=function(e){return void 0==e?this.attributes:this.attributes[e]},i.prototype.getDefault=function(e){return void 0==e?this.defaultAttributes:this.defaultAttributes[e]},i.prototype.reset=function(){this.setMultiple(this.defaultAttributes),this.modelWasResetEvent()},i.prototype.registerNewAttribute=function(e,t){this.defaultAttributes[e]=t,this.attributes[e]=t},i.prototype.getEventName=function(e){return this.eventNameSpace+":"+e},i.prototype.attributesHasChangedEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.change),this.createAttributesChangedArgument())},i.prototype.attributeHasChangedEvent=function(t){e.$(this.element).trigger(this.getEventName(i.eventTypes.changeOne)+t,this.createAttributeChangedArgument(t))},i.prototype.preprocessEvent=function(t){e.$(this.element).trigger(this.getEventName(i.eventTypes.preprocess),t)},i.prototype.modelWasResetEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.reset),this.createModelChangedArgument())},i.prototype.anyEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.all),this.createModelChangedArgument())},i.prototype.createAttributeChangedArgument=function(e){return{attribute:e,value:this.attributes[e]}},i.prototype.createAttributesChangedArgument=function(){return{attributes:this.attributes}},i.prototype.createModelChangedArgument=function(){return{model:this}},i.prototype.checkIfAttributeExists=function(t){e.Assert.check(e._.has(this.attributes,t))},i.prototype.validateType=function(t,i){e.Utils.isNullOrUndefined(this.attributes[t])||e.Utils.isUndefined(i)||(e._.isNumber(this.attributes[t])?e.Assert.check(e._.isNumber(i)&&!isNaN(i),"Non-matching type"):e._.isBoolean(this.attributes[t])?e.Assert.check(e._.isBoolean(i)||void 0!==e.Utils.parseBooleanIfNotUndefined(i),"Non-matching type"):e.Utils.isNullOrUndefined(this.defaultAttributes[t])||e.Assert.check(typeof i==typeof this.defaultAttributes[t],"Non-matching type"))},i.prototype.parseToCorrectType=function(t,i){return e._.isNumber(this.attributes[t])?parseInt(i,10):e._.isBoolean(this.attributes[t])?e._.isBoolean(i)?i:e.Utils.parseBooleanIfNotUndefined(i):i},i.prototype.checkIfAttributeChanged=function(t,i){var n=this.attributes[t];return e._.isNumber(n)||e._.isString(n)||e._.isBoolean(n)?n!==i:e._.isArray(n)?!e.Utils.arrayEqual(n,i):e._.isObject(n)?!e.Utils.objectEqual(n,i):!0},i.prototype.debugInfo=function(){return null},i.eventTypes={preprocess:"preprocess",changeOne:"change:",change:"change",reset:"reset",all:"all"},i}(e.Component);e.Model=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i){if(e.Assert.exists(t),0==i.length||void 0==i[0])return t;if(1==i.length&&e.Utils.isNonEmptyString(i[0]))return t.get(i[0]);if(e._.isObject(i[0])){var n=i[0],o=e.$.extend({customAttribute:!0},i[1]);return t.setMultiple(n,o)}if(i.length>1){var s=i[0],r=i[1],o=e.$.extend({customAttribute:!0},i[2]);return e.Assert.isNonEmptyString(s),t.set(s,r,o)}}var i=function(t){function i(n,o,s){var r=e._.extend({},i.defaultAttributes,o);t.call(this,n,i.ID,r,s)}return __extends(i,t),i.getFacetId=function(e,t){return void 0===t&&(t=!0),"f:"+e+(t?"":":not")},i.getFacetOperator=function(e){return"f:"+e+":operator"},i.getFacetLookupValue=function(e){return i.getFacetId(e)+":lookupvalues"},i.prototype.atLeastOneFacetIsActive=function(){return!e._.isUndefined(e._.find(this.attributes,function(t,i){return 0==i.indexOf("f:")&&e.Utils.isNonEmptyArray(t)&&i.indexOf(":range")<0}))},i.prototype.set=function(e,i,n){this.validate(e,i),t.prototype.set.call(this,e,i,n)},i.prototype.validate=function(t,n){t==i.attributesEnum.first&&e.Assert.isLargerOrEqualsThan(0,n)},i.ID="state",i.defaultAttributes={q:"",first:0,t:"",hd:"",hq:"",sort:"",tg:"",quickview:""},i.attributesEnum={q:"q",first:"first",t:"t",sort:"sort",hd:"hd",hq:"hq",tg:"tg",quickview:"quickview"},i}(e.Model);e.QueryStateModel=i,e.setState=t,e.CoveoJQuery.registerNamedMethod("state",function(n){e.Assert.exists(n);var o=e.Component.resolveBinding(n,i);return t(o,e._.toArray(arguments).slice(1))})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(i){e.call(this,i,t.ID,{})}return __extends(t,e),t.prototype.registerComponent=function(e,t){var i=this.attributes[e];void 0==i?this.attributes[e]=[t]:this.attributes[e].push(t)},t.ID="ComponentState",t}(e.Model);e.ComponentStateModel=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o){var s=e._.extend({},i.defaultAttributes,o);t.call(this,n,i.ID,s)}return __extends(i,t),i.ID="ComponentOptions",i.defaultAttributes={resultLink:void 0},i.attributesEnum={resultLink:"resultLink"},i}(e.Model);e.ComponentOptionsModel=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this._window=o,this.model=s,this.queryController=r,this.ignoreNextHashChange=!1,this.initialHashChange=!1,this.willUpdateHash=!1,this._window=this._window||window,this.model=s||this.resolveQueryStateModel(),this.queryController=r||this.resolveQueryController(),e.Assert.exists(this.model),e.Assert.exists(this.queryController),e.$(this.element).on(e.InitializationEvents.restoreHistoryState,function(){a.logger.trace("Restore history state. Update model"),a.updateModelFromHash()}),e.$(this.element).on(this.model.getEventName(e.Model.eventTypes.all),function(){a.logger.trace("Query model changed. Update hash"),a.updateHashFromModel()}),e.$(this._window).on("hashchange",e.$.proxy(this.handleHashChange,this))}return __extends(i,t),i.prototype.handleHashChange=function(){if(this.logger.trace("History hash changed"),this.ignoreNextHashChange)return this.logger.trace("History hash change ignored"),this.ignoreNextHashChange=!1,void 0;var t=this.updateModelFromHash();e._.difference(i.attributesThatDoNotTriggerQuery,t).length>0&&this.queryController.executeQuery()},i.prototype.updateHashFromModel=function(){var t=this;this.logger.trace("Model -> history hash"),this.willUpdateHash||(e.Defer.defer(function(){var e=t.model.getAttributes();t.setHashValues(e),t.logger.debug("Saving state to hash",e),t.willUpdateHash=!1}),this.willUpdateHash=!0)},i.prototype.updateModelFromHash=function(){var t=this;this.logger.trace("History hash -> model");var i={},n=[];return e._.each(this.model.attributes,function(e,o){var s=t.getHashValue(o);void 0==s&&(s=t.model.defaultAttributes[o]),i[o]=s,t.model.get(o)!=s&&n.push(o)}),this.initialHashChange=!0,this.model.setMultiple(i),n},i.prototype.getHashValue=function(t){return e.Assert.isNonEmptyString(t),e.HashUtils.getValue(t,e.HashUtils.getHash(this._window))},i.prototype.setHashValues=function(t){this.logger.trace("Update history hash");var i="#"+e.HashUtils.encodeValues(t);this.ignoreNextHashChange=this._window.location.hash!=i,this.logger.trace("ignoreNextHashChange",this.ignoreNextHashChange),this.logger.trace("initialHashChange",this.initialHashChange),this.logger.trace("from",this._window.location.hash,"to",i),this.initialHashChange?(this.initialHashChange=!1,this._window.location.replace(i),this.logger.trace("History hash modified",i)):this.ignoreNextHashChange&&(this._window.location.hash=i,this.logger.trace("History hash created",i))},i.prototype.debugInfo=function(){return{state:this.model.getAttributes()}},i.ID="HistoryController",i.attributesThatDoNotTriggerQuery=["quickview"],i}(e.Component);e.HistoryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=window.localStorage,i=function(){function e(e){this.id=e}return e.prototype.save=function(e){try{null!=t&&t.setItem(this.getLocalStorageKey(),JSON.stringify(e))}catch(i){}},e.prototype.load=function(){try{if(null==t)return null;var e=t.getItem(this.getLocalStorageKey());return e&&JSON.parse(e)}catch(i){return null}},e.prototype.remove=function(e){try{if(null!=t)if(void 0==e)t.removeItem(this.getLocalStorageKey());else{var i=this.load();delete i[e],this.save(i)}}catch(n){}},e.prototype.getLocalStorageKey=function(){return"coveo-"+this.id},e}();e.LocalStorageUtils=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this._window=o,this.model=s,this.queryController=r,this.omit=[],o.localStorage?(this.storage=new e.LocalStorageUtils(i.ID),this.model=s||this.resolveQueryStateModel(),this.queryController=r||this.resolveQueryController(),e.Assert.exists(this.model),e.Assert.exists(this.queryController),e.$(this.element).on(e.InitializationEvents.restoreHistoryState,function(){return a.updateModelFromLocalStorage()}),e.$(this.element).on(this.model.getEventName(e.Model.eventTypes.all),function(){return a.updateLocalStorageFromModel()})):new e.Logger(n).info("No local storage available in current browser. LocalStorageHistoryController cannot initialize itself",this)}return __extends(i,t),i.prototype.withoutThoseAttribute=function(e){this.omit=e},i.prototype.updateLocalStorageFromModel=function(){var t=e._.omit(this.model.getAttributes(),this.omit);this.setStorageValues(t),this.logger.debug("Saving state to localstorage",t)},i.prototype.updateModelFromLocalStorage=function(){var t=this,i={},n=this.storage.load();e._.each(this.model.attributes,function(e,o){var s=n?n[o]:void 0;void 0==s&&(s=t.model.defaultAttributes[o]),i[o]=s}),this.model.setMultiple(i)},i.prototype.setStorageValues=function(e){this.storage.save(e)},i.ID="LocalStorageHistoryController",i}(e.Component);e.LocalStorageHistoryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){this.searchAsYouType=!1,this.closeModalBox=!0,this.cancel=!1}return e}(),i=function(i){function n(t,o){i.call(this,t,n.ID),this.options=o,this.showingExecutingQueryAnimation=!1,this.localStorage=new e.LocalStorageUtils("lastQueryHash"),e.Assert.exists(t),e.Assert.exists(o),this.firstQuery=!0}return __extends(n,i),n.prototype.setEndpoint=function(e){this.overrideEndpoint=e,this.logger.debug("Endpoint set",e)},n.prototype.getEndpoint=function(){var t=this.overrideEndpoint||this.options.endpoint;return new e.SearchEndpointWithDefaultCallOptions(t,this.getCallOptions())},n.prototype.getLastQuery=function(){return this.lastQuery||(new e.QueryBuilder).build()},n.prototype.getLastQueryHash=function(){return null!=this.lastQueryHash?this.lastQueryHash:(this.loadLastQueryHash(),this.lastQueryHash||this.queryHash((new e.QueryBuilder).build()))},n.prototype.getLastSearchUid=function(){return null!=this.lastSearchUid?this.lastSearchUid:(this.loadLastQueryHash(),this.lastSearchUid)},n.prototype.loadLastQueryHash=function(){var e=this.localStorage.load();null!=e&&(new Date).getTime()<=e.expire&&(this.lastQueryHash=e.hash,this.lastSearchUid=e.uid,this.localStorage.remove())},n.prototype.saveLastQuery=function(){this.localStorage.save({expire:(new Date).getTime()+18e5,hash:this.lastQueryHash,uid:this.lastSearchUid})},n.prototype.executeQuery=function(i){var n=this;null==i&&(i=e._.extend(new t,i)),i.closeModalBox&&e.ModalBox.close(!0),this.logger.debug("Executing new query",a);var i=e._.extend(new t,i);this.cancelAnyCurrentPendingQuery(),null!=i.beforeExecuteQuery&&i.beforeExecuteQuery(),i.ignoreWarningSearchEvent||this.usageAnalytics.warnAboutSearchEvent(),this.showExecutingQueryAnimation();var o=e.$.Deferred();this.currentPendingQuery=o;var s={deferred:o,searchAsYouType:i.searchAsYouType,cancel:i.cancel,origin:i.origin};if(this.newQueryEvent(s),s.cancel)return this.cancelQuery(),void 0;var r=this.createQueryBuilder(i);if(r){var a=r.build(),l=this.getEndpoint(),u=l.search(a);u.done(function(t){e.Assert.exists(t);var s=n.firstQuery;if(n.firstQuery&&(n.firstQuery=!1),o===n.currentPendingQuery){n.logger.debug("Query results received",a,t),s&&!n.searchInterface.options.enableHistory||!n.keepLastSearchUid(a,t)?(n.lastQueryHash=n.queryHash(a,t),n.lastSearchUid=t.searchUid):(t.searchUid=n.getLastSearchUid(),t._reusedSearchUid=!0,e.QueryUtils.setPropertyOnResults(t,"queryUid",n.getLastSearchUid())),n.lastQuery=a,n.lastQueryResults=t,n.currentError=null;var l={queryBuilder:r,query:a,results:t,searchAsYouType:i.searchAsYouType};n.preprocessResultsEvent(l);var u={queryBuilder:r,query:a,results:t,searchAsYouType:i.searchAsYouType,retryTheQuery:!1};if(0==t.results.length&&n.noResultEvent(u),u.retryTheQuery)n.executeQuery().done(function(e){o.resolve(e)}).fail(function(e,t){o.reject(e,t)});else{n.lastQueryBuilder=r,n.currentPendingQuery.resolve(t),n.currentPendingQuery=void 0;var c={queryBuilder:r,query:a,results:t,searchAsYouType:i.searchAsYouType};n.querySuccessEvent(c),e.Defer.defer(function(){n.deferredQuerySuccessEvent(c),n.hideExecutingQueryAnimation()})}}}),u.fail(function(e,t){if(o===n.currentPendingQuery){n.logger.error("Query triggered an error",a,t),n.currentPendingQuery.reject(t),n.currentPendingQuery=void 0;var s={queryBuilder:r,endpoint:l,query:a,error:t,searchAsYouType:i.searchAsYouType};n.lastQueryResults=null,n.currentError=t,n.queryError(s),n.hideExecutingQueryAnimation()}});var c={queryBuilder:r,query:a,deferred:o,searchAsYouType:i.searchAsYouType};return this.duringQueryEvent(c),o}},n.prototype.deferExecuteQuery=function(t){var i=this;this.showExecutingQueryAnimation(),e.Defer.defer(function(){return i.executeQuery(t)})},n.prototype.fetchMore=function(t){var i=this;if(void 0!=this.currentPendingQuery)return void 0;var n=this.currentPendingQuery=e.$.Deferred(),o=new e.QueryBuilder;this.continueLastQueryBuilder(o,t);var s=o.build(),r=this.getEndpoint();n=r.search(s);var a={queryBuilder:o,query:s,deferred:n,searchAsYouType:!1};return e.$(this.element).trigger(e.QueryEvents.duringFetchMoreQuery,a),this.lastQueryBuilder=o,this.lastQuery=s,n.done(function(t){i.currentPendingQuery=void 0,null==i.lastQueryResults?i.lastQueryResults=t:e._.forEach(t.results,function(e){i.lastQueryResults.results.push(e)});var n={queryBuilder:o,query:s,results:t,searchAsYouType:!1};i.preprocessResultsEvent(n),e.QueryUtils.setIndexAndUidOnQueryResults(s,t,i.getLastSearchUid(),t.pipeline,t.splitTestRun);var r={query:s,results:t,queryBuilder:o,searchAsYouType:!1};i.fetchMoreSuccessEvent(r)}),n},n.prototype.isStandaloneSearchbox=function(){return e.Utils.isNonEmptyString(this.options.searchPageUri)},n.prototype.cancelQuery=function(){this.cancelAnyCurrentPendingQuery(),this.hideExecutingQueryAnimation()},n.prototype.continueLastQueryBuilder=function(t,i){e.$.extend(t,this.lastQueryBuilder),t.firstResult=t.firstResult+t.numberOfResults,t.numberOfResults=i},n.prototype.createQueryBuilder=function(t){e.Assert.exists(t);var i=new e.QueryBuilder;i.language=String.locale,i.firstResult=i.firstResult||0,i.numberOfResults=this.options.resultsPerPage,i.filterField=this.options.filterField,i.excerptLength=this.options.excerptLength,i.enableCollaborativeRating=this.options.enableCollaborativeRating,e.Utils.isNonEmptyString(this.options.expression)&&i.advancedExpression.add(this.options.expression),e.Utils.isNonEmptyString(this.options.timezone)&&(i.timezone=this.options.timezone);var n={queryBuilder:i,searchAsYouType:t.searchAsYouType,cancel:t.cancel};this.buildingQueryEvent(n);var o={queryBuilder:i,searchAsYouType:t.searchAsYouType,cancel:t.cancel};if(this.doneBuildingQueryEvent(o),n.cancel||o.cancel)return this.cancelQuery(),void 0;var s=this.getPipelineInUrl();return s&&(i.pipeline=s),i},n.prototype.getPipelineInUrl=function(){return e.QueryUtils.getUrlParameter("pipeline")},n.prototype.cancelAnyCurrentPendingQuery=function(){return e.Utils.exists(this.currentPendingQuery)?(this.logger.debug("Cancelling current pending query"),this.currentPendingQuery.reject(),this.currentPendingQuery=void 0,!0):!1},n.prototype.showExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation||(e.$(this.root).addClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!0)},n.prototype.hideExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation&&(e.$(this.root).removeClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!1)},n.prototype.keepLastSearchUid=function(e,t){return this.getLastQueryHash()==this.queryHash(e,t)},n.prototype.queryHash=function(t,i){var n=JSON.stringify(e._.omit(t,"firstResult","groupBy","debug"));return null!=i&&(n+=i.pipeline),n},n.prototype.getCallOptions=function(){var t={options:{authentication:[]}};return e.$(this.element).trigger(e.QueryEvents.buildingCallOptions,t),t.options},n.prototype.newQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.newQuery,t)},n.prototype.buildingQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.buildingQuery,t)},n.prototype.doneBuildingQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.doneBuildingQuery,t)},n.prototype.duringQueryEvent=function(t){e.$(this.element).trigger(e.QueryEvents.duringQuery,t)},n.prototype.querySuccessEvent=function(t){e.$(this.element).trigger(e.QueryEvents.querySuccess,t)},n.prototype.fetchMoreSuccessEvent=function(t){e.$(this.element).trigger(e.QueryEvents.fetchMoreSuccess,t)},n.prototype.deferredQuerySuccessEvent=function(t){e.$(this.element).trigger(e.QueryEvents.deferredQuerySuccess,t)},n.prototype.queryError=function(t){e.$(this.element).trigger(e.QueryEvents.queryError,t)},n.prototype.preprocessResultsEvent=function(t){e.$(this.element).trigger(e.QueryEvents.preprocessResults,t)},n.prototype.noResultEvent=function(t){e.$(this.element).trigger(e.QueryEvents.noResults,t)},n.prototype.debugInfo=function(){var t=this,i={query:this.lastQuery};return null!=this.lastQueryResults&&(i.queryDuration=function(){return t.buildQueryDurationSection(t.lastQueryResults)},i.results=function(){return e._.omit(t.lastQueryResults,"results")}),null!=this.currentError&&(i.error=function(){return t.currentError}),i},n.prototype.buildQueryDurationSection=function(t){var i=e.$('<div class="coveo-debug-queryDuration"></div>'),n=e.$('<div class="coveo-debug-durations"></div>').appendTo(i);return e._.forEach(e.Debug.durationKeys,function(o){var s=t[o];if(null!=s){n.append('<div class="coveo-debug-duration" style="width:'+s+'px" data-id="'+o+'"></div>');var r=e.$('<div class="coveo-debug-duration-legend" data-id="'+o+'"></div>').appendTo(i);e.$('<span class="coveo-debug-duration-label"></span>').text(o).appendTo(r),e.$('<span class="coveo-debug-duration-value"></span>').text(s).appendTo(r)}}),i},n.ID="QueryController",n}(e.Component);e.QueryController=i,e.CoveoJQuery.registerNamedMethod("executeQuery",function(t){e.Assert.exists(t);var n=e.Component.resolveBinding(t,i);e.Assert.exists(n),n.executeQuery()})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.newQuery="newQuery",e.buildingQuery="buildingQuery",e.doneBuildingQuery="doneBuildingQuery",e.duringQuery="duringQuery",e.duringFetchMoreQuery="duringFetchMoreQuery",e.querySuccess="querySuccess",e.fetchMoreSuccess="fetchMoreSuccess",e.deferredQuerySuccess="deferredQuerySuccess",e.queryError="queryError",e.preprocessResults="preprocessResults",e.noResults="noResults",e.buildingCallOptions="buildingCallOptions",e}();e.QueryEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.beforeInitialization="beforeInitialization",e.afterComponentsInitialization="afterComponentsInitialization",e.restoreHistoryState="restoreHistoryState",e.afterInitialization="afterInitialization",e}();e.InitializationEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.newResultsDisplayed="newResultsDisplayed",e.newResultDisplayed="newResultDisplayed",e.openQuickview="openQuickview",e}();e.ResultListEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.imageResultsLayoutComplete="imageResultsLayoutComplete",e}();e.ImageResultListEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.enterOnSearchbox="enterOnSearchbox",e.quickviewLoaded="quickviewLoaded",e.openQuickview="openQuickview",e}();e.UserActionEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.savePreferences="savePreferences",e.exitPreferencesWithoutSave="exitPreferencesWithoutSave",e}();e.PreferencesPanelEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;void 0===r&&(r=window),t.call(this,n,i.ID),this.element=n,this.options=o,this.analyticsOptions=s,e.$(document.body).toggleClass("coveo-mobile-device",e.DeviceUtils.isMobileDevice()),FastClick.attach(n),this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.options.hideUntilFirstQuery&&this.showAndHideFirstQueryAnimation(),this.root=n,this.usageAnalytics=this.initializeAnalytics(),this.queryStateModel=new e.QueryStateModel(n),this.componentStateModel=new e.ComponentStateModel(n),this.componentOptionsModel=new e.ComponentOptionsModel(n),this.queryController=new e.QueryController(n,this.options),this.searchInterface=this;var l=this.queryStateModel.getEventName(e.Model.eventTypes.preprocess);e.$(this.element).on(l,function(e,t){return a.handlePreprocessQueryStateModel(t)}),e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),this.options.enableHistory?this.options.useLocalStorageForHistory?new e.LocalStorageHistoryController(n,r,this.queryStateModel,this.queryController):new e.HistoryController(n,r,this.queryStateModel,this.queryController):e.$(this.element).on(e.InitializationEvents.restoreHistoryState,function(){return a.queryStateModel.setMultiple(a.queryStateModel.defaultAttributes)});var u=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.quickview);e.$(this.element).on(u,e.$.proxy(this.handleQuickviewChanged,this)),e.$(this.element).css("display","block"),this.setupDebugInfo()}return __extends(i,t),i.prototype.initializeAnalytics=function(){var t=e.Component.getComponentRef("Analytics");return t?t.create(this.element,this.analyticsOptions):new e.NoopAnalyticsClient},i.prototype.setupDebugInfo=function(){var t=this;if(this.options.enableDebugInfo){var i=e.Component.getComponentRef("Debug");i?setTimeout(function(){return new i(t.element)}):this.logger.warn("Options to enable debug component was true, but not present in the Coveo object (not compiled)")}},i.prototype.showAndHideFirstQueryAnimation=function(){var t=this;this.displayFirstQueryWaitAnimation(),e.$(this.element).one(e.QueryEvents.querySuccess,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})}),e.$(this.element).on(e.QueryEvents.queryError,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})})},i.prototype.displayFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).addClass("coveo-waiting-for-first-query"),e.$(this.element).append(this.options.firstLoadingAnimation)},i.prototype.hideFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).removeClass("coveo-waiting-for-first-query")},i.prototype.handlePreprocessQueryStateModel=function(t){var i=this.queryStateModel.get(e.QueryStateModel.attributesEnum.tg),n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.t),o=i,s=n;void 0!==t.tg&&(t.tg=this.getTabGroupId(t.tg),o!=t.tg&&(t.t=t.t||e.QueryStateModel.defaultAttributes.t,t.sort=t.sort||e.QueryStateModel.defaultAttributes.sort,o=t.tg)),void 0!==t.t&&(t.t=this.getTabId(o,t.t),s!=t.t&&(t.sort=t.sort||e.QueryStateModel.defaultAttributes.sort,s=t.t)),void 0!==t.sort&&(t.sort=this.getSort(s,t.sort)),void 0!==t.quickview&&(t.quickview=this.getQuickview(t.quickview))},i.prototype.getTabGroupId=function(t){var i=e.Component.getComponentRef("TabGroup");if(i){var n=this.searchInterface.components(i.ID);if(t!=e.QueryStateModel.defaultAttributes.tg&&e._.any(n,function(e){return!e.disabled&&t==e.options.id}))return t;if(n.length>0)return n[0].options.id}return e.QueryStateModel.defaultAttributes.tg},i.prototype.getTabId=function(t,i){var n=e.Component.getComponentRef("Tab"),o=e.Component.getComponentRef("TabGroup");if(n){var s=this.searchInterface.components(n.ID);
if(o&&t!=e.QueryStateModel.defaultAttributes.tg){var r=this.searchInterface.components(o.ID),a=e._.find(r,function(e){return t==e.options.id});if(i!=e.QueryStateModel.defaultAttributes.t&&e._.any(s,function(e){return i==e.options.id&&a.isElementIncludedInTabGroup(e.element)}))return i;var l=e._.find(s,function(e){return a.isElementIncludedInTabGroup(e.element)});return null!=l?l.options.id:e.QueryStateModel.defaultAttributes.t}if(i!=e.QueryStateModel.defaultAttributes.t&&e._.any(s,function(e){return i==e.options.id}))return i;if(s.length>0)return s[0].options.id}return e.QueryStateModel.defaultAttributes.t},i.prototype.getSort=function(t,i){var n=e.Component.getComponentRef("Sort");if(n){var o=this.searchInterface.components(n.ID),s=e.Component.getComponentRef("Tab");if(s&&t!=e.QueryStateModel.defaultAttributes.t){var r=this.searchInterface.components(s.ID),a=e._.find(r,function(e){return t==e.options.id}),l=a.options.sort;if(i!=e.QueryStateModel.defaultAttributes.sort&&e._.any(o,function(e){return a.isElementIncludedInTab(e.element)&&e.match(i)}))return i;if(null!=l)return l.toString();var u=e._.find(o,function(e){return a.isElementIncludedInTab(e.element)});return null!=u?u.options.sortCriteria[0].toString():e.QueryStateModel.defaultAttributes.sort}if(i!=e.QueryStateModel.defaultAttributes.sort&&e._.any(o,function(e){return e.match(i)}))return i;if(o.length>0)return o[0].options.sortCriteria[0].toString()}return e.QueryStateModel.defaultAttributes.sort},i.prototype.getQuickview=function(t){var i=e.Component.getComponentRef("Quickview");if(i){var n=this.searchInterface.components(i.ID);if(e._.any(n,function(e){return e.getHashId()==t}))return t}return e.QueryStateModel.defaultAttributes.quickview},i.prototype.handleQuickviewChanged=function(t,i){var n=e.Component.getComponentRef("Quickview");if(n){var o=this.searchInterface.components(n.ID);if(""!=i.value){var s=e._.partition(o,function(e){return e.getHashId()==i.value});0!=s[0].length&&(e._.first(s[0]).open(),e._.forEach(e._.tail(s[0]),function(e){return e.close()})),e._.forEach(s[1],function(e){return e.close()})}else e._.forEach(o,function(e){e.close()})}},i.prototype.handleBuildingQuery=function(e,t){this.options.enableDuplicateFiltering&&(t.queryBuilder.enableDuplicateFiltering=!0),null!=this.options.pipeline&&(t.queryBuilder.pipeline=this.options.pipeline)},i.prototype.attachComponent=function(e,t){this.components(e).push(t)},i.prototype.detachComponent=function(t,i){var n=this.components(t),o=e._.indexOf(n,i);o>-1&&n.splice(o,1)},i.prototype.components=function(e){return null==this.attachedComponents&&(this.attachedComponents={}),e in this.attachedComponents||(this.attachedComponents[e]=[]),this.attachedComponents[e]},i.ID="SearchInterface",i.options={searchPageUri:e.ComponentOptions.buildStringOption(),enableHistory:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),resultsPerPage:e.ComponentOptions.buildNumberOption({defaultValue:10,min:0}),excerptLength:e.ComponentOptions.buildNumberOption({defaultValue:200,min:0}),expression:e.ComponentOptions.buildStringOption({defaultValue:""}),filterField:e.ComponentOptions.buildStringOption({defaultValue:""}),hideUntilFirstQuery:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),firstLoadingAnimation:e.ComponentOptions.buildChildHtmlElementOption({childSelector:".coveo-first-loading-animation",defaultFunction:function(){return e.JQueryUtils.getBasicLoadingAnimation().get(0)}}),autoTriggerQuery:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),endpoint:e.ComponentOptions.buildCustomOption(function(t){return null!=t&&t in e.SearchEndpoint.endpoints?e.SearchEndpoint.endpoints[t]:null},{defaultFunction:function(){return e.SearchEndpoint.endpoints["default"]}}),timezone:e.ComponentOptions.buildStringOption({defaultFunction:function(){return jstz.determine().name()}}),enableDebugInfo:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableCollaborativeRating:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),useLocalStorageForHistory:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableDuplicateFiltering:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),pipeline:e.ComponentOptions.buildStringOption()},i}(e.Component);e.SearchInterface=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){void 0===r&&(r=window),t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,r),this.element=n,this.options=o,this.analyticsOptions=s,e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this.handleRedirect,this))}return __extends(i,t),i.prototype.handleRedirect=function(t,i){var n={searchPageUri:this.options.searchPageUri,cancel:!1};e.$(this.root).trigger(e.StandaloneSearchInterfaceEvents.beforeRedirect,n),n.cancel||(i.cancel=!0,(!this.searchboxIsEmpty()||this.options.redirectIfEmpty)&&this.redirectToSearchPage(n.searchPageUri))},i.prototype.redirectToSearchPage=function(t){var i=this.queryStateModel.getAttributes(),n=this.usageAnalytics.getCurrentEventCause();null!=n&&(i.firstQueryCause=n);var o=this.usageAnalytics.getCurrentEventMeta();null!=o&&(i.firstQueryMeta=o),window.location.href=t+"#"+e.HashUtils.encodeValues(i)},i.prototype.searchboxIsEmpty=function(){return e.Utils.isEmptyString(this.queryStateModel.get(e.QueryStateModel.attributesEnum.q))},i.ID="StandaloneSearchInterface",i.options={redirectIfEmpty:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.SearchInterface);e.StandaloneSearchInterface=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.beforeRedirect="beforeRedirect",e}();e.StandaloneSearchInterfaceEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.debug=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).on(e.QueryEvents.buildingQuery,function(e,t){t.queryBuilder.enableDebug=r.debug||t.queryBuilder.enableDebug}),e.$(this.element).on(e.ResultListEvents.newResultDisplayed,function(e,t){return r.handleNewResultDisplayed(e,t)}),e.$(this.root).on(e.DebugEvents.showDebugPanel,function(e,t){r.handleShowDebugPanel(t)}),this.localStorageDebug=new e.LocalStorageUtils("DebugPanel"),this.collapsedSections=this.localStorageDebug.load()||[]}return __extends(i,t),i.prototype.showDebugPanel=function(t){var i=this,n=t(),o=function(){var e=t();return l.attr("href",i.dowloadHref(e.json)),e.body},s=e.ModalBox.open(n.body,{title:"",className:"coveo-debug",titleClose:!0,overlayClose:!0}),r=s.wrapper.children(".coveo-title"),a=this.buildSearchbox(n.body);this.buildEnableCheckbox(n.body,a,o).appendTo(r),a.appendTo(r);var l=e.$('<a download="debug.json">Download</a>').appendTo(r).attr("href",this.dowloadHref(n.json))},i.prototype.handleShowDebugPanel=function(t){var i=this;null==this.stackDebug&&(setTimeout(function(){var e=i.stackDebug;i.showDebugPanel(function(){return i.buildStackPanel(e)}),i.stackDebug=null}),this.stackDebug={}),e._.extend(this.stackDebug,t)},i.prototype.handleNewResultDisplayed=function(t,i){var n=this;null!=i.item&&e.$(i.item).dblclick(function(e){n.handleResultDoubleClick(e,i)})},i.prototype.handleResultDoubleClick=function(t,i){var n=this;if(t.altKey){var o=i.result.index,s=function(t){return null!=t?e._.find(t.results,function(e){return e.index==o}):i.result},r=e.$(i.item),a=r.data("template");this.handleShowDebugPanel({result:s,fields:function(e){return n.buildFieldsSection(s(e))},rankingInfo:function(e){return n.buildRankingInfoSection(s(e))},template:this.templateToJson(a)})}},i.prototype.dowloadHref=function(e){return"data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))},i.prototype.buildStackPanel=function(t,n){var o=this,s=e.$('<div class="coveo-debug"></div>'),r=e._.pairs(e._.keys(t));r=r.sort(function(t,n){var o=e._.indexOf(i.customOrder,t[1]),s=e._.indexOf(i.customOrder,n[1]);return-1!=o&&-1!=s?o-s:-1!=o?-1:-1!=s?1:t[0]-n[0]});var a={};return e._.forEach(r,function(e){var i=o.buildSection(e[1]),r=o.buildStackPanelSection(t[e[1]],n);i.container.append(r.section),null!=r.json&&(a[e[1]]=r.json),i.dom.appendTo(s)}),{body:s,json:a}},i.prototype.buildStackPanelSection=function(t,i){if(t instanceof e.$)return{section:t};if(e._.isFunction(t))return this.buildStackPanelSection(t(i),i);var n=this.toJson(t);return{section:this.buildProperty(n),json:n}},i.prototype.buildSearchbox=function(t){var i=this,n=e.$('<div class="coveo-debug-search"><input type="text"/></div>').click(function(e){e.stopPropagation()}),o="",s=e.$(n).find("input").attr({placeholder:"Search in debug"}).keyup(function(e){if(13==e.keyCode){var n=s.val().toLowerCase();o!=n&&(o=n,i.search(n,t))}}).change(function(){var e=s.val().toLowerCase();o!=e&&(o=e,i.search(e,t))});return n},i.prototype.search=function(t,i){var n=this;e._.isEmpty(t)?(i.find(".coveo-search-match, .coveo-search-submatch").removeClass("coveo-search-match, coveo-search-submatch"),i.removeClass("coveo-searching")):(i.addClass("coveo-searching-loading"),setTimeout(function(){var o=i.find(".coveo-section .coveo-section-container > .coveo-property"),s=(new Date).getTime();e._.each(o,function(e){n.findInProperty(e,t),console.log((new Date).getTime()-s)}),i.addClass("coveo-searching"),i.removeClass("coveo-searching-loading")}))},i.prototype.findInProperty=function(t,i){var n=this,o=e.$(t),s=-1!=t.label.indexOf(i);if(s?this.highlightSearch(t.labelDom,i):this.removeHighlightSearch(t.labelDom),o.hasClass("coveo-property-object")){o.toggleClass("coveo-search-match",s);var r=t.buildKeys(),a=!1;return e._.each(r,function(e){a=n.findInProperty(e,i)||a}),o.toggleClass("coveo-search-submatch",a),s||a}return-1!=t.value.indexOf(i)?(this.highlightSearch(t.valueDom,i),s=!0):this.removeHighlightSearch(t.valueDom),o.toggleClass("coveo-search-match",s),s},i.prototype.buildEnableCheckbox=function(t,i,n){var o=this,s=e.$('<div class="coveo-enabled-debug"><label>Enable query debug <input type="checkbox"/></label></div>').click(function(e){e.stopPropagation()}),r=e.$(s).find("input");return r.prop("checked",this.debug),r.change(function(){o.debug=!o.debug,e.$(o.element).one(e.QueryEvents.querySuccess+" "+e.QueryEvents.queryError,function(e,i){t.removeClass("coveo-debug-loading"),t.empty().append(n(i.results).children())}),o.queryController.executeQuery({closeModalBox:!1}),t.addClass("coveo-debug-loading"),i.find("input").val("").keyup()}),s},i.prototype.buildSection=function(t){var i=this,n=e.$('<div class="coveo-section"></div>').addClass("coveo-"+t+"-section"),o=e.$('<div class="coveo-section-header"></div>').text(t).appendTo(n),s=e.$('<div class="coveo-section-container"></div>').appendTo(n);return e._.contains(this.collapsedSections,t)&&n.addClass("coveo-debug-collapsed"),o.click(function(){n.toggleClass("coveo-debug-collapsed"),e._.contains(i.collapsedSections,t)?i.collapsedSections=e._.without(i.collapsedSections,t):i.collapsedSections.push(t),i.localStorageDebug.save(i.collapsedSections)}),{dom:n,header:o,container:s}},i.prototype.buildFieldsSection=function(t){var i={};return e._.each(t.raw,function(e,t){i["@"+t]=e}),i},i.prototype.buildRankingInfoSection=function(e){return e.rankingInfo&&this.parseRankingInfo(e.rankingInfo)},i.prototype.parseRankingInfo=function(t){var i=this,n={},o=t.match(/^(?:Document weights:\n((?:.)*?)\n)?\n(?:Terms weights:\n((?:.|\n)*))?Total weight: ([0-9]+)$/);if(null!=o[1]&&(n["Document weights"]=this.parseWeights(o[1])),null!=o[2]){var s=e.StringUtils.match(o[2],/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g);n["Terms weights"]=e._.object(e._.map(s,function(t){var n=e._.object(e._.map(e.StringUtils.match(t[1],/([^:]+): ([0-9]+), ([0-9]+); /g),function(e){return[e[1],{Correlation:Number(e[2]),"TF-IDF":Number(e[3])}]})),o=i.parseWeights(t[2]);return[e._.keys(n).join(", "),{terms:n,Weights:o}]}))}return n["Total weight"]=Number(o[3]),n},i.prototype.parseWeights=function(t){var i=t.match(/(\w+(?:\s\w+)*): ([0-9]+)/g);return e._.object(e._.map(i,function(e){var t=e.match(/^(\w+(?:\s\w+)*): ([0-9]+)$/);return[t[1],Number(t[2])]}))},i.prototype.buildProperty=function(t,i){return!e._.isArray(t)&&!e._.isObject(t)||e._.isString(t)?this.buildBasicProperty(t,i):this.buildObjectProperty(t,i)},i.prototype.buildObjectProperty=function(t,i){var n=this,o=document.createElement("div");o.className="coveo-property coveo-property-object";var s=document.createElement("div");s.className="coveo-property-value";var r=e._.keys(t);e._.isArray(t)||r.sort();var a,l=function(){return null==a&&(a=[],e._.each(r,function(e){var i=n.buildProperty(t[e],e);null!=i&&(a.push(i),s.appendChild(i))})),a};if(o.buildKeys=l,null!=i){var u=document.createElement("div");u.className="coveo-property-label",u.appendChild(document.createTextNode(i)),o.labelDom=u,o.appendChild(u),0!=r.length&&(o.className+=" coveo-collapsible",u.onclick=function(){l();var t=o.className.split(/\s+/);e._.contains(t,"coveo-expanded")?t=e._.without(t,"coveo-expanded"):t.push("coveo-expanded"),o.className=t.join(" ")})}else l();if(0==r.length){var c=e._.without(o.className.split(/\s+/),"coveo-property-object");c.push("coveo-property-basic"),o.className=c.join(" "),s.innerHTML=e._.isArray(t)?"[]":"{}",o.value=""}return o.label=null!=i?i.toLowerCase():"",o.appendChild(s),o},i.prototype.buildBasicProperty=function(t,i){var n=this,o=document.createElement("div");if(o.className="coveo-property coveo-property-basic",null!=i){var s=document.createElement("div");s.className="coveo-property-label",s.appendChild(document.createTextNode(i)),o.appendChild(s),o.labelDom=s}var r=null!=t?t.toString():String(t);null!=t&&null!=t.ref&&(t=t.ref);var a=document.createElement("div");a.appendChild(document.createTextNode(r)),a.ondblclick=function(){n.selectElementText(a)},o.appendChild(a),o.valueDom=a;var l=["coveo-property-value"];return e._.isString(t)&&l.push("coveo-property-value-string"),(e._.isNull(t)||e._.isUndefined(t))&&l.push("coveo-property-value-null"),e._.isNumber(t)&&l.push("coveo-property-value-number"),e._.isBoolean(t)&&l.push("coveo-property-value-boolean"),e._.isObject(t)&&l.push("coveo-property-value-object"),e._.isArray(t)&&l.push("coveo-property-value-array"),a.className=l.join(" "),o.label=null!=i?i.toLowerCase():"",o.value=r.toLowerCase(),o},i.prototype.toJson=function(t,n,o){var s=this;if(void 0===n&&(n=0),void 0===o&&(o=[]),t instanceof e.Component||t instanceof e.SearchEndpoint)return this.componentToJson(t,n);if(t instanceof HTMLElement)return this.htmlToJson(e.$(t));if(t instanceof e.$)return this.htmlToJson(t);if(t instanceof e.Template)return this.templateToJson(t);if(t==window)return this.toJsonRef(t);if(e._.isArray(t)||e._.isObject(t)){if(e._.contains(o,t))return this.toJsonRef(t,"< RECURSIVE >");if(n>=i.maxDepth)return this.toJsonRef(t);if(e._.isArray(t))return e._.map(t,function(e){return s.toJson(e,n+1,o.concat([t]))});var r={};return e._.each(t,function(e,i){r[i]=s.toJson(e,n+1,o.concat([t]))}),r.ref,r}return t},i.prototype.toJsonRef=function(e,t){return t=new String(t||e),t.ref=e,t},i.prototype.componentToJson=function(t,i){void 0===i&&(i=0);var n=e._.keys(t.options);return n.length>0?this.toJson(t.options,i):this.toJsonRef(t.options,new String("No options"))},i.prototype.htmlToJson=function(t){var i=this;return t.length>0?void 0:t.length>1?e._.map(t,function(t){return i.htmlToJson(e.$(t))}):{tagName:t.prop("tagName"),id:t.attr("id"),classList:t.attr("class").split(/\s+/),data:t.data()}},i.prototype.templateToJson=function(t){if(null==t)return null;var i=t.element,n={type:t.getType()};return null!=i&&(n.id=i.id,n.condition=e.$(i).data("condition"),n.content=e.$(i).html()),n},i.prototype.selectElementText=function(e){if(window.getSelection&&document.createRange){var t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}else if("createTextRange"in document.body){var n=document.body.createTextRange();n.moveToElementText(e),n.select()}},i.prototype.highlightSearch=function(t,i){null!=t&&(t.innerHTML=t.innerText.replace(new RegExp("("+e.StringUtils.regexEncode(i)+")","gi"),'<span class="coveo-debug-highlight">$1</span>'))},i.prototype.removeHighlightSearch=function(e){null!=e&&(e.innerHTML=e.innerText)},i.prototype.debugInfo=function(){return null},i.ID="Debug",i.options={enableDebug:e.ComponentOptions.buildBooleanOption({defaultvalue:!1})},i.customOrder=["error","queryDuration","result","fields","rankingInfo","template","query","results","state"],i.durationKeys=["indexDuration","proxyDuration","clientDuration","duration"],i.maxDepth=10,i}(e.Component);e.Debug=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.showDebugPanel="showDebugPanel",e}();e.DebugEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.querySuccess,this.handleQuerySuccess),e.$(this.element).hide()}return __extends(i,t),i.prototype.handleBuildingQuery=function(e,t){var i={field:this.options.field,maximumNumberOfValues:0,computedFields:[{field:this.options.field,operation:this.options.operation}]};this.index=t.queryBuilder.groupByRequests.length,t.queryBuilder.groupByRequests.push(i)},i.prototype.handleQuerySuccess=function(t,i){if(e._.isNumber(this.index)&&0!=i.results.groupByResults.length){var n=i.results.groupByResults[this.index],o=n.globalComputedFieldResults[0];e.$(this.element).text(Globalize.format(o,this.options.format)),e.$(this.element).show()}else e.$(this.element).hide()},i.ID="Aggregate",i.options={field:e.ComponentOptions.buildStringOption(),operation:e.ComponentOptions.buildStringOption({defaultValue:"sum"}),format:e.ComponentOptions.buildStringOption({defaultValue:"c0"})},i}(e.Component);e.Aggregate=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.options=t,this.visitId=void 0,this.logger=new e.Logger(this)}return t.prototype.getVisitId=function(i){var n=this,o=e.$.Deferred();if(this.visitId)o.resolve(this.visitId);else{var s=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/analytics/visit");this.getFromService(s,i).done(function(e){n.visitId=e.id,o.resolve(n.visitId)})}return o},t.prototype.sendSearchEvents=function(t){var i=this;t.length>0&&(this.logger.info("Logging analytics search events",t),this.sendEventToApi(t,"searches","searchEvents").done(function(t){e.Utils.isNullOrUndefined(t)||(i.visitId=e._.first(t.searchEventResponses).visitId)}))},t.prototype.sendDocumentViewEvent=function(t){var i=this;e.Assert.exists(t),this.logger.info("Logging analytics document view",t),this.sendEventToApi(t,"click","clickEvent").done(function(t){e.Utils.isNullOrUndefined(t)||(i.visitId=t.visitId)})},t.prototype.sendCustomEvent=function(t){var i=this;e.Assert.exists(t),this.logger.info("Logging analytics custom event",t),this.sendEventToApi(t,"custom","customEvent").done(function(t){e.Utils.isNullOrUndefined(t)||(i.visitId=t.visitId)})},t.prototype.getTopQueries=function(i){var n=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/stats/topQueries");return this.getFromService(n,i)},t.prototype.sendEventToApi=function(i,n,o){var s=this,r=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/analytics/"+n);if(r=this.appendUrlParamSign(r),r+=o+"="+encodeURIComponent(JSON.stringify(i)),this.options.token&&""!=this.options.token&&(r+="&access_token="+encodeURIComponent(this.options.token)),null==t.pendingRequest){var a=t.pendingRequest=e.$.ajax({url:r,dataType:"jsonp",async:!1});return t.pendingRequest.done(function(){t.pendingRequest=null}),a}var l=e.$.Deferred();return t.pendingRequest.always(function(){s.sendEventToApi(i,n,o).done(function(e){l.resolve(e)}).fail(function(e){l.reject(e)})}),l},t.prototype.appendUrlParamSign=function(e){return"?"==e.charAt(e.length-1)?e:e+"?"},t.prototype.getFromService=function(t,i){var n=this.options.token&&""!=this.options.token?e.$.extend({access_token:this.options.token},i):i;return e.$.ajax({url:this.appendUrlParamSign(t)+this.buildQueryStringFromParam(n),dataType:"jsonp"})},t.prototype.buildQueryStringFromParam=function(t){var i=e._.map(e._.pairs(t),function(e){return e[0]+"="+encodeURIComponent(e[1])});return i.join("&")},t.DEFAULT_ANALYTICS_URI="https://usageanalytics.coveo.com",t.DEFAULT_ANALYTICS_VERSION="v14",t.CUSTOM_ANALYTICS_VERSION=void 0,t}();e.AnalyticsEndpoint=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n,o){this._root=t,this._endpoint=i,this._templateSearchEvent=n,this._sendToCloud=o,this.searchDeferred=[],this.searchEvents=[],this.results=[],this._cancelled=!1,this._finished=!1,e.Assert.exists(t),e.Assert.exists(i),e.Assert.exists(n),this.handler=e.$.proxy(this._handleDuringQuery,this),e.$(t).on(e.QueryEvents.duringQuery+" "+e.QueryEvents.duringFetchMoreQuery,this.handler)}return t.prototype.getEventCause=function(){return this._templateSearchEvent.actionCause},t.prototype.getEventMeta=function(){return this._templateSearchEvent.customData},t.prototype.cancel=function(){this._stopRecording(),this._cancelled=!0},t.prototype._handleDuringQuery=function(t,i){var n=this;e.Assert.check(!this._finished),e.Assert.check(!this._cancelled),this.searchDeferred.push(i.deferred);var o=e.Component.get(t.target,e.SearchInterface);e.Assert.exists(o);var s=e.Component.get(t.target,e.QueryController);e.Assert.exists(s),i.deferred.done(function(t){if(e.Assert.exists(t),e.Assert.check(!n._finished),t._reusedSearchUid!==!0){var s=e._.extend({},n._templateSearchEvent);n.fillSearchEvent(s,o,i.query,t),n.searchEvents.push(s),n.results.push(t)}}).always(function(){var t=e._.indexOf(n.searchDeferred,i.deferred);n.searchDeferred.splice(t,1),0==n.searchDeferred.length&&n.flush()})},t.prototype._stopRecording=function(){this.handler&&(e.$(this._root).off(e.QueryEvents.duringQuery+" "+e.QueryEvents.duringFetchMoreQuery,this.handler),this.handler=void 0)},t.prototype.flush=function(){var t=this;this._cancelled||(this._stopRecording(),this._finished=!0,e.Assert.check(this.searchEvents.length==this.results.length),e.Defer.defer(function(){t._sendToCloud&&t._endpoint.sendSearchEvents(t.searchEvents);var i=e._.map(t.searchEvents,function(t){return e.APIAnalyticsBuilder.convertSearchEventToAPI(t)});e.$(t._root).trigger(e.AnalyticsEvents.searchEvent,{searchEvents:i})}))},t.prototype.fillSearchEvent=function(t,i,n,o){e.Assert.exists(t),e.Assert.exists(i),e.Assert.exists(n),e.Assert.exists(o);var s=i.queryStateModel.get(e.QueryStateModel.attributesEnum.q);t.queryPipeline=o.pipeline,t.splitTestRunName=t.splitTestRunName||o.splitTestRun,t.splitTestRunVersion=t.splitTestRunVersion||(void 0!=o.splitTestRun?o.pipeline:void 0),t.originLevel2=t.originLevel2||i.queryStateModel.get("t")||"default",t.queryText=s||n.q||"",t.advancedQuery=n.aq||"",t.didYouMean=n.enableDidYouMean,t.numberOfResults=o.totalCount,t.responseTime=o.duration,t.pageNumber=n.firstResult/n.numberOfResults,t.resultsPerPage=n.numberOfResults,t.searchQueryUid=o.searchUid,t.queryPipeline=o.pipeline},t}();e.PendingSearchEvent=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o,s){t.call(this,i,n,o,s),this._root=i,this._endpoint=n,this._templateSearchEvent=o,this._sendToCloud=s,this.delayBeforeSending=5e3,this.armBatchDelay=50,this.beforeUnloadHandler=e.$.proxy(this.onWindowUnload,this),e.$(window).on("beforeunload",this.beforeUnloadHandler)}return __extends(i,t),i.prototype._handleDuringQuery=function(i,n){var o=this;this.toSendRightNow=function(){o.isCancelledOrFinished()||t.prototype._handleDuringQuery.call(o,i,n)},e._.delay(function(){o.toSendRightNow()},this.delayBeforeSending)},i.prototype.sendRightNow=function(){this.toSendRightNow&&this.toSendRightNow()},i.prototype._stopRecording=function(){t.prototype._stopRecording.call(this),this.beforeUnloadHandler&&(e.$(window).off("beforeunload",this.beforeUnloadHandler),this.beforeUnloadHandler=void 0)},i.prototype.onWindowUnload=function(){this.isCancelledOrFinished()||(this.armBatchDelay=0,this.sendRightNow())},i.prototype.isCancelledOrFinished=function(){return this._cancelled?!0:this._finished?(this.cancel(),!0):!1},i}(e.PendingSearchEvent);e.PendingSearchAsYouTypeSearchEvent=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.searchEvent="analyticsSearchEvent",e.documentViewEvent="analyticsDocumentViewEvent",e.customEvent="analyticsCustomEvent",e.changeAnalyticsCustomData="changeAnalyticsCustomData",e}();e.AnalyticsEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.convertSearchEventToAPI=function(e){var t={advancedQuery:e.advancedQuery,customMetadatas:e.customData,device:e.device,didYouMean:e.didYouMean,language:e.language,pageNumber:e.pageNumber,queryText:e.queryText,responseTime:e.responseTime,numberOfResults:e.numberOfResults,resultsPerPage:e.resultsPerPage,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,type:e.actionType,actionCause:e.actionCause,queryPipeline:e.queryPipeline,splitTestRunName:e.splitTestRunName,splitTestRunVersion:e.splitTestRunVersion};return t},e.convertDocumentViewToAPI=function(e){var t={collectionName:e.collectionName,device:e.device,documentPosition:e.documentPosition,title:e.documentTitle,documentUrl:e.documentUrl,documentUri:e.documentUri,documentUriHash:e.documentUriHash,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,sourceName:e.sourceName,viewMethod:e.viewMethod,customMetadatas:e.customData,actionCause:e.actionCause,queryPipeline:e.queryPipeline,splitTestRunName:e.splitTestRunName,splitTestRunVersion:e.splitTestRunVersion};return t},e.convertCustomEventToAPI=function(e){var t={actionCause:e.actionCause,actionType:e.actionType,device:e.device,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,customMetadatas:e.customData};return t},e}();e.APIAnalyticsBuilder=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n,o,s,r,a,l,u){this.endpoint=t,this.rootElement=i,this.userId=n,this.userDisplayName=o,this.anonymous=s,this.splitTestRunName=r,this.splitTestRunVersion=a,this.originLevel1=l,this.sendToCloud=u,this.isContextual=!1,this.language=String.locale,this.device=e.DeviceUtils.getDeviceName(),this.mobile=e.DeviceUtils.isMobileDevice(),e.Assert.exists(t),e.Assert.exists(i),e.Assert.isNonEmptyString(this.language),e.Assert.isNonEmptyString(this.device),e.Assert.isNonEmptyString(this.originLevel1),this.logger=new e.Logger(this)}return t.prototype.isActivated=function(){return!0},t.prototype.getCurrentVisitId=function(){var t={},i=e.Utils.readCookie("visitor");return i&&(t.visitor=i),this.endpoint.getVisitId(t)},t.prototype.getCurrentEventCause=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventCause():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventCause():null},t.prototype.getCurrentEventMeta=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventMeta():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventMeta():null},t.prototype.logSearchEvent=function(e,t){var i=this.buildMetaObject(t);this.pushSearchEvent(e,i)},t.prototype.logSearchAsYouType=function(e,t){var i=this.buildMetaObject(t);this.pushSearchAsYouTypeEvent(e,i)},t.prototype.logClickEvent=function(e,t,i,n){var o=this.buildMetaObject(t);this.pushClickEvent(e,o,i,n)},t.prototype.logCustomEvent=function(e,t,i){var n=this.buildMetaObject(t);this.pushCustomEvent(e,n,i)},t.prototype.getTopQueries=function(e){return this.endpoint.getTopQueries(e)},t.prototype.sendAllPendingEvents=function(){this.pendingSearchAsYouTypeSearchEvent&&this.pendingSearchAsYouTypeSearchEvent.sendRightNow()},t.prototype.warnAboutSearchEvent=function(){e._.isUndefined(this.pendingSearchEvent)&&e._.isUndefined(this.pendingSearchAsYouTypeSearchEvent)&&(this.logger.warn("A search was triggered, but no analytics event was logged. If you wish to have consistent analytics data, consider logging a search event using the methods provided by the framework","https://developers.coveo.com/x/TwA5"),window.console&&console.trace&&console.trace())},t.prototype.pushCustomEvent=function(t,i,n){var o=this,s=this.buildCustomEvent(t,i,n);this.triggerChangeAnalyticsCustomData("CustomEvent",i,s),this.checkToSendAnyPendingSearchAsYouType(t),e.Defer.defer(function(){o.sendToCloud&&o.endpoint.sendCustomEvent(s),e.$(o.rootElement).trigger(e.AnalyticsEvents.customEvent,{customEvent:e.APIAnalyticsBuilder.convertCustomEventToAPI(s)})})},t.prototype.pushSearchEvent=function(t,i){var n=this;if(e.Assert.exists(t),this.pendingSearchEvent&&this.pendingSearchEvent.getEventCause()!==t.name&&(this.pendingSearchEvent._stopRecording(),this.pendingSearchEvent=null),this.checkToSendAnyPendingSearchAsYouType(t),!this.pendingSearchEvent){var o=this.buildSearchEvent(t,i);this.triggerChangeAnalyticsCustomData("SearchEvent",i,o);var s=this.pendingSearchEvent=new e.PendingSearchEvent(this.rootElement,this.endpoint,o,this.sendToCloud);e.Defer.defer(function(){n.pendingSearchEvent=void 0,s._stopRecording()})}},t.prototype.checkToSendAnyPendingSearchAsYouType=function(e){this.eventIsNotRelatedToSearchbox(e.name)?this.sendAllPendingEvents():this.cancelAnyPendingSearchAsYouTypeEvent()},t.prototype.pushSearchAsYouTypeEvent=function(t,i){this.cancelAnyPendingSearchAsYouTypeEvent();var n=this.buildSearchEvent(t,i);this.triggerChangeAnalyticsCustomData("SearchEvent",i,n),this.pendingSearchAsYouTypeSearchEvent=new e.PendingSearchAsYouTypeSearchEvent(this.rootElement,this.endpoint,n,this.sendToCloud)},t.prototype.pushClickEvent=function(t,i,n,o){var s=this,r=this.buildClickEvent(t,i,n,o);this.checkToSendAnyPendingSearchAsYouType(t),this.triggerChangeAnalyticsCustomData("ClickEvent",i,r),e.Assert.isNonEmptyString(r.searchQueryUid),e.Assert.isNonEmptyString(r.collectionName),e.Assert.isNonEmptyString(r.sourceName),e.Assert.isNumber(r.documentPosition),e.Defer.defer(function(){s.sendToCloud&&s.endpoint.sendDocumentViewEvent(r),e.$(s.rootElement).trigger(e.AnalyticsEvents.documentViewEvent,{documentViewEvent:e.APIAnalyticsBuilder.convertDocumentViewToAPI(r)})})},t.prototype.buildAnalyticsEvent=function(t,i){return{actionCause:t.name,actionType:t.type,username:this.userId,userDisplayName:this.userDisplayName,anonymous:this.anonymous,device:this.device,mobile:this.mobile,language:this.language,responseTime:void 0,originLevel1:this.originLevel1,originLevel2:this.resolveActiveTabFromElement(this.rootElement),customData:e._.keys(i).length>0?i:void 0,userAgent:navigator.userAgent}},t.prototype.buildSearchEvent=function(e,t){return this.merge(this.buildAnalyticsEvent(e,t),{searchQueryUid:void 0,pipeline:void 0,splitTestRunName:this.splitTestRunName,splitTestRunVersion:this.splitTestRunVersion,queryText:void 0,advancedQuery:void 0,results:void 0,resultsPerPage:void 0,pageNumber:void 0,didYouMean:void 0,facets:void 0,contextual:this.isContextual})},t.prototype.buildClickEvent=function(e,t,i,n){return this.merge(this.buildAnalyticsEvent(e,t),{searchQueryUid:i.queryUid,queryPipeline:i.pipeline,splitTestRunName:this.splitTestRunName||i.splitTestRun,splitTestRunVersion:this.splitTestRunVersion||(void 0!=i.splitTestRun?i.pipeline:void 0),documentUri:i.uri,documentUriHash:i.raw.sysurihash,documentUrl:i.clickUri,documentTitle:i.title,originLevel2:this.resolveActiveTabFromElement(n)||"default",collectionName:i.raw.syscollection,sourceName:i.raw.syssource,documentPosition:i.index+1,responseTime:0,viewMethod:e.name,rankingModifier:i.rankingModifier})
},t.prototype.buildCustomEvent=function(e,t,i){return this.merge(this.buildAnalyticsEvent(e,t),{eventType:e.type,eventValue:e.name,originLevel2:this.resolveActiveTabFromElement(i)||"default",responseTime:0})},t.prototype.buildMetaObject=function(t){var i=e._.extend({},t);return i.JSUIVersion=e.version.lib+";"+e.version.product,i},t.prototype.cancelAnyPendingSearchAsYouTypeEvent=function(){this.pendingSearchAsYouTypeSearchEvent&&(this.pendingSearchAsYouTypeSearchEvent.cancel(),this.pendingSearchAsYouTypeSearchEvent=void 0)},t.prototype.resolveActiveTabFromElement=function(t){e.Assert.exists(t);var i=this.resolveQueryStateModel(t);return i&&i.get(e.QueryStateModel.attributesEnum.t)},t.prototype.resolveQueryStateModel=function(t){return e.Component.resolveBinding(t,e.QueryStateModel)},t.prototype.eventIsNotRelatedToSearchbox=function(t){return t!==e.AnalyticsActionCauseList.searchboxSubmit.name&&t!==e.AnalyticsActionCauseList.searchboxClear.name},t.prototype.triggerChangeAnalyticsCustomData=function(t,i,n){var o={language:n.language,originLevel1:n.originLevel1,originLevel2:n.originLevel2,originLevel3:n.originLevel3};i.metaDataAsString={},i.metaDataAsNumber={};var s=e.$.extend({},{type:t,metaObject:i},o);e.$(this.rootElement).trigger(e.AnalyticsEvents.changeAnalyticsCustomData,s),n.language=s.language,n.originLevel1=s.originLevel1,n.originLevel2=s.originLevel2,n.originLevel3=s.originLevel3,n.customData=i;var r=n.customData.metaDataAsString;e._.keys(r).length>0&&(this.logger.warn("Using deprecated 'metaDataAsString' key to log custom analytics data. Custom meta should now be put at the root of the object."),e._.extend(n.customData,r)),delete n.customData.metaDataAsString;var a=n.customData.metaDataAsNumber;e._.keys(a).length>0&&(this.logger.warn("Using deprecated 'metaDataAsNumber' key to log custom analytics data. Custom meta should now be put at the root of the object."),e._.extend(n.customData,a)),delete n.customData.metaDataAsNumber},t.prototype.merge=function(t,i){return e.$.extend({},t,i)},t}();e.LiveAnalyticsClient=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e){void 0===e&&(e=[]),this.analyticsClients=e,this.isContextual=!1}return t.prototype.isActivated=function(){return e._.some(this.analyticsClients,function(e){return e.isActivated()})},t.prototype.getCurrentEventCause=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventCause()}),function(e){return null!=e})},t.prototype.getCurrentEventMeta=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventMeta()}),function(e){return null!=e})},t.prototype.logSearchEvent=function(t,i){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,i)})},t.prototype.logSearchAsYouType=function(t,i){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,i)})},t.prototype.logClickEvent=function(t,i,n,o){e._.each(this.analyticsClients,function(e){return e.logClickEvent(t,i,n,o)})},t.prototype.logCustomEvent=function(t,i,n){e._.each(this.analyticsClients,function(e){return e.logCustomEvent(t,i,n)})},t.prototype.getTopQueries=function(t){var i=this,n=e.$.Deferred(),o=[];return e._.forEach(this.analyticsClients,function(e){e.getTopQueries(t).done(function(e){o[r]=e;for(var s=!0,r=0;r<i.analyticsClients.length&&s;r++)s=s&&void 0!=o[r];s&&n.resolve(i.mergeTopQueries(o,t.pageSize))})}),n},t.prototype.getCurrentVisitId=function(){return e._.first(this.analyticsClients).getCurrentVisitId()},t.prototype.sendAllPendingEvents=function(){e._.each(this.analyticsClients,function(e){return e.sendAllPendingEvents()})},t.prototype.warnAboutSearchEvent=function(){e._.each(this.analyticsClients,function(e){return e.warnAboutSearchEvent()})},t.prototype.mergeTopQueries=function(t,i){var n=[];return e._.each(t,function(t){return e._.each(t,function(e){return n.push(e)})}),n.length=Math.min(n.length,i),n},t}();e.MultiAnalyticsClient=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(e){var t=i(e);return t?t.client:void 0}function i(t){var i=e.$(t).find("."+e.Component.computeCssClassNameForType(e.Analytics.ID));return 0!=i.length?i.coveo():void 0}e.CoveoJQuery.registerNamedMethod("logCustomEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1];o.logCustomEvent(s,r,e)}}),e.CoveoJQuery.registerNamedMethod("logSearchEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1];o.logSearchEvent(s,r)}}),e.CoveoJQuery.registerNamedMethod("logSearchAsYouTypeEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1];o.logSearchAsYouType(s,r)}}),e.CoveoJQuery.registerNamedMethod("logClickEvent",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t(e);if(o){var s=i[0],r=i[1],a=i[2];o.logClickEvent(s,r,a,e)}}),e.CoveoJQuery.registerNamedMethod("logCustomEventVersion",function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var s=t(i);if(s){var r=s;e.AnalyticsEndpoint.CUSTOM_ANALYTICS_VERSION=n[0],r.endpoint.sendCustomEvent(n[1]),e.AnalyticsEndpoint.CUSTOM_ANALYTICS_VERSION=void 0}})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){if(void 0===o&&(o={}),t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null==this.options.token){var r=e.SearchEndpoint.endpoints["default"];r&&(this.options.token=r.options.accessToken)}this.initializeAnalyticsClient(),e.Assert.exists(this.client),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.queryError,this.handleQueryError)}return __extends(i,t),i.create=function(t,n){var o=e.Component.computeSelectorForType(i.ID),s=e.$(t),r=s.find(o).add(s.closest(o));return 1==r.length?i.getClient(r.get(0),n):r.length>1?new e.MultiAnalyticsClient(e._.map(r,function(e){return i.getClient(e,n)})):new e.NoopAnalyticsClient},i.getClient=function(t,n){var o=e.Component.get(t,i,!0);return o instanceof i?o.client:new i(t,n).client},i.prototype.initializeAnalyticsEndpoint=function(){return new e.AnalyticsEndpoint({token:this.options.token,serviceUrl:this.options.endpoint})},i.prototype.initializeAnalyticsClient=function(){if(e.Utils.isNonEmptyString(this.options.endpoint)){var t=this.initializeAnalyticsEndpoint();this.client=new e.LiveAnalyticsClient(t,this.root||this.element,this.options.user,this.options.userDisplayName,this.options.anonymous,this.options.splitTestRunName,this.options.splitTestRunVersion,this.options.searchHub,this.options.sendToCloud)}else this.client=new e.NoopAnalyticsClient},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),i.queryBuilder.searchHub=this.options.searchHub},i.prototype.handleQueryError=function(t,i){e.Assert.exists(i),this.client.logCustomEvent(e.AnalyticsActionCauseList.queryError,{query:i.query.q,aq:i.query.aq,cq:i.query.cq,dq:i.query.dq,errorType:i.error.type,errorMessage:i.error.message},e.$(t.target)[0])},i.ID="Analytics",i.options={user:e.ComponentOptions.buildStringOption(),userDisplayName:e.ComponentOptions.buildStringOption(),token:e.ComponentOptions.buildStringOption(),endpoint:e.ComponentOptions.buildStringOption({defaultValue:e.AnalyticsEndpoint.DEFAULT_ANALYTICS_URI}),anonymous:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchHub:e.ComponentOptions.buildStringOption({defaultValue:"default"}),splitTestRunName:e.ComponentOptions.buildStringOption(),splitTestRunVersion:e.ComponentOptions.buildStringOption(),sendToCloud:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.Analytics=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){void 0===o&&(o={}),t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.bind.onRoot(e.QueryEvents.buildingCallOptions,this.handleBuildingCallOptions),this.bind.onRoot(e.QueryEvents.queryError,this.handleQueryError)}return __extends(i,t),i.prototype.getCssClass=function(){return"coveo-authentication-provider"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("Reauthenticate",this.options.caption),onOpen:function(){return t.authenticateWithProvider()},onClose:function(){return 0}}]},i.prototype.handleBuildingCallOptions=function(e,t){t.options.authentication.push(this.options.name)},i.prototype.handleQueryError=function(e,t){t.error.provider==this.options.name&&this.authenticateWithProvider()},i.prototype.authenticateWithProvider=function(){this.options.useIFrame?this.useIFrameToAuthenticate():this.redirectToAuthenticationProvider()},i.prototype.redirectToAuthenticationProvider=function(){this.logger.info("Redirecting to authentication provider "+this.options.name),window.location.href=this.getAuthenticationProviderUriForRedirect()},i.prototype.useIFrameToAuthenticate=function(){var t=this;this.logger.info("Using iframe to retrieve authentication for provider "+this.options.name);var i,n=e.$("<iframe/>").attr("src",this.getAuthenticationProviderUriForIFrame());i=this.options.showIFrame?this.createPopupForVisibleIFrame(n):this.createPopupForWaitMessage(n),e.$(window).one("message",function(){i.close(),n.detach(),t.logger.info("Got authentication for provider "+t.options.name+"; retrying query."),t.queryController.executeQuery()})},i.prototype.createPopupForWaitMessage=function(t){var i=e.$("<div/>").addClass("coveo-waiting-for-authentication-popup").append(e.JQueryUtils.getBasicLoadingDots());return t.hide().appendTo(document.body),e.ModalBox.open(i,{title:e.l("Authenticating",this.options.caption)})},i.prototype.createPopupForVisibleIFrame=function(t){var i=e.$("<div/>");return t.addClass("coveo-authentication-iframe").appendTo(i),e.ModalBox.open(i,{className:"coveo-authentication-popup"})},i.prototype.getAuthenticationProviderUriForRedirect=function(){return this.queryController.getEndpoint().getAuthenticationProviderUri(this.options.name,window.location.href,void 0)},i.prototype.getAuthenticationProviderUriForIFrame=function(){return this.queryController.getEndpoint().getAuthenticationProviderUri(this.options.name,void 0,"success")},i.ID="AuthenticationProvider",i.options={name:e.ComponentOptions.buildStringOption(),caption:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.name}}),useIFrame:e.ComponentOptions.buildBooleanOption({defaultValue:!1,attrName:"data-use-iframe"}),showIFrame:e.ComponentOptions.buildBooleanOption({defaultValue:!0,attrName:"data-show-iframe"})},i}(e.Component);e.AuthenticationProvider=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.populateBreadcrumb="populateBreadcrumb",e.clearBreadcrumb="clearBreadcrumb",e.redrawBreadcrumb="redrawBreadcrumb",e}();e.BreadcrumbEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).one(e.InitializationEvents.afterInitialization,function(){return r.handleAfterInitialization()}),e.$(this.root).on(e.BreadcrumbEvents.redrawBreadcrumb,function(){return r.redrawBreadcrumb()}),e.$(this.element).hide()}return __extends(i,t),i.prototype.drawBreadcrumb=function(t){var i=this;e.$(this.element).children().detach();var n=e.$("<div />").addClass("coveo-breadcrumb-clear-all");e.$(this.element).fastToggle(0!=t.length),e.$(this.element).append(n);for(var o=0;o<t.length;o++)e.$(t[o].element).addClass("coveo-breadcrumb-item").appendTo(this.element);n.attr("title",e.l("ClearAllFilters")),n.append(e.$("<div />").addClass("coveo-icon coveo-breadcrumb-icon-clear-all")),this.bind.click(n,function(){i.clearBreadcrumbs()})},i.prototype.redrawBreadcrumb=function(){this.lastBreadcrumbs?this.drawBreadcrumb(this.lastBreadcrumbs):this.drawBreadcrumb(this.getBreadcrumbs())},i.prototype.handleDeferredQuerySuccess=function(){this.drawBreadcrumb(this.getBreadcrumbs())},i.prototype.handleAfterInitialization=function(){var t=this;e.$(this.root).on(e.QueryEvents.deferredQuerySuccess,function(){return t.handleDeferredQuerySuccess()})},i.prototype.getBreadcrumbs=function(){var t={breadcrumbs:[]};return e.$(this.root).trigger(e.BreadcrumbEvents.populateBreadcrumb,t),this.logger.debug("Retrieved breadcrumbs",t.breadcrumbs),this.lastBreadcrumbs=t.breadcrumbs,t.breadcrumbs},i.prototype.clearBreadcrumbs=function(){var t=this,i={};e.$(this.root).trigger(e.BreadcrumbEvents.clearBreadcrumb,i),this.logger.debug("Clearing breadcrumbs"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.breadcrumbResetAll,{})}})},i.ID="Breadcrumb",i.options={},i}(e.Component);e.Breadcrumb=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(i,n){void 0===n&&(n=""),this.sort=i,this.direction=n,e.Assert.isNonEmptyString(i),e.Assert.check(e._.contains(t.validSorts,i)||t.sortIsField(i)),t.sortNeedsDirection(i)?e.Assert.check(e._.contains(t.validDirections,n)):e.Assert.check(""==n)}return t.prototype.putInQueryBuilder=function(i){e.Assert.exists(i),t.sortIsField(this.sort)?(i.sortCriteria="field"+this.direction,i.sortField=this.sort):i.sortCriteria=""!=this.direction?this.sort+this.direction:this.sort},t.prototype.getValueFromResult=function(i){return e.Assert.exists(i),t.sortIsField(this.sort)?(e.Assert.stringStartsWith(this.sort,"@"),e.Utils.getFieldValue(i,this.sort)):"date"==this.sort?i.raw.sysdate:(e.Assert.fail("Cannot retrieve value: "+this.sort),void 0)},t.prototype.toString=function(){return e.Utils.isNonEmptyString(this.direction)?this.sort+" "+this.direction:this.sort},t.prototype.equals=function(t){return e.Assert.exists(t),t.sort==this.sort&&t.direction==this.direction},t.parse=function(i){e.Assert.isNonEmptyString(i);var n=i.match(/\S+/g);return new t(n[0],n[1])},t.sortIsField=function(e){return"@"==e.substr(0,1)},t.sortNeedsDirection=function(i){return e._.contains(t.sortsNeedingDirection,i)||t.sortIsField(i)},t.validSorts=["relevancy","date","qre"],t.sortsNeedingDirection=["date"],t.validDirections=["ascending","descending"],t}();e.SortCriteria=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.iconTemplate=e._.template("<span class='coveo-icon <%= icon %>'></span>"),this.tabTemplate=e._.template("<span><%= caption %></span>"),this.isFirstQuery=!0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this));var r=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);e.$(this.root).on(r,e.$.proxy(this.handleQueryStateChanged,this)),this.render(),e.$(this.element).click(e.$.proxy(this.handleClick,this))}return __extends(i,t),i.prototype.select=function(){this.disabled||this.queryStateModel.setMultiple({t:this.options.id,sort:this.options.sort||e.QueryStateModel.defaultAttributes.sort})},i.prototype.handleClick=function(t){var i=this;t.preventDefault(),this.select(),e.DeviceUtils.isMobileDevice()&&e.MobileUtils.removeToggleClassOnSearchInterface(),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.interfaceChange,{interfaceChangeTo:i.options.id})}})},i.prototype.render=function(){var t=this.options.icon;""!=t&&e.$(this.element).prepend(this.iconTemplate({icon:t}));var i=this.options.caption;e.Utils.isNonEmptyString(i)&&e.$(this.element).append(this.tabTemplate({caption:i}))},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),this.isFirstQuery=!1,!this.disabled&&this.isSelected()&&(i.queryBuilder.tab=this.options.id,e.Utils.isNonEmptyString(this.options.expression)&&(this.options.constant?i.queryBuilder.constantExpression.add(this.options.expression):i.queryBuilder.advancedExpression.add(this.options.expression)),this.options.enableDuplicateFiltering&&(i.queryBuilder.enableDuplicateFiltering=!0),null!=this.options.pipeline&&(i.queryBuilder.pipeline=this.options.pipeline))},i.prototype.handleQueryStateChanged=function(t,i){e.Assert.exists(i),!this.disabled&&this.isSelected()?(e.$(this.element).addClass("coveo-selected"),this.queryController.setEndpoint(this.options.endpoint),this.showAndHideAppropriateElements()):e.$(this.element).removeClass("coveo-selected")},i.prototype.isSelected=function(){var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.t);return t==this.options.id},i.prototype.showAndHideAppropriateElements=function(){var t=this,i=[],n=[];e._.each(e.$(this.root).find("[data-tab],[data-tab-not]"),function(e){t.isElementIncludedInTab(e)?(t.toggleAllComponentsUnder(e,!0),i.push(e)):(t.toggleAllComponentsUnder(e,!1),n.push(e))}),e.$(this.root).one(e.QueryEvents.querySuccess,function(){e._.each(i,function(t){return e.$(t).removeClass("coveo-tab-disabled")}),e._.each(n,function(t){return e.$(t).addClass("coveo-tab-disabled")})})},i.prototype.isElementIncludedInTab=function(t){e.Assert.exists(t);var i=this.splitListOfTabs(e.$(t).attr("data-tab")),n=this.splitListOfTabs(e.$(t).attr("data-tab-not"));return e.Assert.check(!(0!=i.length&&0!=n.length),"You cannot both explicity include and exclude an element from tabs"),0!=i.length&&-1!=e._.indexOf(i,this.options.id)||0!=n.length&&-1==e._.indexOf(n,this.options.id)||0==i.length&&0==n.length},i.prototype.splitListOfTabs=function(t){return e.Utils.exists(t)?e._.map(t.split(","),function(t){return e.Utils.trim(t)}):[]},i.prototype.toggleAllComponentsUnder=function(t,i){e.Assert.exists(t),e.$(t).find("*").addBack().each(function(t,n){var o=e.Component.get(n,void 0,!0);o&&(i?o.enable():o.disable())})},i.prototype.enable=function(){t.prototype.enable.call(this),e.$(this.element).css("display","")},i.prototype.disable=function(){t.prototype.disable.call(this),e.$(this.element).css("display","none")},i.ID="Tab",i.options={id:e.ComponentOptions.buildStringOption({required:!0}),caption:e.ComponentOptions.buildLocalizedStringOption({required:!0}),icon:e.ComponentOptions.buildIconOption(),expression:e.ComponentOptions.buildStringOption(),endpoint:e.ComponentOptions.buildCustomOption(function(t){return null!=t?e.SearchEndpoint.endpoints[t]:null}),sort:e.ComponentOptions.buildStringOption(),constant:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableDuplicateFiltering:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),pipeline:e.ComponentOptions.buildStringOption()},i}(e.Component);e.Tab=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o);var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);e.$(this.root).on(a,e.$.proxy(this.handleTabChange,this)),this.options.tabSectionToOpen&&(e.$(this.options.tabSectionToOpen).addClass("coveo-targeted-by-current-tab"),e.$(this.element).addClass("coveo-targeting-tab-section"),this.bind.click(e.$(this.element),function(){e.$(".coveo-glass").toggleClass("coveo-active-glass").toggleClass("coveo-active-glass-for-current-tab"),e.$(r.element).toggleClass("coveo-opening-tab-section"),e.$(r.options.tabSectionToOpen).toggleClass("coveo-opened-by-current-tab"),e.$(r.element).hasClass("coveo-opening-tab-section")?(e.$(r.options.tabSectionToOpen).css("z-index","1001"),e.$(r.element).css("z-index","1001")):(e.$(r.options.tabSectionToOpen).css("z-index",void 0),e.$(r.element).css("z-index",void 0))}))}return __extends(i,t),i.prototype.handleTabChange=function(){var t=this,i=this.queryStateModel.get(e.QueryStateModel.attributesEnum.t);if(e.Utils.isNonEmptyString(i)){var n=!1;e.$(this.root).find(e.Component.computeSelectorForType(e.Tab.ID)).each(function(o,s){var r=e.Component.get(s,e.Tab);r.options.id==i&&(e.$(t.element).html(e.$(r.element).html()),n=!0)}),e.Assert.check(n,"Cannot find the currently active tab")}else e.$(this.element).hide()},i.ID="CurrentTab",i.options={tabSectionToOpen:e.ComponentOptions.buildStringOption()},i}(e.Component);e.CurrentTab=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.hideNext=!0,this.bind.onRoot(e.QueryEvents.buildingQuery,this.handlePrepareQueryBuilder),this.bind.onRoot(e.QueryEvents.querySuccess,this.handleProcessNewQueryResults),this.bind.onRoot(e.QueryEvents.noResults,this.handleNoResults),this.bind.onRoot(e.QueryEvents.newQuery,this.handleNewQuery),e.$(this.element).hide()}return __extends(i,t),i.prototype.handleNewQuery=function(){this.hideNext?(e.$(this.element).empty(),e.$(this.element).hide()):this.hideNext=!0},i.prototype.handlePrepareQueryBuilder=function(t,i){e.Assert.exists(i),i.queryBuilder.enableDidYouMean=!0},i.prototype.handleNoResults=function(t,i){if(e.Utils.isNonEmptyArray(i.results.queryCorrections)&&!i.searchAsYouType&&this.options.enableAutoCorrection){var n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.q),o=this.buildCorrectedSentence(i.results.queryCorrections[0]);this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,i.results.queryCorrections[0].correctedQuery),i.retryTheQuery=!0,this.hideNext=!1,e.$('<div class="coveo-did-you-mean-no-results-for"/>').html(e.l("noResultFor","<span class='coveo-highlight coveo-did-you-mean-highlight'>"+e.StringUtils.htmlEncode(n)+"</span>")).appendTo(this.element),e.$('<div class="coveo-did-you-mean-automatic-correct" />').html(e.l("autoCorrectedQueryTo","<span class='coveo-highlight'>"+o+"</span>")).appendTo(this.element),e.$(this.element).show(),this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.didyoumeanAutomatic,{})}},i.prototype.handleProcessNewQueryResults=function(t,i){var n=this;e.Assert.exists(i),e.Assert.exists(i.results);var o=i.results;if(this.logger.trace("Received query results from new query",o),e.Utils.isNonEmptyArray(o.queryCorrections)){var s=this.buildCorrectedSentence(o.queryCorrections[0]),r=e.$('<div class="coveo-did-you-mean-suggestion"/>').text(e.l("didYouMean","")).appendTo(this.element),a=e.$("<a/>").html(s).appendTo(r);e.$(a).click(function(){n.doQueryWithCorrectedTerm(o.queryCorrections[0].correctedQuery)}),e.$(this.element).show()}},i.prototype.buildCorrectedSentence=function(t){var i=[],n='<span class="coveo-did-you-mean-word-correction">',o="</span>",s=0;return e._.each(t.wordCorrections,function(r){i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s,r.offset))),s=r.offset,i.push(n),i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s,r.length+s))),i.push(o),s=r.offset+r.length}),i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s))),i.join("")},i.prototype.doQueryWithCorrectedTerm=function(t){var i=this;this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.didyoumeanClick,{})}})},i.ID="DidYouMean",i.options={enableAutoCorrection:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.DidYouMean=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).append(e.$("<div />").addClass("coveo-error-report-title").append("<h3></h3><h4></h4>"));var r=e.$("<div />").addClass("coveo-error-report-options").append(this.buildPrevious()).append(this.buildClear()).append(this.buildRetry());e.$(this.element).append(r).append(this.message=e.$("<div class='coveo-error-report-message'></div>")).hide(),e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this.handleNewQuery,this)),e.$(this.root).on(e.QueryEvents.queryError,e.$.proxy(this.handleQueryError,this))}return __extends(i,t),i.prototype.setErrorTitle=function(){var t={h3:e.l("OopsError"),h4:e.l("ProblemPersists")};e.DeviceUtils.isPhonegap()&&navigator.connection&&window.Connection&&(navigator.connection.type==window.Connection.NONE||0===navigator.connection.type)&&(t={h3:e.l("CannotConnect"),h4:e.l("NoNetworkConnection")}),e.$(this.element).find("h3").text(t.h3),e.$(this.element).find("h4").text(t.h4)},i.prototype.buildPrevious=function(){var t=this;return e.$("<span class='coveo-error-report-previous' > "+e.l("GoBack")+" </span>").click(function(){t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.errorBack,{},t.root),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.errorBack,{}),history.back()})},i.prototype.buildClear=function(){var t=this;return e.$("<span class='coveo-error-report-clear'>"+e.l("Reset")+"</span>").click(function(){t.queryStateModel.reset(),t.queryController.deferExecuteQuery({beforeExecuteQuery:function(){t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.errorClearQuery,{}),t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.errorClearQuery,{},t.root)}})})},i.prototype.buildRetry=function(){var t=this;return e.$("<span class='coveo-error-report-retry'>"+e.l("Retry")+"</span>").click(function(){t.queryController.deferExecuteQuery({beforeExecuteQuery:function(){t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.errorRetry,{}),t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.errorRetry,{},t.root)}})})},i.prototype.handleNewQuery=function(){e.$(this.element).hide(),null!=this.closePopup&&this.closePopup()},i.prototype.handleQueryError=function(t,i){var n=this;if(e.Assert.exists(i),e.Assert.exists(i.error),!i.error.isMissingAuthentication&&(this.message.empty(),this.setErrorTitle(),this.options.showDetailedError&&this.message.append(e.$("<span class='coveo-error-report-more-info'>"+e.l("MoreInfo")+"</span>").click(function(t){e.$(t.target).empty(),e.$(t.target).parent().append(n.buildErrorInfo(i.error))})),e.$(this.element).show(),this.options.enablePopup)){var o=e.ModalBox.open(e.$(this.element).clone(!0,!0),{title:e.JQueryUtils.getPopUpCloseButton(e.l("Close"),e.l("ErrorReport")),titleClose:!0,overlayClose:!0,className:"coveo-error-report"});this.closePopup=o.close}},i.prototype.buildErrorInfo=function(t){{var i=e.$("<div class='coveo-error-info'></div>");e.$("<textarea>"+JSON.stringify(t,null,2)+"</textarea>").appendTo(i),e.$("<div class='coveo-error-info-label'>"+e.l("CopyPasteToSupport")+"</div>").appendTo(i)}return i.get(0)},i.ID="ErrorReport",i.options={enablePopup:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),showDetailedError:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ErrorReport=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),e.Assert.exists(this.result),this.element.innerHTML=e.HighlightUtils.highlightString(this.result.excerpt,this.result.excerptHighlights,null,"coveo-highlight")}return __extends(i,t),i.ID="Excerpt",i}(e.Component);e.Excerpt=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){this.selected=!1,this.excluded=!1,this.waitingForDelta=!1}return t.prototype.reset=function(){this.selected=!1,this.excluded=!1},t.prototype.updateCountsFromNewValue=function(t){e.Assert.exists(t),this.occurrences=t.occurrences,this.delta=t.delta,this.computedField=t.computedField},t.prototype.cloneWithZeroOccurrences=function(){return this.occurrences=0,this.computedField=0,this.delta=void 0,this},t.prototype.cloneWithDelta=function(t,i){e.Assert.isLargerOrEqualsThan(0,t);var n=this.cloneWithZeroOccurrences();return n.delta=i,n.occurrences=t,n},t.prototype.getFormattedCount=function(){var t=void 0;return e.Utils.exists(this.delta)&&this.delta>0?t="+"+Globalize.format(this.delta,"n0"):this.occurrences>0&&(t=Globalize.format(this.occurrences,"n0")),t},t.prototype.getFormattedComputedField=function(e){return 0!=this.computedField?Globalize.format(this.computedField,e):void 0},t.create=function(i){if(e._.isString(i))return t.createFromValue(i);if(e._.isObject(i))return"computedFieldResults"in i?t.createFromGroupByValue(i):t.createFromFieldValue(i);throw new Error("Can't create value from "+i)},t.createFromValue=function(i){e.Assert.isNonEmptyString(i);var n=new t;return n.value=i,n.lookupValue=i,n},t.createFromGroupByValue=function(i){e.Assert.exists(i),e.Assert.exists(i);var n=new t;return n.value=i.value,n.lookupValue=e.Utils.exists(i.lookupValue)?i.lookupValue:i.value,n.occurrences=i.numberOfResults,n.computedField=e.Utils.isNonEmptyArray(i.computedFieldResults)?i.computedFieldResults[0]:void 0,n.score=i.score,n},t.createFromFieldValue=function(i){e.Assert.exists(i);var n=new t;return n.value=i.value,n.lookupValue=i.lookupValue,n.occurrences=i.numberOfResults,n},t}();e.FacetValue=t;var i=function(){function i(i){this.values=e.Utils.exists(i)?e._.map(i.values,function(e){return t.createFromGroupByValue(e)}):[]}return i.prototype.add=function(t){e.Assert.exists(t),e.Assert.check(!this.contains(t.value)),this.values.push(t)},i.prototype.remove=function(t){e.Assert.isNonEmptyString(t),t=t,this.values=e._.filter(this.values,function(e){return e.value!=t})},i.prototype.size=function(){return this.values.length},i.prototype.isEmpty=function(){return 0==this.values.length},i.prototype.at=function(t){return e.Assert.isLargerOrEqualsThan(0,t),e.Assert.isSmallerThan(this.values.length,t),this.values[t]},i.prototype.get=function(t){return e._.find(this.values,function(e){return e.value.toLowerCase()==t.toLowerCase()})},i.prototype.contains=function(t){return e.Utils.exists(this.get(t))},i.prototype.getAll=function(){return this.values},i.prototype.getSelected=function(){return e._.filter(this.values,function(e){return e.selected})},i.prototype.getExcluded=function(){return e._.filter(this.values,function(e){return e.excluded})},i.prototype.hasSelectedOrExcludedValues=function(){return 0!=this.getSelected().length||0!=this.getExcluded().length},i.prototype.reset=function(){e._.each(this.values,function(e){return e.reset()})},i.prototype.importActiveValuesFromOtherList=function(t){var i=this;e.Assert.exists(t),e._.each(t.getSelected(),function(t){var n=i.get(t.value);e.Utils.exists(n)?n.selected=!0:i.values.push(t.cloneWithZeroOccurrences())}),e._.each(t.getExcluded(),function(t){var n=i.get(t.value);e.Utils.exists(n)?n.excluded=!0:i.values.push(t.cloneWithZeroOccurrences())})},i.prototype.updateCountsFromNewValues=function(t){e.Assert.exists(t),this.values=e._.map(this.values,function(i){var n=t.get(i.value);return e.Utils.exists(n)?(i.updateCountsFromNewValue(n),i):i.cloneWithZeroOccurrences()})},i.prototype.updateDeltaWithFilteredFacetValues=function(t){e.Assert.exists(t),e._.each(this.values,function(i){var n=t.get(i.value);i.waitingForDelta=!1,e.Utils.exists(n)?i.delta=i.occurrences-n.occurrences>0?i.occurrences-n.occurrences:null:i.selected||i.excluded||(i.delta=i.occurrences)})},i.prototype.mergeWithUnfilteredFacetValues=function(t){var i=this;e.Assert.exists(t);var n=[];e._.each(t.values,function(t){var o=i.get(t.value);e.Utils.exists(o)?o.occurrences==t.occurrences?n.push(o):n.push(t.cloneWithDelta(t.occurrences,t.occurrences-o.occurrences)):n.push(t.cloneWithDelta(t.occurrences,t.occurrences))});var o=0;e._.each(this.values,function(i){var s=t.get(i.value);
if(e.Utils.exists(s)){for(var r=0;r<n.length;r++)if(n[r].value==i.value){o=r+1;break}}else(i.selected||i.excluded)&&(n.splice(o,0,i),o++)}),this.values=n},i.prototype.sortValuesDependingOnStatus=function(t){if(this.values=e._.sortBy(this.values,function(e){return e.selected?1:e.excluded?3:2}),null!=t&&t<this.values.length){var i=this.getExcluded().length,n=this.values.splice(this.values.length-i,i);Array.prototype.splice.apply(this.values,[t-i,0].concat(n))}},i}();e.FacetValues=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(t){var i=t.raw.objecttype,s=t.raw.sysfiletype;return e.Utils.isNonEmptyString(i)&&"file"!=i.toLowerCase()?n(i):e.Utils.isNonEmptyString(s)?o(s):{icon:"coveo-icon sysfiletype",caption:e.l("Unknown")}}function n(t){t=t.toLowerCase();var i=e.l["objecttype_"+t];return{icon:"coveo-icon objecttype "+t,caption:i?i():t}}function o(t){t=t.toLowerCase(),"."==t[0]&&(t=t.substring(1));var i=e.l["sysfiletype_"+t];return{icon:"coveo-icon sysfiletype "+t,caption:i?i():t}}function s(){if(void 0==r){r={};var t=String.locales[String.locale];e.Assert.isNotUndefined(t),e._.each(e._.keys(t),function(e){0==e.indexOf("sysfiletype_")?r[e.substr("sysfiletype_".length)]=e.toLocaleString():0==e.indexOf("objecttype_")&&(r[e.substr("objecttype_".length)]=e.toLocaleString())})}return r}var r;t.get=i,t.getObjectType=n,t.getSysFileType=o,t.getSysFileTypeCaptions=s}(t=e.FileTypes||(e.FileTypes={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(t,i){return new RegExp(e.StringUtils.stringToRegex(t,i),"i")}function n(t,i){var n=[t],o=this.getRegexToUseForFacetSearch(t,i.options.facetSearchIgnoreAccents);return i.options.valueCaption?e._.chain(i.options.valueCaption).pairs().filter(function(e){return o.test(e[1])}).each(function(e){n.push(e[0])}):"@objecttype"==i.options.field||"@sysfiletype"==i.options.field?e._.each(e._.filter(e._.pairs(e.FileTypes.getSysFileTypeCaptions()),function(e){return o.test(e[1])}),function(e){n.push(e[0])}):"@sysmonth"==i.options.field&&e._.each(e._.range(1,13),function(t){o.test(e.DateUtils.monthToString(t-1))&&n.push(("0"+t.toString()).substr(-2))}),n}function o(t){return t=e._.map(t,function(t){return e.Utils.escapeRegexCharacter(t)}),t[0]=".*"+t[0]+".*",t.join("|")}function s(e,t,i,n){return t>e&&n>e&&t!=i}function r(t,i){if(0!=t.values.getSelected().length){var n=i.find("li").not(".coveo-selected");e._.each(n,function(t){e.$(t).addClass("coveo-no-state")})}}function a(t,i){var n;if("@sysfiletype"==t.toLowerCase())n=e.FileTypes.getSysFileTypeCaptions()[i.toLowerCase()];else if("@sysmonth"==t.toLowerCase())try{var o=parseInt(i);n=e.DateUtils.monthToString(o-1)}catch(s){}return void 0!=n&&e.Utils.isNonEmptyString(n)?n:i}function l(t,i){if(!t.isInstanceOf("HierarchicalFacet")||i){t.logger.trace("Clipping captions");for(var n=e.$(t.element).show(),o=n.find(".coveo-facet-value-caption"),s=0;s<o.length;s++)""!=o[s].style.width&&(o[s].style.width="");for(var r=n.find(".coveo-facet-value-label-wrapper"),a=[],s=0;s<r.length;s++){var l=r.get(s),u=e.$(l),c=u.find(".coveo-facet-value-caption"),p=c.get(0),d=l.scrollWidth,h=l.clientWidth,f=p.scrollWidth,m=Math.max(0,d-h);m&&a.push({element:c,width:f,crop:m,label:u})}n.css("display","");for(var s=0;s<a.length;s++){var v=a[s],g=v.element.get(0);g.style.width=v.width-v.crop+"px";{v.element[0]}v.crop>0?v.label.attr("title",v.element.text()):v.label.attr("title",null)}}}t.getRegexToUseForFacetSearch=i,t.getValuesToUseForSearchInFacet=n,t.buildFacetSearchPattern=o,t.needAnotherFacetSearch=s,t.addNoStateCssClassToFacetValues=r,t.tryToGetTranslatedCaption=a,t.clipCaptionsToAvoidOverflowingTheirContainer=l}(t=e.FacetUtils||(e.FacetUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e){this.facet=e}return t.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0,this.expressionToUseForFacetSearch=void 0,this.constantExpressionToUseForFacetSearch=void 0},t.prototype.computeOurFilterExpression=function(){var t=this;e.Assert.check(this.facet.values.hasSelectedOrExcludedValues());var i=new e.ExpressionBuilder,n=this.facet.values.getSelected();n.length>0&&(this.facet.options.useAnd?e._.each(n,function(e){i.addFieldExpression(t.facet.options.field,"==",[e.value])}):i.addFieldExpression(this.facet.options.field,"==",e._.map(n,function(e){return e.value})));var o=this.facet.values.getExcluded();return o.length>0&&i.addFieldNotEqualExpression(this.facet.options.field,e._.map(o,function(e){return e.value})),i.build()},t.prototype.putGroupByIntoQueryBuilder=function(t){e.Assert.exists(t);var i=this.createGroupByAllowedValues(),n=this.createBasicGroupByRequest(i),o=this.createGroupByQueryOverride(t);if(e.Utils.isNullOrUndefined(o)){var s=t.computeCompleteExpressionParts();this.expressionToUseForFacetSearch=s.withoutConstant,null==this.expressionToUseForFacetSearch&&(this.expressionToUseForFacetSearch="@sysuri"),this.constantExpressionToUseForFacetSearch=s.constant}else n.queryOverride=o.withoutConstant,n.constantQueryOverride=o.constant,this.expressionToUseForFacetSearch=o.withoutConstant,this.constantExpressionToUseForFacetSearch=o.constant;this.lastGroupByRequestIndex=t.groupByRequests.length,this.lastGroupByRequest=n,t.groupByRequests.push(n)},t.prototype.searchInFacet=function(e,t,i){void 0===i&&(i=!0);var n=this.buildListFieldValuesRequest(e,t,i);return this.createListFieldDeferer(n)},t.prototype.searchInFacetWithLookupField=function(t,i,n){void 0===n&&(n=!0);var o=this.buildGroupByQuery(),s=o.groupBy[0];s.maximumNumberOfValues=t,s.allowedValues=e._.map(i,function(e){return"*"+e+"*"});var r=this.buildSearchQueryForFacetWithLookupField(i);return null==o.aq?o.aq=r:o.aq+=" "+r,this.createSearchDeferer(o)},t.prototype.recursiveFacetSearch=function(t,i,n,o){var s=this;void 0===o&&(o=e.$.Deferred());var r,a=e.FacetUtils.getValuesToUseForSearchInFacet(t,this.facet),l=function(r){var a=r.length;r=s.checkForFacetSearchValuesToRemove(r,t),e.FacetUtils.needAnotherFacetSearch(r.length,a,n,5)?s.recursiveFacetSearch(t,i+i,a,o):o.resolve(r)};return null==this.facet.options.lookupField&&null==this.facet.options.computedField?(r=this.facet.facetQueryController.searchInFacet(i,a,this.facet.options.facetSearchIgnoreAccents),r.done(l)):(r=this.facet.facetQueryController.searchInFacetWithLookupField(i,a,this.facet.options.facetSearchIgnoreAccents),r.done(function(e){var t=e.groupByResults.length>0?e.groupByResults[0].values:[];l(t)})),r.fail(function(e,t){o.reject(e,t)}),o.fail(function(){r.reject()}),o},t.prototype.fetchMore=function(){var t=this.facet.options.allowedValues||e._.pluck(this.facet.values.getAll(),"value"),i=this.buildGroupByQuery(t);return this.createSearchDeferer(i)},t.prototype.searchInFacetToUpdateDelta=function(t){var i=this.buildGroupByQuery();return i.aq=this.computeOurFilterExpression(),e._.each(t,function(e){e.waitingForDelta=!0}),i.groupBy=[this.createBasicGroupByRequest(e._.map(t,function(e){return e.value}))],i.groupBy[0].completeFacetWithStandardValues=!1,this.createSearchDeferer(i)},t.prototype.createSearchDeferer=function(e){return this.facet.getEndpoint().search(e)},t.prototype.createListFieldDeferer=function(e){return this.facet.queryController.getEndpoint().listFieldValues(e)},t.prototype.buildSearchQueryForFacetWithLookupField=function(t){var i=this.facet.options.lookupField?this.facet.options.lookupField:this.facet.options.field;return"("+t.map(function(t){return e.QueryUtils.buildFieldExpression(i,"*=",["*"+t+"*"])}).join(" OR ")+")"},t.prototype.buildListFieldValuesRequest=function(e,i,n,o){void 0===n&&(n=!0);var s={field:this.facet.options.field,ignoreAccents:n,sortCriteria:"occurrences",maximumNumberOfValues:e,queryOverride:o||this.expressionToUseForFacetSearch,constantQueryOverride:this.constantExpressionToUseForFacetSearch};return null!=i&&(s.pattern=t.makeFacetSearchPattern(i),s.patternType="RegularExpression"),s},t.prototype.buildGroupByQuery=function(e){var t=[this.createBasicGroupByRequest(e)];return{q:this.expressionToUseForFacetSearch,cq:this.constantExpressionToUseForFacetSearch,enableDidYouMean:!1,firstResult:0,numberOfResults:0,groupBy:t}},t.prototype.createGroupByAllowedValues=function(){var t;if(void 0!=this.facet.options.allowedValues)return this.facet.options.allowedValues;if(void 0!=this.facet.options.customSort)return this.facet.options.customSort;if(this.facet.options.useAnd||!this.facet.keepDisplayedValuesNextTime){var i=this.facet.values.getSelected();if(0==i.length)return void 0;t=this.facet.values.getSelected()}else t=this.facet.values.getAll();return e._.map(t,function(e){return e.value})},t.prototype.createGroupByQueryOverride=function(t){var i=this.facet.options.additionalFilter?this.facet.options.additionalFilter:void 0;if(!this.facet.values.hasSelectedOrExcludedValues()||this.facet.options.useAnd)return i?{constant:i,withoutConstant:"@sysuri"}:void 0;var n=e._.defaults(t.computeCompleteExpressionPartsExcept(this.computeOurFilterExpression()),{withoutConstant:"@sysuri"});return void 0==n.constant?n.constant=i:n.constant+=i?" "+i:"",n},t.prototype.createBasicGroupByRequest=function(t,i){void 0===i&&(i=!0);var n=this.facet.numberOfValues;if(null!=this.facet.options.customSort){var o=e._.union(e._.map(this.facet.values.getSelected(),function(e){return e.value}),e._.map(this.facet.values.getExcluded(),function(e){return e.value}),this.facet.options.customSort);n=Math.max(n,o.length)}var s={field:this.facet.options.field,maximumNumberOfValues:n+(this.facet.options.enableMoreLess?1:0),sortCriteria:this.facet.options.sortCriteria,injectionDepth:this.facet.options.injectionDepth,completeFacetWithStandardValues:void 0==this.facet.options.allowedValues?!0:!1};return this.facet.options.lookupField&&(s.lookupField=this.facet.options.lookupField),null!=t&&(s.allowedValues=t),i&&e.Utils.isNonEmptyString(this.facet.options.computedField)&&(s.computedFields=[{field:this.facet.options.computedField,operation:this.facet.options.computedFieldOperation}]),s},t.prototype.checkForFacetSearchValuesToRemove=function(t,i){var n=this,o=e.FacetUtils.getRegexToUseForFacetSearch(i,this.facet.options.facetSearchIgnoreAccents);return e._.filter(t,function(t){var i=e._.isEmpty(n.facet.options.allowedValues)||e._.contains(n.facet.options.allowedValues,t.value),s=n.facet.getValueCaption(t);return i&&o.test(s)})},t.makeFacetSearchPattern=function(t){return t=e._.map(t,function(t){return e.Utils.escapeRegexCharacter(t)}),t[0]=".*"+t[0]+".*",t.join("|")},t}();e.FacetQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){!function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACEBAR=32]="SPACEBAR",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE"}(e.KEYBOARD||(e.KEYBOARD={}));var t=(e.KEYBOARD,function(){function t(){}return t.keysEqual=function(t,i){return e.Utils.isNullOrUndefined(t.keyCode)?e.Utils.isNullOrUndefined(t.which)?!1:t.which==i:t.keyCode==i},t.isAllowedKeyForOmnibox=function(e){var i=e.keyCode,n=t.isNumberKeyPushed(i)||32==i||13==i||t.isLetterKeyPushed(i)||i>95&&112>i||i>185&&193>i||i>218&&223>i||8==i||46==i||t.isArrowKeyPushed(i);return n},t.isAllowedKeyForSearchAsYouType=function(e){return t.isAllowedKeyForOmnibox(e)&&!t.isArrowKeyPushed(e.keyCode)},t.isDeleteOrBackspace=function(e){return t.keysEqual(e,8)||t.keysEqual(e,46)},t.isArrowKeyPushed=function(e){return 37==e||38==e||39==e||40==e},t.isNumberKeyPushed=function(e){return e>47&&58>e},t.isLetterKeyPushed=function(e){return e>64&&91>e},t}());e.KeyboardUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){var n=this;this.facet=t,this.facetSearchValuesListKlass=i,this.showingFacetSearchWaitAnimation=!1,this.searchTemplate=e._.template("<div class='coveo-facet-search'></div>"),this.magnifierTemplate=e._.template("<div class='coveo-facet-search-magnifier'></div>"),this.waitTemplate=e._.template("<div class='coveo-facet-search-wait-animation'></div>"),this.clearIconTemplate=e._.template("<span class='coveo-icon'></span>"),this.clearTemplate=e._.template("<div title='"+e.l("Clear",e.l("Search"))+"' class='coveo-facet-search-clear'></div>"),this.middleTemplate=e._.template("<div class='coveo-facet-search-middle'></div>"),this.inputTemplate=e._.template("<input type='text' autocapitalize='off' autocorrect='off' placeholder='<%- placeholder %>' class='coveo-facet-search-input'/>"),this.searchResultsTemplate=e._.template('<ul class="coveo-facet-search-results"/>'),this.searchResults=e.$(this.searchResultsTemplate()),e.$(window).resize(function(){e.DeviceUtils.isMobileDevice()||n.positionSearchResults()})}return t.prototype.build=function(){return e.DeviceUtils.isMobileDevice()?this.buildSearchMobile():this.buildBaseSearch()},t.prototype.positionSearchResults=function(){if(null!=this.searchResults&&this.searchResults.is(":visible"))if(e.DeviceUtils.isMobileDevice())this.searchResults.insertAfter(this.search);else{var t=this.searchResults.outerWidth()-this.searchResults.innerWidth();this.searchResults.outerWidth(this.search.outerWidth()-t),this.searchResults.show(),e.JQueryUtils.positionPopup(this.searchResults,this.search,e.$(this.facet.element),e.$(this.facet.root),{vertical:2,horizontal:1})}},t.prototype.completelyDismissSearch=function(){this.cancelAnyPendingSearchOperation(),this.facet.unfadeInactiveValuesInMainList(),this.search.removeClass("coveo-facet-search-no-results"),this.hideSearchResultsElement(),this.input.val(""),this.clear.hide()},t.prototype.buildBaseSearch=function(){var t=this;return this.search=e.$(this.searchTemplate()),this.magnifier=e.$(this.magnifierTemplate()).appendTo(this.search),this.wait=e.$(this.waitTemplate()).hide().appendTo(this.search),this.clearIcon=e.$(this.clearIconTemplate()),this.clear=e.$(this.clearTemplate()).appendTo(this.search).hide().append(this.clearIcon),this.middle=e.$(this.middleTemplate()).appendTo(this.search),this.input=e.$(this.inputTemplate({placeholder:e.l("SearchIn",this.facet.options.title)})).appendTo(this.middle),e.Component.pointElementsToDummyForm(this.input),this.input.keyup(function(e){return t.handleFacetSearchKeyUp(e)}),this.clear.click(function(){return t.handleFacetSearchClear()}),this.input.focus(function(e){return t.handleFacetSearchFocus(e)}),this.input.blur(function(){return t.handleFacetSearchBlur()}),this.search},t.prototype.buildSearchMobile=function(){var t=this,i=e.$("<div class='coveo-facet-search-button-mobile'>"+e.l("Search")+"</div>");return this.search=this.buildBaseSearch(),i.click(function(){var i=e.ModalBox.open(e.$("<div />").append(t.search),{title:e.JQueryUtils.getPopUpCloseButton(e.l("Close"),e.l("SearchIn",t.facet.options.title)),validation:function(){return t.completelyDismissSearch(),!0},className:"coveo-mobile-facet-search"});e.$(i.wrapper.find(".coveo-title")).click(function(){return i.close()}),t.input.val("").keyup().focus()}),i},t.prototype.handleFacetSearchKeyUp=function(t){e.Assert.exists(t);var i=""==this.input.val();this.showOrHideClearElement(i),e.DeviceUtils.isMobileDevice()?this.startNewSearchTimeout():this.handleKeyboardNavigation(t,i)},t.prototype.handleFacetSearchFocus=function(){""==this.getValueInInputForFacetSearch()||e.DeviceUtils.isMobileDevice()||this.startNewSearchTimeout(),e.DeviceUtils.isSmallScreenWidth()&&e.MobileUtils.addToggleClassOnSearchInterface("slide-left")},t.prototype.handleFacetSearchBlur=function(){var t=this;setTimeout(function(){e.DeviceUtils.isMobileDevice()||t.completelyDismissSearch()},250)},t.prototype.handleFacetSearchClear=function(){this.input.val(""),this.clear.hide(),this.completelyDismissSearch()},t.prototype.showOrHideClearElement=function(e){e?(this.clear.hide(),this.search.removeClass("coveo-facet-search-no-results")):this.clear.show()},t.prototype.handleKeyboardNavigation=function(e,t){switch(e.which){case 13:this.keyboardNavigationEnterPressed(e,t);break;case 46:this.keyboardNavigationDeletePressed(e);break;case 27:this.completelyDismissSearch();break;case 40:this.moveCurrentResultDown();break;case 38:this.moveCurrentResultUp();break;default:this.highlightCurrentQueryWithinSearchResults(),this.startNewSearchTimeout()}},t.prototype.keyboardNavigationEnterPressed=function(e,t){e.shiftKey?this.triggerNewFacetSearch():this.searchResults.is(":visible")||"block"==this.searchResults.css("display")?(this.performSelectActionOnCurrentSearchResult(),this.completelyDismissSearch()):this.search.is(".coveo-facet-search-no-results")||t||this.selectAllValuesMatchingSearch()},t.prototype.keyboardNavigationDeletePressed=function(e){e.shiftKey&&(this.performExcludeActionOnCurrentSearchResult(),this.completelyDismissSearch(),this.input.val(""))},t.prototype.triggerNewFacetSearch=function(t){var i=this;void 0===t&&(t=this.facet.options.numberOfValuesInFacetSearch),this.cancelAnyPendingSearchOperation(),this.showFacetSearchWaitingAnimation(),this.facet.logger.info("Triggering new facet search");var n=this.getValueInInputForFacetSearch();this.facetSearchDeferred=this.facet.facetQueryController.recursiveFacetSearch(n,this.facet.options.numberOfValuesInFacetSearch),this.facetSearchDeferred.done(function(t){i.facet.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.facetSearch,{facetId:i.facet.options.id,facetTitle:i.facet.options.title},i.facet.root),i.facet.logger.debug("Received field values",t),i._processNewFacetSearchResults(t.slice(0,i.facet.options.numberOfValuesInFacetSearch+1)),i.hideFacetSearchWaitingAnimation(),i.facetSearchDeferred=void 0}),this.facetSearchDeferred.fail(function(t,n){e.Utils.exists(n)&&(i.facet.logger.error("Error while retrieving facet values",n),i.hideFacetSearchWaitingAnimation()),i.facetSearchDeferred=void 0})},t.prototype.startNewSearchTimeout=function(){var e=this;this.cancelAnyPendingSearchOperation(),this.facetSearchTimeout=setTimeout(function(){""!=e.getValueInInputForFacetSearch()?e.triggerNewFacetSearch():e.completelyDismissSearch()},this.facet.options.facetSearchDelay)},t.prototype.cancelAnyPendingSearchOperation=function(){e.Utils.exists(this.facetSearchTimeout)&&(clearTimeout(this.facetSearchTimeout),this.facetSearchTimeout=void 0),e.Utils.exists(this.facetSearchDeferred)&&(this.facetSearchDeferred.reject(),this.facetSearchDeferred=void 0),this.hideFacetSearchWaitingAnimation()},t.prototype._processNewFacetSearchResults=function(t){e.Assert.exists(t),t.length>0?(this.search.removeClass("coveo-facet-search-no-results"),this.facet.fadeInactiveValuesInMainList(this.facet.options.facetSearchDelay),this.rebuildSearchResults(t),this.showSearchResultsElement(),this.highlightCurrentQueryWithinSearchResults(),e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet,!0),this.makeFirstSearchResultTheCurrentOne()):(this.hideSearchResultsElement(),this.search.addClass("coveo-facet-search-no-results"))},t.prototype.rebuildSearchResults=function(t){var i=this;e.Assert.exists(t),this.searchResults.empty();var n=e.$('<li class="coveo-facet-selectable coveo-facet-search-selectable coveo-facet-search-select-all "/>').text(e.l("SelectAll"));n.click(function(){return i.selectAllValuesMatchingSearch()}),e.DeviceUtils.isMobileDevice()||n.appendTo(this.searchResults);var o=e._.map(t,function(t){return e.FacetValue.create(t)});new this.facetSearchValuesListKlass(this.facet,e.FacetValueElement).build(o).appendTo(this.searchResults),e.DeviceUtils.isMobileDevice()&&(n.append("<span class='coveo-mobile-facet-search-select-all'></span>"),n.appendTo(this.searchResults)),this.searchResults.find(".coveo-facet-selectable").each(function(t,n){e.$(n).addClass("coveo-facet-search-selectable"),e.$(n).mousemove(function(){i.makeCurrentResult(e.$(n))})})},t.prototype.showSearchResultsElement=function(){this.searchResults.appendTo(this.facet.root),this.positionSearchResults()},t.prototype.hideSearchResultsElement=function(){this.searchResults.remove()},t.prototype.highlightCurrentQueryWithinSearchResults=function(){var t=this;e.$(this.searchResults).find(".coveo-facet-value-caption").each(function(i,n){var o=t.getValueInInputForFacetSearch(),s=new RegExp("("+e.StringUtils.wildcardsToRegex(o,t.facet.options.facetSearchIgnoreAccents)+")","ig"),r=e.$(n).text(),a=r.replace(s,'<span class="coveo-highlight">$1</span>');e.$(n).html(a)})},t.prototype.makeFirstSearchResultTheCurrentOne=function(){this.makeCurrentResult(this.getSelectables().first())},t.prototype.makeCurrentResult=function(){this.getSelectables().removeClass("coveo-current"),this.getSelectables().first().addClass("coveo-current")},t.prototype.moveCurrentResultDown=function(){var e=this.searchResults.find(".coveo-current");this.getSelectables().removeClass("coveo-current");var t=e.next(".coveo-facet-selectable").first();t.length>0?t.addClass("coveo-current"):e.siblings(".coveo-facet-selectable").first().addClass("coveo-current")},t.prototype.moveCurrentResultUp=function(){var e=this.searchResults.find(".coveo-current");this.searchResults.find(".coveo-facet-selectable").removeClass("coveo-current");var t=e.prev(".coveo-facet-selectable").first();t.length>0?t.addClass("coveo-current"):e.siblings(".coveo-facet-selectable").last().addClass("coveo-current")},t.prototype.getSelectables=function(e){return void 0===e&&(e=this.searchResults),e.find(".coveo-facet-selectable")},t.prototype.performSelectActionOnCurrentSearchResult=function(){var t=this.searchResults.find(".coveo-current");e.Assert.check(1==t.length);var i=t.find('input[type="checkbox"]');i.length>0?(i.prop("checked",!0),i.change()):t.click()},t.prototype.performExcludeActionOnCurrentSearchResult=function(){var t=this.searchResults.find(".coveo-current");e.Assert.check(1==t.length),t.find(".coveo-facet-value-exclude").click()},t.prototype.getValueInInputForFacetSearch=function(){return this.input.val()},t.prototype.selectAllValuesMatchingSearch=function(){var t=this;this.facet.showWaitingAnimation();var i=this.getValueInInputForFacetSearch(),n=e.FacetUtils.getValuesToUseForSearchInFacet(i,this.facet),o=this.facet.facetQueryController.searchInFacet(1e3,n,this.facet.options.facetSearchIgnoreAccents);o.done(function(i){t.completelyDismissSearch();var n=e._.map(i,function(i){var n=t.facet.values.get(i.value);return e.Utils.exists(n)||(n=e.FacetValue.create(i)),n.selected=!0,n.excluded=!1,n});t.facet.processFacetSearchAllResultsSelected(n)}),this.completelyDismissSearch()},t.prototype.showFacetSearchWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingFacetSearchWaitAnimation||(t.magnifier.hide(),t.wait.show(),t.showingFacetSearchWaitAnimation=!0)})},t.prototype.hideFacetSearchWaitingAnimation=function(){this.showingFacetSearchWaitAnimation&&(this.magnifier.show(),this.wait.hide(),this.showingFacetSearchWaitAnimation=!1)},t}();e.FacetSearch=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.options=t,this.element=e.$('<div class="coveo-facet-header"/>')}return t.prototype.build=function(){return this.buildIcon().appendTo(this.element),this.buildWaitAnimation().appendTo(this.element),this.options.settingsKlass?(this.sort=this.settings=new this.options.settingsKlass(this.options.availableSorts,this.options.facet),this.settings.build().appendTo(this.element)):this.options.sortKlass&&(this.sort=new this.options.sortKlass(this.options.availableSorts,this.options.facet)),this.options.enableCollapseElement&&(this.collapseElement=this.buildCollapse().appendTo(this.element),this.excludeElement=this.buildExpand().appendTo(this.element)),this.options.facet&&(this.operatorElement=this.buildOperatorToggle().appendTo(this.element),this.operatorElement.fastToggle(this.options.facet.options.allowTogglingOperator)),this.eraserElement=this.buildEraser().appendTo(this.element),this.buildTitle().appendTo(this.element),this.element},t.prototype.switchToAnd=function(){this.options.facet&&(this.options.facet.options.useAnd=!0,this.rebuildOperatorToggle(),this.updateOperatorQueryStateModel())},t.prototype.switchToOr=function(){this.options.facet&&(this.options.facet.options.useAnd=!1,this.rebuildOperatorToggle(),this.updateOperatorQueryStateModel())},t.prototype.collapseFacet=function(){this.collapseElement.hide(),this.excludeElement.show(),e.$(this.options.facetElement).addClass("coveo-facet-collapsed")},t.prototype.expandFacet=function(){this.excludeElement.hide(),this.collapseElement.show(),e.$(this.options.facetElement).removeClass("coveo-facet-collapsed"),this.options.facet&&e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.options.facet)},t.prototype.rebuildOperatorToggle=function(){var e=this.buildOperatorToggle();this.operatorElement&&this.operatorElement.replaceWith(e),this.operatorElement=e},t.prototype.updateOperatorQueryStateModel=function(){if(this.options.facet&&this.options.facet.options.allowTogglingOperator){var e="";(0!=this.options.facet.getSelectedValues().length||0!=this.options.facet.getExcludedValues().length)&&(e=this.options.facet.options.useAnd?"and":"or"),this.options.facet.queryStateModel.set(this.options.facet.operatorAttributeId,e)}},t.prototype.buildIcon=function(){var t;return t=this.options.icon?"coveo-icon-custom "+this.options.icon:"coveo-icon "+this.options.field.substr(1),this.icon=e.$("<div></div>").addClass(t),this.icon},t.prototype.buildWaitAnimation=function(){return this.waitElement=e.$("<div />").addClass("coveo-facet-header-wait-animation").css("display","none"),this.waitElement},t.prototype.buildCollapse=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",e.l("Collapse")).addClass("coveo-facet-header-collapse").append(i).click(function(){t.collapseFacet()})},t.prototype.buildExpand=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",e.l("Expand")).hide().addClass("coveo-facet-header-expand").append(i).click(function(){t.expandFacet()})},t.prototype.buildOperatorToggle=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return i.addClass("coveo-"+(this.options.facet.options.useAnd?"and":"or")),e.$("<div />").attr("title",e.l("SwitchTo",this.options.facet.options.useAnd?e.l("Or"):e.l("And"))).addClass("coveo-facet-header-operator").append(i).click(function(){t.handleOperatorClick()})},t.prototype.handleOperatorClick=function(){var t=this;if(this.options.facet.options.useAnd?this.options.facet.switchToOr():this.options.facet.switchToAnd(),0!=this.options.facet.getSelectedValues().length){var i=this.options.facet.options.useAnd?"AND":"OR",n=this.options.facet.options.useAnd?"OR":"AND";this.options.facet.triggerNewQuery(function(){return t.options.facet.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetToggle,{facetId:t.options.facet.options.id,facetOperatorBefore:n,facetOperatorAfter:i,facetTitle:t.options.title})})}},t.prototype.buildTitle=function(){return e.$('<div class="coveo-facet-header-title"/>').text(this.options.title)},t.prototype.buildEraser=function(){var t=this,i=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",e.l("Clear",this.options.title)).append(i).addClass("coveo-facet-header-eraser").click(function(){t.options.onEraserClick()})},t}();e.FacetHeader=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i){var n=this;this.facet=i,this.enabledSorts=[],this.customSortDirection="ascending",e._.each(t,function(t){var i=e.FacetSettings.availableSorts[t.toLowerCase()];void 0!=i&&n.enabledSorts.push(i)}),this.removeEnabledSortsBasedOnFacetType(),e.Utils.isNonEmptyArray(this.enabledSorts)&&(void 0!=this.facet.options.sortCriteria&&(this.activeSort=e._.find(this.enabledSorts,function(e){return e.name==n.facet.options.sortCriteria})),this.activeSort||(this.activeSort=this.enabledSorts[0]))}return t.prototype.removeEnabledSortsBasedOnFacetType=function(){if(this.facet.isInstanceOf("FacetRange")){var e=this.facet;e.options.slider&&(this.enabledSorts=[])}},t.prototype.reorderValues=function(e){return"custom"==this.activeSort.name&&void 0!=this.facet.options.customSort?this.reorderValuesWithCustomOrder(e):e},t.prototype.reorderValuesWithCustomOrder=function(t){var i=t.length,n=e._.map(this.facet.options.customSort,function(e){return e.toLowerCase()}),o=e._.map(t,function(t){var o=e._.reduce(n,function(i,n,o){return-1!=i?i:e.StringUtils.equalsCaseInsensitive(n,t.value)||null!=t.lookupValue&&e.StringUtils.equalsCaseInsensitive(n,t.lookupValue)?o:-1},-1);return o=-1==o?++i:o,{facetValue:t,index:o}}),s=e._.sortBy(o,"index");return s="ascending"==this.customSortDirection?s:s.reverse(),e._.pluck(s,"facetValue")},t.availableSorts={score:{label:e.l("Score"),directionToggle:!1,description:e.l("ScoreDescription"),name:"score"},occurrences:{label:e.l("Occurrences"),directionToggle:!1,description:e.l("OccurrencesDescription"),name:"occurrences"},alphaascending:{label:e.l("Label"),directionToggle:!0,description:e.l("LabelDescription"),name:"alphaascending",relatedSort:"alphadescending"},alphadescending:{label:e.l("Label"),directionToggle:!0,description:e.l("LabelDescription"),name:"alphadescending",relatedSort:"alphaascending"},computedfieldascending:{label:e.l("Value"),directionToggle:!0,description:e.l("ValueDescription"),name:"computedfieldascending",relatedSort:"computedfielddescending"},computedfielddescending:{label:e.l("Value"),directionToggle:!0,description:e.l("ValueDescription"),name:"computedfielddescending",relatedSort:"computedfieldascending"},chisquare:{label:e.l("RelativeFrequency"),directionToggle:!1,description:e.l("RelativeFrequencyDescription"),name:"chisquare"},custom:{label:e.l("Custom"),directionToggle:!0,description:e.l("CustomDescription"),name:"custom",relatedSort:"custom"}},t}();e.FacetSort=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n){t.call(this,i,n),this.facet=n,this.facetSettingsIconTemplate=e._.template("<span class='coveo-icon'></span>"),this.facetSettingsButtonTemplate=e._.template("<div title='"+e.l("Settings")+"' class='coveo-facet-header-settings'></div>"),this.facetSettingsPopupTemplate=e._.template('<div class="coveo-facet-settings-popup"></div>'),this.facetSettingsSectionTemplate=e._.template("<div class='coveo-facet-settings-section <%= _class %>'></div>"),this.facetSettingsSectionIconTemplate=e._.template("<div class='coveo-icon'></div>"),this.facetSettingsItemsTemplate=e._.template("<div class='coveo-facet-settings-items'></div>"),this.facetSettingsItemTemplate=e._.template("<div class='coveo-facet-settings-item' title='<%- title %>'><%- label %></div>"),this.customSortDirectionChange=!1,this.enabledSortsIgnoreRenderBecauseOfPairs=[],this.filterDuplicateForRendering()}return __extends(i,t),i.prototype.build=function(){if(this.settingsButton=e.$(this.facetSettingsButtonTemplate()),this.settingsIcon=e.$(this.facetSettingsIconTemplate()),this.settingsPopup=e.$(this.facetSettingsPopupTemplate()),e.Utils.isNonEmptyArray(this.enabledSorts)){var t=this.buildSortSection();this.directionSection=this.buildDirectionSection()}return this.facet.options.enableSettingsFacetState&&(this.saveStateSection=this.buildSaveStateSection(),this.clearStateSection=this.buildClearStateSection()),this.hideSection=this.buildHideSection(),this.showSection=this.buildShowSection(),this.handleMouseEventOnButton(t),e.Utils.isNonEmptyArray(this.enabledSorts)?this.settingsPopup.append(t.element,this.directionSection,this.saveStateSection,this.clearStateSection,this.hideSection,this.showSection):this.settingsPopup.append(this.saveStateSection,this.clearStateSection,this.hideSection,this.showSection),this.settingsButton.append(this.settingsIcon),this.settingsButton},i.prototype.loadSavedState=function(){var t=this.facetStateLocalStorage.load(),i=this.facet.queryStateModel.get(this.includedStateAttribute),n=this.facet.queryStateModel.get(this.excludedStateAttribute),o=this.facet.queryStateModel.get(this.operatorStateAttribute);
if(!e.Utils.isNullOrUndefined(t)&&e.Utils.isEmptyArray(i)&&e.Utils.isEmptyArray(n)&&!e.Utils.isNonEmptyString(o)){var s={};s[this.includedStateAttribute]=t.included,s[this.excludedStateAttribute]=t.excluded,s[this.operatorStateAttribute]=t.operator,this.facet.queryStateModel.setMultiple(s),this.loadedFromSettings=s}},i.prototype.buildSortSection=function(){var t=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-sort"})),i=e.$(this.facetSettingsSectionIconTemplate()),n=e.$(this.facetSettingsItemsTemplate()),o=this.buildSortSectionItems();return n.append(o),t.append(i,n),{element:t,sortItems:o}},i.prototype.buildSortSectionItems=function(){var t=this;return e._.map(this.enabledSorts,function(i){return e._.contains(t.enabledSortsIgnoreRenderBecauseOfPairs,i)?e.$():e.$(t.facetSettingsItemTemplate({label:e.L10N.format(i.label),title:i.description})).click(function(e){return t.handleClickSortButton(e,i)})})},i.prototype.closePopupAndUpdateSort=function(){this.closePopup(),"custom"!=this.activeSort.name?this.facet.updateSort(this.activeSort.name):(this.facet.updateSort("nosort"),this.customSortDirectionChange&&(this.customSortDirectionChange=!1,this.facet.queryController.executeQuery()))},i.prototype.closePopup=function(){this.settingsPopup.detach()},i.prototype.buildDirectionSection=function(){var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-direction"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate()),s=e.$(this.facetSettingsItemTemplate({label:e.l("Ascending"),title:e.l("Ascending")})).click(function(e){return t.handleDirectionClick(e,"ascending")}),r=e.$(this.facetSettingsItemTemplate({label:e.l("Descending"),title:e.l("Descending")})).click(function(e){return t.handleDirectionClick(e,"descending")});return o.append(s,r),i.append(n,o),this.activeSort.directionToggle?this.selectItem(this.getItems(i).first()):i.addClass("coveo-facet-settings-disabled"),i},i.prototype.buildSaveStateSection=function(){var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-save-state"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());this.facetStateLocalStorage=new e.LocalStorageUtils("facet-state-"+this.facet.options.id),this.includedStateAttribute=e.QueryStateModel.getFacetId(this.facet.options.id),this.excludedStateAttribute=e.QueryStateModel.getFacetId(this.facet.options.id,!1),this.operatorStateAttribute=e.QueryStateModel.getFacetOperator(this.facet.options.id);e.$(this.facetSettingsItemTemplate({label:e.l("SaveFacetState"),title:e.l("SaveFacetState")})).click(function(e){return t.handleSaveStateClick(e)}).appendTo(o);return i.append(n,o),i},i.prototype.buildClearStateSection=function(){{var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-clear-state"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:e.l("ClearFacetState"),title:e.l("ClearFacetState")})).click(function(e){return t.handleClearStateClick(e)}).appendTo(o)}return i.append(n,o),i},i.prototype.buildHideSection=function(){{var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-hide"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:e.l("Collapse"),title:e.l("HideFacet")})).click(function(){t.facet.facetHeader.collapseFacet(),t.settingsPopup.detach()}).appendTo(o)}return i.append(n,o),i},i.prototype.buildShowSection=function(){{var t=this,i=e.$(this.facetSettingsSectionTemplate({_class:"coveo-facet-settings-section-show"})),n=e.$(this.facetSettingsSectionIconTemplate()),o=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:e.l("Expand"),title:e.l("Expand")})).click(function(){t.facet.facetHeader.expandFacet(),t.settingsPopup.detach()}).appendTo(o)}return i.append(n,o),i},i.prototype.handleClickSettingsButtons=function(t,i){var n=this;this.settingsPopup.is(":visible")?this.settingsPopup.detach():(e.JQueryUtils.positionPopup(this.settingsPopup,e.$(t.delegateTarget),e.$(this.facet.root),e.$(this.facet.root),this.getPopupAlignment()),this.hideSection.toggle(!e.$(this.facet.element).hasClass("coveo-facet-collapsed")),this.showSection.toggle(e.$(this.facet.element).hasClass("coveo-facet-collapsed")),this.facet.options.enableSettingsFacetState&&this.clearStateSection.toggle(!e.Utils.isNullOrUndefined(this.facetStateLocalStorage.load())),e._.each(this.enabledSorts,function(e,t){n.activeSort.name.toLowerCase()==e.name.toLowerCase()?n.selectItem(i.sortItems[t]):n.unselectItem(i.sortItems[t])}))},i.prototype.handleClickSortButton=function(t,n){this.activeSort=n,n.directionToggle&&e._.contains(this.enabledSorts,i.availableSorts[this.activeSort.relatedSort])?this.activateDirectionSection():this.disableDirectionSection(),this.selectItem(e.$(t.target)),this.closePopupAndUpdateSort()},i.prototype.handleDirectionClick=function(t,n){e.$(t.target).parent().parent().hasClass("coveo-facet-settings-disabled")||-1!=this.activeSort.name.indexOf(n)||(this.activeSort=i.availableSorts[this.activeSort.relatedSort],this.unselectSection(this.directionSection),this.selectItem(e.$(t.target)),"custom"==this.activeSort.name&&this.customSortDirection!=n&&(this.customSortDirection=n,this.customSortDirectionChange=!0),this.closePopupAndUpdateSort())},i.prototype.handleSaveStateClick=function(){this.facetStateLocalStorage.save({included:this.facet.queryStateModel.get(this.includedStateAttribute),excluded:this.facet.queryStateModel.get(this.excludedStateAttribute),operator:this.facet.queryStateModel.get(this.operatorStateAttribute)}),this.closePopup()},i.prototype.handleClearStateClick=function(){var t=this;this.facetStateLocalStorage.remove(),this.facet.reset(),this.closePopup(),this.facet.triggerNewQuery(function(){return t.facet.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.facet.options.id,facetTitle:t.facet.options.title})})},i.prototype.handleMouseEventOnButton=function(t){var i,n=this;this.settingsButton.click(function(e){return n.handleClickSettingsButtons(e,t)}),e.$([this.settingsIcon[0],this.settingsPopup[0]]).mouseleave(function(){return i=setTimeout(function(){n.settingsPopup.detach()},300)}).mouseenter(function(){return clearTimeout(i)})},i.prototype.activateDirectionSection=function(){this.directionSection.removeClass("coveo-facet-settings-disabled"),this.unselectSection(this.directionSection),this.selectItem(this.getItems(this.directionSection).first())},i.prototype.disableDirectionSection=function(){this.directionSection.addClass("coveo-facet-settings-disabled"),this.unselectSection(this.directionSection)},i.prototype.getItems=function(e){return e.find(".coveo-facet-settings-item")},i.prototype.unselectSection=function(e){this.getItems(e).removeClass("coveo-selected")},i.prototype.selectItem=function(e){e.addClass("coveo-selected")},i.prototype.unselectItem=function(e){e.removeClass("coveo-selected")},i.prototype.getPopupAlignment=function(){var t=e.DeviceUtils.isMobileDevice()?1:2,i=2;return{horizontal:t,vertical:i}},i.prototype.filterDuplicateForRendering=function(){this.hasDuplicate("alphaascending","alphadescending")&&this.enabledSortsIgnoreRenderBecauseOfPairs.push(i.availableSorts.alphadescending),this.hasDuplicate("computedfieldascending","computedfielddescending")&&this.enabledSortsIgnoreRenderBecauseOfPairs.push(i.availableSorts.computedfielddescending)},i.prototype.hasDuplicate=function(t,i){var n=e._.filter(this.enabledSorts,function(e){return e.name==t||e.name==i});return void 0!=n&&2==n.length},i}(e.FacetSort);e.FacetSettings=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValueElementKlass=t,this.valueList={}}return t.prototype.build=function(){return this.valueContainer=e.$('<ul class="coveo-facet-values"/>'),this.valueContainer},t.prototype.get=function(t){var i;return t instanceof e.FacetValue?i=t.value:(t=e.Utils.anyTypeToString(t),i=t),this.ensureFacetValueIsInList(t),this.valueList[i.toLowerCase()]},t.prototype.select=function(e){var t=this.get(e);return t.select(),t},t.prototype.unselect=function(e){var t=this.get(e);return t.unselect(),t},t.prototype.exclude=function(e){var t=this.get(e);return t.exclude(),t},t.prototype.unExclude=function(e){var t=this.get(e);return t.unexclude(),t},t.prototype.toggleSelect=function(e){var t=this.get(e);return t.facetValue.selected?t.unselect():t.select(),t},t.prototype.toggleExclude=function(e){var t=this.get(e);return t.facetValue.excluded?t.unexclude():t.exclude(),t},t.prototype.rebuild=function(t){var i=this;this.valueContainer.empty();var n=this._getValuesToBuildWith(),o=t;e._.each(n,function(e,t){if(i.facetValueShouldBeRemoved(e))i.facet.values.remove(e.value),o+=1;else if(o>t){var n=new i.facetValueElementKlass(i.facet,e,!0);i.valueList[e.value.toLowerCase()]=n;var s=n.build().listElement;i.valueContainer.append(s)}}),e.FacetUtils.addNoStateCssClassToFacetValues(this.facet,this.valueContainer),e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet)},t.prototype._getValuesToBuildWith=function(){return this.facet.facetSort.reorderValues(this.facet.values.getAll())},t.prototype.facetValueShouldBeRemoved=function(e){return!(0!=e.occurrences||0!=e.delta&&void 0!=e.delta||e.selected||e.excluded||this.facet.keepDisplayedValuesNextTime)},t.prototype.ensureFacetValueIsInList=function(t){var i;t instanceof e.FacetValue?(i=this.facet.values.get(t.value),null==i&&(this.facet.values.add(t),i=t)):(i=this.facet.values.get(t),null==i&&(i=e.FacetValue.createFromValue(t),this.facet.values.add(i)));var n=i.value.toLowerCase(),o=this.valueList[n];void 0==o?(o=this.valueList[n]=new e.FacetValueElement(this.facet,i,!0),o.build()):o.facetValue=i},t.prototype.addNoStateCssClassToFacetValues=function(){if(0!=this.facet.values.getSelected().length){var t=this.valueContainer.find("li").not(".coveo-selected");e._.each(t,function(t){e.$(t).addClass("coveo-no-state")})}},t}();e.FacetValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValue=t}return t.prototype.build=function(){this.listElement=e.$('<li class="coveo-facet-value coveo-facet-selectable"/>'),this.listElement.data("value",this.facetValue.value),this.excludeIcon=this._buildExcludeIcon().appendTo(this.listElement),this.label=e.$('<label class="coveo-facet-value-label"/>').appendTo(this.listElement),e.Utils.exists(this.facetValue.computedField)&&(this.computedField=this._buildValueComputedField().appendTo(this.label),this.label.addClass("coveo-with-computed-field"));var t=e.$('<div class="coveo-facet-value-label-wrapper"/>').appendTo(this.label);return this.checkbox=this._buildValueCheckbox().appendTo(t),this.stylishCheckbox=this._buildValueStylishCheckbox().appendTo(t),this.facet.options.showIcon&&(this.icon=this._buildValueIcon().appendTo(t)),this.valueCaption=this._buildValueCaption().appendTo(t),this.valueCount=this._buildValueCount().appendTo(t),this._setCssClassOnListValueElement(),this.bindEvent({displayNextTime:!0,pinFacet:this.facet.options.preservePosition}),this},t.prototype.bindEvent=function(t){this.isOmnibox=e.Utils.isNullOrUndefined(t.omniboxObject)?!1:!0,this._handleEventForCheckboxChange(t),this.facetValue.excluded?this._handleEventForExcludedValueElement(t):this._handleEventForValueElement(t)},t.prototype.select=function(){this.facetValue.selected=!0,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},t.prototype.unselect=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},t.prototype.exclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!0,this._setCssClassOnListValueElement()},t.prototype.unexclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},t.prototype._buildExcludeIcon=function(){return e.$("<div />").attr("title",e.l("Exclude",this.facet.getValueCaption(this.facetValue))).addClass("coveo-facet-value-exclude")},t.prototype._buildValueComputedField=function(){var t=this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat);return e.Utils.isNonEmptyString(t)?e.$("<span/>").addClass("coveo-facet-value-computed-field").text(t):e.$([])},t.prototype._buildValueCheckbox=function(){var t=e.$('<input type="checkbox"/>');return t.prop("checked",this.facetValue.selected),t.prop("disabled",this.facetValue.excluded),e.Component.pointElementsToDummyForm(t),t},t.prototype._buildValueStylishCheckbox=function(){var t=e.$("<div/>").addClass("coveo-facet-value-checkbox");return e.$("<span/>").appendTo(t),t},t.prototype._buildValueIcon=function(){var t=this._getValueIcon();return e.Utils.exists(t)?e.$('<img class="coveo-facet-value-icon coveo-icon"/>').prop("src",this._getValueIcon()):this._buildValueIconFromSprite()},t.prototype._getValueIcon=function(){return e.Utils.exists(this.facet.options.valueIcon)?this.facet.options.valueIcon(this.facetValue):void 0},t.prototype._buildValueIconFromSprite=function(){return e.$("<div />").addClass("coveo-facet-value-icon coveo-icon").addClass(this.facet.options.field.substr(1)).addClass(this.facetValue.value)},t.prototype._buildValueCaption=function(){return e.$('<span class="coveo-facet-value-caption"/>').text(this.facet.getValueCaption(this.facetValue))},t.prototype._buildValueCount=function(){var t=this.facetValue.getFormattedCount();if(e.Utils.isNonEmptyString(t)){var i=e.$("<span/>").addClass("coveo-facet-value-count").text(t);return i}return e.$([])},t.prototype._handleSelectValue=function(t){var i=this;this.facet.keepDisplayedValuesNextTime=t.displayNextTime&&!this.facet.options.useAnd;var n;this.facetValue.excluded?(n=e.AnalyticsActionCauseList.facetUnexclude,this.facet.unexcludeValue(this.facetValue)):(n=this.facetValue.selected?e.AnalyticsActionCauseList.facetDeselect:e.AnalyticsActionCauseList.facetSelect,this.facet.toggleSelectValue(this.facetValue)),this.isOmnibox&&(n=e.AnalyticsActionCauseList.omniboxFacet),this.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(n,i.getAnalyticsFacetMeta())})},t.prototype._handleExcludeClick=function(t){var i=this;this.facet.keepDisplayedValuesNextTime=t.displayNextTime&&!this.facet.options.useAnd,this.facet.toggleExcludeValue(this.facetValue);var n=this.isOmnibox?e.AnalyticsActionCauseList.omniboxFacet:e.AnalyticsActionCauseList.facetExclude;this.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(n,i.getAnalyticsFacetMeta())})},t.prototype._handleEventForExcludedValueElement=function(e){var t=this;this.label.click(function(i){return e.pinFacet&&t.facet.pinFacetPosition(),e.omniboxObject&&t._omniboxCloseEvent(e.omniboxObject),t._handleSelectValue(e),i.stopPropagation(),!1})},t.prototype._handleEventForValueElement=function(e){var t=this;this.excludeIcon.click(function(i){return e.omniboxObject&&t._omniboxCloseEvent(e.omniboxObject),t._handleExcludeClick(e),i.stopPropagation(),!1}),this.label.click(function(i){return e.pinFacet&&t.facet.pinFacetPosition(),i.preventDefault(),t.checkbox.change(),!1})},t.prototype._handleEventForCheckboxChange=function(t){var i=this;this.checkbox.change(function(){t.omniboxObject&&i._omniboxCloseEvent(t.omniboxObject),i._handleSelectValue(t),e.DeviceUtils.isMobileDevice()&&i.facet.options.enableFacetSearch&&e.Defer.defer(function(){e.ModalBox.close(!0),i.facet.facetSearch.completelyDismissSearch()})})},t.prototype._omniboxCloseEvent=function(e){e.closeOmnibox(),e.clear()},t.prototype._setCssClassOnListValueElement=function(){this.listElement.toggleClass("coveo-selected",this.facetValue.selected),this.listElement.toggleClass("coveo-excluded",this.facetValue.excluded)},t.prototype.getAnalyticsFacetMeta=function(){return{facetId:this.facet.options.id,facetValue:this.facetValue.value,facetTitle:this.facet.options.title}},t}();e.ValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){var s=this;t.call(this,i,n),this.facet=i,this.facetValue=n,this.keepDisplayedValueNextTime=o,this.firstQuery=!0,e.$(i.root).one(e.QueryEvents.querySuccess,function(){s.firstQuery=!1})}return __extends(i,t),i.prototype.bindEvent=function(){t.prototype.bindEvent.call(this,{displayNextTime:this.keepDisplayedValueNextTime,pinFacet:this.facet.options.preservePosition})},i}(e.ValueElement);e.FacetValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i),this.facet=t,this.facetValue=i,this.eventArg=n}return __extends(t,e),t.prototype.bindEvent=function(){e.prototype.bindEvent.call(this,{displayNextTime:!1,pinFacet:!1,omniboxObject:this.eventArg})},t}(e.ValueElement);e.OmniboxValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValueElementKlass=t}return t.prototype.build=function(t){var i=this,n=e._.map(t,function(t){return e._.find(i.facet.values.getAll(),function(e){return e.value==t.value})||t});return e.$(e._.map(n,function(e){return new i.facetValueElementKlass(i.facet,e,i.facet.keepDisplayedValuesNextTime).build().listElement.get(0)}))},t}();e.FacetSearchValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.facet=e,this.facetValue=t}return t.prototype.build=function(t){var i=this;void 0===t&&(t=!0),e.Assert.exists(this.facetValue);var n=e.DeviceUtils.isMobileDevice()?e.$("<div/>"):e.$("<span/>");n.addClass("coveo-facet-breadcrumb-value"),n.toggleClass("coveo-selected",this.facetValue.selected),n.toggleClass("coveo-excluded",this.facetValue.excluded),n.attr("title",this.getBreadcrumbTooltip()),e.$("<span/>").addClass("coveo-facet-breadcrumb-caption").text(this.facet.getValueCaption(this.facetValue)).appendTo(n),e.$("<span/>").addClass("coveo-facet-breadcrumb-clear").appendTo(n);var o=!1;return n.click(function(){o||(o=!0,i.facetValue.excluded?i.facet.unexcludeValue(i.facetValue.value):i.facet.deselectValue(i.facetValue.value),i.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.breadcrumbFacet,{facetId:i.facet.options.id,facetValue:i.facetValue.value,facetTitle:i.facet.options.title})}))}),n},t.prototype.getBreadcrumbTooltip=function(){var t=[this.facet.getValueCaption(this.facetValue),this.facetValue.getFormattedCount(),this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat)];return e._.compact(t).join(" ")},t}();e.BreadcrumbValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n){this.facet=t,this.facetValues=i,this.breadcrumbValueElementKlass=n,this.setExpandedAndCollapsed(),this.elem=e.$("<div/>").addClass("coveo-facet-breadcrumb");var o=e.DeviceUtils.isMobileDevice()?e.$("<div/>"):e.$("<span/>");o.addClass("coveo-facet-breadcrumb-title").text(this.facet.options.title+(e.DeviceUtils.isMobileDevice()?"":":")).appendTo(this.elem),this.valueContainer=e.$("<span/>").addClass("coveo-facet-breadcrumb-values").appendTo(this.elem)}return t.prototype.build=function(){return this.buildExpanded(),0!=this.collapsed.length&&this.buildCollapsed(),this.elem},t.prototype.buildExpanded=function(){var t=this;e._.each(this.expanded,function(i,n){0==n||e.DeviceUtils.isMobileDevice()||e.$("<span/>").addClass("coveo-facet-breadcrumb-separator").text(", ").appendTo(t.valueContainer),new t.breadcrumbValueElementKlass(t.facet,i).build().appendTo(t.valueContainer)})},t.prototype.buildCollapsed=function(){var t=this,i=e._.filter(this.collapsed,function(e){return e.selected}).length,n=e._.filter(this.collapsed,function(e){return e.excluded}).length;e.Assert.check(i+n==this.collapsed.length);var o=e.$("<div/>").addClass("coveo-facet-breadcrumb-value");e.DeviceUtils.isMobileDevice()||e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(o),i>0&&(e.$("<span/>").addClass("coveo-facet-breadcrumb-multi-count").text(Globalize.format(i,"n0")).appendTo(o),e.$("<div/>").addClass("coveo-selected").addClass("coveo-facet-breadcrumb-multi-icon").appendTo(o)),n>0&&(e.$("<span/>").addClass("coveo-facet-breadcrumb-multi-count").text(Globalize.format(n,"n0")).appendTo(o),e.$("<div />").addClass("coveo-excluded").addClass("coveo-facet-breadcrumb-multi-icon").appendTo(o));var s=e._.map(this.collapsed,function(e){return new t.breadcrumbValueElementKlass(t.facet,e)}),r=e._.map(s,function(e){return e.getBreadcrumbTooltip()});o.attr("title",r.join("\n")),o.click(function(){var t=[];e._.forEach(s,function(i){e.DeviceUtils.isMobileDevice()||t.push(e.$("<span/>").addClass("coveo-facet-breadcrumb-separator").text(", ")[0]),t.push(i.build(!1).get(0))}),e.$(t).insertBefore(o),o.detach()}),this.valueContainer.append(o)},t.prototype.setExpandedAndCollapsed=function(){this.facetValues.length>this.facet.options.numberOfValuesInBreadcrumb?(this.collapsed=e._.rest(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1),this.expanded=e._.first(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1)):(this.collapsed=[],this.expanded=this.facetValues)},t}();e.BreadcrumbValueList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t,i,n){this.facet=e,this.facetValues=t,this.omniboxObject=i,this.omniboxValueElementKlass=n}return t.prototype.build=function(){var t=this,i=[];return e._.each(this.facetValues,function(e){i.push(t.buildOmniboxForOneRow(e,t.omniboxObject))}),this.buildFinalOmniboxElement(i)},t.prototype.buildOmniboxForOneRow=function(t,i){var n=new this.omniboxValueElementKlass(this.facet,t,i),o=n.build().listElement,s=i.completeQueryExpression.regex,r=i.completeQueryExpression.word;o.find(".coveo-facet-value-caption").html(this.highlightOmniboxMatch(this.facet.getValueCaption(t),s,r));var a=e.$("<div class='coveo-omnibox-selectable coveo-facet-value coveo-omnibox-facet-value'></div>").append(o);return a.on("keyboardSelect",function(){o.find("input[type=checkbox]").change()}),a},t.prototype.buildFinalOmniboxElement=function(t){var i=this.buildOmniboxHeader();if(e.Utils.isEmptyArray(t))return void 0;var n=e.$("<div></div>").append(i,t);return e.FacetUtils.addNoStateCssClassToFacetValues(this.facet,n),n},t.prototype.buildOmniboxHeader=function(){var t=e.$("<span class='coveo-icon "+this.facet.options.field.substr(1)+"'></span>"),i=this.facet.options.title;return e.$("<div class='coveo-omnibox-facet-header'></div>").append(t,i)},t.prototype.highlightOmniboxMatch=function(e,t,i){var n=e.search(t),o=n+i.length;return e.slice(0,n)+"<span class='coveo-highlight'>"+e.slice(n,o)+"</span>"+e.slice(o)},t.prototype.omniboxCloseEvent=function(e){e.closeOmnibox(),e.clear()},t}();e.OmniboxValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.populateOmnibox="populateOmnibox",e.openOmnibox="openOmnibox",e.closeOmnibox="closeOmnibox",e}();e.OmniboxEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;void 0===r&&(r=i.ID),t.call(this,n,r,s),this.element=n,this.options=o,this.keepDisplayedValuesNextTime=!1,this.values=new e.FacetValues,this.currentPage=0,this.firstQuery=!0,this.canFetchMore=!0,this.showingWaitAnimation=!1,this.listenToQueryStateChange=!0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null!=this.options.valueCaption&&(this.options.availableSorts=e._.filter(this.options.availableSorts,function(e){return!/^alpha.*$/.test(e)})),this._omniboxZIndex=i.omniboxIndex,i.omniboxIndex--,this.checkForComputedFieldAndSort(),this.checkForValueCaptionType(),this.checkForCustomSort(),this.initFacetQueryController(),this.initQueryEvents(),this.initQueryStateEvents(),this.initComponentStateEvents(),this.initOmniboxEvents(),this.initBreadCrumbEvents(),this.updateNumberOfValues(),e.$(window).resize(function(){a.disabled||e.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(a)}),e.$(this.root).one(e.QueryEvents.querySuccess,function(){a.firstQuery=!1})}return __extends(i,t),i.prototype.createDom=function(){if(this.initBottomAndTopSpacer(),this.buildFacetContent(),this.updateAppearanceDependingOnState(),this.facetSettings&&this.options.enableSettingsFacetState){var t=e._.once(e.$.proxy(this.facetSettings.loadSavedState,this.facetSettings));this.bind.onRoot(e.QueryEvents.newQuery,t)}},i.prototype.selectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Selecting facet value",this.facetValuesList.select(t)),this.facetValueHasChanged()},i.prototype.selectMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Selecting facet value",i.facetValuesList.select(e))}),this.facetValueHasChanged()},i.prototype.deselectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Deselecting facet value",this.facetValuesList.unselect(t)),this.facetValueHasChanged()},i.prototype.deselectMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Deselecting facet value",i.facetValuesList.unselect(e))}),this.facetValueHasChanged()},i.prototype.excludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Excluding facet value",this.facetValuesList.exclude(t)),this.facetValueHasChanged()},i.prototype.excludeMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Excluding facet value",i.facetValuesList.exclude(e))}),this.facetValueHasChanged()},i.prototype.unexcludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Unexcluding facet value",this.facetValuesList.unExclude(t)),this.facetValueHasChanged()},i.prototype.unexcludeMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Unexcluding facet value",i.facetValuesList.unExclude(e))}),this.facetValueHasChanged()},i.prototype.toggleSelectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle select facet value",this.facetValuesList.toggleSelect(t)),this.facetValueHasChanged()},i.prototype.toggleExcludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle exclude facet value",this.facetValuesList.toggleExclude(t)),this.facetValueHasChanged()},i.prototype.getDisplayedValues=function(){return this.ensureDom(),e._.first(e._.pluck(this.values.getAll(),"value"),this.numberOfValues)},i.prototype.getSelectedValues=function(){return this.ensureDom(),e._.map(this.values.getSelected(),function(e){return e.value})},i.prototype.getExcludedValues=function(){return this.ensureDom(),e._.map(this.values.getExcluded(),function(e){return e.value})},i.prototype.reset=function(){this.ensureDom(),this.values.reset(),this.rebuildValueElements(),this.updateAppearanceDependingOnState(),this.updateQueryStateModel()},i.prototype.switchToAnd=function(){this.ensureDom(),this.logger.info("Switching to AND"),this.facetHeader.switchToAnd()},i.prototype.switchToOr=function(){this.ensureDom(),this.logger.info("Switching to OR"),this.facetHeader.switchToOr()},i.prototype.getEndpoint=function(){return this.queryController.getEndpoint()},i.prototype.updateSort=function(e){this.options.sortCriteria!=e&&(this.options.sortCriteria=e,this.triggerNewQuery())},i.prototype.unfadeInactiveValuesInMainList=function(){e.$(this.element).removeClass("coveo-facet-fade")},i.prototype.fadeInactiveValuesInMainList=function(){e.$(this.element).addClass("coveo-facet-fade")},i.prototype.showWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingWaitAnimation||(t.headerElement.find(".coveo-icon").first().css("display","none"),t.headerElement.find(".coveo-facet-header-wait-animation").css("display",""),t.showingWaitAnimation=!0)})},i.prototype.hideWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingWaitAnimation&&(t.headerElement.find(".coveo-icon").css("display",""),t.headerElement.find(".coveo-facet-header-wait-animation").css("display","none"),t.showingWaitAnimation=!1)})},i.prototype.processFacetSearchAllResultsSelected=function(t){var i=this,n=[];e._.each(t,function(e){i.ensureFacetValueIsInList(e),n.push(e.value)}),this.updateQueryStateModel(),this.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetSelectAll,{facetId:i.options.id,facetTitle:i.options.title})})},i.prototype.pinFacetPosition=function(){this.pinnedViewportPosition=this.element.getBoundingClientRect().top},i.prototype.getValueCaption=function(t){e.Assert.exists(t);var i=t.lookupValue||t.value,n=i;return n=e.FacetUtils.tryToGetTranslatedCaption(this.options.field,i),e.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(n=this.options.valueCaption[i]||n),"function"==typeof this.options.valueCaption&&(this.values.get(i),n=this.options.valueCaption.call(this,this.facetValuesList.get(i).facetValue))),n},i.prototype.enable=function(){t.prototype.enable.call(this)},i.prototype.disable=function(){t.prototype.disable.call(this)},i.prototype.triggerNewQuery=function(t){var i=this;t?this.queryController.deferExecuteQuery({beforeExecuteQuery:t}):this.queryController.deferExecuteQuery({ignoreWarningSearchEvent:!0}),e.Defer.defer(function(){return i.showWaitingAnimation()})},i.prototype.handleDeferredQuerySuccess=function(t,i){e.Assert.exists(i),this.unfadeInactiveValuesInMainList(),this.hideWaitingAnimation(),this.updateVisibilityBasedOnDependsOn();var n=i.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];this.facetQueryController.lastGroupByResult=n,n||(this.keepDisplayedValuesNextTime=!1),this.processNewGroupByResults(n)},i.prototype.handlePopulateBreadcrumb=function(t,i){if(e.Assert.exists(i),this.values.hasSelectedOrExcludedValues()){var n=new e.BreadcrumbValueList(this,this.values.getSelected().concat(this.values.getExcluded()),e.BreadcrumbValueElement).build();i.breadcrumbs.push({element:n.get(0)})}},i.prototype.initFacetQueryController=function(){this.facetQueryController=new e.FacetQueryController(this)},i.prototype.initFacetValuesList=function(){this.facetValuesList=new e.FacetValuesList(this,e.FacetValueElement),e.$(this.element).append(this.facetValuesList.build())},i.prototype.initFacetSearch=function(){this.facetSearch=new e.FacetSearch(this,e.FacetSearchValuesList),e.$(this.element).append(this.facetSearch.build())},i.prototype.facetValueHasChanged=function(){var t=this;this.updateQueryStateModel(),this.rebuildValueElements(),e.Defer.defer(function(){t.updateAppearanceDependingOnState()})},i.prototype.updateAppearanceDependingOnState=function(){e.$(this.element).toggleClass("coveo-active",this.values.hasSelectedOrExcludedValues()),e.$(this.element).toggleClass("coveo-facet-empty",!this.isAnyValueCurrentlyDisplayed()),e.$(this.facetHeader.eraserElement).fastToggle(this.values.hasSelectedOrExcludedValues())},i.prototype.initQueryEvents=function(){this.bind.onRoot(e.QueryEvents.duringQuery,this.handleDuringQuery),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.doneBuildingQuery,this.handleDoneBuildingQuery),this.bind.onRoot(e.QueryEvents.deferredQuerySuccess,this.handleDeferredQuerySuccess)},i.prototype.initQueryStateEvents=function(){this.includedAttributeId=e.QueryStateModel.getFacetId(this.options.id),this.excludedAttributeId=e.QueryStateModel.getFacetId(this.options.id,!1),this.operatorAttributeId=e.QueryStateModel.getFacetOperator(this.options.id),this.lookupValueAttributeId=e.QueryStateModel.getFacetLookupValue(this.options.id),this.queryStateModel.registerNewAttribute(this.includedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.excludedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.operatorAttributeId,""),this.queryStateModel.registerNewAttribute(this.lookupValueAttributeId,{});
var t=this.queryStateModel.getEventName(e.Model.eventTypes.change);this.bind.onRoot(t,this.handleQueryStateChanged)},i.prototype.initComponentStateEvents=function(){this.componentStateId=e.QueryStateModel.getFacetId(this.options.id),this.componentStateModel.registerComponent(this.componentStateId,this)},i.prototype.initOmniboxEvents=function(){this.options.includeInOmnibox&&this.bind.onRoot(e.OmniboxEvents.populateOmnibox,this.handlePopulateOmnibox)},i.prototype.initBreadCrumbEvents=function(){this.options.includeInBreadcrumb&&(this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,this.handlePopulateBreadcrumb),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,this.handleClearBreadcrumb))},i.prototype.handleOmniboxWithStaticValue=function(t){var i=this,n=new RegExp("^"+t.completeQueryExpression.regex.source,"i"),o=(t.completeQueryExpression.word,e._.first(e._.filter(this.getDisplayedValues(),function(e){var t=i.getValueCaption(i.facetValuesList.get(e).facetValue);return n.test(t)}),this.options.numberOfValuesInOmnibox)),s=e._.map(o,function(e){return i.facetValuesList.get(e).facetValue}),r=new e.OmniboxValuesList(this,s,t,e.OmniboxValueElement).build();t.rows.push({element:r?r.get(0):void 0,zIndex:this._omniboxZIndex})},i.prototype.processNewGroupByResults=function(t){this.logger.trace("Displaying group by results",t),void 0!=t&&void 0!=t.values&&(this.nbAvailableValues=t.values.length);var i=new e.FacetValues(t);this.updateValues(i),this.canFetchMore=this.numberOfValues<this.nbAvailableValues,this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField?this.triggerUpdateDeltaQuery(e._.filter(this.values.getAll(),function(e){return!e.selected&&!e.excluded})):this.values.getSelected().length>0&&!this.options.useAnd&&this.values.updateDeltaWithFilteredFacetValues(new e.FacetValues),this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField||(this.rebuildValueElements(),this.updateAppearanceDependingOnState(),this.ensurePinnedFacetHasntMoved()),this.keepDisplayedValuesNextTime=!1},i.prototype.updateQueryStateModel=function(){this.listenToQueryStateChange=!1,this.updateExcludedQueryStateModel(),this.updateIncludedQueryStateModel(),this.facetHeader.updateOperatorQueryStateModel(),this.updateLookupValueQueryStateModel(),this.listenToQueryStateChange=!0},i.prototype.rebuildValueElements=function(){this.updateNumberOfValues(),this.facetValuesList.rebuild(this.numberOfValues),this.options.enableMoreLess&&this.updateMoreLess()},i.prototype.updateMoreLess=function(){var e=!1;this.getMinimumNumberOfValuesToDisplay()<this.numberOfValues?(this._lessElement.show(),e=!0):this._lessElement.hide();var t=this.nbAvailableValues>this.numberOfValues;this._moreElement.toggleClass("coveo-active",t),e||t?this.footerElement.removeClass("coveo-facet-empty"):this.footerElement.addClass("coveo-facet-empty")},i.prototype.handleClickMore=function(){this.currentPage++,this.updateNumberOfValues(),this.nbAvailableValues>=this.numberOfValues||!this.canFetchMore?this.rebuildValueElements():this.triggerMoreQuery()},i.prototype.handleClickLess=function(){this._lessElement.hide(),this.currentPage=0,this.updateNumberOfValues(),this._moreElement.addClass("coveo-active"),this.values.sortValuesDependingOnStatus(this.numberOfValues),this.rebuildValueElements()},i.prototype.checkForComputedFieldAndSort=function(){-1!=this.options.sortCriteria.toLowerCase().indexOf("computedfield")&&e.Utils.isNullOrUndefined(this.options.computedField)&&this.logger.warn("Sort criteria is specified as ComputedField, but the facet uses no computed field. Facet will always be empty !",this)},i.prototype.checkForValueCaptionType=function(){this.options.valueCaption&&"function"==typeof this.options.valueCaption&&(this.options.enableFacetSearch=!1,this.options.includeInOmnibox=!1,this.logger.warn("Using a function as valueCaption is now deprecated. Use a json key value pair instead. Facet search and omnibox has been disabled for this facet",this))},i.prototype.checkForCustomSort=function(){void 0==this.options.customSort||e._.contains(this.options.availableSorts,"custom")||this.options.availableSorts.unshift("custom"),"custom"==this.options.availableSorts[0]&&(this.options.sortCriteria="nosort")},i.prototype.initBottomAndTopSpacer=function(){var t=this,i=e.$(this.options.paddingContainer).children(".coveo-bottomSpace"),n=e.$(this.options.paddingContainer).children(".coveo-topSpace");this.options.preservePosition&&(e.$(this.options.paddingContainer).mouseleave(function(){return t.unpinFacetPosition()}),this.pinnedTopSpace=n,this.pinnedBottomSpace=i,0==this.pinnedTopSpace.length&&(this.pinnedTopSpace=e.$("<div />").addClass("coveo-topSpace").prependTo(this.options.paddingContainer)),0==this.pinnedBottomSpace.length&&(this.pinnedBottomSpace=e.$("<div />").addClass("coveo-bottomSpace").appendTo(this.options.paddingContainer)))},i.prototype.updateIncludedQueryStateModel=function(){var e={included:this.getSelectedValues(),title:this.includedAttributeId};this.queryStateModel.set(this.includedAttributeId,e.included)},i.prototype.updateExcludedQueryStateModel=function(){var e={title:this.excludedAttributeId,excluded:this.getExcludedValues()};this.queryStateModel.set(this.excludedAttributeId,e.excluded)},i.prototype.updateLookupValueQueryStateModel=function(){if(this.options.lookupField){var t={};e._.each(this.values.getSelected().concat(this.values.getExcluded()),function(e){t[e.value]=e.lookupValue}),this.queryStateModel.set(this.lookupValueAttributeId,t)}},i.prototype.handleQueryStateChangedOperator=function(e){"and"==e?this.switchToAnd():"or"==e&&this.switchToOr()},i.prototype.handleQueryStateChangedIncluded=function(t){var i=e._.difference(this.getSelectedValues(),t);e.Utils.isNonEmptyArray(i)&&this.deselectMultipleValues(i),e.Utils.arrayEqual(this.getSelectedValues(),t,!1)||this.selectMultipleValues(t)},i.prototype.handleQueryStateChangedExcluded=function(t){var i=e._.difference(this.getExcludedValues(),t);e.Utils.isNonEmptyArray(i)&&this.unexcludeMultipleValues(i),e.Utils.arrayEqual(this.getExcludedValues(),t,!1)||this.excludeMultipleValues(t)},i.prototype.handleLookupvalueChanged=function(t){var i=this;e._.each(t,function(e,t){i.facetValuesList.get(decodeURIComponent(t)).facetValue.lookupValue=decodeURIComponent(e)})},i.prototype.handleQueryStateChanged=function(t,i){e.Assert.exists(i),this.ensureDom();var n=i.attributes,o=n[this.includedAttributeId],s=n[this.excludedAttributeId],r=n[this.operatorAttributeId],a=n[this.lookupValueAttributeId];this.listenToQueryStateChange&&(e.Utils.isNullOrEmptyString(r)||this.handleQueryStateChangedOperator(r),e.Utils.isNullOrUndefined(o)||this.handleQueryStateChangedIncluded(o),e.Utils.isNullOrUndefined(s)||this.handleQueryStateChangedExcluded(s),e.Utils.isNullOrUndefined(a)||this.handleLookupvalueChanged(a))},i.prototype.handlePopulateOmnibox=function(t,i){e.Assert.exists(i),e.Assert.exists(i.completeQueryExpression),this.canFetchMore?this.handleOmniboxWithSearchInFacet(i):this.handleOmniboxWithStaticValue(i)},i.prototype.handleOmniboxWithSearchInFacet=function(t){var i=this,n=new RegExp("^"+t.completeQueryExpression.regex.source,"i"),o=e.$.Deferred();t.rows.push({deferred:o});var s=this.facetQueryController.recursiveFacetSearch(t.completeQueryExpression.word,this.options.numberOfValuesInOmnibox);s.done(function(s){var r=e._.map(e._.filter(s,function(e){return n.test(e.lookupValue)}),function(t){return i.values.get(t.lookupValue)||e.FacetValue.create(t)}),a=new e.OmniboxValuesList(i,r,t,e.OmniboxValueElement).build();o.resolve({element:a?a.get(0):void 0,zIndex:i._omniboxZIndex})}),s.fail(function(){o.resolve({element:void 0})})},i.prototype.handleDuringQuery=function(){this.ensureDom(),this.keepDisplayedValuesNextTime||this.fadeInactiveValuesInMainList(this.options.facetSearchDelay)},i.prototype.handleBuildingQuery=function(t,i){if(e.Assert.exists(i),e.Assert.exists(i.queryBuilder),this.facetQueryController.prepareForNewQuery(),this.values.hasSelectedOrExcludedValues()){var n=this.facetQueryController.computeOurFilterExpression();this.logger.trace("Putting filter in query",n),i.queryBuilder.advancedExpression.add(n)}},i.prototype.handleDoneBuildingQuery=function(t,i){e.Assert.exists(i),e.Assert.exists(i.queryBuilder);var n=i.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(n)},i.prototype.handleClearBreadcrumb=function(t,i){e.Assert.exists(i),this.reset()},i.prototype.updateValues=function(t){e.Assert.exists(t),this.keepDisplayedValuesNextTime?this.values.updateCountsFromNewValues(t):(t.importActiveValuesFromOtherList(this.values),t.sortValuesDependingOnStatus(this.numberOfValues),this.values=t),this.updateNumberOfValues()},i.prototype.ensureFacetValueIsInList=function(t){e.Assert.exists(t),this.values.contains(t.value)||this.values.add(t)},i.prototype.isAnyValueCurrentlyDisplayed=function(){return!this.values.isEmpty()},i.prototype.handleEraserClick=function(){var t=this;this.reset(),this.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title})})},i.prototype.buildFacetContent=function(){this.headerElement=this.buildHeader().appendTo(this.element),this.initFacetValuesList(),this.options.enableFacetSearch&&this.initFacetSearch(),this.options.enableMoreLess&&(this.footerElement=this.buildFooter().appendTo(this.element),this._moreElement=this.buildMore().appendTo(this.footerElement),this._lessElement=this._buildLess().appendTo(this.footerElement))},i.prototype.buildHeader=function(){var t=this;this.facetHeader=new e.FacetHeader({facetElement:e.$(this.element),title:this.options.title,icon:this.options.headerIcon,field:this.options.field,enableClearElement:!0,enableCollapseElement:this.options.enableCollapse,facet:this,settingsKlass:this.options.enableSettings?e.FacetSettings:void 0,sortKlass:e.FacetSort,availableSorts:this.options.availableSorts,onEraserClick:function(){t.handleEraserClick()}});var i=this.facetHeader.build();return this.facetSettings=this.facetHeader.settings,this.facetSort=this.facetHeader.sort,i},i.prototype._buildLess=function(){return e.$('<a class="coveo-facet-less">'+e.l("Less")+"</a>").hide().click(e.$.proxy(this.handleClickLess,this))},i.prototype.unpinFacetPosition=function(){var e=this;this.isFacetPinned()&&(this.pinnedTopSpace.animate({height:0},"fast",function(){void 0!=e.facetSearch&&e.facetSearch.positionSearchResults()}),this.pinnedBottomSpace.animate({height:0},"fast",function(){void 0!=e.facetSearch&&e.facetSearch.positionSearchResults()}),this.pinnedViewportPosition=void 0)},i.prototype.isFacetPinned=function(){return e.Utils.exists(this.pinnedViewportPosition)},i.prototype.ensurePinnedFacetHasntMoved=function(){var t=this;if(this.isFacetPinned()){e.Assert.exists(this.pinnedViewportPosition),this.pinnedTopSpace.height(0),this.pinnedBottomSpace.height(0);var i=this.options.scrollContainer==document.body?window:this.options.scrollContainer,n=this.element.getBoundingClientRect().top,o=n-this.pinnedViewportPosition;e.$(i).scrollTop(e.$(i).scrollTop()+o),n=this.element.getBoundingClientRect().top,o=n-this.pinnedViewportPosition,0>o?this.pinnedTopSpace.height(-1*o):setTimeout(function(){var n=t.element.getBoundingClientRect().top,o=n-t.pinnedViewportPosition;e.$(i).scrollTop(e.$(i).scrollTop()+o);for(var s=0,r=0;o>0&&r++<100;)s+=100,t.pinnedBottomSpace.height(s),n=t.element.getBoundingClientRect().top,o=n-t.pinnedViewportPosition,e.$(i).scrollTop(e.$(i).scrollTop()+o)},0)}},i.prototype.buildFooter=function(){return e.$('<div class="coveo-facet-footer"/>')},i.prototype.buildMore=function(){return e.$('<a class="coveo-facet-more">'+e.l("More")+"</a>").click(e.$.proxy(this.handleClickMore,this))},i.prototype.triggerMoreQuery=function(){var t=this;this.logger.info("Triggering new facet more query"),this.showWaitingAnimation(),this.facetQueryController.fetchMore().done(function(i){var n=new e.FacetValues(i.groupByResults[0]);n.importActiveValuesFromOtherList(t.values),n.sortValuesDependingOnStatus(t.numberOfValues),t.values=n,t.nbAvailableValues=t.values.size(),t.updateNumberOfValues(),t.canFetchMore=t.numberOfValues<t.nbAvailableValues,t.values.hasSelectedOrExcludedValues()&&!t.options.useAnd&&t.options.isMultiValueField?t.triggerUpdateDeltaQuery(e._.filter(t.values.getAll(),function(e){return!e.selected&&!e.excluded})):(t.values.hasSelectedOrExcludedValues()&&!t.options.useAnd?(t.values.updateDeltaWithFilteredFacetValues(new e.FacetValues),t.hideWaitingAnimation()):t.hideWaitingAnimation(),t.rebuildValueElements())}).fail(function(){return t.hideWaitingAnimation()})},i.prototype.triggerUpdateDeltaQuery=function(t){var i=this;this.showWaitingAnimation(),this.facetQueryController.searchInFacetToUpdateDelta(t).done(function(t){var n=new e.FacetValues;e._.each(t.groupByResults,function(t){e._.each(t.values,function(t){n.contains(t.value)||n.add(e.FacetValue.createFromGroupByValue(t))})}),i.values.updateDeltaWithFilteredFacetValues(n),i.rebuildValueElements(),i.hideWaitingAnimation()})},i.prototype.updateNumberOfValues=function(){this.currentPage<=0?(this.currentPage=0,this.numberOfValues=0):this.numberOfValues=this.options.numberOfValues+this.currentPage*this.options.pageSize,this.numberOfValues=Math.max(this.numberOfValues,this.getMinimumNumberOfValuesToDisplay())},i.prototype.getMinimumNumberOfValuesToDisplay=function(){var e=this.values.getExcluded().length+this.values.getSelected().length;if(null!=this.options.customSort&&null!=this.facetSort&&this.options.customSort.length>0){var t=-1;this.facetSort.reorderValues(this.values.getAll()).forEach(function(e,i){e.selected&&(t=i)}),e=t+1}return Math.max(e,this.options.numberOfValues)},i.prototype.updateVisibilityBasedOnDependsOn=function(){e.Utils.isNonEmptyString(this.options.dependsOn)&&e.$(this.element).toggleClass("coveo-facet-dependent",!this.doesParentFacetHasSelectedValue()&&!this.values.hasSelectedOrExcludedValues())},i.prototype.doesParentFacetHasSelectedValue=function(){var t=e.QueryStateModel.getFacetId(this.options.dependsOn),i=this.queryStateModel.get(t);return null!=i&&0!=i.length},i.prototype.debugInfo=function(){var e={};return e[this.constructor.ID]={component:this,groupByRequest:this.facetQueryController.lastGroupByRequest,groupByResult:this.facetQueryController.lastGroupByResult},e},i.ID="Facet",i.omniboxIndex=50,i.options={title:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("NoTitle")}),field:e.ComponentOptions.buildFieldOption({required:!0,groupByField:!0}),headerIcon:e.ComponentOptions.buildIconOption(),id:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),isMultiValueField:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),lookupField:e.ComponentOptions.buildFieldOption(),enableSettings:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableSettingsFacetState:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),availableSorts:e.ComponentOptions.buildListOption({defaultValue:["occurrences","score","alphaAscending","alphaDescending"],values:["Occurrences","Score","AlphaAscending","AlphaDescending","ComputedFieldAscending","ComputedFieldDescending","ChiSquare","NoSort"]}),sortCriteria:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||(t.availableSorts.length>0?t.availableSorts[0]:"occurrences")}}),customSort:e.ComponentOptions.buildListOption(),numberOfValues:e.ComponentOptions.buildNumberOption({defaultValue:5,min:0}),injectionDepth:e.ComponentOptions.buildNumberOption({defaultValue:1e3,min:0}),showIcon:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),useAnd:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),allowTogglingOperator:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableFacetSearch:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),facetSearchDelay:e.ComponentOptions.buildNumberOption({defaultValue:100,min:0}),facetSearchIgnoreAccents:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),numberOfValuesInFacetSearch:e.ComponentOptions.buildNumberOption({defaultValue:15,min:1}),includeInBreadcrumb:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),numberOfValuesInBreadcrumb:e.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:5},min:0}),includeInOmnibox:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),numberOfValuesInOmnibox:e.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:5},min:0}),computedField:e.ComponentOptions.buildFieldOption(),computedFieldOperation:e.ComponentOptions.buildStringOption({defaultValue:"sum"}),computedFieldFormat:e.ComponentOptions.buildStringOption({defaultValue:"c0"}),computedFieldCaption:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("ComputedField")}),preservePosition:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),paddingContainer:e.ComponentOptions.buildSelectorOption({defaultFunction:function(e){return e.parentElement}}),scrollContainer:e.ComponentOptions.buildSelectorOption({defaultFunction:function(){return document.body}}),enableMoreLess:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),pageSize:e.ComponentOptions.buildNumberOption({defaultValue:10,min:1}),enableCollapse:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),allowedValues:e.ComponentOptions.buildListOption(),additionalFilter:e.ComponentOptions.buildStringOption(),dependsOn:e.ComponentOptions.buildStringOption()},i}(e.Component);e.Facet=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.prototype.merge=function(t){return e.$.extend({},this,t)},t.prototype.mergeDeep=function(t){return e.$.extend(!0,{},e.Utils.extendDeep(this,t))},t}();e.Options=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.now=new Date,this.useTodayYesterdayAndTomorrow=!0,this.useWeekdayIfThisWeek=!0,this.omitYearIfCurrentOne=!0,this.useLongDateFormat=!1,this.includeTimeIfToday=!0,this.includeTimeIfThisWeek=!0,this.alwaysIncludeTime=!1,this.predefinedFormat=void 0}return __extends(t,e),t}(e.Options),i=function(){function i(){}return i.convertFromJsonDateIfNeeded=function(t){return e._.isDate(t)?t:null===t||isNaN(Number(t))?e._.isString(t)?new Date(t.replace("@"," ")):void 0:new Date(Number(t))},i.keepOnlyDatePart=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},i.offsetDateByDays=function(e,t){var i=new Date(e.valueOf());return i.setDate(i.getDate()+t),i},i.dateToString=function(n,o){if(e.Utils.isNullOrUndefined(n))return"";if(o=(new t).merge(o),e.Utils.isNullOrUndefined(n))return"";var n=i.keepOnlyDatePart(n),s=i.keepOnlyDatePart(o.now),r=i.offsetDateByDays(s,1),a=i.offsetDateByDays(s,-1),l=Math.abs(e.TimeSpan.fromDates(n,s).getDays())<7;return o.predefinedFormat?Globalize.format(n,o.predefinedFormat):o.useTodayYesterdayAndTomorrow&&n.valueOf()==s.valueOf()?e.l("Today"):o.useTodayYesterdayAndTomorrow&&n.valueOf()==a.valueOf()?e.l("Yesterday"):o.useTodayYesterdayAndTomorrow&&n.valueOf()==r.valueOf()?e.l("Tomorrow"):o.useWeekdayIfThisWeek&&l?n.valueOf()>s.valueOf()?e.l("Next")+" "+Globalize.format(n,"dddd"):e.l("Last")+" "+Globalize.format(n,"dddd"):o.omitYearIfCurrentOne&&n.getFullYear()===s.getFullYear()?Globalize.format(n,"M"):o.useLongDateFormat?Globalize.format(n,"D"):Globalize.format(n,"d")},i.timeToString=function(t){return e.Utils.isNullOrUndefined(t)?"":Globalize.format(t,"t")},i.dateTimeToString=function(i,n){if(e.Utils.isNullOrUndefined(i))return"";n=(new t).merge(n);var o=e.DateUtils.keepOnlyDatePart(n.now),s=Math.abs(e.TimeSpan.fromDates(i,o).getDays())<7,r=e.DateUtils.dateToString(i,n),a=e.DateUtils.keepOnlyDatePart(i);return n.alwaysIncludeTime||n.includeTimeIfThisWeek&&s||n.includeTimeIfToday&&a.valueOf()==o.valueOf()?r+", "+e.DateUtils.timeToString(i):r},i.monthToString=function(e){var t=new Date(1980,e);return Globalize.format(t,"MMMM")},i.isValid=function(e){return e instanceof Date?!isNaN(e.getTime()):!1},i.timeBetween=function(t,i){return e.Utils.isNullOrUndefined(t)||e.Utils.isNullOrUndefined(i)?"":("0"+((i.getTime()-t.getTime())/36e5).toFixed()).slice(-2)+":"+("0"+((i.getTime()-t.getTime())%36e5/6e4).toFixed()).slice(-2)+":"+("0"+((i.getTime()-t.getTime())%6e4/1e3).toFixed()).slice(-2)},i}();e.DateUtils=i}(Coveo||(Coveo={})),Date.prototype.toISOString||!function(){function e(e){return 10>e?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();var Coveo;!function(e){var t=function(t){function i(e){t.call(this,e),this.facet=e}return __extends(i,t),i.prototype.createBasicGroupByRequest=function(i,n){void 0===n&&(n=!0);var o=t.prototype.createBasicGroupByRequest.call(this,null,n);return o.allowedValues=void 0,o=e.Utils.isNonEmptyArray(this.facet.options.ranges)?this.buildGroupByQueryForPredefinedRanges(o):this.buildGroupByQueryForAutomaticRanges(o)},i.prototype.createGroupByAllowedValues=function(){return void 0},i.prototype.buildGroupByQueryForAutomaticRanges=function(e){return e.generateAutomaticRanges=!0,e},i.prototype.buildGroupByQueryForPredefinedRanges=function(e){return e.rangeValues=this.facet.options.ranges,e.maximumNumberOfValues=this.facet.options.ranges.length,e},i.prototype.buildGroupByQueryForSelectedAndExcludedValues=function(t){var i=this;return t.rangeValues=e._.map(this.facet.values.getAll(),function(e){var t=e.value.split(".."),n=t[0],o=t[1];return i.facet.options.dateField&&(n=i.getISOFormat(n),o=i.getISOFormat(o)),{start:n,end:o,endInclusive:!0,label:e.lookupValue}}),t},i.prototype.getISOFormat=function(t){if(t){isNaN(t)||(t=Number(t));var i=new Date(t);return e.DateUtils.isValid(i)||(i=new Date(this.getBrowserCompatibleFormat(t)),e.DateUtils.isValid(i))?i.toISOString():(this.facet.logger.error("Cannot parse this date format.",t,new Date(t)),void 0)}return void 0},i.prototype.getBrowserCompatibleFormat=function(e){return e.replace("@","T").replace(/\//g,"-")},i}(e.FacetQueryController);e.FacetRangeQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,i.ID),this.element=n,this.options.enableFacetSearch=!1,this.options.enableSettings=!1,this.options.includeInOmnibox=!1,this.options.enableMoreLess=!1}return __extends(i,t),i.prototype.getValueCaption=function(i){var n=t.prototype.getValueCaption.call(this,i);if(e.Utils.exists(this.options.valueCaption)&&"string"==typeof this.options.valueCaption){var o=/^(.*)\.\.(.*)$/.exec(i.value);if(null!=o){var s=e.TemplateHelpers.getHelper(this.options.valueCaption);if(null!=s)n=s.call(this,o[1])+" - "+s.call(this,o[2]);else{var r=o[1].match(/^[\+\-]?[0-9]+(\.[0-9]+)?$/)?Number(o[1]):e.DateUtils.convertFromJsonDateIfNeeded(o[1]),a=o[2].match(/^[\+\-]?[0-9]+(\.[0-9]+)?$/)?Number(o[2]):e.DateUtils.convertFromJsonDateIfNeeded(o[2]);n=Globalize.format(r,this.options.valueCaption)+" - "+Globalize.format(a,this.options.valueCaption)}}}return n},i.prototype.initFacetQueryController=function(){this.facetQueryController=new e.FacetRangeQueryController(this)},i.prototype.processNewGroupByResults=function(e){var i=this;null!=e&&(null!=this.options.ranges||this.keepDisplayedValuesNextTime&&!this.values.hasSelectedOrExcludedValues()||(this.keepDisplayedValuesNextTime=!1,e.values.sort(function(e,t){var n=e.value.split(".."),o=t.value.split("..");return i.options.dateField?Date.parse(n[0])-Date.parse(o[0]):Number(n[0])-Number(o[0])}))),t.prototype.processNewGroupByResults.call(this,e)},i.ID="FacetRange",i.parent=e.Facet,i.options={dateField:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Facet);e.FacetRange=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e,t){this.element=e,this.options=t,this.steps=[],this.options.dateField&&(this.options.start=new Date(this.options.start).getTime(),this.options.end=new Date(this.options.end).getTime()),void 0==this.options.rounded&&(this.options.rounded=0),(this.options.steps||this.options.getSteps)&&this.buildSteps(),this.options.graph&&(this.sliderGraph=new r(this)),this.sliderLine=new i(this),this.sliderLine.build().appendTo(this.element),this.options.rangeSlider?(this.sliderRange=new o(this),this.sliderRange.build().appendTo(this.element)):(this.sliderButton=new n(this,1),this.sliderButton.build().addClass("coveo-no-range-button").appendTo(this.element),this.sliderLine.setActiveWidth(this.sliderButton)),this.sliderCaption=new s(this),this.sliderCaption.build().appendTo(this.element)}return e.prototype.onMoving=function(){this.options.rangeSlider?(this.sliderRange.setBoundary(),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):this.sliderLine.setActiveWidth(this.sliderButton),this.options.graph&&this.sliderGraph.draw(),this.displayCaption()},e.prototype.initializeState=function(e){void 0===e&&(e=[this.options.start,this.options.end]),this.currentValues=e,this.options.rangeSlider?(this.sliderRange.initializeSliderRangeState(e),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(void 0==e?this.sliderButton.toEnd():this.sliderButton.setValue(e[1]),this.sliderButton.leftBoundary=0,this.sliderButton.rightBoundary=this.element.width(),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.getPosition=function(){return this.options.rangeSlider?this.sliderRange.getPosition():[0,this.sliderButton.getPosition()]},e.prototype.getPercentPosition=function(){return this.options.rangeSlider?this.sliderRange.getPercentPosition():[0,this.sliderButton.getPercent()]},e.prototype.getValues=function(){return void 0!=this.currentValues?this.currentValues:this.options.rangeSlider?this.sliderRange.getValue():[this.options.start,this.sliderButton.getValue()]},e.prototype.getCaptionFromValue=function(e){return this.sliderCaption.getCaptionFromValues(e)},e.prototype.getCaption=function(){return this.sliderCaption.getCaption()},e.prototype.setValues=function(e){void 0!=e&&(e[0]=Math.max(e[0],this.options.start),e[1]=Math.min(e[1],this.options.end)),this.currentValues=e,this.options.rangeSlider?(this.sliderRange.setValue(e),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(this.sliderButton.setValue(e[1]),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.drawGraph=function(e){this.sliderGraph.draw(e)},e.prototype.displayCaption=function(){void 0!=this.options.valueCaption?this.sliderCaption.setFromString(this.options.valueCaption(this.getValues())):void 0!=this.options.percentCaption?this.sliderCaption.setFromString(this.options.percentCaption(this.getPercentPosition())):void 0!=this.options.displayAsPercent&&void 0!=this.options.displayAsPercent.separator&&this.options.displayAsPercent.enable?this.sliderCaption.setAsPercent():this.sliderCaption.setAsValue()},e.prototype.buildSteps=function(){if(this.options.getSteps)this.steps=this.options.getSteps(this.options.start,this.options.end);else{var e=(this.options.end-this.options.start)/Math.max(1,this.options.steps);if(e>0)for(var t=this.options.start;t<=this.options.end;)this.steps.push(t),t+=e;else this.steps.push(this.options.start),this.steps.push(this.options.end)}},e}();e.Slider=t;var i=function(){function t(e){this.slider=e}return t.prototype.build=function(){return this.backGround=e.$("<div class='coveo-slider-line coveo-background'></div>"),this.activePart=e.$("<div class='coveo-slider-line coveo-active'></div>"),this.backGround.add(this.activePart)},t.prototype.setActiveWidth=function(e,t){if(this.slider.options.rangeSlider){var i=100*(t.getPercent()-e.getPercent());this.activePart.css({width:i+"%",left:100*e.getPercent()+"%",right:100*t.getPercent()+"%"})}else{var i=100*e.getPercent();this.activePart.css({width:i+"%"})}},t}(),n=function(){function t(t,i){this.slider=t,this.which=i,this.eventMouseDown=e.DeviceUtils.isMobileDevice()?"touchstart":"mousedown",this.eventMouseMove=e.DeviceUtils.isMobileDevice()?"touchmove":"mousemove",this.eventMouseUp=e.DeviceUtils.isMobileDevice()?"touchend":"mouseup"}return t.prototype.build=function(){return this.element=e.$("<div class='coveo-slider-button'></div>"),this.bindEvents(),this.element.get(0).CoveoSliderButton=this,this.element},t.prototype.toBeginning=function(){this.element.css({left:"0%"})},t.prototype.toEnd=function(){this.slider.element.width();this.element.css({left:"100%"})},t.prototype.setValue=function(e){var t=this.fromValueToPercent(e);this.element.css("left",Math.round(100*t)+"%")},t.prototype.getPosition=function(){var e=this.element.css("left");return-1!=e.indexOf("%")?parseFloat(e)/100*this.slider.element.width():parseFloat(e)},t.prototype.getPercent=function(e){return void 0===e&&(e=this.getPosition()),0==this.slider.element.width()?0:+(e/this.slider.element.width()).toFixed(2)},t.prototype.getValue=function(){var e=this.getPercent()*(this.slider.options.end-this.slider.options.start)+this.slider.options.start;return e},t.prototype.fromValueToPercent=function(e){return 1-(this.slider.options.end-e)/(this.slider.options.end-this.slider.options.start)},t.prototype.fromPositionToValue=function(e){var t=this.getPercent(e);return this.slider.options.start+t*(this.slider.options.end-this.slider.options.start)},t.prototype.fromValueToPosition=function(e){var t=this.fromValueToPercent(e);return this.slider.element.width()*t},t.prototype.bindEvents=function(){var t=this;e.$(this.element).on(this.eventMouseDown,function(e){t.handleStartSlide(e)});var i=this.slider.options.document||document;e.$(i).on(this.eventMouseMove,function(e){"touchmove"==t.eventMouseMove&&t.isMouseDown&&e.preventDefault(),t.handleMoving(e)}),e.$(i).on(this.eventMouseUp,function(e){t.handleEndSlide(e)})},t.prototype.handleStartSlide=function(t){var i=this.getMousePosition(t);this.isMouseDown=!0,this.startPositionX=i.x,this.lastElementLeft=this.element.css("left"),this.origUserSelect=e.$("body").css("user-select"),this.origCursor=e.$("body").css("cursor"),e.$("body").css("user-select","none"),e.$("body").css("cursor","pointer"),e.$(this.element).addClass("coveo-active"),e.$(this.element).trigger(e.SliderEvents.startSlide,{button:this,slider:this.slider})},t.prototype.handleMoving=function(t){this.isMouseDown&&(this.updatePosition(t),this.slider.onMoving(),this.handleButtonNearEnd(),this.element.trigger(e.SliderEvents.duringSlide,{button:this,slider:this.slider}))},t.prototype.handleEndSlide=function(){this.isMouseDown&&(e.$("body").css("user-select",this.origUserSelect),e.$("body").css("cursor",this.origCursor),e.$(this.element).removeClass("coveo-active"),this.element.trigger(e.SliderEvents.endSlide,{button:this,slider:this.slider})),this.isMouseDown=!1},t.prototype.handleButtonNearEnd=function(){0==this.which&&(void 0==this.origZIndex&&(this.origZIndex=this.element.css("z-index")),this.currentPos>90?this.element.css("z-index",this.origZIndex+1):this.element.css("z-index",this.origZIndex))},t.prototype.getMousePosition=function(e){var t=0,i=0;return"touchmove"==this.eventMouseMove?(t=e.originalEvent.touches[0].pageX,i=e.originalEvent.touches[0].pageY):e.pageX||e.pageY?(t=e.pageX,i=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:i}},t.prototype.updatePosition=function(e){var t=this.getMousePosition(e),i=t.x-this.startPositionX;if(this.currentPos=parseInt(this.lastElementLeft,10)+i,this.slider.options.steps||this.slider.options.getSteps){var n=this.snapToStep(i);
this.currentPos=n.position;var o=n.value}this.currentPos=Math.max(this.leftBoundary,this.currentPos),this.currentPos=Math.min(this.rightBoundary,this.currentPos),this.currentPos=100*this.getPercent(this.currentPos),this.currentPos=Math.min(this.currentPos,100),this.currentPos=Math.max(this.currentPos,0),this.element.css("left",Math.round(this.currentPos)+"%"),this.slider.currentValues[this.which]=this.slider.options.steps||this.slider.options.getSteps?o:this.getValue()},t.prototype.snapToStep=function(){var t=this,i=e._.map(this.slider.steps,function(e,i){return Math.abs(t.currentPos-t.fromValueToPosition(t.slider.steps[i]))}),n=e._.map(this.slider.steps,function(e,i){return Math.abs(t.rightBoundary-t.fromValueToPosition(t.slider.steps[i]))}),o=e._.map(this.slider.steps,function(e,i){return Math.abs(t.leftBoundary-t.fromValueToPosition(t.slider.steps[i]))}),s=e._.min(i),r=e._.min(n),a=e._.min(o),l=this.slider.steps[e._.indexOf(i,s)],u=this.slider.steps[e._.indexOf(n,r)],c=this.slider.steps[e._.indexOf(o,a)];return l=Math.min(l,u),l=Math.max(l,c),{position:this.fromValueToPosition(l),value:l}},t}();e.SliderButton=n;var o=function(){function e(e){this.slider=e,this.firstButton=new n(e,0),this.secondButton=new n(e,1)}return e.prototype.build=function(){var e=this.firstButton.build(),t=this.secondButton.build().addClass("coveo-range-button");return e.add(t)},e.prototype.initializeSliderRangeState=function(e){void 0==e?(this.firstButton.toBeginning(),this.secondButton.toEnd()):(this.firstButton.setValue(e[0]),this.secondButton.setValue(e[1])),this.setBoundary()},e.prototype.setValue=function(e){this.firstButton.setValue(e[0]),this.secondButton.setValue(e[1])},e.prototype.setBoundary=function(){this.firstButton.leftBoundary=0,this.firstButton.rightBoundary=this.secondButton.getPosition(),this.secondButton.leftBoundary=this.firstButton.getPosition(),this.secondButton.rightBoundary=this.slider.element.width()},e.prototype.getPosition=function(){return[this.firstButton.getPosition(),this.secondButton.getPosition()]},e.prototype.getPercentPosition=function(){return[this.firstButton.getPercent(),this.secondButton.getPercent()]},e.prototype.getValue=function(){return[this.firstButton.getValue(),this.secondButton.getValue()]},e}(),s=function(){function t(e){this.slider=e,this.separator="-",this.unitSign="",this.slider.options.displayAsPercent&&this.slider.options.displayAsPercent.enable?this.separator=void 0!=this.slider.options.displayAsPercent.separator?this.slider.options.displayAsPercent.separator:this.separator:this.slider.options.displayAsValue&&this.slider.options.displayAsValue.enable&&(this.separator=void 0!=this.slider.options.displayAsValue.separator?this.slider.options.displayAsValue.separator:this.separator,this.unitSign=void 0!=this.slider.options.displayAsValue.unitSign?this.slider.options.displayAsValue.unitSign:this.unitSign)}return t.prototype.build=function(){return this.caption=e.$("<div class='coveo-slider-caption'></div>"),this.caption},t.prototype.getCaption=function(){return this.caption.text()},t.prototype.getCaptionFromValues=function(e){return this.getValueCaption(e)},t.prototype.getCaptionFromValuesAsPercent=function(e){return this.getValueCaption(e)},t.prototype.setAsValue=function(){this.caption.text(this.getValueCaption())},t.prototype.setAsPercent=function(){var e=this.slider.getPercentPosition();this.caption.text([(100*e[0]).toFixed(this.slider.options.rounded),"%",this.separator,(100*e[1]).toFixed(this.slider.options.rounded),"%"].join(" "))},t.prototype.setFromString=function(e){this.caption.text(e)},t.prototype.getValueCaption=function(e){void 0===e&&(e=this.slider.getValues());var t=e[0],i=e[1];if(this.slider.options.dateField){var n=new Date(t),o=new Date(i);n.setHours(0,0,0,0),o.setHours(0,0,0,0),t=Globalize.format(n,this.slider.options.dateFormat||"MMM dd, yyyy"),i=Globalize.format(o,this.slider.options.dateFormat||"MMM dd, yyyy"),this.unitSign=""}else t=t.toFixed(this.slider.options.rounded),i=i.toFixed(this.slider.options.rounded);return[t,this.unitSign,this.separator,i,this.unitSign].join(" ")},t}(),r=function(){function t(t){var i=this;this.slider=t,this.svg=d3.select(t.element.get(0)).append("svg").append("g"),this.x=d3.scale.ordinal(),this.y=d3.scale.linear(),this.slider.options.graph.margin=e.Utils.extendDeep({top:20,right:0,left:0,bottom:20},this.slider.options.graph.margin||{}),this.slider.options.graph.animationDuration=this.slider.options.graph.animationDuration||500,e.$(window).resize(function(){i.draw()}),this.tooltip=e.$("<div></div>").css({display:"none"}).addClass("coveo-slider-tooltip"),this.slider.element.append(this.tooltip),this.slider.options.graph.steps=this.slider.options.graph.steps||10}return t.prototype.draw=function(e){if(void 0===e&&(e=this.oldData),e){var t=this.slider.element.outerWidth(),i=this.slider.element.outerHeight(),n=t-this.slider.options.graph.margin.left-this.slider.options.graph.margin.right,o=i-this.slider.options.graph.margin.top-this.slider.options.graph.margin.bottom;this.applyTransformOnSvg(n,o),this.setXAndYRange(n,o),this.setXAndYDomain(e);var s=this.svg.selectAll(".coveo-bar").data(e),r=this.slider.getValues();this.renderGraphBars(s,n,o,r),this.setGraphBarsTransition(s,o,r),this.oldData=e}},t.prototype.setXAndYRange=function(e,t){this.x.rangeBands([0,e],.2,0),this.y.range([t-this.slider.options.graph.margin.top,0])},t.prototype.setXAndYDomain=function(t){this.padGraphWithEmptyData(t),this.x.domain(e._.map(t,function(e){return e.start})),this.y.domain([0,d3.max(t,function(e){return e.y})])},t.prototype.padGraphWithEmptyData=function(e){var t=e[0].end-e[0].start;0!=t&&(this.padBeginningOfGraphWithEmptyData(e,t),this.padEndOfGraphWithEmptyData(e,t))},t.prototype.padBeginningOfGraphWithEmptyData=function(e,t){if(e[0].start>this.slider.options.start)for(var i=e[0].start-this.slider.options.start,n=Math.round(i/t),o=e[0].start,s=n;s>0;s--)e.unshift({start:o-t,end:o,y:0}),o-=t},t.prototype.padEndOfGraphWithEmptyData=function(e,t){var i=e.length-1;if(e[i].end<this.slider.options.end)for(var n=this.slider.options.end-e[i].end,o=Math.round(n/t),s=e[i].end,r=0;o>r;r++)e.push({start:s,end:s+t,y:0}),s+=t},t.prototype.applyTransformOnSvg=function(t,i){e.$(this.slider.element).find("svg").attr("width",t).attr("height",i),this.svg.attr("transform","translate("+this.slider.options.graph.margin.left+","+this.slider.options.graph.margin.top+")")},t.prototype.renderGraphBars=function(e,t,i,n){e.enter().append("rect").attr("class",this.getFunctionForClass(n)).attr("width",this.x.rangeBand()).attr("height",this.getFunctionForHeight(i)).attr("x",this.getFunctionForX()).attr("y",this.getFunctionForY()).on("click",this.getFunctionForClick()).on("mouseover",this.getFunctionForMouseOver(i)).on("mouseout",this.getFunctionForMouseOut())},t.prototype.setGraphBarsTransition=function(e,t,i){e.transition().attr("x",this.getFunctionForX()).attr("width",this.x.rangeBand()).attr("class",this.getFunctionForClass(i)).transition().duration(this.slider.options.graph.animationDuration).attr("y",this.getFunctionForY()).attr("height",this.getFunctionForHeight(t))},t.prototype.getBarClass=function(e,t,i){return t.start>=e[0]&&t.end<=e[1]?"coveo-active":e[0]==this.slider.options.start&&0==i?"coveo-active":e[1]==this.slider.options.end&&i==this.slider.options.graph.steps-1?"coveo-active":""},t.prototype.setTooltip=function(e,t){this.tooltip.html("<span class='coveo-caption'>"+this.slider.getCaptionFromValue([e.start,e.end])+"</span><span class='coveo-count'>"+e.y+"</span>"),this.tooltip.css({display:"block",left:this.x(e.start)-.2*this.slider.options.graph.steps,top:this.y(e.y)-t})},t.prototype.getFunctionForX=function(){var e=this;return function(t){return e.x(t.start)}},t.prototype.getFunctionForY=function(){var e=this;return function(t){return e.y(t.y)}},t.prototype.getFunctionForHeight=function(e){var t=this;return function(i){return e-t.y(i.y)}},t.prototype.getFunctionForClass=function(e){var t=this;return function(i,n){return"coveo-bar "+t.getBarClass(e,i,n)}},t.prototype.getFunctionForClick=function(){var t=this;return function(i){t.slider.element.trigger(e.SliderEvents.graphValueSelected,{start:i.start,end:i.end,value:i.y})}},t.prototype.getFunctionForMouseOver=function(e){var t=this;return function(i){d3.event.clientX,d3.event.clientY;t.setTooltip(i,e)}},t.prototype.getFunctionForMouseOut=function(){var e=this;return function(){e.tooltip.css("display","none")}},t}()}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){var i=this;this.facet=t,this.facet.bind.onRoot(e.QueryEvents.querySuccess,function(e,t){return i.handleQuerySuccess(e,t)})}return t.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0},t.prototype.putGroupByIntoQueryBuilder=function(e){this.facet.options.graph&&this.putGroupByForGraphIntoQueryBuilder(e),this.putGroupByForSliderIntoQueryBuilder(e)},t.prototype.createBasicGroupByRequest=function(e,t){void 0===t&&(t=!0);var i={field:this.facet.options.field,completeFacetWithStandardValues:!0};return i.allowedValues=void 0,i=this.facet.options.graph?this.buildGroupByQueryForSlider(i):this.buildGroupByQueryForAutomaticRanges(i)},t.prototype.computeOurFilterExpression=function(t){void 0===t&&(t=[this.facet.startOfSlider,this.facet.endOfSlider]);var i=new e.ExpressionBuilder;return void 0!=t[0]&&void 0!=t[1]&&(this.facet.options.excludeOuterBounds?this.addFilterExpressionWithOuterBoundsExcluded(t[0],t[1],i):this.addFilterExpressionWithOuterBoundsIncluded(t[0],t[1],i)),i.build()},t.prototype.handleQuerySuccess=function(t,i){var n=this;if(this.facet.options&&this.facet.options.graph&&void 0==this.rangeValuesForGraphToUse){this.rangeValuesForGraphToUse=[];var o=i.results.groupByResults[this.graphGroupByQueriesIndex].values;e._.each(o,function(e){var t=e.value.split("..");n.rangeValuesForGraphToUse.push({start:n.facet.options.dateField?n.getISOFormat(t[0].replace("@"," ")):parseInt(t[0],10),end:n.facet.options.dateField?n.getISOFormat(t[1].replace("@"," ")):parseInt(t[1],10)})})}},t.prototype.addFilterExpressionWithOuterBoundsIncluded=function(e,t,i){(e!=this.facet.options.start||t!=this.facet.options.end)&&(this.facet.options.dateField&&(e=this.getFilterDateFormat(e),t=this.getFilterDateFormat(t)),i.addFieldExpression(this.facet.options.field,"==",[e+".."+t]))},t.prototype.addFilterExpressionWithOuterBoundsExcluded=function(e,t,i){var n=this.facet.options.start,o=this.facet.options.end,s=e,r=t;this.facet.options.dateField?(s=this.getFilterDateFormat(e),r=this.getFilterDateFormat(t),n=this.getFilterDateFormat(n),o=this.getFilterDateFormat(o)):(s+="",r+="",n+="",o+=""),s!=n&&r==o?i.addFieldExpression(this.facet.options.field,">=",[s]):s==n&&r!=o?i.addFieldExpression(this.facet.options.field,"<=",[r]):this.addFilterExpressionWithOuterBoundsIncluded(e,t,i)},t.prototype.buildGroupByQueryForSlider=function(e){if(void 0!=this.facet.options.start&&void 0!=this.facet.options.end){var t=this.facet.options.start,i=this.facet.options.end;return(this.facet.options.dateField||this.facet.options.dateField)&&(t=this.getISOFormat(t),i=this.getISOFormat(i)),e.rangeValues=[{start:t,end:i,endInclusive:!0,label:"Slider"}],e}return this.buildGroupByQueryForAutomaticRanges(e)},t.prototype.buildGroupByQueryForAutomaticRanges=function(e){return e.generateAutomaticRanges=!0,e},t.prototype.putGroupByForGraphIntoQueryBuilder=function(e){this.graphGroupByQueriesIndex=e.groupByRequests.length;var t=this.createBasicGroupByRequest();if(t.rangeValues){var i=t.rangeValues[0];t.rangeValues=this.createRangeValuesForGraph(i)}var n=this.computeOurFilterExpression(this.facet.getSliderBoundaryForQuery());if(void 0!=n){var o=e.computeCompleteExpressionPartsExcept(n);t.queryOverride=o.withoutConstant,t.constantQueryOverride=o.constant,void 0==t.queryOverride?t.queryOverride=this.facet.options.queryOverride||"@sysuri":t.queryOverride+=this.facet.options.queryOverride?" "+this.facet.options.queryOverride:""}else if(null!=this.facet.options.queryOverride){var s=e.computeCompleteExpression();t.queryOverride=(null!=s?s+" ":"")+this.facet.options.queryOverride}t.sortCriteria="nosort",t.maximumNumberOfValues=this.facet.options.graph.steps,e.groupByRequests.push(t)},t.prototype.putGroupByForSliderIntoQueryBuilder=function(e){this.lastGroupByRequestIndex=e.groupByRequests.length;var t=this.createBasicGroupByRequest();t.maximumNumberOfValues=null!=this.facet.options.graph?this.facet.options.graph.steps||1:1,t.queryOverride=this.facet.options.queryOverride||"@sysuri",t.sortCriteria="nosort",t.generateAutomaticRanges=!0,t.rangeValues=void 0,e.groupByRequests.push(t)},t.prototype.createRangeValuesForGraph=function(e){return void 0==this.facet.options.graph.steps&&(this.facet.options.graph.steps=10),this.facet.options.dateField&&isNaN(this.facet.options.start)&&(this.facet.options.start=new Date(this.facet.options.start).getTime()),this.facet.options.dateField&&isNaN(this.facet.options.end)&&(this.facet.options.end=new Date(this.facet.options.end).getTime()),void 0!=this.rangeValuesForGraphToUse?this.usePrebuiltRange(e):this.buildRange(e)},t.prototype.usePrebuiltRange=function(t){return e._.map(this.rangeValuesForGraphToUse,function(e){return{start:e.start,end:e.end,endInclusive:t.endInclusive,label:t.label}})},t.prototype.buildRange=function(t){var i=this,n=this.facet.options.start,o=(this.facet.options.end,(this.facet.options.end-this.facet.options.start)/this.facet.options.graph.steps);return e._.map(e._.range(0,this.facet.options.graph.steps,1),function(e){var s=n+e*o,r=n+(e+1)*o;return i.facet.options.dateField&&(s=i.getISOFormat(s),r=i.getISOFormat(r)),{endInclusive:t.endInclusive,label:t.label,start:s,end:r}})},t.prototype.getISOFormat=function(t){if(t){isNaN(t)||(t=Number(t));var i=new Date(t);return e.DateUtils.isValid(i)||(i=new Date(this.getBrowserCompatibleFormat(t)),e.DateUtils.isValid(i))?i.toISOString():(this.facet.logger.error("Cannot parse this date format.",t,new Date(t)),void 0)}return void 0},t.prototype.getFilterDateFormat=function(e){return e?this.getISOFormat(e).replace("T","@").replace(".000Z","").replace(/-/g,"/"):void 0},t.prototype.getBrowserCompatibleFormat=function(e){return e.replace("@","T").replace(/\//g,"-")},t}();e.FacetSliderQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.startSlide="startSlide",e.duringSlide="duringSlide",e.endSlide="endSlide",e.graphValueSelected="graphValueSelected",e}();e.SliderEvents=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}e.supportSVG=t}(t=e.FeatureDetectionUtils||(e.FeatureDetectionUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.isEmpty=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null==this.options.excludeOuterBounds&&(this.options.excludeOuterBounds=!1),this.options.start&&(this.options.start=this.options.dateField?new Date(this.options.start.replace(/-/g,"/")).getTime():Number(this.options.start)),this.options.end&&(this.options.end=this.options.dateField?new Date(this.options.end.replace(/-/g,"/")).getTime():Number(this.options.end)),this.hasAGraph()&&(e.FeatureDetectionUtils.supportSVG()||(this.options.graph=void 0,this.logger.info("Your browser does not support SVG. Cannot add graphic to your facet range",this)),"undefined"==typeof d3&&(this.options.graph=void 0,this.logger.info("Cannot find the required dependencies d3.js. Cannot add graphic to your facet range",this))),this.facetQueryController=new e.FacetSliderQueryController(this),this.initQueryStateEvents(),this.bind.onRoot(e.QueryEvents.newQuery,function(){return r.handleNewQuery()}),this.bind.onRoot(e.QueryEvents.noResults,function(){return r.handleNoresults()}),this.bind.onRoot(e.QueryEvents.deferredQuerySuccess,function(e,t){return r.handleDeferredQuerySuccess(e,t)}),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.onRoot(e.QueryEvents.doneBuildingQuery,function(e,t){return r.handleDoneBuildingQuery(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,function(e,t){return r.handlePopulateBreadcrumb(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,function(){return r.reset()})}return __extends(i,t),i.prototype.createDom=function(){var t=this;this.facetHeader=new e.FacetHeader({field:this.options.field,facetElement:e.$(this.element),title:this.options.title,enableClearElement:!0,enableCollapseElement:!0,onEraserClick:function(){t.reset(),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title}),t.queryController.executeQuery()}}),this.facetHeader.build().appendTo(this.element)},i.prototype.reset=function(){this.slider.initializeState(),this.updateQueryState(),this.updateAppearanceDependingOnState()},i.prototype.getSelectedValues=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider?[this.startOfSlider.toString(),this.endOfSlider.toString()]:["undefined","undefined"]},i.prototype.getSliderBoundaryForQuery=function(){var e=!1;return this.slider?this.slider&&this.sliderIsActive()&&(e=!0):e=!0,e?this.generateBoundary():void 0},i.prototype.handleNoresults=function(){this.isEmpty=!0,this.updateAppearanceDependingOnState()},i.prototype.handleNewQuery=function(){this.isEmpty=!1},i.prototype.handleRangeQueryStateChanged=function(e,t){this.setupSliderIfNeeded(t),this.startOfSlider=void 0==t.value[0]?this.startOfSlider:t.value[0],this.endOfSlider=void 0==t.value[1]?this.endOfSlider:t.value[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},i.prototype.handlePopulateBreadcrumb=function(t,i){var n=this,o=function(){n.sliderIsActive()&&i.breadcrumbs.push({element:n.buildBreadcrumbFacetSlider().get(0)})};this.slider?o():e.$(this.root).one(e.QueryEvents.deferredQuerySuccess,function(){o(),e.$(n.root).trigger(e.BreadcrumbEvents.redrawBreadcrumb)})},i.prototype.sliderIsActive=function(){return!(isNaN(this.startOfSlider)||isNaN(this.endOfSlider)||isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)||this.startOfSlider==this.initialStartOfSlider&&this.endOfSlider==this.initialEndOfSlider)},i.prototype.buildBreadcrumbFacetSlider=function(){var t=this,i=e.$("<div/>").addClass("coveo-facet-slider-breadcrumb");e.$("<span/>").addClass("coveo-facet-slider-breadcrumb-title").text(this.options.title+":").appendTo(i);{var n=e.$("<span/>").addClass("coveo-facet-slider-breadcrumb-values").appendTo(i),o=e.$("<span class='coveo-facet-slider-breadcrumb-value'>"+this.slider.getCaption()+"</span>").appendTo(n);e.$("<span class='coveo-facet-slider-breadcrumb-clear'></span>").appendTo(o)}return o.click(function(){t.reset(),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title}),t.queryController.executeQuery()}),i},i.prototype.initSlider=function(){this.buildSlider(),this.slider.initializeState([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},i.prototype.initQueryStateEvents=function(){var t=this;this.rangeQueryStateAttribute=e.QueryStateModel.getFacetId(this.options.id)+":range",this.queryStateModel.registerNewAttribute(this.rangeQueryStateAttribute,[void 0,void 0]);var i=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+this.rangeQueryStateAttribute);this.bind.onRoot(i,function(e,i){t.slider?t.handleRangeQueryStateChanged(e,i):t.setRangeStateSliderStillNotCreated(e,i)})},i.prototype.setRangeStateSliderStillNotCreated=function(e,t){this.rangeFromUrlState=this.copyValues(t.value)},i.prototype.buildSlider=function(){var t=this,i=e.$("<div class='coveo-facet-values coveo-slider-container'></div>");this.hasAGraph()&&i.addClass("coveo-with-graph");var n=e.$("<div></div>");this.slider=new e.Slider(n,e.$.extend({},this.options,{dateField:this.options.dateField})),n.on(e.SliderEvents.endSlide,function(e,i){t.handleEndSlide(e,i)}),n.on(e.SliderEvents.duringSlide,function(e,i){t.handleDuringSlide(e,i)}),this.hasAGraph()&&n.on(e.SliderEvents.graphValueSelected,function(e,i){t.handleGraphValueSelected(e,i)}),i.append(n),e.$(this.element).append(i),this.updateAppearanceDependingOnState()},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),e.Assert.exists(i.queryBuilder);var n=this.getSliderBoundaryForQuery();if(void 0!=n){this.facetQueryController.prepareForNewQuery();var o=this.facetQueryController.computeOurFilterExpression(n);e.Utils.isNonEmptyString(o)&&(this.logger.trace("Putting filter in query",o),i.queryBuilder.advancedExpression.add(o))}},i.prototype.handleDoneBuildingQuery=function(e,t){var i=t.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(i)},i.prototype.handleDeferredQuerySuccess=function(e,t){this.ensureDom(),this.setupSliderIfNeeded(t);var i=t.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];(void 0==i||void 0==i.values[0])&&(this.isEmpty=!0),this.hasAGraph()&&this.renderToSliderGraph(t),this.updateAppearanceDependingOnState()},i.prototype.handleEndSlide=function(t,i){var n=i.slider.getValues();this.startOfSlider=n[0],this.endOfSlider=n[1],this.updateQueryState(n)&&(this.updateAppearanceDependingOnState(),this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetRangeSlider,{facetId:this.options.id,facetRangeStart:this.startOfSlider.toString(),facetRangeEnd:this.endOfSlider.toString()}),this.queryController.executeQuery())},i.prototype.handleDuringSlide=function(e,t){var i=t.slider.getValues();this.startOfSlider=i[0],this.endOfSlider=i[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},i.prototype.handleGraphValueSelected=function(t,i){(this.options.rangeSlider&&this.startOfSlider!=i.start||this.endOfSlider!=i.end)&&(this.options.rangeSlider&&(this.startOfSlider=i.start),this.endOfSlider=i.end,this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateQueryState(),this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.facetRangeGraph,{facetId:this.options.id,facetRangeStart:this.startOfSlider.toString(),facetRangeEnd:this.endOfSlider.toString()}),this.queryController.executeQuery())},i.prototype.updateQueryState=function(e,t){void 0===e&&(e=this.slider.getValues()),void 0===t&&(t=!1);var i=this.copyValues(e),n=e[0]+0,o=e[1]+0,s=this.queryStateModel.get(this.rangeQueryStateAttribute);return null==s||i[0]!=s[0]||i[1]!=s[1]?(i[0]=n,i[1]=o,this.queryStateModel.set(this.rangeQueryStateAttribute,i,{silent:t}),!0):!1},i.prototype.copyValues=function(e){var t=[];return t[0]=Number(e[0])+0,t[1]=Number(e[1])+0,t},i.prototype.renderToSliderGraph=function(t){var i,n=this,o=t.results.groupByResults[this.facetQueryController.graphGroupByQueriesIndex],s=0;o&&(i=e._.map(o.values,function(e){s+=e.numberOfResults;var t=e.value.split("..")[0],i=e.value.split("..")[1];n.options.dateField?(t=new Date(t.split("@")[0]).getTime(),i=new Date(i.split("@")[0]).getTime()):(t=Number(t),i=Number(i));var o=e.numberOfResults;return{start:t,y:o,end:i,isDate:n.options.dateField}})),0==s?(this.isEmpty=!0,this.updateAppearanceDependingOnState()):void 0!=i&&this.slider.drawGraph(i)},i.prototype.generateBoundary=function(){if(this.slider){var e=this.generateBoundaryFromSlider();return void 0==e[0]&&void 0==e[1]?this.generateBoundaryFromState():e}return this.generateBoundaryFromState()},i.prototype.generateBoundaryFromSlider=function(){var e,t;return void 0!=this.startOfSlider&&(e=this.startOfSlider),void 0!=this.endOfSlider&&(t=this.endOfSlider),[e,t]},i.prototype.generateBoundaryFromState=function(){var e,t,i=this.queryStateModel.get(this.rangeQueryStateAttribute)[0];void 0!=i&&(e=i);var n=this.queryStateModel.get(this.rangeQueryStateAttribute)[1];return void 0!=n&&(t=n),e!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[0]||t!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[1]?[e,t]:[void 0,void 0]},i.prototype.setupSliderIfNeeded=function(t){if(this.ensureDom(),e.Utils.isNullOrUndefined(this.slider)){this.alreadySetBoundary()||this.trySetSliderBoundaryFromOptions(),this.alreadySetBoundary()||void 0==t||this.trySetSliderBoundaryFromQueryResult(t),this.trySetSliderBoundaryFromState(),this.setupSliderStateVariables();var i=this.verifySetup();i?this.logger.warn("Unable to initialize slider with current values",this):(this.initSlider(),this.updateQueryState())}},i.prototype.verifySetup=function(){var e=0;return e+=void 0==this.initialStartOfSlider?1:0,e+=isNaN(this.initialStartOfSlider)?1:0,e+=void 0==this.initialEndOfSlider?1:0,e+=isNaN(this.initialEndOfSlider)?1:0},i.prototype.setupSliderStateVariables=function(){isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)?this.logger.warn("Cannnot initialize slider with those values : start: "+this.initialStartOfSlider+" end: "+this.initialEndOfSlider):(this.initialStartOfSlider=Number(this.initialStartOfSlider),this.initialEndOfSlider=Number(this.initialEndOfSlider),this.startOfSlider=void 0!=this.startOfSlider?Number(this.startOfSlider):this.initialStartOfSlider,this.endOfSlider=void 0!=this.endOfSlider?Number(this.endOfSlider):this.initialEndOfSlider,this.options.start=this.initialStartOfSlider,this.options.end=this.initialEndOfSlider,this.queryStateModel.setNewDefault(this.rangeQueryStateAttribute,[this.initialStartOfSlider,this.initialEndOfSlider]))},i.prototype.alreadySetBoundary=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider},i.prototype.trySetSliderBoundaryFromOptions=function(){e.Utils.isNullOrUndefined(this.options.start)||this.setupInitialSliderStateStart(this.options.start),e.Utils.isNullOrUndefined(this.options.end)||this.setupInitialSliderStateEnd(this.options.end)},i.prototype.trySetSliderBoundaryFromState=function(){var e=this.rangeFromUrlState||this.queryStateModel.get(this.rangeQueryStateAttribute);e&&void 0!=e[0]&&void 0!=e[1]&&(e[0]=Number(e[0]),e[1]=Number(e[1]),this.setupInitialSliderStateStart(e[0]),this.setupInitialSliderStateEnd(e[1]),this.startOfSlider=e[0],this.endOfSlider=e[1])},i.prototype.trySetSliderBoundaryFromQueryResult=function(e){var t=e.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];t&&t.values.length>0&&(this.setupInitialSliderStateStart(t.values[0].value.split("..")[0]),this.setupInitialSliderStateEnd(t.values[t.values.length-1].value.split("..")[1]))},i.prototype.setupInitialSliderStateStart=function(e){void 0==this.initialStartOfSlider&&(this.initialStartOfSlider=e,this.options.dateField&&isNaN(e)&&(this.initialStartOfSlider=new Date(e.replace("@"," ")).getTime()))},i.prototype.setupInitialSliderStateEnd=function(e){void 0==this.initialEndOfSlider&&(this.initialEndOfSlider=e,this.options.dateField&&isNaN(e)&&(this.initialEndOfSlider=new Date(e.replace("@"," ")).getTime()))},i.prototype.hasAGraph=function(){return void 0!=this.options.graph},i.prototype.updateAppearanceDependingOnState=function(){this.isEmpty&&!this.sliderIsActive()?e.$(this.element).addClass("coveo-disabled-empty"):(e.$(this.element).removeClass("coveo-disabled-empty"),e.$(this.facetHeader.eraserElement).fastToggle(this.sliderIsActive())),this.sliderIsActive()?e.$(this.element).removeClass("coveo-disabled"):e.$(this.element).addClass("coveo-disabled")},i.options={title:e.ComponentOptions.buildStringOption({defaultValue:e.l("NoTitle")}),dateField:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),field:e.ComponentOptions.buildFieldOption({groupByField:!0,required:!0}),id:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),dateFormat:e.ComponentOptions.buildStringOption(),queryOverride:e.ComponentOptions.buildStringOption(),start:e.ComponentOptions.buildStringOption(),end:e.ComponentOptions.buildStringOption(),excludeOuterBounds:e.ComponentOptions.buildBooleanOption(),rounded:e.ComponentOptions.buildNumberOption({min:0}),steps:e.ComponentOptions.buildNumberOption({min:2}),rangeSlider:e.ComponentOptions.buildBooleanOption(),displayAsValue:e.ComponentOptions.buildObjectOption({subOptions:{enable:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),unitSign:e.ComponentOptions.buildStringOption(),separator:e.ComponentOptions.buildStringOption({defaultValue:"-"})}}),displayAsPercent:e.ComponentOptions.buildObjectOption({subOptions:{enable:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),separator:e.ComponentOptions.buildStringOption({defaultValue:"-"})}}),graph:e.ComponentOptions.buildObjectOption({subOptions:{steps:e.ComponentOptions.buildNumberOption({min:2}),animationDuration:e.ComponentOptions.buildNumberOption({min:0}),margin:e.ComponentOptions.buildObjectOption({subOptions:{top:e.ComponentOptions.buildNumberOption({min:0}),bottom:e.ComponentOptions.buildNumberOption({min:0}),left:e.ComponentOptions.buildNumberOption({min:0}),right:e.ComponentOptions.buildNumberOption({min:0})}})}})},i.ID="FacetSlider",i}(e.Component);e.FacetSlider=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(Coveo){function showOnlyWithHelper(e,t){return null==t&&(t={}),t.helpers=e,t}var FieldValue=function(_super){function FieldValue(e,t,i,n,o){var s=this;void 0===o&&(o=FieldValue.ID),_super.call(this,e,o,i),this.element=e,this.options=t,this.result=n,this.options=Coveo.ComponentOptions.initComponentOptions(e,FieldValue,t),this.result=this.result||this.resolveResult(),Coveo.Assert.exists(this.result),this.options.field=this.options.field||"@field";var r=this.getValue();if(null!=r){Coveo._.isArray(r)||Coveo._.isString(r)||(r=r.toString());var a;Coveo._.isString(r)&&this.options.splitValues?(a=r.split(";"),a=Coveo._.map(a,function(e){return Coveo.$.trim(e)})):a=Coveo._.isArray(r)?r:[r],Coveo._.each(a,function(e){void 0!=e&&s.renderOneValue(e).appendTo(s.element)})}else Coveo.$(this.element).detach()}return __extends(FieldValue,_super),FieldValue.prototype.getValue=function(){var e=Coveo.Utils.getFieldValue(this.result,this.options.field);return!Coveo._.isArray(e)&&Coveo._.isObject(e)&&(e=null),e},FieldValue.prototype.getHelperOptions=function(){var inlineOptions=Coveo.ComponentOptions.loadStringOption(this.element,"helperOptions",{});return Coveo.Utils.isNonEmptyString(inlineOptions)?Coveo._.extend({},this.options.helperOptions,eval("("+inlineOptions+")")):this.options.helperOptions},FieldValue.prototype.renderOneValue=function(e){var t=Coveo.$("<span></span>"),i=e;return this.options.helper&&(i=Coveo.TemplateHelpers.getHelper(this.options.helper).call(this,e,this.getHelperOptions())),this.options.htmlValue?t.html(i):t.text(i),this.bindEventOnValue(t,e),t},FieldValue.prototype.bindEventOnValue=function(e,t){var i=this,n=Coveo.QueryStateModel.getFacetId(this.options.facet),o=Coveo._.filter(this.componentStateModel.get(n),function(e){return!e.disabled}),s=o.length>0;if(s){var r=Coveo._.find(o,function(e){var i=e.values.get(t);return i&&i.selected});Coveo.$(e).on("click",function(){null!=r?Coveo._.each(o,function(e){e.deselectValue(t)}):Coveo._.each(o,function(e){e.selectValue(t)}),i.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(Coveo.AnalyticsActionCauseList.documentField,{facetId:i.options.facet,facetValue:t.toLowerCase()})}})}),r&&Coveo.$(e).addClass("coveo-selected"),Coveo.$(e).addClass("coveo-clickable")}},FieldValue.ID="FieldValue",FieldValue.options={field:Coveo.ComponentOptions.buildFieldOption({required:!0}),facet:Coveo.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),htmlValue:Coveo.ComponentOptions.buildBooleanOption({defaultValue:!1}),helper:Coveo.ComponentOptions.buildHelperOption(),helperOptions:Coveo.ComponentOptions.buildObjectOption({subOptions:{text:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["anchor"])),target:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["anchor"])),"class":Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["anchor"])),decimals:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["currency"],{min:0})),symbol:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["currency"])),useTodayYesterdayAndTomorrow:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),useWeekdayIfThisWeek:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),omitYearIfCurrentOne:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),useLongDateFormat:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!1})),includeTimeIfToday:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),includeTimeIfThisWeek:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!0})),alwaysIncludeTime:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"],{defaultValue:!1})),predefinedFormat:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["date","dateTime","emailDateTime","time"])),companyDomain:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["email"])),lengthLimit:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["email"],{min:1})),truncateName:Coveo.ComponentOptions.buildBooleanOption(showOnlyWithHelper(["email"])),alt:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["image"])),height:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["image"])),width:Coveo.ComponentOptions.buildStringOption(showOnlyWithHelper(["image"])),presision:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["size"],{min:0,defaultValue:2})),base:Coveo.ComponentOptions.buildNumberOption(showOnlyWithHelper(["size"],{min:0,defaultValue:0}))}}),splitValues:Coveo.ComponentOptions.buildBooleanOption({defaultValue:!1})},FieldValue
}(Coveo.Component);Coveo.FieldValue=FieldValue,Coveo.CoveoJQuery.registerAutoCreateComponent(FieldValue)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,o=e.ComponentOptions.initComponentOptions(n,i,o),s,r,i.ID),this.options=o}return __extends(i,t),i.prototype.getColor=function(t){if(null==this.colors&&null!=this.options.colors){var n=i.parseColors(this.options.colors);this.defaultColor=n.defaultColor,this.colors=n.valueColors}var o=e._.find(e._.keys(this.colors),function(e){return t.toLowerCase()==e.toLowerCase()});return null!=o?this.colors[o]:this.defaultColor},i.parseColors=function(e){var t,i={};if(null!=e)for(var n=0;n<e.length;){var o=/^\s*(?:((?:\\(?:[:;])|[^:;])+)\s*:\s*)?(\w+|#[A-Fa-f0-9]{3}|#[A-Fa-f0-9]{6})\s*(?:;|$)/.exec(e.substr(n));null!=o?(null!=o[1]?i[o[1].replace(/\\(:|;)/g,"$1")]=o[2]:t=o[2],n+=o[0].length):n=e.length}return{defaultColor:t,valueColors:i}},i.prototype.renderOneValue=function(e){var i=t.prototype.renderOneValue.call(this,e),n=this.getColor(e);return null!=n&&i.css("background-color",n),i},i.ID="Badge",i.options={colors:e.ComponentOptions.buildStringOption()},i.parent=e.FieldValue,i}(e.FieldValue);e.Badge=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function n(o,s,r,a){t.call(this,o,i.ID,r),this.element=o,this.options=s,this.options=e.ComponentOptions.initComponentOptions(o,n,s);var l=e.$(this.element).find("tr[data-field]");l.each(function(e,t){new i(t,{},r,a)}),0==e.$(o).find("tr").length&&e.$(o).detach()}return __extends(n,t),n.ID="FieldTable",n.options={},n}(e.Component);e.FieldTable=t,e.CoveoJQuery.registerAutoCreateComponent(t);var i=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=r||this.resolveResult();var a=e.Utils.getFieldValue(this.result,this.options.field);if(null!=a){e.$(n).append('<th class ="CoveoCaption">'+this.options.caption.toLocaleString()+"</th>");var l=e.$("<td />").appendTo(n);new e.FieldValue(l[0],this.options,s,r)}else e.$(n).detach()}return __extends(i,t),i.ID="ValueRow",i.options=e._.extend({caption:e.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field.substr(1)}})},e.FieldValue.options),i}(e.Component)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),e.Assert.exists(this.result),i.createIcon(this.result,this.options,e.$(n))}return __extends(i,t),i.createIcon=function(t,i,n){if(void 0===i&&(i={}),void 0===n&&(n=e.$("<span />")),null==i.value){var o=e.FileTypes.get(t);n.addClass(o.icon),n.attr("title",o.caption)}else n.addClass("coveo-icon "+i.value);return n},i.ID="Icon",i.options={value:e.ComponentOptions.buildIconOption()},i}(e.Component);e.Icon=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),e.Assert.exists(this.options.maximumExpandedResults),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.preprocessResults,this.handlepreprocessResults)}return __extends(i,t),i.resultNodeToQueryResult=function(t){var n=t.result;return n.attachments=e._.map(e._.sortBy(t.children,"score"),i.resultNodeToQueryResult),n.parentResult=null!=t.parent?t.parent.result:null,n},i.findUniqueId=function(e,t){for(var n=0;n<e.length;n++){if(e[n].result.uniqueId==t)return e[n];var o=i.findUniqueId(e[n].children,t);if(null!=o)return o}return null},i.foldWithParent=function(t){var n={score:Number.NEGATIVE_INFINITY,children:[],result:{raw:!1}};e._.each(t,function(t,o){var s=i.findUniqueId(n.children,t.uniqueId);if(null==t.parentResult||t.parentResult.uniqueId==t.uniqueId)null==s&&(s={result:t,score:o,children:[]},n.children.push(s),s.parent=n);else{null!=s?(s.score=Math.min(o,s.score),s.parent.children=e._.without(s.parent.children,s)):s={result:t,score:o,children:[]};var r=i.findUniqueId(n.children,t.parentResult.uniqueId);null==r&&(r={result:t.parentResult,score:Number.POSITIVE_INFINITY,children:[]},n.children.push(r),r.parent=n),r.children.push(s),s.parent=r;for(var a=r;null!=a&&s.score<a.score;)a.score=s.score,a=a.parent}});var o=i.resultNodeToQueryResult(n);return e._.each(o.attachments,function(e){return e.parentResult=null}),o.attachments},i.defaultGetResult=function(e){var t=e.childResults||[];t.unshift(e),e.childResults=[],t=i.foldWithParent(t);var n=t.shift();return n.childResults=t,n},i.defaultGetMoreResults=function(e){return i.foldWithParent(e)},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),this.disabled||(i.queryBuilder.childField=this.options.childField,i.queryBuilder.parentField=this.options.parentField,i.queryBuilder.filterField=this.options.field,i.queryBuilder.filterFieldRange=this.options.range)},i.prototype.handlepreprocessResults=function(t,n){e.Assert.exists(n),e.Assert.check(!n.results._folded,"Two folding component are active at the same time for the same tab. Can't process result !"),n.results._folded=!0;var o=n.results,s=this.options.getResult||i.defaultGetResult;o.results=e._.map(o.results,s),this.addLoadMoreHandler(o.results,n.query)},i.prototype.addLoadMoreHandler=function(t,i){var n=this;return e._.map(t,function(t){return n.options.enableExpand&&!e.Utils.isNullOrUndefined(e.Utils.getFieldValue(t,n.options.field))&&(t.moreResults=function(){return n.moreResults(t,i)}),t})},i.prototype.moreResults=function(t,i){var n=this,o=e.$.Deferred(),s=new e.QueryBuilder;s.numberOfResults=this.options.maximumExpandedResults;var r=e.Utils.getFieldValue(t,this.options.field);e.Utils.isNonEmptyString(r)&&s.advancedExpression.addFieldExpression(this.options.field,"=",[r]),e.Utils.isNonEmptyString(i.q)&&s.expression.add("("+i.q+") OR @sysuri"),e.Utils.isNonEmptyString(this.options.expandExpression)&&s.constantExpression.add(this.options.expandExpression),null!=this.options.parentField&&(s.parentField=this.options.parentField),null!=this.options.childField&&(s.childField=this.options.childField),this.options.rearrange?this.options.rearrange.putInQueryBuilder(s):(s.sortCriteria=i.sortCriteria,s.sortField=i.sortField);var a=s.build();return this.queryController.getEndpoint().search(a).done(function(e){n.handlePreprocessMoreResults(e),o.resolve(e.results)}),o},i.prototype.handlePreprocessMoreResults=function(e){var t=this.options.getMoreResults||i.defaultGetMoreResults;e.results=t(e.results)},i.ID="Folding",i.options={field:e.ComponentOptions.buildFieldOption({required:!0}),childField:e.ComponentOptions.buildFieldOption({defaultValue:"@systopparentid"}),parentField:e.ComponentOptions.buildFieldOption({defaultValue:"@syscontainsattachment"}),range:e.ComponentOptions.buildNumberOption({defaultValue:2,min:0}),rearrange:e.ComponentOptions.buildCustomOption(function(t){return e.Utils.isNonEmptyString(t)?e.SortCriteria.parse(t):null}),directChildField:e.ComponentOptions.buildFieldOption({defaultValue:"@sysisattachment"}),directParentField:e.ComponentOptions.buildFieldOption({defaultValue:"@syscontainsattachment"}),enableExpand:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),expandExpression:e.ComponentOptions.buildStringOption(),maximumExpandedResults:e.ComponentOptions.buildNumberOption({defaultValue:100,min:1})},i}(e.Component);e.Folding=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,o),this.element=i,this.options=n,this.options.getMoreResults=function(t){return e.Folding.foldWithParent(t)[0].attachments},this.options.getResult=function(t){var i=e.Folding.defaultGetResult(t);return i.childResults=i.attachments,i.attachments=[],i}}return __extends(i,t),i.ID="FoldingForThread",i}(e.Folding);e.FoldingForThread=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,function(e,t){return r.handlePopulateBreadcrumb(e,t)}),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,this.clearHiddenQuery)}return __extends(i,t),i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.hq);e.Utils.isNonEmptyString(n)&&i.queryBuilder.advancedExpression.add(n)},i.prototype.handlePopulateBreadcrumb=function(t,i){var n=this,o=this.getDescription();if(!e._.isEmpty(o)&&!e._.isEmpty(this.queryStateModel.get(e.QueryStateModel.attributesEnum.hq))){var s=e.$("<div></div>").addClass("coveo-hidden-query-breadcrumb");e.$("<span/>").addClass("coveo-hidden-query-breadcrumb-title").text(this.options.title).appendTo(s),e.$("<span/>").addClass("coveo-hidden-query-breadcrumb-values").append(e.$('<span class="coveo-hidden-query-breadcrumb-value" />').text(o)).appendTo(s),e.$("<span/>").addClass("coveo-hidden-query-breadcrumb-clear").appendTo(s),s.click(function(){return n.clearHiddenQuery()}),i.breadcrumbs.push({element:s.get(0)})}},i.prototype.clearHiddenQuery=function(){var t=this,i=this.getDescription();this.queryStateModel.set(e.QueryStateModel.attributesEnum.hd,""),this.queryStateModel.set(e.QueryStateModel.attributesEnum.hq,""),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.contextRemove,{contextName:i})}})},i.prototype.getDescription=function(){var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.hd);return e._.isEmpty(t)&&(t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.hq)),e._.isEmpty(t)||t.length>this.options.maximumDescriptionLength&&(t=t.slice(0,this.options.maximumDescriptionLength)+" ..."),t},i.ID="HiddenQuery",i.options={maximumDescriptionLength:e.ComponentOptions.buildNumberOption({min:0,defaultValue:100}),title:e.ComponentOptions.buildStringOption({defaultValue:e.l("AdditionalFilters")+" : "})},i}(e.Component);e.HiddenQuery=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t){e.call(this,t),this.facet=t}return __extends(t,e),t.prototype._createBasicGroupByRequest=function(){var t=e.prototype.createBasicGroupByRequest.call(this);return t.maximumNumberOfValues=Math.max(this.facet.numberOfValues,1e4),t},t}(e.FacetQueryController);e.HierarchicalFacetQueryController=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,i,n){t.call(this,e,i,n),this.facet=e,this.facetValue=i,this.keepDisplayedValueNextTime=n}return __extends(i,t),i.prototype.build=function(){var e=t.prototype.build.call(this);return e.excludeIcon&&e.label.append(e.excludeIcon),e},i.prototype.buildXOfYCountText=function(t){var i=this,n=this.facet.facetQueryController,o=e._.find(n.lastGroupByForCountOf.values,function(t){return e.StringUtils.equalsCaseInsensitive(t.value,i.facetValue.value)});if(o){var s=Globalize.format(o.numberOfResults,"n0");return s!=t?t+" "+e.l("Of")+" "+s:t}return t},i}(e.FacetValueElement);e.HierarchicalFacetValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i){e.call(this,t,i),this.facet=t,this.facetValueElementKlass=i}return __extends(t,e),t.prototype._getValuesToBuildWith=function(){return this.hierarchyFacetValues},t}(e.FacetValuesList);e.HierarchicalFacetValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i,n),this.facet=t,this.facetValue=i,this.eventArg=n}return __extends(t,e),t.prototype._handleSelectValue=function(t){this.facet.open(this.facetValue),e.prototype._handleSelectValue.call(this,t)},t.prototype._handleExcludeClick=function(t){this.facet.open(this.facetValue),e.prototype._handleExcludeClick.call(this,t)},t}(e.OmniboxValueElement);e.OmniboxHierarchicalValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,o,e.OmniboxHierarchicalValueElement),this.facet=i,this.facetValues=n,this.omniboxObject=o}return __extends(i,t),i}(e.OmniboxValuesList);e.OmniboxHierarchicalValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i){e.call(this,t,i),this.facet=t,this.facetValue=i}return __extends(t,e),t.prototype.build=function(){var t=e.prototype.build.call(this);return t.addClass("coveo-hierarchical-facet-value"),t.find(".coveo-facet-value-caption").html(this.facetValue.value.split(this.facet.options.delimitingCharacter).join("<span class='coveo-hierarchical-breadcrumb-separator'></span>")),t},t}(e.BreadcrumbValueElement);e.HierarchicalBreadcrumbValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,e.HierarchicalBreadcrumbValueElement),this.facet=i,this.facetValues=n,this.valueHierarchy=o}return __extends(i,t),i}(e.BreadcrumbValueList);e.HierarchicalBreadcrumbValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i,n),this.facet=t,this.facetValue=i,this.keepDisplayedValueNextTime=n}return __extends(t,e),t.prototype._handleSelectValue=function(t){this.facet.open(this.facetValue),e.prototype._handleSelectValue.call(this,t)},t.prototype._handleExcludeClick=function(t){this.facet.open(this.facetValue),e.prototype._handleExcludeClick.call(this,t)},t}(e.FacetValueElement);e.HierarchicalFacetSearchValueElement=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(i){t.call(this,i,e.HierarchicalFacetSearchValueElement),this.facet=i}return __extends(i,t),i}(e.FacetSearchValuesList);e.HierarchicalFacetSearchValuesList=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,o,s,i.ID),this.element=n,this.bindings=s,this.firstPlacement=!0,this.correctLevels=[],this.options=e.ComponentOptions.initComponentOptions(n,i,this.options),this.numberOfValuesToShow=this.originalNumberOfValuesToShow=this.options.numberOfValues||5,this.numberOfValues=Math.max(this.options.numberOfValues,1e4),this.options.injectionDepth=Math.max(this.options.injectionDepth,1e4),this.logger.info("Hierarchy facet : Set number of values very high in order to build hierarchy",this.numberOfValues,this),this.logger.info("Hierarchy facet : Set injection depth very high in order to build hierarchy",this.options.injectionDepth)}return __extends(i,t),i.prototype.selectValue=function(e,i){void 0===i&&(i=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists([e]);var n=this.getValueFromHierarchy(e);this.options.useAnd||this.selectChilds(n,n.childs),this.flagParentForSelection(n),t.prototype.selectValue.call(this,e)},i.prototype.selectMultipleValues=function(i,n){var o=this;void 0===n&&(n=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists(i),e._.each(i,function(t){var i=o.getValueFromHierarchy(t);o.flagParentForSelection(i),n&&e._.each(i.childs,function(e){o.selectValue(e.facetValue)})}),t.prototype.selectMultipleValues.call(this,i)},i.prototype.deselectValue=function(i,n){var o=this;void 0===n&&(n=!0),this.ensureDom(),this.ensureValueHierarchyExists([i]);var s=this.getValueFromHierarchy(i);if(n){var r=void 0!=s.childs;if(r){var a=e._.filter(s.childs,function(e){var t=o.getFacetValueFromHierarchy(e.facetValue);return t.selected||t.excluded});s.hasChildSelected=!1,a.length==s.childs.length&&this.deselectChilds(s,s.childs)}}this.deselectParent(s.parent),this.unflagParentForSelection(s),t.prototype.deselectValue.call(this,i)},i.prototype.excludeValue=function(e,i){void 0===i&&(i=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists([e]);var n=this.getValueFromHierarchy(e);i?this.excludeChilds(n.childs):(this.deselectChilds(n,n.childs),this.close(n)),this.flagParentForSelection(n),t.prototype.excludeValue.call(this,e)},i.prototype.unexcludeValue=function(e,i){void 0===i&&(i=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists([e]);var n=this.getValueFromHierarchy(e);i&&this.unexcludeChilds(n.childs),this.unflagParentForSelection(n),t.prototype.unexcludeValue.call(this,e)},i.prototype.deselectMultipleValues=function(i,n){var o=this;void 0===n&&(n=!this.options.useAnd),this.ensureDom(),this.ensureValueHierarchyExists(i),e._.each(i,function(t){var i=o.getValueFromHierarchy(t);i.hasChildSelected=!1,o.unflagParentForSelection(i),n&&e._.each(i.childs,function(e){var t=o.getValueFromHierarchy(e.facetValue);t.hasChildSelected=!1,o.deselectValue(e.facetValue)})}),t.prototype.deselectMultipleValues.call(this,i)},i.prototype.toggleSelectValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]),0==this.getFacetValueFromHierarchy(e).selected?this.selectValue(e):this.deselectValue(e)},i.prototype.toggleExcludeValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]),0==this.getFacetValueFromHierarchy(e).excluded?this.excludeValue(e):this.unexcludeValue(e)},i.prototype.getValueCaption=function(t){var i=this.getSelf(t),n=i;return e.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(n=this.options.valueCaption[i]||n),"function"==typeof this.options.valueCaption&&(n=this.options.valueCaption.call(this,t))),n},i.prototype.getDisplayedValues=function(){return e._.first(e._.pluck(this.values.getAll(),"value"),this.numberOfValuesToShow)},i.prototype.updateSort=function(e){this.firstPlacement=!0,t.prototype.updateSort.call(this,e)},i.prototype.open=function(t){var i=t instanceof e.FacetValue?this.valueHierarchy[t.value]:t;void 0!=i&&(this.getElementFromFacetValueList(i.facetValue.value).addClass("coveo-open"),this.showChilds(i.childs),void 0!=i.parent&&this.open(this.valueHierarchy[i.facetValue.value].parent),this.valueHierarchy[i.facetValue.value].keepOpened=!0)},i.prototype.close=function(t){var i=this,n=t instanceof e.FacetValue?this.valueHierarchy[t.value]:t;void 0!=n&&(this.getElementFromFacetValueList(n.facetValue).removeClass("coveo-open"),this.hideChilds(n.childs),e._.each(n.childs,function(e){i.close(i.valueHierarchy[e.facetValue.value])}),this.valueHierarchy[n.facetValue.value].keepOpened=!1)},i.prototype.facetValueHasChanged=function(){var t=this;this.updateQueryStateModel(),e.Defer.defer(function(){t.updateAppearanceDependingOnState()})},i.prototype.reset=function(){e._.each(this.valueHierarchy,function(e){e.hasChildSelected=!1}),t.prototype.reset.call(this)},i.prototype.initFacetQueryController=function(){this.facetQueryController=new e.HierarchicalFacetQueryController(this)},i.prototype.initFacetSearch=function(){this.facetSearch=new e.FacetSearch(this,e.HierarchicalFacetSearchValuesList),e.$(this.element).append(this.facetSearch.build())},i.prototype.handleDeferredQuerySuccess=function(e,i){this.updateAppearanceDependingOnState(),t.prototype.handleDeferredQuerySuccess.call(this,e,i)},i.prototype.handlePopulateBreadcrumb=function(t,i){if(e.Assert.exists(i),this.values.hasSelectedOrExcludedValues()){var n=new e.HierarchicalBreadcrumbValuesList(this,this.values.getSelected().concat(this.values.getExcluded()),this.valueHierarchy).build();i.breadcrumbs.push({element:n.get(0)})}},i.prototype.handleOmniboxWithStaticValue=function(t){var i=this,n=t.completeQueryExpression.regex,o=(t.completeQueryExpression.word,e._.first(e._.filter(this.valueHierarchy,function(e){return n.test(i.getValueCaption(e.facetValue))}),this.options.numberOfValuesInOmnibox)),s=e._.compact(e._.map(o,function(e){var t=i.getFromFacetValueList(e.facetValue);return t?t.facetValue:void 0})),r=new e.OmniboxHierarchicalValuesList(this,s,t).build();t.rows.push({element:r?r.get(0):void 0,zIndex:this._omniboxZIndex})},i.prototype.rebuildValueElements=function(){this.numberOfValues=Math.max(this.numberOfValues,1e4),this.processHierarchy(),this.setValueListContent(),t.prototype.rebuildValueElements.call(this),this.buildParentChildRelationship(),this.crop()},i.prototype.initFacetValuesList=function(){this.facetValuesList=new e.HierarchicalFacetValuesList(this,e.HierarchicalFacetValueElement),e.$(this.element).append(this.facetValuesList.build())},i.prototype.updateMoreLess=function(){this._moreElement.toggleClass("coveo-active",this.topLevelHierarchy.length>this.numberOfValuesToShow),this.numberOfValuesToShow>this.originalNumberOfValuesToShow?this._lessElement.show():this._lessElement.hide()},i.prototype.handleClickMore=function(){this.numberOfValuesToShow+=this.originalNumberOfValuesToShow,this.numberOfValuesToShow=Math.min(this.numberOfValuesToShow,this.values.size()),this.rebuildValueElements()},i.prototype.handleClickLess=function(){this.numberOfValuesToShow=this.originalNumberOfValuesToShow,this.rebuildValueElements()},i.prototype.updateNumberOfValues=function(){this.numberOfValues=Math.max(this.numberOfValues,1e4)},i.prototype.ensureValueHierarchyExists=function(t){var i=this;t[0]&&"string"==typeof t[0]&&(t=e._.map(t,function(t){return e.FacetValue.createFromValue(t)}));var n=!1;e._.each(t,function(e){(void 0==i.valueHierarchy||void 0==i.valueHierarchy[e.value])&&(n=!0)}),n&&this.processHierarchy(t)},i.prototype.crop=function(){var t=this,i=e._.partition(this.topLevelHierarchy,function(e){return e.facetValue.selected||e.facetValue.excluded});e._.each(e._.last(i[1],i[1].length-(this.numberOfValuesToShow-i[0].length)),function(e){t.getElementFromFacetValueList(e.facetValue).hide()})},i.prototype.placeChildsUnderTheirParent=function(t,i){var n=this;e._.each(t.childs.reverse(),function(e){if(n.valueHierarchy[e.facetValue.value]){var t=n.getElementFromFacetValueList(e.facetValue);t.insertAfter(i)}}),t.keepOpened?(this.open(t),this.showChilds(t.childs)):this.hideChilds(t.childs)},i.prototype.addCssClassToParentAndChilds=function(t,i){var n=this;i.addClass("coveo-has-childs"),t.hasChildSelected&&i.addClass("coveo-has-childs-selected");var o=e.$("<div class='coveo-has-childs-toggle'></div>").click(function(){i.hasClass("coveo-open")?n.close(t):n.open(t)});i.prepend(o)},i.prototype.buildParentChildRelationship=function(){var t=this,i=e._.chain(this.valueHierarchy).toArray().sortBy("level").value();e._.each(i,function(i){var n=t.getElementFromFacetValueList(i.facetValue);e.Utils.isNonEmptyArray(i.childs)?(t.placeChildsUnderTheirParent(i,n),t.addCssClassToParentAndChilds(i,n)):n.addClass("coveo-no-childs"),n.css("margin-left",t.options.marginByLevel*(i.level-t.options.levelStart))})},i.prototype.setValueListContent=function(){var t=this;this.facetValuesList.hierarchyFacetValues=e._.map(this.correctLevels,function(e){return t.values.contains(e.facetValue.value)||(e.facetValue.occurrences=0,t.values.add(e.facetValue)),e.facetValue})},i.prototype.createHierarchy=function(t){var i=this,n=e._.map(t,function(e){var t=i.getParent(e),n=e.lookupValue||e.value;return{facetValue:e,level:i.getLevel(e),parent:t,self:n}});return this.setInHierarchy(n),e._.each(this.valueHierarchy,function(e){e.facetValue.selected&&i.flagParentForSelection(e)}),n},i.prototype.processHierarchy=function(t){var i=this;void 0===t&&(t=this.values.getAll()),this.valueHierarchy=this.valueHierarchy?this.valueHierarchy:{},e._.each(this.valueHierarchy,function(e){void 0==i.values.get(e.facetValue.value)&&delete i.valueHierarchy[i.getLookupOrValue(e.facetValue)]}),this.createHierarchy(t)},i.prototype.setInHierarchy=function(t){var i=this;this.correctLevels=e._.filter(t,function(e){var t=void 0==i.options.levelStart||e.level>=i.options.levelStart,n=void 0==i.options.levelEnd||e.level<i.options.levelEnd;return t&&n}),e._.each(this.correctLevels,function(t){var n,o=e._.map(e._.filter(i.correctLevels,function(e){return e.parent==t.self}),function(e){return{facetValue:e.facetValue,level:e.level,keepOpened:!1,hasChildSelected:!1}}),s=e._.find(i.correctLevels,function(e){return e.self==t.parent}),r=i.valueHierarchy[t.facetValue.value];s&&(n=i.valueHierarchy[s.facetValue.value]),i.valueHierarchy[t.facetValue.value]={childs:o,parent:void 0==s?void 0:{facetValue:s.facetValue,level:s.level,keepOpened:n?n.keepOpened:!1,hasChildSelected:n?n.hasChildSelected:!1,originalPosition:n?n.originalPosition:void 0},facetValue:t.facetValue,level:t.level,keepOpened:r?r.keepOpened:!1,hasChildSelected:r?r.hasChildSelected:!1,originalPosition:r?r.originalPosition:void 0}}),this.topLevelHierarchy=e._.chain(this.values.getAll()).filter(function(e){var t=i.getValueFromHierarchy(e);return t?t.level==(i.options.levelStart||0):!1}).map(function(e){return i.getValueFromHierarchy(e)}).value()},i.prototype.getParent=function(e){var t=this.getLookupOrValue(e).lastIndexOf(this.options.delimitingCharacter);return-1!=t?this.getLookupOrValue(e).substring(0,t):void 0},i.prototype.getSelf=function(e){var t=this.getParent(e);if(void 0==t)return this.getLookupOrValue(e);var i=this.getLookupOrValue(e).indexOf(t);return this.getLookupOrValue(e).substring(i+t.length+1)},i.prototype.showFacetValue=function(e){this.getElementFromFacetValueList(e.facetValue.value).removeClass("coveo-inactive")},i.prototype.hideFacetValue=function(e){this.getElementFromFacetValueList(e.facetValue.value).addClass("coveo-inactive")},i.prototype.hideChilds=function(t){var i=this;e._.each(t,function(e){i.hideFacetValue(e)})},i.prototype.showChilds=function(t){var i=this;e._.each(t,function(e){i.showFacetValue(e)})},i.prototype.hideParent=function(e){e&&this.hideFacetValue(e)},i.prototype.showParent=function(e){e&&this.showFacetValue(e)},i.prototype.selectChilds=function(t,i){this.flagParentForSelection(t),this.selectMultipleValues(e._.map(i,function(e){return e.facetValue}))},i.prototype.deselectChilds=function(t,i){t.hasChildSelected=!1,this.deselectMultipleValues(e._.map(i,function(e){return e.facetValue}))},i.prototype.excludeChilds=function(t){this.excludeMultipleValues(e._.map(t,function(e){return e.facetValue}))},i.prototype.unexcludeChilds=function(t){this.unexcludeMultipleValues(e._.map(t,function(e){return e.facetValue}))},i.prototype.selectParent=function(e){void 0!=e&&(this.selectValue(e.facetValue),e.parent&&this.selectParent(this.valueHierarchy[e.parent.facetValue.value]))},i.prototype.deselectParent=function(e){void 0!=e&&this.deselectValue(e.facetValue,!1)},i.prototype.flagParentForSelection=function(e){for(var t=e.parent;t;){var i=this.valueHierarchy[t.facetValue.value];i.hasChildSelected=!0,t=i.parent}},i.prototype.unflagParentForSelection=function(t){for(var i=this,n=t.parent;n;){var o=this.valueHierarchy[n.facetValue.value],s=e._.filter(o.childs,function(e){var n=i.valueHierarchy[e.facetValue.value];return void 0!=n?n.facetValue.value!=t.facetValue.value&&(n.facetValue.selected||n.facetValue.excluded||n.hasChildSelected):void 0});0==s.length&&(o.hasChildSelected=!1),n=o.parent}},i.prototype.getValueFromHierarchy=function(t){var i=t instanceof e.FacetValue?t.value:t;return this.valueHierarchy[i]},i.prototype.getFacetValueFromHierarchy=function(e){return this.getValueFromHierarchy(e).facetValue},i.prototype.getLookupOrValue=function(e){return e.lookupValue||e.value},i.prototype.getElementFromFacetValueList=function(t){var i=this.getFromFacetValueList(t);return i?i.listElement:e.$("</div>")},i.prototype.getFromFacetValueList=function(e){var t=this.getValueFromHierarchy(e);return void 0!=t?this.facetValuesList.get(e):void 0},i.prototype.getLevel=function(e){return e.value.split(this.options.delimitingCharacter).length-1},i.ID="HierarchicalFacet",i.options={delimitingCharacter:e.ComponentOptions.buildStringOption({defaultValue:"|"}),levelStart:e.ComponentOptions.buildNumberOption({defaultValue:0,min:0}),levelEnd:e.ComponentOptions.buildNumberOption({min:0}),marginByLevel:e.ComponentOptions.buildNumberOption({defaultValue:10,min:0})},i}(e.Facet);e.HierarchicalFacet=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.buildAttributeString=function(t){var i=[];return e._.each(t,function(e,t){void 0!=e&&i.push(t+"="+JSON.stringify(e.toString()))}),i.join(" ")},t}();e.HTMLUtils=t;var i=function(){function e(){}return e.buildAnchor=function(e,i){var n;return i&&i.text?(n=i.text,i.text=void 0):n=e,"<a href='"+e+"'"+t.buildAttributeString(i)+">"+n+"</a>"},e}();e.AnchorUtils=i;var n=function(){function i(){}return i.buildImage=function(e,i){var n="<img ";return n+=e?"src='"+e+"' ":"",n+=t.buildAttributeString(i)+"/>"},i.selectImageFromResult=function(t){return e.$("img[data-coveo-sys-uri-hash='"+t.raw.sysurihash+"']")},i.buildImageWithDirectSrcAttribute=function(e,t){var n=new Image,o=e.getViewAsDatastreamUri(t.uniqueId,"$Thumbnail$",{contentType:"image/png"});n.onload=function(){i.selectImageFromResult(t).attr("src",o)},n.src=o},i.buildImageWithBase64SrcAttribute=function(e,t){e.getRawDataStream(t.uniqueId,"$Thumbnail$").done(function(e){var n=String.fromCharCode.apply(null,new Uint8Array(e));i.selectImageFromResult(t).attr("src","data:image/png;base64, "+btoa(n))}).fail(function(){i.selectImageFromResult(t).remove()})},i.buildImageFromResult=function(t,n,o){var o=o?o:{},s=i.buildImage(void 0,e.$.extend(o,{"data-coveo-sys-uri-hash":t.raw.sysurihash}));return n.isJsonp()||e.DeviceUtils.isIE8or9()?i.buildImageWithDirectSrcAttribute(n,t):i.buildImageWithBase64SrcAttribute(n,t),s},i}();e.ImageUtils=n}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.splitSemicolonSeparatedListOfEmailAddresses=function(t){var i=t.split(/\s*;\s*/);return e._.filter(i,function(t){return e.Utils.exists(t)&&e.Utils.isNonEmptyString(e.Utils.trim(t))})},t.emailAddressesToHyperlinks=function(i,n,o,s,r){void 0===s&&(s=2),void 0===r&&(r=!1),i=e._.filter(i,function(t){return e.Utils.exists(t)&&e.Utils.isNonEmptyString(e.Utils.trim(t))});var a=e._.map(i,function(i){var s=t.parseEmail(i),a=s[1],l=s[0];if(e.Utils.exists(o)&&a==o&&(l=e.l("Me")),r){var u=l.split(" ");e.Utils.isNullOrUndefined(u[1])||(l=u[0]+" "+u[1].substring(0,1)+".")}var c=a.indexOf("@")>=0?a.indexOf("@")+1:0,p=a.substr(c);return e.Utils.exists(n)&&p!=n&&(l+=" ("+p+")"),'<a title="'+i.replace(/"/g,"&quot;")+'" href="mailto:'+encodeURI(a)+'">'+l+"</a>"}),l=a.length-s,u=l>0?t.buildEmailAddressesAndOthers(e._.last(a,l)):"";return e._.first(a,s).join(", ")+u},t.buildEmailAddressesAndOthers=function(t){return"<span class='coveo-emails-excess-collapsed coveo-active' onclick='Coveo.TemplateHelpers.getHelper(\"excessEmailToggle\")(this);'> "+e.l("AndOthers",t.length.toString(),t.length)+"</span><span class='coveo-emails-excess-expanded'> , "+t.join(" , ")+"</span>"},t.parseEmail=function(e){var e,t,i=e.match(/^\s*(.*)\s+<(.*)>$/);return null!=i?(t=i[1],/^".*"|'.*'$/.test(t)&&(t=t.substr(1,t.length-2)),e=i[2]):(t=e,e=e),[t,e]},t}();e.EmailUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.decimals=0}return __extends(t,e),t}(e.Options),i=function(){function i(){}return i.currencyToString=function(i,n){if(e.Utils.isNullOrUndefined(i))return"";i=Number(i),e.Assert.isNumber(i),n=(new t).merge(n);var o=Globalize.culture().numberFormat.currency,s=o.symbol;e.Utils.isNonEmptyString(n.symbol)&&(o.symbol=n.symbol);var r=Globalize.format(i,"c"+n.decimals.toString());return o.symbol=s,r},i}();e.CurrencyUtils=i}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i){return e._.isEmpty(i)?t:s({value:t,search:i.toLowerCase()})}var i=function(){function e(e,t,i){this.begin=e,this.size=t,this.replacementSize=i}return e}();e.Hole=i;var n=function(){function t(){}return t.replace=function(n,o,s){var r=new t;if(e.Utils.isNullOrEmptyString(n))return r;
var a=n.lastIndexOf(o);if(-1==a)return r.value=n,r;for(var l=[];a>=0;){var u=new i(a,o.length,s.length);l.push(u),n=n.slice(0,a)+s+n.slice(a+o.length),a=n.lastIndexOf(o)}return r.holes=l,r.value=n,r},t.shortenPath=function(n,o){var s=n,r=new t;if(e.Utils.isNullOrEmptyString(s)||s.length<=o)return r.value=s,r;var a=[],l=-1;if(l=e.Utils.stringStartsWith(s,"\\\\")?s.indexOf("\\",l+2):s.indexOf("\\"),-1!=l){for(var u=0,c=s.indexOf("\\",l+1);-1!=c&&s.length-u+t.SHORTEN_END.length>o;)u=c-l-1,c=s.indexOf("\\",c+1);if(u>0){s=s.slice(0,l+1)+t.SHORTEN_END+s.slice(u);var p=new i(l+1,u-t.SHORTEN_END.length,t.SHORTEN_END.length);a.push(p)}}if(s.length>o){var d=s.length-o+t.SHORTEN_END.length,h=s.length-d;s=s.slice(0,h)+t.SHORTEN_END;var p=new i(h,d,t.SHORTEN_END.length);a.push(p)}return r.holes=a,r.value=s,r},t.shortenString=function(n,o,s){void 0===o&&(o=200);var r=n;s=e.Utils.toNotNullString(s);var a=new t;if(e.Utils.isNullOrEmptyString(r)||o<=s.length)return a.value=r,a;if(r.length<=o)return a.value=r,a;var l=r;if(o-=s.length,l=l.slice(0,o)," "!=r.charAt(l.length)){var u=l.lastIndexOf(" ");-1!=u&&l.length-u<t.WORD_SHORTER&&(l=l.slice(0,u))}var c=[];return c[0]=new i(l.length,r.length-l.length,s.length),l+=s,a.value=l,a.holes=c,a},t.shortenUri=function(n,o){var s=new t;if(e.Utils.isNullOrEmptyString(n)||n.length<=o)return s.value=n,s;var r=[],a=n.indexOf("//");if(-1!=a&&(a=n.indexOf("/",a+2)),-1!=a){for(var l=0,u=n.indexOf("/",a+1);-1!=u&&n.length-l+t.SHORTEN_END.length>o;)l=u-a-1,u=n.indexOf("/",u+1);if(l>0){n=n.slice(0,a+1)+t.SHORTEN_END+n.slice(a+1+l);var c=new i(a+1,l,t.SHORTEN_END.length);r.push(c)}}if(n.length>o){var p=n.length-o+t.SHORTEN_END.length,d=n.length-p;n=n.slice(0,d)+t.SHORTEN_END;var c=new i(d,p,t.SHORTEN_END.length);r.push(c)}return s.holes=r,s.value=n,s},t.SHORTEN_END="...",t.WORD_SHORTER=10,t}();e.StringAndHoles=n;var o=function(){function t(){}return t.highlightString=function(e,i,n,o){return t.buildHighlightedString(e,i,n,o)},t.buildHighlightedString=function(t,i,n,o){if(e.Assert.isNotUndefined(i),e.Assert.isNotNull(i),e.Assert.isNonEmptyString(o),e.Utils.isNullOrEmptyString(t))return t;for(var s=0,r=t.length,a="",l=0;l<i.length;l++){var u=i[l],c=u.offset,p=c+u.length;if(null!=n){for(var d=!1,h=0;h<n.length;h++){var f=n[h],m=f.begin,v=m+f.size;if(m>c&&p>=m&&v>p)p=m;else{if(c>=m&&v>p){d=!0;break}if(c>=m&&v>c&&p>=v)c=m+f.replacementSize,p-=f.size-f.replacementSize;else if(m>c&&p>=v)p-=f.size-f.replacementSize;else if(c>=v){var g=f.size-f.replacementSize;c-=g,p-=g}}}if(d||c==p)continue}if(p>r)break;a+=e._.escape(t.slice(s,c)),a+="<span class='"+o+"'",u.dataHighlightGroup&&(a+=" data-highlight-group='"+u.dataHighlightGroup.toString()+"'"),u.dataHighlightGroupTerm&&(a+=" data-highlight-group-term='"+u.dataHighlightGroupTerm+"'"),a+=" >",a+=e._.escape(t.slice(c,p)),a+="</span>",s=p}return s!=r&&(a+=e._.escape(t.slice(s))),a},t}();e.HighlightUtils=o;var s=e._.template('<% var i = 0; var lowercaseValue = value.toLowerCase(); while(i < value.length) { %><% var index = lowercaseValue.indexOf(search, i); if(index != -1) { %><% if(i != index){ %> <span><%- value.substr(i, index) %></span><% } %><span class="coveo-hightlight"><%- value.substr(index, search.length) %></span><% i = index + search.length %></span><% } else { %><span><%- value.substr(i) %></span><% i = value.length; %><% } %><% } %>');e.highlightString=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i,o,r){var a=(new l).merge(r),u=s(t);return u.find("*").each(function(t,s){var r=e.$(s).text();e.$(s).html(e.HighlightUtils.highlightString(r,n(r,i,o,a),[],a.cssClass))}),u.html()}function i(t,i,o,s){var r=(new l).merge(s);return e.HighlightUtils.highlightString(t,n(t,i,o,r),[],r.cssClass)}function n(t,i,n,s){var l=[],u=e._.keys(i).sort(o);return e._.each(u,function(n){var u=e._.compact([n].concat(i[n]).sort(o)),c=a;c+=u.join("|")+")(?=(?:"+r+"|$)+)";var p=e.StringUtils.getHighlights(t,new RegExp(c,s.regexFlags),n);void 0!=p&&e.Utils.isNonEmptyArray(p)&&l.push(p)}),e._.each(n,function(i,n){var o=n.split(" "),u=a;e._.each(o,function(e,t){u+="(?:"+[e].concat(i[e]).join("|")+")",t==o.length-1&&(u+="(?="),u+=r,t==o.length-1&&(u+=")"),t!=o.length-1&&(u+="+")}),u+=")";var c=e.StringUtils.getHighlights(t,new RegExp(u,s.regexFlags),n);void 0!=c&&e.Utils.isNonEmptyArray(c)&&l.push(c)}),e._.chain(l).flatten().compact().uniq(function(e){return e.offset}).sortBy(function(e){return e.offset}).map(function(t){var o=e._.keys(i),s=e._.keys(n),r=o.concat(s),a=e._.indexOf(r,t.dataHighlightGroupTerm)+1;return e._.extend(t,{dataHighlightGroup:a})}).value()}function o(e,t){return e.length-t.length}function s(t){var i=e.$("<div />");return i.get(0).innerHTML=t,i}var r="[\\.\\-\\u2011\\s~=,.\\|\\/:'`â€™;_()]",a="("+r+"|^)(",l=function(e){function t(t,i,n){void 0===t&&(t="coveo-highlight"),void 0===i&&(i=0),void 0===n&&(n="gi"),e.call(this),this.cssClass=t,this.shorten=i,this.regexFlags=n}return __extends(t,e),t}(e.Options);e.highlightStreamHTML=t,e.highlightStreamText=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(){}return e.buildURI=function(e,t,i){return e.replace(t,i)},e}();e.ChatterUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(){for(var e=arguments.callee.caller,t=e.arguments[0],i=0;void 0!=e&&(void 0==t||void 0==t.uri)&&100>i;)t=e.arguments[0],e=e.caller,i++;return t}e.TemplateHelpers.registerFieldHelper("javascriptEncode",function(t){return e.Utils.exists(t)?e.StringUtils.javascriptEncode(t):void 0}),e.TemplateHelpers.registerTemplateHelper("shorten",function(t,i,n,o){var s=e.StringAndHoles.shortenString(t,i,"...");return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),e.TemplateHelpers.registerTemplateHelper("shortenPath",function(t,i,n,o){var s=e.StringAndHoles.shortenPath(t,i);return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),e.TemplateHelpers.registerTemplateHelper("shortenUri",function(t,i,n,o){var s=e.StringAndHoles.shortenUri(t,i);return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),e.TemplateHelpers.registerTemplateHelper("highlight",function(t,i,n){return e.Utils.exists(t)?e.Utils.exists(i)?e.HighlightUtils.highlightString(t,i,null,n||"highlight"):t:void 0}),e.TemplateHelpers.registerTemplateHelper("highlightStreamText",function(i,n,o,s){return void 0===n&&(n=t().termsToHighlight),void 0===o&&(o=t().phrasesToHighlight),e.Utils.exists(i)?e.Utils.isNonEmptyArray(e._.keys(n))||e.Utils.isNonEmptyArray(e._.keys(o))?e.highlightStreamText(i,n,o,s):i:void 0}),e.TemplateHelpers.registerTemplateHelper("highlightStreamHTML",function(i,n,o,s){return void 0===n&&(n=t().termsToHighlight),void 0===o&&(o=t().phrasesToHighlight),e.Utils.exists(i)?e.Utils.isNonEmptyArray(n)?e.highlightStreamHTML(i,n,o,s):i:void 0}),e.TemplateHelpers.registerFieldHelper("number",function(t,i){var n=Number(t);return e.Utils.exists(t)?e._.isString(i)?e.StringUtils.htmlEncode(Globalize.format(n,i)):e.StringUtils.htmlEncode(n.toString()):void 0}),e.TemplateHelpers.registerFieldHelper("date",function(t,i){return e.DateUtils.dateToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),e.TemplateHelpers.registerFieldHelper("time",function(t,i){return e.DateUtils.timeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),e.TemplateHelpers.registerFieldHelper("dateTime",function(t,i){return e.DateUtils.dateTimeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),e.TemplateHelpers.registerFieldHelper("emailDateTime",function(t,i){var n={};n.includeTimeIfThisWeek=!0;var o=e.$.extend({},n,i);return t?e.DateUtils.dateTimeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),o):void 0}),e.TemplateHelpers.registerFieldHelper("currency",function(t,i){return e.CurrencyUtils.currencyToString(t,i)}),e.TemplateHelpers.registerFieldHelper("timeSpan",function(t,i){return void 0===i&&(i={isMilliseconds:!1}),new e.TimeSpan(t,i.isMilliseconds).getHHMMSS()}),e.TemplateHelpers.registerFieldHelper("email",function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o,s,r,a;if(e._.isObject(i[0])?(o=i[0].companyDomain,s=i[0].me,r=i[0].lengthLimit,a=i[0].truncateName):(o=i[0],s=i[1],r=i[2],a=i[3]),void 0==r&&(r=2),void 0==a&&(a=!1),e._.isString(t)){var l=e.EmailUtils.splitSemicolonSeparatedListOfEmailAddresses(t);return e.EmailUtils.emailAddressesToHyperlinks(l,o,s,r,a)}return e._.isArray(t)?e.EmailUtils.emailAddressesToHyperlinks(t,o,s,r,a):void 0}),e.TemplateHelpers.registerTemplateHelper("excessEmailToggle",function(t){return e.$(t).removeClass("coveo-active"),e.$(t).hasClass("coveo-emails-excess-collapsed")?e.$(t).siblings(".coveo-emails-excess-expanded").addClass("coveo-active"):e.$(t).hasClass("coveo-hide-expanded")&&(e.$(t).parent().addClass("coveo-inactive"),e.$(t).parent().siblings(".coveo-emails-excess-collapsed").addClass("coveo-active")),void 0}),e.TemplateHelpers.registerFieldHelper("anchor",function(t,i){return e.AnchorUtils.buildAnchor(t,i)}),e.TemplateHelpers.registerFieldHelper("image",function(t,i){return e.ImageUtils.buildImage(t,i)}),e.TemplateHelpers.registerTemplateHelper("thumbnail",function(i,n,o){return void 0===i&&(i=t()),void 0===n&&(n="default"),e.QueryUtils.hasThumbnail(i)?e.ImageUtils.buildImageFromResult(i,e.SearchEndpoint.endpoints[n],o):void 0}),e.TemplateHelpers.registerTemplateHelper("fromFileTypeToIcon",function(i,n){return void 0===i&&(i=t()),void 0===n&&(n={}),e.Icon.createIcon(i,n).get(0).outerHTML}),e.TemplateHelpers.registerTemplateHelper("attrEncode",function(e){return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),e.TemplateHelpers.registerTemplateHelper("templateFields",function(i){void 0===i&&(i=t());var n=[];return null!=i.fields&&e._.forEach(i.fields,function(t){var i=e.$(document.createElement("tr"));return e._.forEach(t,function(t,n){e._.isObject(t)?i.attr(e.ComponentOptions.attrNameFromName(n),JSON.stringify(t)):i.attr(e.ComponentOptions.attrNameFromName(n),t)}),n.push(i.get(0).outerHTML)}),n.join("")}),e.TemplateHelpers.registerTemplateHelper("loadTemplates",function(i,n){void 0===n&&(n=!0);var o,s="",r=t(),a=!1,l=i;return e._.each(i,function(e,t){"default"==e&&(o=t)}),void 0!=o&&(l=e._.omit(i,o)),e._.each(l,function(t,i){a&&n||(a=a||t,s+=e.TemplateHelpers.getHelper("loadTemplate")(i,t,r))}),a||void 0==o||(s+=e.TemplateHelpers.getHelper("loadTemplate")(o,!0,r)),s});var i=["B","KB","MB","GB","TB","PB","EB"];e.TemplateHelpers.registerFieldHelper("size",function(e,t){for(var n=Number(e),o=null!=t&&null!=t.presision?t.presision:2,s=null!=t&&null!=t.base?t.base:0;n>1024&&s+1<i.length;)n/=1024,s++;return n=Math.floor(n*Math.pow(10,o))/Math.pow(10,o),n+" "+i[s]}),e.TemplateHelpers.registerTemplateHelper("loadTemplate",function(i,n,o){return void 0===n&&(n=!0),e.Utils.isNullOrUndefined(o)&&(o=t()),n?e.TemplateCache.getTemplate(i).instantiateToString(o,!1):""}),e.TemplateHelpers.registerTemplateHelper("encodeCarriageReturn",function(t){return e.Utils.isNullOrUndefined(t)?void 0:e.StringUtils.encodeCarriageReturn(t)}),e.TemplateHelpers.registerTemplateHelper("isMobileDevice",function(){return e.DeviceUtils.isMobileDevice()?e.DeviceUtils.getDeviceName():null})}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.buildMailToString=function(e){var i=e.to?"mailto:"+encodeURIComponent(e.to):"mailto:",n=t.buildMailToParametersString(e.subject,e.cc,e.bcc,e.body,i);return n&&(i+="?"+n),i},t.buildMailToParametersString=function(e,i,n,o,s){var r=[];if(e&&r.push(t.buildMailToParameter("subject",e)),i&&r.push(t.buildMailToParameter("cc",i)),n&&r.push(t.buildMailToParameter("bcc",n)),o){var a=t.getShortenBody(o,s+"?"+r.join("&"));a&&r.push(t.buildMailToParameter("body",a))}return r.join("&")},t.getShortenBody=function(i,n){var o=i;if(n.length<e.MailTo.maxLength){var s=e.MailTo.maxLength-n.length-"&body=".length;o=t.shortenString(i,s)}return o},t.buildMailToParameter=function(e,t){return t?encodeURIComponent(e)+"="+encodeURIComponent(t):""},t.shortenString=function(t,i,n){void 0===n&&(n=!1);var o=n?encodeURIComponent(e.MailTo.shortenBodyIndicator):e.MailTo.shortenBodyIndicator;i-=e.MailTo.shortenBodyIndicator.length;var s=t.length>i?!0:!1,r=t.substring(0,i);return r+=s?o:""},t.appendShortenBodyToMailToString=function(e,i){var n=t.getShortenBody(i,e);return e.indexOf("?")>=0?e+"&body="+n:e+"?body="+n},t.removeCurrentUserEmailFromString=function(t,i){return i&&t?e._.filter(i.split(";"),function(e){return-1==e.indexOf(t)}).join(";"):i},t.buildReplyMailToFromResult=function(t,i){return new e.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,to:t.raw.sysfrom,subject:t.raw.sysconversationsubject})},t.buildReplyAllMailToFromResult=function(t,i){return new e.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,to:t.raw.sysfrom+";"+t.raw.systo,subject:t.raw.sysconversationsubject,cc:t.raw.syscc})},t.buildForwardMailToFromResult=function(t,i){return new e.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,subject:t.raw.sysconversationsubject})},t.encodeMailToBody=function(t){var i=t.split("\n");return e._.each(i,function(e,t){i[t]=encodeURIComponent(i[t])}),i.join(e.MailTo.enter)},t}();e.EmailActionsUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(){t.apply(this,arguments),this.currentUserEmail="",this.originalFrom="",this.to="",this.subject="",this.cc="",this.bcc="",this.body="",this.bodyIsHTML=e.DeviceUtils.isPhonegap()}return __extends(i,t),i}(e.Options);e.DefaultMailToOptions=t;var i=function(){function i(i){this.options=i,this.bodyHeader="",this.options=(new t).merge(i),this.removeCurrentUserFromParameters(),e.DeviceUtils.isPhonegap()&&this.setRecipientsArrays(),this.options.originalFrom&&(this.bodyHeader=this.options.bodyIsHTML?"<p><br/><br/><br/>"+e.l("From")+": "+this.options.originalFrom+"<hr></p>":"\n\n\n"+e.l("From")+": "+this.options.originalFrom+"\n_________________________________\n")}return i.prototype.removeCurrentUserFromParameters=function(){this.options.to=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.to),this.options.cc=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.cc),this.options.bcc=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.bcc)},i.prototype.setRecipientsArrays=function(){this.toArray=this.options.to?this.options.to.split(";"):[],this.ccArray=this.options.cc?this.options.cc.split(";"):[],this.bccArray=this.options.bcc?this.options.bcc.split(";"):[]},i.prototype.open=function(){if(e.DeviceUtils.isPhonegap()){var t=this.options.bodyIsHTML?this.body:e.EmailActionsUtils.shortenString(this.body,i.phonegapMaxLength);window.plugin.email.open(this.getEmailOpenerObject(t))}else this.ensureValueIsSet(),window.location.href=this.value},i.prototype.getEmailOpenerObject=function(e){var t={to:this.toArray,cc:this.ccArray,bcc:this.bccArray,subject:this.options.subject,body:e,isHtml:this.options.bodyIsHTML};return t},i.prototype.ensureValueIsSet=function(){this.value?this.valueBodyIsSet()||this.setValueBody():this.setValue()},i.prototype.setValue=function(){this.value=e.EmailActionsUtils.buildMailToString(this.options),this.value&&!this.valueBodyIsSet()&&this.setValueBody()},i.prototype.setValueBody=function(){this.value=e.EmailActionsUtils.appendShortenBodyToMailToString(this.value,this.body)},i.prototype.setMailToBodyFromText=function(t){void 0===t&&(t=""),this.body=t,e.DeviceUtils.isPhonegap()||(this.body=e.EmailActionsUtils.encodeMailToBody(this.body))},i.prototype.valueBodyIsSet=function(){return this.value.indexOf("body=")>=0},i.prototype.bodyIsSet=function(){return this.body?!0:!1},i.enter="%0D%0A",i.shortenBodyIndicator="\r\n\r\n...",i.maxLength=1e3,i.phonegapMaxLength=15e3,i}();e.MailTo=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=r||this.resolveResult(),this.createAndAppendEmailActions(),this.appendWaitingAnimation()}return __extends(i,t),i.prototype.createAndAppendEmailActions=function(){this.options.reply&&(this.reply=new e.EmailAction(e.$(document.createElement("div"))[0],this,{type:e.EmailAction.reply,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.reply.element)),this.options.replyAll&&(this.replyAll=new e.EmailAction(e.$(document.createElement("div"))[0],this,{type:e.EmailAction.replyAll,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.replyAll.element)),this.options.forward&&(this.forward=new e.EmailAction(e.$(document.createElement("div"))[0],this,{type:e.EmailAction.forward,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.forward.element))},i.prototype.appendWaitingAnimation=function(){this.loadingAnimation=e.JQueryUtils.getBasicLoadingDots().hide(),e.$(this.element).append(this.loadingAnimation)},i.ID="EmailActions",i.options={currentUserEmail:e.ComponentOptions.buildStringOption({defaultValue:""}),reply:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),replyAll:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),forward:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.EmailActions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){var l=this;t.call(this,n,i.ID,r),this.element=n,this.actions=o,this.options=s,this.result=a,this.options=e.ComponentOptions.initComponentOptions(n,e.EmailActions,s),this.result=a||this.resolveResult(),this.setMailToFromResult(),e.$(this.element).click(function(){l.showWaitingAnimation(),l.mailTo.bodyIsSet()?l.openMailTo():l.appendBodyToMailTo(function(){return l.openMailTo()})})}return __extends(i,t),i.prototype.showWaitingAnimation=function(){this.actions.loadingAnimation.show()},i.prototype.hideWaitingAnimation=function(){this.actions.loadingAnimation.hide()},i.prototype.setMailToFromResult=function(){switch(this.options.type){case i.reply:this.mailTo=e.EmailActionsUtils.buildReplyMailToFromResult(this.result,this.options.currentUserEmail),e.$(this.element).append(e.l("Reply"));break;case i.replyAll:this.mailTo=e.EmailActionsUtils.buildReplyAllMailToFromResult(this.result,this.options.currentUserEmail),e.$(this.element).append(e.l("ReplyAll"));break;case i.forward:e.$(this.element).append(e.l("Forward")),this.mailTo=e.EmailActionsUtils.buildForwardMailToFromResult(this.result,this.options.currentUserEmail);break;default:this.mailTo=new e.MailTo({})}},i.prototype.appendBodyToMailTo=function(t){var i=this;if(e.DeviceUtils.isPhonegap()){var n,o=this.queryController.getEndpoint();n=e.DeviceUtils.isAndroid()?o.getDocumentText(this.result.uniqueId).done(function(e){i.doneRetrieveBody(e,t)}):o.getDocumentHtml(this.result.uniqueId).done(function(e){i.doneRetrieveBody(e.getElementsByTagName("body")[0].innerHTML,t)}),n.fail(function(){i.doneRetrieveBody("",t)})}else this.queryController.getEndpoint().getDocumentText(this.result.uniqueId).done(function(e){return i.doneRetrieveBody(e,t)}).fail(function(){return i.doneRetrieveBody("",t)})},i.prototype.doneRetrieveBody=function(e,t){var i=e.content?e.content:e;this.mailTo.setMailToBodyFromText(i),t(e)},i.prototype.openMailTo=function(){this.mailTo.open(),this.hideWaitingAnimation()},i.ID="EmailAction",i.options={type:e.ComponentOptions.buildStringOption({defaultValue:"forward"}),currentUserEmail:e.ComponentOptions.buildStringOption({defaultValue:""})},i.forward="forward",i.reply="reply",i.replyAll="replyAll",i}(e.Component);e.EmailAction=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(i,n){e.$(i).click(function(e){e.preventDefault(),n&&n.indexOf("javascript:")<0&&t.openInPhonegap(n)})}function n(e){window.open(e,"_system","location=yes")}t.bindOpenLinkInPhonegap=i,t.openInPhonegap=n}(t=e.PhonegapUtils||(e.PhonegapUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t="CoveoHighlight",i=function(i){function n(t,o,s,r){i.call(this,t,n.ID,s),this.element=t,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(t,n,o),this.result=r||this.resolveResult(),this.termsToHighlightWereModified=!1,e.Assert.exists(this.result)}return __extends(n,i),n.prototype.createDom=function(){var t=e.$('<div class="coveo-quickview-document"></div>').appendTo(e.$(this.element));this.header=this.buildHeader().appendTo(t),this.iframe=this.buildIFrame().appendTo(t)},n.prototype.open=function(){var t=this;this.ensureDom(),this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentQuickview,{},this.result,this.queryController.element);var i=(new Date).getTime(),n=this.iframe.find("iframe")[0];n.src="about:blank";var o=this.queryController.getEndpoint(),s=e._.keys(this.result.termsToHighlight),r={termsToHighlight:s};e.$(this.element).trigger(e.UserActionEvents.openQuickview,r),this.checkIfTermsToHighlightWereModified(r.termsToHighlight);var a=e.$.extend(!0,{},this.getBindings().queryController.getLastQuery());this.termsToHighlightWereModified&&this.handleTermsToHighlight(r.termsToHighlight,a);var l={queryObject:a,requestedOutputSize:this.options.maximumDocumentSize};o.getDocumentHtml(this.result.uniqueId,l).done(function(e){null!=n.contentDocument&&(t.renderHTMLDocument(n,e),t.triggerQuickviewLoaded(i))}).fail(function(e,s){null!=n.contentDocument&&(0!=s.status?(t.renderErrorReport(n),t.triggerQuickviewLoaded(i)):(n.onload=function(){t.triggerQuickviewLoaded(i)},n.src=o.getViewAsHtmlUri(t.result.uniqueId,l)))})},n.prototype.renderHTMLDocument=function(t,i){var n=this;t.onload=function(){n.computeHighlights(t.contentWindow),n.isNewQuickviewDocument(t.contentWindow)&&(e.$(n.element).parents(".coveo-body").css("padding",0),e.$(n.element).children(".coveo-quickview-header").css("padding-top",10),e.$(n.element).children(".coveo-quickview-header").css("padding-left",10)),""==e.$(n.element).children(".coveo-quickview-header").html()&&e.$(n.element).children(".coveo-quickview-header").css("display","none")},this.writeToIFrame(t,i),this.wrapPreElementsInIframe(t),e.DeviceUtils.isMobileDevice()&&this.bindOpenIframeLinksInPhonegap(t)},n.prototype.renderErrorReport=function(t){var i="<html><body style='font-family: Arimo, \"Helvetica Neue\", Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none;'>"+e.l("OopsError")+"</body></html>";this.writeToIFrame(t,i)},n.prototype.writeToIFrame=function(e,t){var i=t;"object"==typeof t&&(i=t.getElementsByTagName("html")[0].outerHTML),e.contentWindow.document.open(),e.contentWindow.document.write(i),e.contentWindow.document.close()},n.prototype.bindOpenIframeLinksInPhonegap=function(t){try{var i=e.$(t.contentWindow.document).find("a");e._.each(i,function(t){var i=t.href;t.href="javascript:",e.PhonegapUtils.bindOpenLinkInPhonegap(t,i)})}catch(n){}},n.prototype.wrapPreElementsInIframe=function(t){try{var i=document.createElement("style");i.type="text/css";var n="html pre { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; }";n+='body, html { font-family: Arimo, "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none; }',e.DeviceUtils.isIos()&&(n+="body, html { height: 1px !important; min-height: 100%; overflow: scroll; }",e.$(t).attr("scrolling","no"),n+="body, html {margin: auto}",e.$(t).parent().css("margin","0 0 5px 5px"),t.style.position="relative"),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n));var o=t.contentWindow.document.head;o.appendChild(i)}catch(s){}},n.prototype.triggerQuickviewLoaded=function(t){var i=(new Date).getTime(),n={duration:i-t};e.$(this.element).trigger(e.UserActionEvents.quickviewLoaded,n)},n.prototype.computeHighlights=function(i){var n=this;this.header.empty(),this.keywordsState=[];var o={},s=0;e.$(i.document.body).find("[id^="+t+"]").each(function(e,t){var i=n.getHighlightIdParts(t);if(i){var r=i[1],a=parseInt(i[2],10),l=parseInt(i[3],10),u=o[r];if(null==u&&1==l?o[r]=u={text:n.getHighlightInnerText(t),count:1,index:parseInt(r,10),termsCount:"coveotaggedword"==t.nodeName.toLowerCase()?0:1,element:t,occurence:a}:u&&(u.occurence==a&&("coveotaggedword"==t.nodeName.toLowerCase()?u.text+=n.getHighlightInnerText(t):u.termsCount<l&&(u.text+=n.getHighlightInnerText(t),u.termsCount+=1)),u.count=Math.max(u.count,a),s+=1),u&&u.occurence==a&&"span"==t.nodeName.toLowerCase()){var c=n.getHightlightEmbeddedWordIdParts(t),p=c?o[c[1]]:null;p&&p.occurence==parseInt(c[2],10)&&(p.text+=t.childNodes[0].nodeValue||"")}}}),0==s&&this.header.css("min-height",0);var r=[];return e._.each(o,function(e){e.text=n.resolveOriginalTermFromHighlight(e.text);var t={word:e,color:e.element.style.backgroundColor,currentIndex:0,index:e.index};n.keywordsState.push(t),n.header.append(n.buildWordButton(t,i)),r.push(e.text)}),r},n.prototype.getHighlightIdParts=function(e){var i=e.id.substr(t.length+1).match(/^([0-9]+)\.([0-9]+)\.([0-9]+)$/);return i&&i.length>3?i:null},n.prototype.getHighlightInnerText=function(e){return"coveotaggedword"==e.nodeName.toLowerCase()?e.childNodes.length>=1?e.childNodes.item(0).textContent||"":"":e.textContent||""},n.prototype.getHightlightEmbeddedWordIdParts=function(e){var t=e.getElementsByTagName("coveotaggedword")[0];return t?this.getHighlightIdParts(t):null},n.prototype.resolveOriginalTermFromHighlight=function(t){var i=this,n=t;return this.result.termsToHighlight&&(n=e._.find(e._.keys(this.result.termsToHighlight),function(n){return n.toLowerCase()==t.toLowerCase()||void 0!=e._.find(i.result.termsToHighlight[n],function(e){return e.toLowerCase()==t.toLowerCase()})})||n),n},n.prototype.buildWordButton=function(t,i){var n=this,o=e.$("<span/>").addClass("coveo-term-for-quickview");return o.append(e.$("<span/>").addClass("coveo-term-for-quickview-name").html(t.word.text).click(function(){n.navigate(t,!1,i)})),o.append(e.$("<span/>").addClass("coveo-term-for-quickview-down-arrow").append(e.$("<span/>").addClass("coveo-term-for-quickview-down-arrow-icon")).click(function(){n.navigate(t,!1,i)})),o.append(e.$("<span/>").addClass("coveo-term-for-quickview-up-arrow").append(e.$("<span/>").addClass("coveo-term-for-quickview-up-arrow-icon")).click(function(){n.navigate(t,!0,i)})),o.css("background-color",t.color),o.css("border-color",this.getSaturatedColor(t.color)),o.find(".coveo-term-for-quickview-down-arrow").css("border-color",this.getSaturatedColor(t.color)),o},n.prototype.navigate=function(i,n,o){var s,r=i.currentIndex;s=n?1>=r?i.word.count:r-1:r==i.word.count?1:r+1;var a=this.getScrollingElement(o);a.find('[id^="'+t+":"+i.word.index+"."+r+'"]').css("border","");var l=e.$(o.document.body).find('[id^="'+t+":"+i.word.index+"."+s+'."]');if(l.css("border","1px dotted #333"),i.currentIndex=s,this.isNewQuickviewDocument(o)&&l.closest(".pc").addClass("opened"),this.isNewQuickviewDocument(o)||e.DeviceUtils.isMobileDevice())return l[0].scrollIntoView(),this.iframe.closest(".coveo-body").scrollLeft(0).scrollTop(0),void 0;var u=l.offset();a.stop(!0).animate({scrollLeft:u.left-a.get(0).clientWidth/2+l.width()/2,scrollTop:u.top-a.get(0).clientHeight/2+l.height()/2}),this.iframe.stop(!0).animate({scrollLeft:u.left-this.iframe.width()/2+l.width()/2,scrollTop:u.top-this.iframe.height()/2+l.height()/2})},n.prototype.buildHeader=function(){return e.$("<div/>").addClass("coveo-quickview-header")},n.prototype.buildIFrame=function(){return e.$('<div class="coveo-iframeWrapper"><iframe/></div>')},n.prototype.getScrollingElement=function(t){var i;return this.isNewQuickviewDocument(t)&&(i=e.$(t.document.body).find("#page-container")),(void 0==i||0==i.length)&&(i=e.$(t.document.body)),i},n.prototype.isNewQuickviewDocument=function(t){return"pdf2htmlEX"==e.$(t.document.head).find("meta[name='generator']").attr("content")},n.prototype.handleTermsToHighlight=function(t,i){var n=this;for(var o in this.result.termsToHighlight)delete this.result.termsToHighlight[o];var s="";e._.each(t,function(e){s+=e+" ",n.result.termsToHighlight[e]=new Array(e)}),s=s.substring(0,s.length-1),i.q=s},n.prototype.checkIfTermsToHighlightWereModified=function(t){e.Utils.arrayEqual(t,e._.keys(this.result.termsToHighlight))||(this.termsToHighlightWereModified=!0)},n.prototype.getSaturatedColor=function(t){var i=parseInt(t.substring(4,7)),n=parseInt(t.substring(9,12)),o=parseInt(t.substring(14,17)),s=e.ColorUtils.rgbToHsv(i,n,o);s[1]*=2,s[1]>1&&(s[1]=1);var r=e.ColorUtils.hsvToRgb(s[0],s[1],s[2]);return"rgb("+r[0].toString()+", "+r[1].toString()+", "+r[2].toString()+")"},n.ID="QuickviewDocument",n.options={maximumDocumentSize:e.ComponentOptions.buildNumberOption({defaultValue:0,min:0})},n}(e.Component);e.QuickviewDocument=i,e.CoveoJQuery.registerAutoCreateComponent(i)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.instantiateToString=function(){return'<div class="coveo-quick-view-full-height"><div class="CoveoQuickviewDocument"></div></div>'},t}(e.Template);e.DefaultQuickviewTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null==this.options.contentTemplate&&(this.options.contentTemplate=new e.DefaultQuickviewTemplate),""==this.element.innerHTML&&e.$(this.element).append('<div class="coveo-icon-for-quickview">'+"Quickview".toLocaleString()+"</div>"),this.bindClick(r),this.bind.on(e.$(this.bindings.resultElement),e.ResultListEvents.openQuickview,function(){return a.open()})}return __extends(i,t),i.prototype.open=function(){if(null==this.modalbox){e.$(document.activeElement).blur();var t=this.prepareOpenQuickviewObject();this.createModalBox(t),this.bindQuickviewEvents(t),this.animateAndOpen();{this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.quickview)}this.queryStateModel.set(e.QueryStateModel.attributesEnum.quickview,this.getHashId())}},i.prototype.getHashId=function(){return this.result.queryUid+":"+this.result.index},i.prototype.close=function(){null!=this.modalbox&&(this.modalbox.close(),this.modalbox=null,e.DeviceUtils.isAndroid()&&e.DeviceUtils.isPhonegap()&&e.$(document).off("backbutton"),e.$("body").unbind("keyup.quickviewEscape"))},i.prototype.bindClick=function(t){"undefined"==typeof t.hasHtmlVersion||t.hasHtmlVersion||this.options.alwaysShow?e.$(this.element).click(e.$.proxy(this.open,this)):e.$(this.element).css("display","none")},i.prototype.bindQuickviewEvents=function(t){var i=this;e.DeviceUtils.isAndroid()&&e.DeviceUtils.isPhonegap()&&e.$(document).on("backbutton",function(){i.close()}),e.$(this.modalbox.wrapper.find(".coveo-quickview-close-button")).click(function(){i.closeQuickview()}),e.$(this.modalbox.wrapper.find(".coveo-quickview-close-button")).click(function(){return i.close()}),this.modalbox.content.on(e.UserActionEvents.quickviewLoaded,function(){e.$(t.loadingAnimation).remove(),i.bindIFrameEscape()}),this.bindEscape()},i.prototype.animateAndOpen=function(){var t=this,i=this.modalbox.wrapper.css("animation-duration");if(i){var n=/^(.+)(ms|s)$/.exec(i),o=Number(n[1])*("s"==n[2]?1e3:1);setTimeout(function(){null!=t.modalbox&&e.$(t.modalbox.modalBox.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID))).coveo("open")},o)}else e.$(this.modalbox.modalBox.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID))).coveo("open")},i.prototype.createModalBox=function(t){var i=e.$("<div/>").append(t.content);this.modalbox=e.ModalBox.open(i,{overlayClose:!0,title:e.JQueryUtils.getQuickviewHeader(this.result,{showDate:this.options.showDate,title:this.options.title},this.bindings),className:"coveo-quick-view",validation:function(){return!0
},body:this.element.ownerDocument.body}),this.setQuickviewSize()},i.prototype.prepareOpenQuickviewObject=function(){var e=this.options.loadingAnimation;return{loadingAnimation:e,content:this.prepareQuickviewContent(e)}},i.prototype.prepareQuickviewContent=function(t){var i=e.$(this.options.contentTemplate.instantiateToElement(this.result)),n=this.searchInterface.options,o={options:n,bindings:this.getBindings(),result:this.result};return e.CoveoJQuery.automaticallyCreateComponentsInside(i.get(0),o),0!=i.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID)).length&&this.options.enableLoadingAnimation&&i.prepend(t),i},i.prototype.bindEscape=function(){var t=this;e.$("body").on("keyup.quickviewEscape",function(e){27==e.keyCode&&t.closeQuickview()})},i.prototype.bindIFrameEscape=function(){var t=this,i=this.modalbox.content.find("."+e.Component.computeCssClassNameForType(e.QuickviewDocument.ID)).find("iframe");e.$(i.contents().find("body")).on("keyup",null,this,function(e){27==e.keyCode&&t.closeQuickview()})},i.prototype.closeQuickview=function(){this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.quickview);this.queryStateModel.set(e.QueryStateModel.attributesEnum.quickview,"")},i.prototype.setQuickviewSize=function(){var e=this.modalbox.modalBox.find(".coveo-wrapper");e.css("width",this.options.size),e.css("height",this.options.size),e.css("max-width",this.options.size),e.css("max-height",this.options.size)},i.ID="Quickview",i.options={alwaysShow:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),title:e.ComponentOptions.buildStringOption(),showDate:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableLoadingAnimation:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),contentTemplate:e.ComponentOptions.buildTemplateOption({selectorAttr:"data-template-selector",idAttr:"data-template-id"}),loadingAnimation:e.ComponentOptions.buildOption(16,function(t){var i=e.$(t).attr("data-loading-animation-selector");if(null!=i){var n=e.$(i);if(0!=n.length)return n.remove().get(0)}var o=e.$(t).attr("data-loading-animation-template-id");if(null!=o){var s=e.ComponentOptions.loadResultTemplateFromId(o);if(s)return s.instantiateToElement({})}return e.JQueryUtils.getBasicLoadingAnimation().get(0)}),size:e.ComponentOptions.buildStringOption({defaultValue:e.DeviceUtils.isMobileDevice()?"100%":"95%"})},i}(e.Component);e.Quickview=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;void 0===r&&(r=i.ID),t.call(this,n,r,s),this.element=n,this.options=o,this.bindings=s,this.currentlyDisplayedResults=[],this.reachedTheEndOfResults=!1,this.resetList=!0,this.pageChanged=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),e.Assert.exists(this.options.resultContainer),e.Assert.exists(this.options.resultTemplate),e.Assert.exists(this.options.waitAnimationContainer),e.Assert.exists(this.options.infiniteScrollContainer),this.showOrHideElementsDependingOnState(!1,!1),e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this.handleNewQuery,this)),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleProcessNewQueryResults,this)),e.$(this.root).on(e.QueryEvents.duringQuery,e.$.proxy(this.handleDuringQuery,this)),e.$(this.root).on(e.QueryEvents.queryError,function(){a.hideWaitingAnimation(),e.$(a.options.resultContainer).empty(),a.currentlyDisplayedResults=[]}),this.options.enableInfiniteScroll&&e.$(this.options.infiniteScrollContainer).scroll(function(e){return a.handleScrollOfResultList(e)});var l=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.first);e.$(this.queryStateModel.element).on(l,e.$.proxy(this.handlePageChanged,this))}return __extends(i,t),i.prototype.handlePageChanged=function(){var t=this;e.$(this.root).one(e.QueryEvents.querySuccess,function(){e.$(t.options.infiniteScrollContainer).scrollTop(0)})},i.prototype.handleNewQuery=function(){this.disabled||e.$(this.element).show()},i.prototype.displayMoreResults=function(t){var i=this;return e.Assert.isLargerOrEqualsThan(1,t),e.Assert.check(this.hasPotentiallyMoreResultsToDisplay()),this.isCurrentlyFetchingMoreResults()?(this.logger.warn("Ignoring request to display more results since we're already doing so"),void 0):this.hasPotentiallyMoreResultsToDisplay()?(this.options.enableInfiniteScrollWaitingAnimation&&this.showWaitingAnimationForInfiniteScrolling(),this.fetchingMoreResults=this.queryController.fetchMore(t),this.fetchingMoreResults.done(function(n){e.Assert.exists(n),i.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.pagerScrolling,{},i.element);var o=n.results;i.reachedTheEndOfResults=t>n.results.length,i._buildResults(n),e._.each(o,function(e){i.currentlyDisplayedResults.push(e)}),e.$(i.element).trigger(e.ResultListEvents.newResultsDisplayed,{})}),this.fetchingMoreResults.always(function(){i.hideWaitingAnimationForInfiniteScrolling(),i.fetchingMoreResults=void 0,e.Defer.defer(function(){return i.handleScrollOfResultList()})}),void 0):(this.logger.warn("Ignoring request to display more results since we know there aren't more to display"),void 0)},i.prototype._triggerNewResultDisplayed=function(t,i){var n={result:t,item:i};e.$(this.element).trigger(e.ResultListEvents.newResultDisplayed,n)},i.prototype._buildResults=function(t){var i=this;e.$.each(t.results,function(t,n){var o=i._instantiateTemplateForResult(n);null!=o&&(e.$(i.options.resultContainer).append(o),i._autoCreateComponentsInsideResult(o,n),i._triggerNewResultDisplayed(n,o))})},i.prototype._instantiateTemplateForResult=function(t){e.Assert.exists(t),e.QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(),t);var i=this.options.resultTemplate.instantiateToElement(t);return null!=i&&e.Component.bindResultToElement(i,t),i},i.prototype._autoCreateComponentsInsideResult=function(t,i){e.Assert.exists(t);var n=this.searchInterface.options.originalOptionsObject,o=e._.extend({},this.getBindings(),{resultElement:t}),s={options:n,bindings:o,result:i};e.CoveoJQuery.automaticallyCreateComponentsInside(t,s)},i.prototype.handleDuringQuery=function(){this.logger.trace("Emptying the result container"),this.currentlyDisplayedResults=[],this.cancelFetchingMoreResultsIfNeeded(),this.showWaitingAnimation(),this.showOrHideElementsDependingOnState(!1,!1)},i.prototype.handleProcessNewQueryResults=function(t,i){if(e.Assert.exists(i),e.Assert.exists(i.results),e.$(this.element).fastToggle(!this.disabled),!this.disabled){var n=i.results;this.logger.trace("Received query results from new query",n),this.hideWaitingAnimation(),this.options.resultContainer.innerHTML="",this.currentlyDisplayedResults=[],this._buildResults(n),this.currentlyDisplayedResults=n.results,this.reachedTheEndOfResults=!1,this.showOrHideElementsDependingOnState(!0,0!=this.currentlyDisplayedResults.length),this.options.enableInfiniteScroll&&n.results.length==i.queryBuilder.numberOfResults&&this.handleScrollOfResultList(),e.DeviceUtils.isMobileDevice()&&void 0!=this.options.mobileScrollContainer&&(this.options.mobileScrollContainer.scrollTop=0),e.$(this.element).trigger(e.ResultListEvents.newResultsDisplayed,{})}},i.prototype.handleScrollOfResultList=function(e){this.isCurrentlyFetchingMoreResults()||this.isScrollingOfResultListAlmostAtTheBottom()&&this.hasPotentiallyMoreResultsToDisplay()&&this.displayMoreResults(this.options.infiniteScrollPageSize,null!=e)},i.prototype.isCurrentlyFetchingMoreResults=function(){return e.Utils.exists(this.fetchingMoreResults)},i.prototype.isScrollingOfResultListAlmostAtTheBottom=function(){var t;try{t=e.$(this.options.infiniteScrollContainer).get(0)instanceof Window}catch(i){t=!1}return t?this.isScrollAtBottomForWindowElement():this.isScrollAtBottomForHtmlElement()},i.prototype.isScrollAtBottomForWindowElement=function(){var t=e.$(window).height(),i=e.$(window).scrollTop(),n=e.$(document).height();return t/2>n-(t+i)},i.prototype.isScrollAtBottomForHtmlElement=function(){var t=e.$(this.options.infiniteScrollContainer).innerHeight(),i=e.$(this.options.infiniteScrollContainer).get(0).scrollHeight,n=e.$(this.options.infiniteScrollContainer).scrollTop()+t;return t/2>i-n},i.prototype.hasPotentiallyMoreResultsToDisplay=function(){return this.currentlyDisplayedResults.length>0&&!this.reachedTheEndOfResults},i.prototype.cancelFetchingMoreResultsIfNeeded=function(){this.isCurrentlyFetchingMoreResults()&&(this.logger.trace("Cancelling fetching more results"),this.fetchingMoreResults.reject(),this.fetchingMoreResults=void 0)},i.prototype.showOrHideElementsDependingOnState=function(t,i){e.$(this.element).find(".coveo-show-if-query").fastToggle(t),e.$(this.element).find(".coveo-show-if-no-query").fastToggle(!t),e.$(this.element).find(".coveo-show-if-results").fastToggle(t&&i),e.$(this.element).find(".coveo-show-if-no-results").fastToggle(t&&!i)},i.prototype.showWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":e.$(this.options.waitAnimationContainer).addClass("coveo-fade-out");break;case"spinner":e.$(this.options.resultContainer).children().hide(),0==e.$(this.options.waitAnimationContainer).find(".coveo-wait-animation").length&&e.$(this.options.waitAnimationContainer).append(e.JQueryUtils.getLoadingSpinner())}},i.prototype.hideWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":e.$(this.options.waitAnimationContainer).removeClass("coveo-fade-out");break;case"spinner":e.$(this.options.waitAnimationContainer).children(".coveo-loading-spinner").detach()}},i.prototype.showWaitingAnimationForInfiniteScrolling=function(){e.$(this.options.waitAnimationContainer).append(e.JQueryUtils.getLoadingSpinner())},i.prototype.hideWaitingAnimationForInfiniteScrolling=function(){e.$(this.options.waitAnimationContainer).children(".coveo-loading-spinner").detach()},i.ID="ResultList",i.options={resultContainer:e.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){return e.$("<div/>").appendTo(t).get(0)}}),resultTemplate:e.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new e.DefaultResultTemplate}}),waitAnimation:e.ComponentOptions.buildStringOption({defaultValue:"none"}),waitAnimationContainer:e.ComponentOptions.buildChildHtmlElementOption({postProcessing:function(e,t){return e||t.resultContainer}}),enableInfiniteScroll:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),infiniteScrollPageSize:e.ComponentOptions.buildNumberOption({defaultValue:10,min:1}),infiniteScrollContainer:e.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){return e.JQueryUtils.findScrollingParent(t)}}),enableInfiniteScrollWaitingAnimation:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),mobileScrollContainer:e.ComponentOptions.buildSelectorOption({defaultFunction:function(){return e.$(".coveo-results-column").get(0)}})},i}(e.Component);e.ResultList=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){void 0===r&&(r=e.ResultList.ID),t.call(this,n,o,s,i.ID),this.element=n,this.options=o,this.columnResultsArray=[],this.imagesInCurrentRow=[],this.imagesLoaded=0,this.resultIndex=0,this.lastRowHeight=0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.lastRowHeight=this.options.heightThreshold,e.$(this.root).on(e.ResultListEvents.newResultsDisplayed,e.$.proxy(this.handleProcessNewResultsDisplayed,this)),this.bindWindowResizeEvent()}return __extends(i,t),i.prototype.getResultsElement=function(){return e.$(this.element).find(".CoveoResult")},i.prototype.getResultsElementImages=function(){return e.$(this.element).find(".CoveoResult img")},i.prototype.getResultsContainerDiv=function(){return e.$(this.element).find("> div")},i.prototype.bindWindowResizeEvent=function(){var t,i=this;e.$(window).on("resize",function(){clearTimeout(t),t=setTimeout(i.retrieveLayoutMethod(),250)})},i.prototype.handleProcessNewResultsDisplayed=function(){this.disabled?e.$(this.element).fadeOut():e.$(this.element).fadeIn(),this.onImageProxy(this.retrieveLayoutMethod())},i.prototype.addTransitionAllToElement=function(t){e._.defer(function(){t.addClass("coveo-transition-all")})},i.prototype.retrieveLayoutMethod=function(){var e=this;if(!this.disabled){if(this.options.layoutType.toLowerCase()==i.columnLayoutTypeStr)return function(){return e.setupColumns()};if(this.options.layoutType.toLowerCase()==i.rowLayoutTypeStr)return function(){return e.setupRows()}}return function(){}},i.prototype.onImageProxy=function(t){var i=(this.getResultsElement().each(function(t,i){0==e.$(i).find("img").length&&e.$(i).detach()}),this.getResultsElementImages()),n=0,o=function(o){e.$(o).height()>0?(null==e.$(o).attr("width")&&null==e.$(o).attr("height")&&(e.$(o).attr("height",e.$(o).height()),e.$(o).attr("width",e.$(o).width())),n++,n==i.length&&t()):(e.$(o).parent().detach(),i=i.not(o),n==i.length&&t())};i.each(function(t,i){this.src&&this.complete||e.$(i).height()>0?o(i):e.$(i).off("load").one("load",function(){o(i)})})},i.prototype.getHorizontalMargin=function(e){return parseInt(e.css("margin-left"))+parseInt(e.css("margin-right"))},i.prototype.getVerticalMargin=function(e){return parseInt(e.css("margin-top"))+parseInt(e.css("margin-bottom"))},i.prototype.setupColumns=function(){var t=this.getResultsContainerDiv().width(),i=this.getResultsElement(),n=this.options.columnWidth,o=this.getHorizontalMargin(i),s=Math.floor(t/(n+o));this.columnResultsArray=[];for(var r=0;s>r;r++)this.columnResultsArray.push(o);this.positionColumns(n,o),e.$(this.element).trigger(e.ImageResultListEvents.imageResultsLayoutComplete,{}),this.options.enableInfiniteScroll&&this.adjustNumberOfResults()},i.prototype.positionColumns=function(t,i){var n=this,o=this.getResultsElement();e._.each(o,function(o){var s=e._.min(n.columnResultsArray),r=e.$.inArray(s,n.columnResultsArray),a=i+r*(t+i);e.$(o).css({left:a+"px",top:s+"px",width:t+"px"}),n.columnResultsArray[r]=s+e.$(o).outerHeight()+i}),this.setResultsContainerHeight(e._.max(this.columnResultsArray)),this.addTransitionAllToElement(o)},i.prototype.setResultsContainerHeight=function(t){e.$(this.element).height(Math.ceil(t)),e.$(this.element).attr("data-height",Math.ceil(t))},i.prototype.setupRows=function(){var t=this.getResultsElement(),i=e.$(this.element).width();this.resultIndex=0;for(var n=0;this.resultIndex<t.length;){this.imagesInCurrentRow=[];var o=this.getCurrentRowHeight(t,i);this.setCurrentRowImagesDimensions(t,o,n),n+=o}this.setResultsContainerHeight(n),e.$(this.element).trigger(e.ImageResultListEvents.imageResultsLayoutComplete,{}),this.addTransitionAllToElement(t),this.options.enableInfiniteScroll&&this.adjustNumberOfResults()},i.prototype.getCurrentRowHeight=function(e,t){for(var i=0,n=null;this.resultIndex<e.length&&(null==n||n>=this.options.heightThreshold);){var o=this.getImageDimensionsFromResult(e.eq(this.resultIndex));null!=o&&(i+=o.width/o.height,n=t/i),this.imagesInCurrentRow.push(this.resultIndex),this.resultIndex++}return n>this.options.heightThreshold&&(n=this.lastRowHeight),this.lastRowHeight=n,n},i.prototype.getImageDimensionsFromResult=function(e){var t=e.find("img"),i=parseInt(t.attr("height")),n=parseInt(t.attr("width"));return{height:i,width:n}},i.prototype.setCurrentRowImagesDimensions=function(t,i,n){var o=this,s=0;e._.each(this.imagesInCurrentRow,function(e){var r=parseInt(t.eq(e).find("img").attr("width")),a=parseInt(t.eq(e).find("img").attr("height")),l=r*i/a,u=o.getHorizontalMargin(t.eq(e)),c=o.getVerticalMargin(t.eq(e));t.eq(e).css({height:Math.round(i-c),width:Math.round(l-u),left:Math.round(s),top:Math.round(n)}),s+=l})},i.prototype.adjustNumberOfResults=function(){var i=Number(e.$(this.element).attr("data-height"));0==e.$.isNumeric(i)&&(i=e.$(this.element).height()),i<e.$(this.options.infiniteScrollContainer).height()&&t.prototype.hasPotentiallyMoreResultsToDisplay.call(this)&&t.prototype.displayMoreResults.call(this,this.options.infiniteScrollPageSize,!1)},i.ID="ImageResultList",i.rowLayoutTypeStr="row",i.columnLayoutTypeStr="column",i.options={layoutType:e.ComponentOptions.buildStringOption({defaultValue:"row",postProcessing:function(e){return e.toLowerCase()}}),heightThreshold:e.ComponentOptions.buildNumberOption({defaultValue:250,min:16}),columnWidth:e.ComponentOptions.buildNumberOption({defaultValue:225,min:16})},i}(e.ResultList);e.ImageResultList=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.ajaxBasicAuth=function(i,n,o,s,r,a){e.$.ajax({type:i,timeout:5e3,url:n,beforeSend:function(i){null!=o&&null!=s&&(i.setRequestHeader("Authorization",t.getBasicAuthBase64(o,s)),e.DeviceUtils.isPhonegap()&&i.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"))}}).fail(function(e){a&&a(e)}).done(function(e){r(e)})},t.getBasicAuthBase64=function(e,t){return"Basic "+btoa(e+":"+t)},t}();e.AjaxUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.loginPanel=t,this.userInputTemplate=e._.template("<div class='coveo-input-container'>          <span class='coveo-username-icon'></span>          <input class='coveo-username' type='text' placeholder='"+e.l("Username")+"' autocorrect='off' autocapitalize='off' />      </div>"),this.passwordInputTemplate=e._.template("<div class='coveo-input-container'>          <span class='coveo-password-icon'></span>          <input class='coveo-password'  type='password' placeholder='"+e.l("Password")+"' autocorrect='off' autocapitalize='off' />      </div>"),this.containerTemplate=e._.template("<div class='coveo-login-credentials-container'></div>")}return t.prototype.buildDom=function(){var t=this;this.credentialContainer=e.$(this.containerTemplate()),this.loginUser=e.$(this.userInputTemplate()),this.loginUser.keypress(function(e){return t.handleInputKeypress(e)}),this.loginPassword=e.$(this.passwordInputTemplate()),this.loginPassword.keypress(function(e){return t.handleInputKeypress(e)}),this.credentialContainer.append(this.loginUser,this.loginPassword),this.loginPanel.getOrCreateContainer().append(this.credentialContainer),this.loginUser.find("input").val(this.getUser()),this.loginPassword.find("input").val(this.getPassword())},t.prototype.show=function(){this.credentialContainer.show()},t.prototype.getUser=function(){return window.localStorage.getItem(this.getLocalStorageKeyUser())},t.prototype.setUser=function(e){this.loginUser.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyUser(),e)},t.prototype.getPassword=function(){return window.localStorage.getItem(this.getLocalStorageKeyPassword())},t.prototype.setPassword=function(e){this.loginPassword.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyPassword(),e)},t.prototype.validate=function(){var t=e.$.Deferred();return this.setPassword(this.getPasswordFromInput()),this.setUser(this.getUserFromInput()),t.resolve(!0),t},t.prototype.submit=function(){var t=e.$.Deferred();return this.setPassword(this.getPasswordFromInput()),this.setUser(this.getUserFromInput()),t.resolve(!0),t},t.prototype.getLocalStorageKeyUser=function(){return"coveo-user-"+this.loginPanel.options.id},t.prototype.getLocalStorageKeyPassword=function(){return"coveo-password-"+this.loginPanel.options.id},t.prototype.getPasswordFromInput=function(){return this.loginPassword.find("input").val()},t.prototype.getUserFromInput=function(){return this.loginUser.find("input").val()},t.prototype.handleInputKeypress=function(e){this.loginPanel.isHidden||13!=e.keyCode||this.loginPanel.submit()},t}();e.LoginCredentials=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.filename=e,this.flags=t}return t.prototype.done=function(e){return this._success=e,this},t.prototype.fail=function(e){return this._error=e,this},t.prototype.tryAccess=function(){this.tryGetFilesystem()},t.prototype._onGotFileEntry=function(){},t.prototype.tryGetFilesystem=function(){window.requestFileSystem(LocalFileSystem.PERSISTENT,0,e.$.proxy(this._gotFileSystem,this),e.$.proxy(this.onError,this))},t.prototype._gotFileSystem=function(t){t.root.getFile(this.filename,this.flags,e.$.proxy(this._onGotFileEntry,this),e.$.proxy(this.onError,this))},t.prototype.onError=function(e){this._error(e)},t}();e.PhonegapFileAccess=t;var i=function(t){function i(e){t.call(this,e,null)}return __extends(i,t),i.prototype.read=function(){return this.tryAccess(),this},i.prototype._onGotFileEntry=function(e){this.gotFileEntry(e)},i.prototype.gotFileEntry=function(t){t.file(e.$.proxy(this.gotFile,this),e.$.proxy(this._error,this))},i.prototype.gotFile=function(e){var t=this,i=new FileReader;i.onloadend=function(e){t._success&&t._success(e.target.result)},i.readAsText(e)},i}(t);e.PhonegapFileReader=i;var n=function(t){function i(e,i){void 0===i&&(i=!1),t.call(this,e,{create:!0,exclusive:!1}),this.append=i}return __extends(i,t),i.prototype.write=function(e){return this.content=e,this.tryAccess(),this},i.prototype._onGotFileEntry=function(t){t.createWriter(e.$.proxy(this.gotFileWriter,this),e.$.proxy(this._error,this))},i.prototype.gotFileWriter=function(e){var t=this;e.onwriteend=function(e){t._success&&t._success(e)},this.append&&e.seek(e.length),e.write(this.content)},i}(t);e.PhonegapFileWriter=n}(Coveo||(Coveo={}));var Coveo;!function(Coveo){var LoginPageSettings=function(){function LoginPageSettings(e){this.loginPanel=e,this.pageSettingsInputTemplate=Coveo._.template("<div class='coveo-input-container'>          <span class='coveo-page-settings-icon'></span>          <input class='coveo-page-settings' type='text' placeholder='"+Coveo.l("PageUrl")+"' autocorrect='off' autocapitalize='off' />    </div>")}return LoginPageSettings.prototype.buildDom=function(){var e=this,t=Coveo.$("<div></div>").addClass("coveo-login-page-settings-container");this.pageSettings=Coveo.$(this.pageSettingsInputTemplate()),this.pageSettings.keypress(function(t){return e.handleInputKeypress(t)}),t.append(this.pageSettings),this.pageSettings.find("input").val(this.getPageSettingsUrl()),this.loginPanel.getOrCreateContainer().append(t)},LoginPageSettings.prototype.getPageSettingsUrl=function(){return window.localStorage.getItem(this.getLocalStorageKeyPageUrl())},LoginPageSettings.prototype.setPageSettingsUrl=function(e){this.pageSettings.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyPageUrl(),e)},LoginPageSettings.prototype.submit=function(e){var t=this.pageSettings.find("input").val();this.setPageSettingsUrl(t);var i=Coveo.$.Deferred();return this.tryToWriteFileToDisc(e,i,!0),i},LoginPageSettings.prototype.validate=function(e){var t=Coveo.$.Deferred();return this.getPageSettingsUrl()?this.tryToReadFileFomDisc(e,t,!1):t.reject(),t},LoginPageSettings.prototype.getLocalStorageKeyPageUrl=function(){return"coveo-page-settings-url-"+this.loginPanel.options.id},LoginPageSettings.prototype.getSearchApiRootUrl=function(){var e=this.getPageSettingsUrl().trim();return/https?:\/\/[^\/]*\/?$/.test(e)?e:e.match(/^(.*)\/[^\/]*$/)[1]},LoginPageSettings.prototype.handleInputKeypress=function(e){this.loginPanel.isHidden||13!=e.keyCode||this.loginPanel.submit()},LoginPageSettings.prototype.loadFromInterfaceEditorUrl=function(e){var t=document.createElement("a");return t.href=e,"/load"==t.pathname?""!=Coveo.Utils.getQueryStringValue("id",t.search)||-1!=e.indexOf("?id")?e:e+"?id":e+"/load?id"},LoginPageSettings.prototype.tryToWriteFileToDisc=function(e,t,i){var n=this;void 0===i&&(i=!1);var o=this.getPageSettingsUrl();Coveo.AjaxUtils.ajaxBasicAuth("GET",this.loadFromInterfaceEditorUrl(o),this.loginPanel.getUser(),this.loginPanel.getPassword(),function(o){Coveo.DeviceUtils.isPhonegap()?new Coveo.PhonegapFileWriter("SearchPage.html").write(JSON.stringify(o)).done(function(){n.loginPanel.logger.info("Found the page and successfully wrote to disc",n.getPageSettingsUrl()),i&&e.done(function(){n.loginPanel.logger.info("Replacing body content with new search page",n.getPageSettingsUrl()),n.writeDocumentContent(o.body)}),t.resolve()}).fail(function(){n.loginPanel.logger.error("Found the file but unable to write",n.getPageSettingsUrl()),t.reject(Coveo.l("ErrorSavingToDevice"))}):(n.loginPanel.logger.info("Found the page",n.getPageSettingsUrl()),i&&n.writeDocumentContent(o.body),t.resolve())},function(){void 0==n.getPageSettingsUrl()||""==n.getPageSettingsUrl()?(n.loginPanel.logger.error("Search page url is empty"),t.reject(Coveo.l("PleaseEnterYourSearchPage"))):(n.loginPanel.logger.error("Unable to find the file",n.getPageSettingsUrl()),t.reject(Coveo.l("CannotConnectSearchPage")))})},LoginPageSettings.prototype.tryToReadFileFomDisc=function(e,t,i){var n=this;void 0===i&&(i=!1),Coveo.DeviceUtils.isPhonegap()?new Coveo.PhonegapFileReader("SearchPage.html").read().done(function(o){n.loginPanel.logger.info("Found the page on disc",n.getPageSettingsUrl()),i&&e.done(function(){var e=JSON.parse(o).body;n.writeDocumentContent(e)}),n.tryToWriteFileToDisc(Coveo.$.Deferred(),Coveo.$.Deferred(),!1),t.resolve()}).fail(function(){n.getPageSettingsUrl()?(n.loginPanel.logger.info("Unable to find the page on disc",n.getPageSettingsUrl()),n.loginPanel.logger.info("Trying to fetch it with GET request and write to disc"),n.tryToWriteFileToDisc(e,t,!1)):t.reject(Coveo.l("ErrorReadingFromDevice"))}):this.tryToWriteFileToDisc(e,t,i)},LoginPageSettings.prototype.writeDocumentContent=function(e){document.body.outerHTML=e,this.appendMissingLoginComponentIfNeeded(),this.configureNewEndpoints(),Coveo.TemplateCache.scanAndRegisterTemplates(),this.initNewSearchInterface()},LoginPageSettings.prototype.appendMissingLoginComponentIfNeeded=function(){var e=Coveo.$("."+Coveo.Component.computeCssClassNameForType(Coveo.Login.ID));if(0==e.length){var t=Coveo.$('<div class="CoveoLogin" data-require-page-settings="true"></div>');this.loginPanel.options.requireLogin?t.attr("data-require-login","true"):t.attr("data-require-login","false"),Coveo.$(".coveo-tab-section").append(t)}else{var i=e.attr("data-require-page-settings");("false"==i||void 0==i)&&e.attr("data-require-page-settings","true")}},LoginPageSettings.prototype.configureNewEndpoints=function(){var scripts=Coveo.$("body").find("script.CoveoEndpoint");Coveo._.each(scripts,function(script){eval(Coveo.$(script).text())});var endpoint=Coveo.SearchEndpoint.endpoints["default"];null!=endpoint&&0==endpoint.options.restUri.indexOf("/rest/search")&&(endpoint.options.restUri=this.getSearchApiRootUrl()+endpoint.options.restUri,endpoint.reset(),this.loginPanel.logger.info("Overrode the REST API uri",endpoint.options.restUri))},LoginPageSettings.prototype.initNewSearchInterface=function(){var scripts=Coveo.$("body").find("script.CoveoInit");if(0!=scripts.length)Coveo.InitializeFromPhonegap=!0,Coveo._.each(scripts,function(script){eval(Coveo.$(script).text())});else{var searchInterface=Coveo.$("."+Coveo.Component.computeCssClassNameForType(Coveo.SearchInterface.ID));0!=searchInterface.length?searchInterface.coveo("init"):Coveo.$("#search").coveo("init")}},LoginPageSettings}();Coveo.LoginPageSettings=LoginPageSettings}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){void 0===r&&(r=i.ID),t.call(this,n,r,s),this.element=n,this.options=o,this.errorMessageTemplate=e._.template("<div class='coveo-login-error-message'></div>"),this.captionTemplate=e._.template("<div class='coveo-login-caption'></div>"),this.tabButtonTemplate=e._.template("<div class='coveo-login-tab'>Login</div>"),this.containerTemplate=e._.template("<div class='coveo-login-form-container'></div>"),this.submitButtonTemplate=e._.template("<button class='coveo-submit'type='submit'><div class='coveo-icon coveo-waiting'></div>"+e.l("GetStarted")+"</button>"),this.combinedTemplate=e._.template("<div class='coveo-login-combined coveo-active'></div>"),this.logoTemplate=e._.template("<div class='coveo-login-logo'></div>"),this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(this.options.id),e.Assert.exists(e.SearchEndpoint.endpoints[this.options.id]),this.isHidden=!0,this.options.requireLogin&&(this.credentials=new e.LoginCredentials(this)),this.options.requirePageSettings&&(this.pageSettings=new e.LoginPageSettings(this)),this.loadingAnimation=e.$(this.searchInterface.options.firstLoadingAnimation),this.bind.onRoot(e.QueryEvents.queryError,this.handleQueryError),this.buildTabButton(),this.ensureDom(),this.updateEndpointWithCredentials(),this.resetErrorMessage(),this.hide(),this.validate()}return __extends(i,t),i.prototype.getPageSettingsUrl=function(){return this.pageSettings?this.pageSettings.getPageSettingsUrl():void 0},i.prototype.setPageSettingsUrl=function(e){this.pageSettings&&this.pageSettings.setPageSettingsUrl(e)},i.prototype.getUser=function(){return this.credentials?this.credentials.getUser():void 0},i.prototype.setUser=function(e){this.credentials&&this.credentials.setUser(e)},i.prototype.getPassword=function(){return this.credentials?this.credentials.getPassword():void 0},i.prototype.setPassword=function(e){this.credentials&&this.credentials.setPassword(e)},i.prototype.setErrorMessage=function(e){this.errorMessage.text(e),this.errorMessage.show(),this.logo.hide()},i.prototype.resetErrorMessage=function(){this.errorMessage.text(""),this.errorMessage.hide(),this.logo.show()},i.prototype.createDom=function(){var t=this;this.logo=e.$(this.logoTemplate()),this.getOrCreateCombined().append(this.logo),this.caption=e.$(this.captionTemplate()),this.options.caption&&this.caption.text(this.options.caption),this.errorMessage=e.$(this.errorMessageTemplate()),this.getOrCreateCombined().append(this.errorMessage),this.getOrCreateContainer().append(this.caption),this.credentials&&this.credentials.buildDom(),this.pageSettings&&this.pageSettings.buildDom(),this.submitButton=e.$(this.submitButtonTemplate()),this.submitButton.click(function(){return t.submit()}),this.getOrCreateContainer().append(this.submitButton)},i.prototype.getOrCreateContainer=function(){return this.container||(this.container=e.$(this.containerTemplate()),this.getOrCreateCombined().append(this.container)),this.container},i.prototype.getOrCreateCombined=function(){return this.combined||(this.combined=e.$(this.combinedTemplate()),e.$(this.root).append(this.combined)),this.combined},i.prototype.hide=function(){this.isHidden=!0,this.getOrCreateCombined().hide()},i.prototype.hideAndExecuteQuery=function(){this.hide(),this.queryController.executeQuery()},i.prototype.validate=function(){this.baseValidationEvent("validate",this.hide)},i.prototype.submit=function(){var e=this,t=function(){e.credentials&&e.updateEndpointWithCredentials(),e.pageSettings||e.hideAndExecuteQuery()};this.baseValidationEvent("submit",t)},i.prototype.isAccessDeniedError=function(e){return 401===e.status||403===e.status},i.prototype.baseValidationEvent=function(t,i){var n=this;e.MobileUtils.hideIOSKeyboard(document.activeElement),this.resetErrorMessage();var o=[],s=e.$.Deferred();this.credentials&&o.push(this.credentials[t](s)),this.pageSettings&&o.push(this.pageSettings[t](s)),e.$.when.apply(this,o).fail(function(t){n.show(),s.reject(!1),n.pageSettings&&e.Utils.isNonEmptyString(n.getPageSettingsUrl())&&n.setErrorMessage(t),n.credentials&&(e.Utils.isNonEmptyString(n.getPassword())||e.Utils.isNonEmptyString(n.getUser()))&&n.setErrorMessage(t)}).always(function(){n.submitButton.removeClass("coveo-waiting")}).done(function(){s.resolve(!0),e.$.proxy(i,n)})},i.prototype.show=function(){this.isHidden=!1,this.ensureDom(),e.MobileUtils.removeToggleClassOnSearchInterface(),this.getOrCreateCombined().show(),e.DeviceUtils.isPhonegap()&&e.$(document).on("backbutton",e.$.proxy(this.handleBackButton,this))},i.prototype.handleBackButton=function(){this.hide(),e.$(document).off("backbutton")},i.prototype.handleQueryError=function(t,i){this.isAccessDeniedError(i.error)&&(this.setErrorMessage(e.l("BadUserPass")),this.show())
},i.prototype.updateEndpointWithCredentials=function(){this.credentials&&void 0!=e.SearchEndpoint.endpoints[this.options.id]&&(e.SearchEndpoint.endpoints[this.options.id].options.password=this.getPassword(),e.SearchEndpoint.endpoints[this.options.id].options.username=this.getUser())},i.prototype.buildTabButton=function(){var t=this;e.$(this.element).append(e.$(this.tabButtonTemplate())),e.$(this.element).click(function(){t.show()})},i.ID="Login",i.options={id:e.ComponentOptions.buildStringOption({defaultValue:"default"}),caption:e.ComponentOptions.buildLocalizedStringOption(),autoTriggerQuery:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),requireLogin:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),requirePageSettings:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.Login=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.listenToQueryStateChange=!0,this.ignoreNextQuerySuccess=!1,this.needToReset=!0,this.listItemTemplate=e._.template('<li class="<%= _class %> coveo-pager-list-item"></li>'),this.listItemValueTemplate=e._.template('<a class="coveo-pager-anchor"><%= listItemValue %></a>'),this.navigationButtonTemplate=e._.template('<li class="<%= _class %> coveo-pager-list-item"><a><span title="<%= buttonValue %>"/></a></li>'),this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.currentPage=1,this.bind.onRoot(e.QueryEvents.newQuery,function(e,t){return r.handleNewQuery(e,t)}),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.onRoot(e.QueryEvents.querySuccess,function(e,t){return r.handleQuerySuccess(e,t)}),this.bind.onRoot(e.QueryEvents.queryError,function(e,t){return r.handleQueryError(e,t)}),this.bind.onRoot(e.QueryEvents.noResults,function(e,t){return r.handleNoResults(e,t)});var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.first);e.$(this.queryStateModel.element).on(a,e.$.proxy(this.handleQueryStateModelChanged,this)),this.list=e.$("<ul></ul>").addClass("coveo-pager-list").appendTo(n)}return __extends(i,t),i.prototype.setPage=function(t,i){void 0===i&&(i=e.AnalyticsActionCauseList.pagerNumber),e.Assert.exists(t),this.currentPage=Math.max(Math.min(t,1e3),1),this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage)),this.usageAnalytics.logCustomEvent(i,{pagerNumber:this.currentPage},this.element),this.queryController.deferExecuteQuery({ignoreWarningSearchEvent:!0,keepLastSearchUid:!0,origin:this})},i.prototype.previousPage=function(){this.setPage(this.currentPage-1,e.AnalyticsActionCauseList.pagerPrevious)},i.prototype.nextPage=function(){this.setPage(this.currentPage+1,e.AnalyticsActionCauseList.pagerNext)},i.prototype.handleNewQuery=function(e,t){var n=t&&t.origin&&t.origin.type==i.ID;this.needToReset&&!n&&(this.currentPage=1,this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage))),this.needToReset=!0},i.prototype.updateQueryStateModel=function(t){this.listenToQueryStateChange=!1,this.queryStateModel.set(e.QueryStateModel.attributesEnum.first,t),this.listenToQueryStateChange=!0},i.prototype.handleQueryError=function(){this.reset()},i.prototype.handleQuerySuccess=function(t,i){var n=this;if(this.reset(),this.ignoreNextQuerySuccess)this.ignoreNextQuerySuccess=!1;else{e.Assert.isNotUndefined(i);var o=i.query.firstResult,s=i.results.totalCountFiltered,r=this.computePagerBoundary(o,s);if(this.currentPage=r.currentPage,r.end-r.start>0){for(var a=r.start;a<=r.end;a++){var l=e.$(this.listItemValueTemplate({listItemValue:a}));!function(t){var i=e.$(n.listItemTemplate({_class:t==n.currentPage?"coveo-active":""})).click(function(){return n.handleClickPage(t)});i.append(l).appendTo(n.list)}(a)}this.options.enableNavigationButton&&r.lastResultPage>1&&this.renderNavigationButton(r,this.list)}}},i.prototype.handleNoResults=function(e,t){var i=this.computePagerBoundary(t.results.totalCountFiltered,t.results.totalCount).lastResultPage;this.currentPage>i&&(this.ignoreNextQuerySuccess=!0,this.setPage(i))},i.prototype.reset=function(){e.$(this.list).empty()},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.getQueryEventArgs();i.queryBuilder.firstResult=n.first,i.queryBuilder.numberOfResults=n.count},i.prototype.computePagerBoundary=function(e,t){var i=this.queryController.options.resultsPerPage,n=Math.floor(e/i)+1,o=Math.ceil(t/i);o=Math.max(o,1);var s=Math.floor(this.options.numberOfPages/2),r=n-s;r=Math.max(r,1);var a=r+this.options.numberOfPages-1;return a=Math.min(a,o),{start:r,end:a,lastResultPage:o,currentPage:n}},i.prototype.renderNavigationButton=function(t,i){var n=this;if(this.currentPage>1){var o=e.$(this.navigationButtonTemplate({_class:"coveo-pager-previous coveo-pager-anchor",buttonValue:e.l("Previous")})).prependTo(i);o.click(function(){return n.handleClickPrevious()})}if(this.currentPage<t.lastResultPage){var s=e.$(this.navigationButtonTemplate({_class:"coveo-pager-next coveo-pager-anchor",buttonValue:e.l("Next")})).appendTo(i);s.click(function(){return n.handleClickNext()})}},i.prototype.handleQueryStateModelChanged=function(t,i){if(this.listenToQueryStateChange){e.Assert.exists(i),this.needToReset=!1;var n=i.value;this.currentPage=this.fromFirstResultsToPageNumber(n)}},i.prototype.handleClickPage=function(t){e.Assert.exists(t),this.setPage(t)},i.prototype.handleClickPrevious=function(){this.previousPage()},i.prototype.handleClickNext=function(){this.nextPage()},i.prototype.fromFirstResultsToPageNumber=function(e){return e/this.queryController.options.resultsPerPage+1},i.prototype.getFirstResultNumber=function(e){return void 0===e&&(e=this.currentPage),(e-1)*this.queryController.options.resultsPerPage},i.prototype.getQueryEventArgs=function(){return{count:this.queryController.options.resultsPerPage,first:this.getFirstResultNumber()}},i.ID="Pager",i.options={numberOfPages:e.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:10},min:1}),enableNavigationButton:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.Pager=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).is("script"))try{this.content=JSON.parse(e.Utils.decodeHTMLEntities(e.$(this.element).text()))}catch(a){try{this.content=JSON.parse(e.$(this.element).text())}catch(a){return}}this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)})}return __extends(i,t),i.prototype.handleBuildingQuery=function(t,i){var n=this;null==i.queryBuilder.context&&(i.queryBuilder.context={});var o=this.getContextKeys();e._.each(o,function(e){i.queryBuilder.context[e]=n.getContextValue(e)})},i.prototype.getContextKeys=function(){return this.content?e._.keys(this.content):[]},i.prototype.getContextValue=function(e){return this.content[e]},i.ID="PipelineContext",i}(e.Component);e.PipelineContext=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n){this.boxInputToBuild=t,this.nameOfInput=i,this.type=n,this.inputs={},this.inputTemplate=e._.template("<div class='coveo-choice-container'>        <div class='coveo-section coveo-section-input'>          <input <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' type='<%= type %>' name='<%= name%>' value='<%= label %>' ></input><span class='coveo-input-icon'></span><label class='coveo-preferences-panel-item-label' for='coveo-<%= label %>'><%= label %></label>        </div>        <div class='coveo-section coveo-section-tab'><%- tab %></div>      <div class='coveo-section coveo-section-expression'><%- expression %></div>      </div>")}return t.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.boxInputToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.nameOfInput,type:t.type,otherAttribute:i.otherAttribute,tab:i.tab,expression:i.expression})),t.inputs[i.label]}),function(e,t){return e.add(t)})},t.prototype.select=function(t){e.Assert.exists(this.inputs[t]),this.inputs[t].find("input").prop("checked",!0),this.inputs[t].find(".coveo-input-icon").addClass("coveo-selected")},t.prototype.unselect=function(t){e.Assert.exists(this.inputs[t]),this.inputs[t].find("input").prop("checked",!1),this.inputs[t].find(".coveo-input-icon").removeClass("coveo-selected")},t.prototype.getSelected=function(){var t=e._.find(this.inputs,function(e){return e.find("input").prop("checked")});return t.find("input").val()},t.prototype.getSelecteds=function(){var t=e._.filter(this.inputs,function(e){return e.find("input").prop("checked")});return e._.map(t,function(e){return e.find("input").val()})},t}();e.PreferencesPanelBoxInput=t;var i=function(e){function t(t,i){e.call(this,t,i,"radio"),this.radioElementToBuild=t,this.name=i}return __extends(t,e),t}(t);e.PreferencesPanelRadioInput=i;var n=function(t){function i(e,i){t.call(this,e,i,"checkbox"),this.checkboxElementToBuild=e,this.name=i}return __extends(i,t),i.prototype.build=function(){var i=t.prototype.build.call(this),n=(i.find("input"),i.find(".coveo-input-icon"));return e._.each(n,function(t){var i=e.$(t).siblings("input"),n=e.$(t);i.change(function(){n.toggleClass("coveo-selected",i.is(":checked"))}),n.click(function(){i.prop("checked",!i.is(":checked")),i.change()})}),i},i}(t);e.PreferencesPanelCheckboxInput=n;var o=function(){function t(t,i){this.textElementToBuild=t,this.name=i,this.inputs={},this.inputTemplate=e._.template("<div class='coveo-choice-container'><input <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' type='<%= type %>' name='<%= name%>' placeholder='<%= placeholder %>' ></input></div>")}return t.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.textElementToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.name,type:"text",otherAttribute:i.otherAttribute,placeholder:i.placeholder||i.label})),t.inputs[i.label]}),function(e,t){return e.add(t)})},t.prototype.getValues=function(){var t=this;return e._.map(this.inputs,function(e,i){return t.getInput(i).val()})},t.prototype.setValue=function(t,i){e.Assert.exists(this.inputs[t]),this.getInput(t).val(i)},t.prototype.reset=function(){e._.each(this.inputs,function(e){e.find("input").val("")})},t.prototype.getInput=function(t){e.Assert.exists(this.inputs[t]);var i=this.inputs[t].find("input");return 0==i.length&&(i=this.inputs[t].find("textarea")),i},t}();e.PreferencesPanelTextInput=o;var s=function(t){function i(){t.apply(this,arguments),this.inputTemplate=e._.template("<div class='coveo-choice-container'><textarea <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' name='<%= name%>' placeholder='<%= placeholder %>' ></textarea></div>")}return __extends(i,t),i.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.textElementToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.name,otherAttribute:i.otherAttribute,placeholder:i.placeholder||i.label})),t.inputs[i.label]}),function(e,t){return e.add(t)})},i}(o);e.PreferencesPanelTextAreaInput=s;var r=function(){function t(e,t,i){this.toBuild=e,this.options=t,this.name=i,this.textInput=new s([{label:e.label,otherAttribute:"readonly"}],i)}return t.prototype.build=function(){var t=this;return this.select=e.$("<select multiple></select>"),e._.each(this.options,function(i){t.select.append(e.$("<option>"+i+"</option>"))}),this.select.change(function(){var i=t.select.val();e.Utils.isNullOrUndefined(i)?t.reset():t.textInput.setValue(t.toBuild.label,i.join(","))}),this.textInput.build().append(this.select)},t.prototype.getValues=function(){return this.textInput.getValues()[0].split(",")},t.prototype.setValues=function(e){this.textInput.setValue(this.toBuild.label,e.join(","))},t.prototype.reset=function(){this.textInput.setValue(this.toBuild.label,"")},t}();e.PreferencePanelMultiSelectInput=r}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.buildCloseButton(),this.buildTitle()}return __extends(i,t),i.prototype.getCssClass=function(){return"coveo-preference-panel"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("Preferences"),onOpen:function(){return t.open()},onClose:function(){return t.close()}}]},i.prototype.open=function(){e.$(this.element).addClass("coveo-active")},i.prototype.close=function(){e.$(this.element).removeClass("coveo-active")},i.prototype.save=function(){e.$(this.element).trigger(e.PreferencesPanelEvents.savePreferences),this.queryController.executeQuery()},i.prototype.closeWithoutSave=function(){e.$(this.element).trigger(e.PreferencesPanelEvents.exitPreferencesWithoutSave)},i.prototype.buildCloseButton=function(){var t=this,i=e.$("<div class='coveo-preferences-panel-close'><span class='coveo-icon'></span></div>");i.click(function(){t.closeWithoutSave(),t.close()}),e.$(this.element).prepend(i)},i.prototype.buildTitle=function(){var t=e.$("<div class='coveo-preferences-panel-title'>"+e.l("Preferences")+"</div>");e.$(this.element).prepend(t)},i.ID="PreferencesPanel",i.options={},i}(e.Component);e.PreferencesPanel=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o);var a=r.raw.sysparents;a?this.renderParentsXml(n,a):this.renderUri(n,r),e.DeviceUtils.isPhonegap()&&e.PhonegapUtils.bindOpenLinkInPhonegap(n,this.uri)}return __extends(i,t),i.prototype.renderParentsXml=function(t,i){for(var n=e.$.parseXML(i),o=n.getElementsByTagName("parent"),s=[],r=[],a=0;a<o.length;a++){if(a>0){var l=this.buildSeperator();r.push(l),t.appendChild(l)}var u=o.item(a),c=this.buildHtmlToken(u.getAttribute("name"),u.getAttribute("uri"));s.push(c),t.appendChild(c)}if(s.length>1){var p=this.buildEllipsis();t.insertBefore(p,r[0]);var d=this.buildSeperator();t.insertBefore(d,p);for(var h=0,f=[],a=0;a<s.length;a++)f[a]=s[a].offsetWidth,h+=f[a];var m=r[0].offsetWidth,v=p.offsetWidth,g=t.offsetWidth;if(h>=g){h+=v+m;for(var y=[],a=1;a<s.length&&h>=g;)t.removeChild(s[a]),t.removeChild(r[a-1]),a>1&&y.push(r[a-1]),y.push(s[a]),h-=f[a]+m,a++;p.onclick=function(){for(var e=0;e<y.length;e++)t.insertBefore(y[e],p);t.removeChild(p)}}else t.removeChild(p),t.removeChild(d)}},i.prototype.renderUri=function(t,i){this.uri=i.clickUri;var n;n=-1==i.printableUri.indexOf("\\")?e.StringAndHoles.shortenUri(i.printableUri,e.$(t).width()/7):e.StringAndHoles.shortenPath(i.printableUri,e.$(t).width()/7);var o=e.HighlightUtils.highlightString(n.value,i.printableUriHighlights,n.holes,"coveo-highlight"),s=e.$("<a>").attr("title",i.printableUri).addClass("coveo-printable-uri").html(o);this.bindLogOpenDocument(s.get(0)),e.DeviceUtils.isPhonegap()||s.attr("href",i.clickUri),s.appendTo(t)},i.prototype.buildSeperator=function(){var e=document.createElement("span");return e.innerText=">",e.className="coveo-printable-uri-separator",e},i.prototype.buildEllipsis=function(){var e=document.createElement("span");return e.innerText="...",e.className="coveo-printable-uri",e},i.prototype.buildHtmlToken=function(t,i){var n=t.charAt(0).toUpperCase()+t.slice(1),o=document.createElement("a");return this.bindLogOpenDocument(o),e.DeviceUtils.isPhonegap()||(o.href=i),this.uri=i,o.className="coveo-printable-uri",o.innerText=n,o},i.prototype.bindLogOpenDocument=function(t){var i=this;e.$(t).on("mousedown touchend",e.$.proxy(function(t){var n=e.$(t.target).attr("href"),o=e.$(t.target).text();i.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentOpen,{documentURL:n,documentTitle:o},i.result,i.root)},this))},i.ID="PrintableUri",i.options={},i}(e.Component);e.PrintableUri=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Component.pointElementsToDummyForm(e.$(n)),e.$(n).change(function(e){r._handleChange(e)}),e.$(n).keyup(function(e){r._handleKeyUp(e)}),e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),e.$(this.root).on(e.QueryEvents.newQuery,e.$.proxy(this._handleNewQuery,this));var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(a,e.$.proxy(this._handleQueryStateChanged,this)),this._clearElement=e.$("<span></span>").addClass("coveo-query-box-clear").hide();e.$("<span></span>").addClass("coveo-icon").appendTo(this._clearElement);if(this._clearElement.click(function(){r.clear(),r._hideClearElement(),r.updateQueryState(),e.DeviceUtils.isMobileDevice()||e.$(r.element).focus(),r.queryController.isStandaloneSearchbox()||r.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return r.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxClear,{})}})}),e.DeviceUtils.isSmallScreenWidth()&&e.$(this.element).focus(function(){e.MobileUtils.removeToggleClassOnSearchInterface()}),e.$(this.element).after(this._clearElement),this.options.autoFocus)try{e.$(this.element).focus()}catch(l){}}return __extends(i,t),i.prototype.clear=function(){e.$(this.element).val(""),this.updateQueryState()},i.prototype.replace=function(t,i){e.$(this.element).val(e.$(this.element).val().replace(t,i)),this.updateQueryState()},i.prototype.replaceCurrentExpression=function(e){this.replace(this.getCurrentQueryExpression(),e),this.updateQueryState()},i.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),""),this.updateQueryState()},i.prototype.getCurrentQueryExpression=function(){var t=e.$(this.element).getCursorPosition(),i=e.$(this.element).val(),n=i.length,o=t,s=t;for(" "==i[o]&&o--;o>0&&" "!=i[o];)o--;for(;n>s&&" "!=i[s];)s++;return i.substring(o,s)},i.prototype.insertAt=function(t,i){var n=e.$(this.element).val(),o=[n.slice(0,t),i,n.slice(t)].join("");e.$(this.element).val(o),this.updateQueryState()},i.prototype._handleChange=function(){return this._addClearElement(),this.updateQueryState(),void 0},i.prototype._handleQueryStateChanged=function(t,i){e.Assert.exists(i);var n=i.value;e.$(this.element).val(n),this._addClearElement()},i.prototype._handleKeyUp=function(t){e.Assert.exists(t),this._addClearElement(),13==t.which?(this.logger.debug("Performing query because user pressed Enter"),this.updateQueryState(),this.enterOnSearchbox(),t.stopPropagation(),e.DeviceUtils.isMobileDevice()&&e.$(this.element).blur()):this.options.enableSearchAsYouType&&e.KeyboardUtils.isAllowedKeyForSearchAsYouType(t)&&this.startNewSearchAsYouTypeTimeout()},i.prototype._addClearElement=function(){""==e.$(this.element).val()?this._hideClearElement():this._showClearElement()},i.prototype._hideClearElement=function(){this._clearElement.hide()},i.prototype._showClearElement=function(){this._clearElement.show()},i.prototype.startNewSearchAsYouTypeTimeout=function(){var t=this;this.cancelAnyPendingSearchAsYouTypeTimeout(),this.searchAsYouTypeTimeout=setTimeout(function(){t.updateQueryState(),t.triggerNewQuery(function(){return t.usageAnalytics.logSearchAsYouType(e.AnalyticsActionCauseList.searchboxAsYouType,{})},!0)},this.options.searchAsYouTypeDelay)},i.prototype._handleNewQuery=function(){i.queryboxIsAlreadyAddedToQuery=!1},i.prototype.handleBuildingQuery=function(t,n){e.Assert.exists(n),e.Assert.exists(n.queryBuilder),this.updateQueryState(),this.options.enableWildcards&&(n.queryBuilder.enableWildcards=!0),this.options.enableQuestionMarks&&(n.queryBuilder.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(n.queryBuilder.enableLowercaseOperators=!0),this.options.enablePartialMatch&&(n.queryBuilder.enablePartialMatch=!0,n.queryBuilder.partialMatchKeywords=this.options.partialMatchKeywords,n.queryBuilder.partialMatchThreshold=this.options.partialMatchThreshold);var o=e.$(this.element).val();e.Utils.isNonEmptyString(o)&&!i.queryboxIsAlreadyAddedToQuery&&(this.options.enableQuerySyntax?n.queryBuilder.expression.add(o):n.queryBuilder.expression.add("<@- "+o+" -@>"),this.logger.trace("Adding query to QueryBuilder",o),i.queryboxIsAlreadyAddedToQuery=!0)},i.prototype.enterOnSearchbox=function(){var t=this;e.$(this.element).trigger(e.UserActionEvents.enterOnSearchbox),this.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})},!1)},i.prototype.triggerNewQuery=function(e,t){this.cancelAnyPendingSearchAsYouTypeTimeout(),this.queryController.deferExecuteQuery({beforeExecuteQuery:e,searchAsYouType:t})},i.prototype.updateQueryState=function(){var t=e.$(this.element).val();this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t)},i.prototype.cancelAnyPendingSearchAsYouTypeTimeout=function(){e.Utils.exists(this.searchAsYouTypeTimeout)&&(clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0)},i.ID="Querybox",i.options={enableSearchAsYouType:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:e.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),enableQuerySyntax:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableWildcards:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),partialMatchThreshold:e.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i.queryboxIsAlreadyAddedToQuery=!1,i}(e.Component);e.Querybox=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleQuerySuccess,this)),e.$(this.root).on(e.QueryEvents.queryError,function(){e.$(r.element).hide()}),e.$(this.element).hide(),this.textContainer=e.$("<span />").appendTo(this.element)}return __extends(i,t),i.prototype.handleQuerySuccess=function(t,i){if(!this.disabled&&i.results.results.length>0){e.Assert.exists(i);var n=e.l("Duration",this.formatQueryDuration(i.results.duration))+"\n"+e.l("IndexDuration",this.formatQueryDuration(i.results.indexDuration))+"\n"+e.l("ProxyDuration",this.formatQueryDuration(i.results.proxyDuration))+"\n"+e.l("ClientDuration",this.formatQueryDuration(i.results.clientDuration));this.textContainer.text(this.formatQueryDuration(i.results.duration)),e.$(this.element).attr("title",n),e.$(this.element).show()}else e.$(this.element).hide()},i.prototype.formatQueryDuration=function(t){if(void 0==t)return e.l("Unavailable");var i=Math.max(t/1e3,.01);return e.l("Seconds",Globalize.format(i,"n2"),i)},i.ID="QueryDuration",i.options={},i}(e.Component);e.QueryDuration=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleQuerySuccess,this)),e.$(this.root).on(e.QueryEvents.queryError,function(){e.$(r.element).hide()}),e.$(this.element).hide(),this.textContainer=e.$("<span />").appendTo(this.element)}return __extends(i,t),i.prototype.handleQuerySuccess=function(t,i){if(!this.disabled)if(e.Assert.exists(i),e.$(this.element).show(),this.options.onlyDisplaySearchTips&&e.$(this.element).hide(),i.results.results.length>0){var n=Globalize.format(i.query.firstResult+1,"n0"),o=Globalize.format(i.query.firstResult+i.results.results.length,"n0"),s=Globalize.format(i.results.totalCountFiltered,"n0");this.textContainer.html(e.l("ShowingResultsOf",'<span class="coveo-highlight">'+n+"</span>",'<span class ="coveo-highlight">'+o+"</span>",'<span class ="coveo-highlight">'+s+"</span>",i.results.results.length))}else if(null!=i.results.exception&&null!=i.results.exception.code){var r=("QueryException"+i.results.exception.code).toLocaleString();this.textContainer.html(e.l("QueryException",r))}else this.displayInfoOnNoResults()},i.prototype.displayInfoOnNoResults=function(){var t=this;e.$(this.element).show(),this.textContainer.empty();var i=e._.escape(this.queryStateModel.get(e.QueryStateModel.attributesEnum.q));if(""!=i)var n=e.$('<div class="coveo-query-summary-no-results-string"></div>').html(e.l("noResultFor","<span class='coveo-highlight'>"+i+"</span>"));var o=e.$('<div class="coveo-query-summary-cancel-last">'+e.l("CancelLastAction")+"</div>").click(function(){t.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.noResultsBack,{},t.root),t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.noResultsBack,{}),history.back()}),s=e.$('<div class="coveo-query-summary-search-tips-info"></div>').text(e.l("SearchTips")),r=e.$("<ul></ul>");e.$("<li></li>").text(e.l("CheckSpelling")).appendTo(r),e.$("<li></li>").text(e.l("TryUsingFewerKeywords")).appendTo(r),this.queryStateModel.atLeastOneFacetIsActive()&&e.$("<li></li>").text(e.l("SelectFewerFilters")).appendTo(r),this.options.enableSearchTips?this.textContainer.append(n,o,s,r):this.textContainer.append(n,o)},i.ID="QuerySummary",i.options={enableSearchTips:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),onlyDisplaySearchTips:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.QuerySummary=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.instantiateToString=function(){return'<div><span class="CoveoIcon"></span> <a class="CoveoResultLink"></a> <span class="CoveoQuickview"></span></div>'},t}(e.Template);e.DefaultResultAttachmentTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){void 0===a&&(a=0),t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.attachmentLevel=a,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.attachments=r.attachments,e.Utils.isNonEmptyArray(this.attachments)&&this.renderAttachments()}return __extends(i,t),i.prototype.renderAttachments=function(){var t=this;e._.each(this.attachments,function(n){e.QueryUtils.setStateObjectOnQueryResult(t.queryStateModel.get(),n);var o=t.attachmentLevel>0?t.options.subResultTemplate.instantiateToElement(n):t.options.resultTemplate.instantiateToElement(n);if(t.autoCreateComponentsInsideResult(o,e.$.extend({},n,{attachments:[]})),e.$(o).addClass("coveo-results-attachment-container").appendTo(t.element),t.attachmentHasSubAttachment(n)&&t.attachmentLevel<t.options.maximumAttachmentLevel){var s=e.$("<div></div>");e.$(o).append(s),new i(s.get(0),t.options,t.bindings,n,t.attachmentLevel+1)}})},i.prototype.attachmentHasSubAttachment=function(t){return e.Utils.isNonEmptyArray(t.attachments)?!0:e.Utils.isNonEmptyArray(t.childResults)?(t.attachments=t.childResults,!0):!1},i.prototype.autoCreateComponentsInsideResult=function(t,n){e.Assert.exists(t);var o=this.searchInterface.options,s={options:o,bindings:this.getBindings(),result:n};e.CoveoJQuery.automaticallyCreateComponentsInside(t,s,[i.ID])},i.ID="ResultAttachments",i.options={resultTemplate:e.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new e.DefaultResultAttachmentTemplate}}),subResultTemplate:e.ComponentOptions.buildTemplateOption({postProcessing:function(e,t){return null!=e?e:t.resultTemplate}}),maximumAttachmentLevel:e.ComponentOptions.buildNumberOption({defaultValue:5,min:0})},i}(e.Component);e.ResultAttachments=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.instantiateToString=function(){return'<div class="coveo-child-result"><span class="CoveoIcon"></span> <a class="CoveoResultLink"></a> <span class="CoveoQuickview"></span></div>'},t.prototype.getType=function(){return"DefaultFoldingTemplate"},t}(e.Template);e.DefaultFoldingTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.showingMoreResults=!1,this.options=e.ComponentOptions.initComponentOptions(this.element,i,o),e.Assert.exists(r),this.buildElements(),this.displayThoseResults(this.result.childResults),this.updateElementVisibility(),0!=this.result.childResults.length||this.result.moreResults||e.$(this.element).hide()}return __extends(i,t),i.prototype.showMoreResults=function(){var t=this;e.Assert.exists(this.result.moreResults),this.cancelAnyPendingShowMore(),this.moreResultsDeferred=this.result.moreResults(),this.waitAnimation=e.JQueryUtils.getBasicLoadingDots().appendTo(this.results),this.updateElementVisibility(),this.moreResultsDeferred.done(function(e){t.showingMoreResults=!0,t.displayThoseResults(e),t.updateElementVisibility(e.length)}),this.moreResultsDeferred.always(function(){t.moreResultsDeferred=void 0,t.waitAnimation.detach(),t.waitAnimation=void 0})},i.prototype.showLessResults=function(){this.cancelAnyPendingShowMore(),this.showingMoreResults=!1,this.displayThoseResults(this.result.childResults),this.updateElementVisibility(),this.scrollToResultElement()},i.prototype.buildElements=function(){this.buildHeader(),this.buildResults(),this.buildFooter()},i.prototype.buildHeader=function(){var t=e.$("<div/>").addClass("coveo-folding-header").appendTo(this.element);void 0!=this.options.normalCaption&&void 0!=this.options.expandedCaption&&(this.normalCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.normalCaption).appendTo(t),this.expandedCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.expandedCaption).appendTo(t)),this.onlyOneMessageCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.oneResultCaption).appendTo(t)},i.prototype.buildResults=function(){this.results=e.$("<div/>").addClass("coveo-folding-results").appendTo(this.element)},i.prototype.buildFooter=function(){var t=this,i=e.$("<div/>").addClass("coveo-folding-footer").appendTo(this.element.parentElement);if(this.result.moreResults){this.showMore=e.$("<div/>").addClass("coveo-folding-footer-section-for-less").appendTo(i).click(function(){return t.showMoreResults()}),this.showLess=e.$("<div/>").addClass("coveo-folding-footer-section-for-more").appendTo(i).click(function(){return t.showLessResults()});var n=e.$("<div><span class='coveo-folding-footer-icon'></span></div>").addClass("coveo-more"),o=e.$("<div><span class='coveo-folding-footer-icon'></span></div>").addClass("coveo-less"),s=e.$("<a/>").addClass("coveo-folding-show-more").text(this.options.moreCaption),r=e.$("<a/>").addClass("coveo-folding-show-less").text(this.options.lessCaption);this.showMore.append(s),this.showLess.append(r),this.showMore.append(n),this.showLess.append(o)}},i.prototype.updateElementVisibility=function(t){this.normalCaption&&this.normalCaption.fastToggle(!this.showingMoreResults&&this.result.childResults.length>0),this.expandedCaption&&this.expandedCaption.fastToggle(this.showingMoreResults),this.onlyOneMessageCaption.fastToggle(t&&1==t),this.showMore&&(this.showMore.fastToggle(!this.showingMoreResults&&!e.Utils.exists(this.moreResultsDeferred)),this.showLess.fastToggle(this.showingMoreResults)),e.$(this.element).find(".coveo-show-if-normal").fastToggle(!this.showingMoreResults),e.$(this.element).find(".coveo-show-if-expanded").fastToggle(this.showingMoreResults)
},i.prototype.scrollToResultElement=function(){e.$(window).scrollTop(e.$(this.element).closest(".CoveoResult").position().top)},i.prototype.displayThoseResults=function(t){var i=this;this.results.empty(),e._.each(t,function(e){i.renderChildResult(e)})},i.prototype.renderChildResult=function(t){e.QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(),t);var i=e.$(this.options.resultTemplate.instantiateToElement(t)).addClass("coveo-result-folding-child-result").appendTo(this.results);i.toggleClass("coveo-normal-child-result",!this.showingMoreResults),i.toggleClass("coveo-expanded-child-result",this.showingMoreResults),this.autoCreateComponentsInsideResult(i.get(0),t)},i.prototype.autoCreateComponentsInsideResult=function(t,i){e.Assert.exists(t);var n=this.searchInterface.options,o={options:n,bindings:this.getBindings(),result:i};e.CoveoJQuery.automaticallyCreateComponentsInside(t,o)},i.prototype.cancelAnyPendingShowMore=function(){this.moreResultsDeferred&&this.moreResultsDeferred.reject(),e.Assert.doesNotExists(this.moreResultsDeferred),e.Assert.doesNotExists(this.waitAnimation)},i.ID="ResultFolding",i.options={resultTemplate:e.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new e.DefaultFoldingTemplate}}),normalCaption:e.ComponentOptions.buildLocalizedStringOption(),expandedCaption:e.ComponentOptions.buildLocalizedStringOption(),moreCaption:e.ComponentOptions.buildLocalizedStringOption({postProcessing:function(t){return t||e.l("ShowMore")}}),lessCaption:e.ComponentOptions.buildLocalizedStringOption({postProcessing:function(t){return t||e.l("ShowLess")}}),oneResultCaption:e.ComponentOptions.buildLocalizedStringOption({postProcessing:function(t){return t||e.l("DisplayingTheOnlyMessage")}})},i}(e.Component);e.ResultFolding=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(e){void 0===e&&(e=navigator);var t;return t=-1!=e.appVersion.indexOf("Win")?0:-1!=e.appVersion.indexOf("Mac")?1:-1!=e.appVersion.indexOf("X11")?2:-1!=e.appVersion.indexOf("Linux")?3:4}!function(e){e[e.WINDOWS=0]="WINDOWS",e[e.MACOSX=1]="MACOSX",e[e.UNIX=2]="UNIX",e[e.LINUX=3]="LINUX",e[e.UNKNOWN=4]="UNKNOWN"}(e.NAME||(e.NAME={}));e.NAME;e.get=t}(t=e.OSUtils||(e.OSUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){var l=this;if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.os=a,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.options=e.$.extend({},this.options,this.componentOptionsModel.get(e.ComponentOptionsModel.attributesEnum.resultLink)),this.result=r||this.resolveResult(),null==this.options.openQuickview&&(this.options.openQuickview="ExchangeCrawler"==r.raw.sysconnectortype&&e.DeviceUtils.isMobileDevice()),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(this.result),!this.options.openQuickview)if(e.DeviceUtils.isMobileDevice())e.$(n).on("mousedown",function(){l.logOpenDocument()});else{var u=!1;e.$(n).on("mousedown",function(){u=!0}),e.$(document.body).on("mouseup scroll",function(){u=!1}),e.$(n).on("mouseup",function(){u&&l.logOpenDocument()})}/^\s*$/.test(this.element.innerHTML)&&(this.element.innerHTML=this.result.title?e.HighlightUtils.highlightString(this.result.title,this.result.titleHighlights,null,"coveo-highlight"):this.result.clickUri),this.bindEventToOpen()}return __extends(i,t),i.prototype.bindEventToOpen=function(){return this.bindOnClickIfNotUndefined()||this.bindOpenQuickviewIfNotUndefined()||this.setHrefIfNotAlready()||this.openLinkThatIsNotAnAnchor()},i.prototype.bindOnClickIfNotUndefined=function(){var t=this;return void 0!=this.options.onClick?(e.$(this.element).click(function(e){t.options.onClick.call(t,e,t.result)}),!0):!1},i.prototype.bindOpenQuickviewIfNotUndefined=function(){var t=this;return(this.options.openQuickview||this.isUriThatMustBeOpenedInQuickview())&&e.QueryUtils.hasHTMLVersion(this.result)?(e.$(this.element).click(function(i){i.preventDefault(),e.$(t.bindings.resultElement).trigger(e.ResultListEvents.openQuickview)}),!0):!1},i.prototype.openLinkThatIsNotAnAnchor=function(){var t=this;return e.DeviceUtils.isPhonegap()?(e.PhonegapUtils.bindOpenLinkInPhonegap(this.element,this.getResultUri()),!0):this.elementIsAnAnchor()?!1:(e.$(this.element).click(function(){t.options.alwaysOpenInNewWindow?t.options.openInOutlook&&t.hasOutlookField()?window.location.href=t.getResultUri():window.open(t.getResultUri(),"_blank"):window.location.href=t.getResultUri()}),!0)},i.prototype.setHrefIfNotAlready=function(){if(e.DeviceUtils.isPhonegap()&&this.elementIsAnAnchor()){var t=e.$(this.element).attr("href");return(void 0==t||""==t)&&(t=this.getResultUri()),e.$(this.element).removeAttr("href"),e.$(this.element).removeAttr("target"),e.PhonegapUtils.bindOpenLinkInPhonegap(this.element,t),!0}return this.elementIsAnAnchor()&&!e.Utils.isNonEmptyString(e.$(this.element).attr("href"))?(e.$(this.element).attr("href",this.getResultUri()),!this.options.alwaysOpenInNewWindow||this.options.openInOutlook&&this.hasOutlookField()||e.$(this.element).attr("target","_blank"),!0):!1},i.prototype.bindPhonegapClick=function(){e.DeviceUtils.isPhonegap()&&e.PhonegapUtils.bindOpenLinkInPhonegap(this.element,this.getResultUri())},i.prototype.logOpenDocument=function(){this.queryController.saveLastQuery();var t=e.$(this.element).attr("href");(void 0==t||""==t)&&(t=this.result.clickUri),this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentOpen,{documentURL:t,documentTitle:this.result.title},this.result,this.root),e.Defer.flush()},i.prototype.getResultUri=function(){return void 0==this.options.field&&this.options.openInOutlook&&this.setField(),void 0!=this.options.field?e.Utils.getFieldValue(this.result,this.options.field):this.result.clickUri},i.prototype.elementIsAnAnchor=function(){return"A"==this.element.tagName},i.prototype.setField=function(){var t=e.Utils.exists(this.os)?this.os:e.OSUtils.get();1==t&&this.hasOutlookField()?this.options.field="@sysoutlookformacuri":0==t&&this.hasOutlookField()&&(this.options.field="@sysoutlookuri")},i.prototype.hasOutlookField=function(){var t=e.Utils.exists(this.os)?this.os:e.OSUtils.get();return 1==t&&void 0!=this.result.raw.sysoutlookformacuri?!0:0==t&&void 0!=this.result.raw.sysoutlookuri?!0:!1},i.prototype.isUriThatMustBeOpenedInQuickview=function(){return 0==this.result.clickUri.toLowerCase().indexOf("ldap://")},i.ID="ResultLink",i.options={field:e.ComponentOptions.buildFieldOption(),openInOutlook:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),openQuickview:e.ComponentOptions.buildBooleanOption(),alwaysOpenInNewWindow:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.ResultLink=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.isInSalesforce=function(){return void 0!=window.sforce},t.isInSalesforceConsole=function(){return t.isInSalesforce()&&void 0!=window.sforce.console&&window.sforce.console.isInConsole()},t.focusOrOpenTab=function(t,i,n){void 0===n&&(n=!1),t="undefined"!=typeof t?t:"";var o=t;t=t.split("#")[0].split("?")[0];var s=this.getSfIdFromUrl(t),r=function(e,t){return e&&t?-1!==e.indexOf(t,e.length-t.length):!1},a=function(e){return e.success?!1:(d(p,t),!0)},l=0,u=!1,c=0,p=null,d=function(e){window.sforce.console.openSubtab(e,o,!0,i,null,function(e){e.success||window.open(o)})},h=function(i,n){if(!a(i)&&(c++,!u)){var o=e.$.parseJSON(i.pageInfo).url;o=o?o.split("#")[0].split("?")[0]:o;var h=e.$.parseJSON(i.pageInfo).objectId;h=h?h.substr(0,15):o,(h==s||r(t,o)||r(o,t))&&(window.sforce.console.focusSubtabById(n),u=!0),l--,u||0!=l||d(p,t)}},f=function(e){if(!a(e)){l=e.ids.length;for(var t=0;t<e.ids.length;t++)window.sforce.console.getPageInfo(e.ids[t],function(t){h(t,e.ids[c])})}},m=function(e){a(e)||(p=e.id,window.sforce.console.getSubtabIds(e.id,f))};n||window.sforce.console.getFocusedPrimaryTabId(m);var v=0,g=0,y=function(){window.sforce.console.openPrimaryTab(null,o,!0,i,function(e){e.success||window.open(o)})},C=function(i,n){if(!a(i)&&(g++,!u)){var o=e.$.parseJSON(i.pageInfo).url;o=o?o.split("#")[0].split("?")[0]:o;var l=e.$.parseJSON(i.pageInfo).objectId;l=l?l.substr(0,15):o,(l==s||r(t,o)||r(o,t))&&(window.sforce.console.focusPrimaryTabById(n),u=!0),v--,u||0!=v||y(t)}},b=function(e){if(!a(e)){v=e.ids.length;for(var t=0;t<e.ids.length;t++)window.sforce.console.getPageInfo(e.ids[t],function(t){C(t,e.ids[g])})}};n&&window.sforce.console.getPrimaryTabIds(b)},t.getSfIdFromUrl=function(e){var t=e.substr(e.lastIndexOf("/")+1,18),i=/^\w+$/.test(t);return i?t.substr(0,15):e.split("#")[0].split("?")[0]},t.expandStringUsingRecord=function(e,i){if(null!=e){var n=e.match(/\{!(>?)(.*?)\}/g);if(null!=n)for(var o=0;o<n.length;o++){var s=n[o],r=/\{!(>?)(.*?)\}/g.exec(s),a=">"===r[1],l=r[2].toLowerCase(),u="";null!=i[l]&&(u=i[l].toString(),a&&(u=t.cleanSentenceForQuery(u))),e=e.replace(r[0],u)}}return e},t.expandStringUsingExpert=function(i,n){if(null!=i){var o=i.match(/%(\w+)%/g);if(null!=o)for(var s=0;s<o.length;s++){var r=o[s],a=/%(\w+)%/g.exec(r),l=a[1].toLowerCase(),u=e.Utils.getFieldValue(n,l);u=null!=u?t.cleanSentenceForQuery(u):"",i=i.replace(a[0],u)}}return i},t.cleanSentenceForQuery=function(e){return e.replace(/[\[\]"'\(\),\.@=<>:]/g,"")},t}();e.SalesforceUtilities=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,r),this.element=n,this.options=o,this.result=r}return __extends(i,t),i.prototype.bindEventToOpen=function(){var i=this;if(e.SalesforceUtilities.isInSalesforceConsole()){var n=!1;return this.options.openInPrimaryTab?(e.$(this.element).click(function(){e.SalesforceUtilities.focusOrOpenTab(decodeURIComponent(i.result.clickUri),i.result.title,!0)}),n=!0):this.options.openInSubTab&&(e.$(this.element).click(function(){e.SalesforceUtilities.focusOrOpenTab(decodeURIComponent(i.result.clickUri),i.result.title,!1)}),n=!0),n||(n=t.prototype.bindEventToOpen.call(this)),n}return t.prototype.bindEventToOpen.call(this)},i.ID="SalesforceResultLink",i.options=e._.extend({},{openInPrimaryTab:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),openInSubTab:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},e.ResultLink.options),i}(e.ResultLink);e.SalesforceResultLink=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.preferencePanel=e.$(this.element).parents("."+e.Component.computeCssClassNameForType(e.PreferencesPanel.ID)),this.preferencePanelLocalStorage=new e.LocalStorageUtils(i.ID),this.mergeLocalPreferencesWithStaticPreferences(),this.bindPreferencePanelEvent(),this.bindBreadcrumbEvent(),this.bindQueryEvent(),e.$(this.root).one(e.InitializationEvents.afterComponentsInitialization,function(){r.createDom()});var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);e.$(this.root).one(a,function(){r.fromPreferencesToCheckboxInput()})}return __extends(i,t),i.prototype.createDom=function(){this.buildTitle(),this.buildCheckboxesInput(),this.options.showAdvancedFilters&&this.buildAdvancedFilters()},i.prototype.save=function(){this.fromCheckboxInputToPreferences();var t=e._.omit(this.preferences,"tab");this.logger.info("Saving preferences",t),this.preferencePanelLocalStorage.save(t)},i.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput()},i.prototype.bindPreferencePanelEvent=function(){var t=this;this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.savePreferences,function(){return t.save()}),this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return t.exitWithoutSave()})},i.prototype.bindBreadcrumbEvent=function(){this.options.includeInBreadcrumb&&(this.bind.onRoot(e.BreadcrumbEvents.populateBreadcrumb,e.$.proxy(this.handlePopulateBreadcrumb,this)),this.bind.onRoot(e.BreadcrumbEvents.clearBreadcrumb,e.$.proxy(this.handleClearBreadcrumb,this)))},i.prototype.bindQueryEvent=function(){this.bind.onRoot(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this))},i.prototype.handleBuildingQuery=function(t,i){e._.each(this.getActiveFilters(),function(e){i.queryBuilder.advancedExpression.add(e.expression)})},i.prototype.handlePopulateBreadcrumb=function(t,i){var n=this.getActiveFilters();if(e.Utils.isNonEmptyArray(n)){var o=e.$("<div/>").addClass("coveo-results-filter-preferences-breadcrumb");e.$("<span/>").addClass("coveo-title").text(e.l("FiltersInYourPreferences")+":").appendTo(o);for(var s=e.$("<span/>").addClass("coveo-values").appendTo(o),r=0;r<n.length;r++)0!=r&&e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(s),this.buildBreadcrumb(n[r]).appendTo(s);i.breadcrumbs.push({element:o.get(0)})}},i.prototype.handleClearBreadcrumb=function(){e._.each(this.getActiveFilters(),function(e){e.selected=!1}),this.fromPreferencesToCheckboxInput()},i.prototype.buildTitle=function(){e.$(this.element).append(e.$("<div class='coveo-title'>"+e.l("ResultsFilteringExpression")+"</div>"))},i.prototype.buildAdvancedFilters=function(){var t=this;this.advancedFilters=e.$("<div>"+e.l("Create")+"</div>").addClass("coveo-advanced-filters"),this.buildAdvancedFilterInput(),this.buildAdvancedFilterFormValidate(),this.advancedFiltersBuilder=e.$("<div class='coveo-advanced-filters-builder'></div>"),this.advancedFiltersBuilder.append(this.advancedFilterFormValidate),this.advancedFilters.click(function(){return t.openAdvancedFilterSectionOrSaveFilters()});var i=e.$("<a href='http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10006' target='_blank' class='coveo-online-help'>?</a>");e.$(this.element).find(".coveo-title").first().after(i,this.advancedFilters),e.$(this.element).append(this.advancedFiltersBuilder)},i.prototype.buildAdvancedFilterInput=function(){this.advancedFiltersTextInputCaption=new e.PreferencesPanelTextAreaInput([{label:e.l("Caption"),placeholder:e.l("EnterExpressionName"),otherAttribute:"required"}],i.ID+"-advanced-caption"),this.advancedFiltersTextInputExpression=new e.PreferencesPanelTextAreaInput([{label:e.l("Expression"),placeholder:e.l("EnterExpressionToFilterWith"),otherAttribute:"required"}],i.ID+"-advanced-expression"),this.advancedFiltersTabSelect=new e.PreferencePanelMultiSelectInput({label:e.l("Tab"),placeholder:e.l("SelectTab")},this.getAllTabs(),i.ID+"-multiselect")},i.prototype.buildAdvancedFilterFormValidate=function(){var t=this;this.advancedFilterFormValidate=e.$("<form></form>");var i=e.$("<input type='submit' />"),n=e.$("<span class='coveo-save'></span>"),o=e.$("<span class='coveo-close'></span>"),s=e.$("<div class='coveo-choice-container coveo-close-and-save'></div>").append(n,o);this.advancedFilterFormValidate.append(this.advancedFiltersTextInputCaption.build().addClass("coveo-caption"),this.advancedFiltersTabSelect.build().addClass("coveo-tab"),this.advancedFiltersTextInputExpression.build().addClass("coveo-expression"),s,i),n.click(function(){i.click()}),o.click(function(){t.advancedFiltersBuilder.toggleClass("coveo-active")}),this.advancedFilterFormValidate.find("textarea").keyup(function(e){13==e.keyCode&&i.click()}),this.advancedFilterFormValidate.submit(function(e){t.validateAndSaveAdvancedFilter(e)})},i.prototype.getAdvancedFiltersTextInputToBuild=function(){return[{label:e.l("Caption"),otherAttribute:"required"},{label:e.l("Expression"),otherAttribute:"required"}]},i.prototype.getAllTabs=function(){var t=e.Component.getComponentRef("Tab");if(t){var i=e.$(this.root).find("."+e.Component.computeCssClassNameForType(t.ID));return e._.map(i,function(t){var i=e.$(t).coveo();return i.options.id})}},i.prototype.getPreferencesBoxInputToBuild=function(){return e._.map(this.preferences,function(e){return{label:e.caption,tab:e.tab,expression:e.expression}})},i.prototype.buildCheckboxesInput=function(){var t=this;void 0!=this.preferenceContainer&&this.preferenceContainer.remove();var n=this.getPreferencesBoxInputToBuild();e.Utils.isNonEmptyArray(n)&&(this.preferencePanelCheckboxInput=new e.PreferencesPanelCheckboxInput(n,i.ID),this.preferenceContainer=e.$("<div class='coveo-choices-container'></div>"),this.preferenceContainer.append(this.preferencePanelCheckboxInput.build()),this.preferenceContainer.find(".coveo-choice-container").append("<div class='coveo-section coveo-section-edit-delete'></div>"),e.$(this.element).append(this.preferenceContainer),this.buildEditAdvancedFilter(),this.buildDeleteAdvancedFilter(),this.fromPreferencesToCheckboxInput(),this.preferenceContainer.find("input").change(function(i){t.save();var n=t.preferences[e.$(i.target).val()];t.fromFilterToAnalyticsEvent(n,n.selected?"selected":"unselected"),t.queryController.executeQuery()}))},i.prototype.buildDeleteAdvancedFilter=function(){var t=this;e._.each(this.preferences,function(i){if(i.custom){var n=e.$("<span class='coveo-delete'><span class='coveo-icon'></span></span>"),o=t.getFilterElementByCaption(i.caption),s=o.closest(".coveo-section").siblings(".coveo-section-edit-delete");n.appendTo(s),n.click(function(){t.confirmDelete(i,o)})}})},i.prototype.buildEditAdvancedFilter=function(){var t=this;e._.each(this.preferences,function(i){if(i.custom){var n=e.$("<span class='coveo-edit'><span class='coveo-icon'></span></span>"),o=t.getFilterElementByCaption(i.caption),s=o.closest(".coveo-section").siblings(".coveo-section-edit-delete");n.appendTo(s),n.click(function(){t.editElement(i,o)})}})},i.prototype.buildBreadcrumb=function(t){var i=this,n=e.$("<span/>").addClass("coveo-value");return e.$("<span/>").addClass("coveo-caption").text(t.caption).appendTo(n),e.$("<span/>").addClass("coveo-clear").appendTo(n),n.click(function(){t.selected=!1,i.fromFilterToAnalyticsEvent(t,"cleared from breadcrumb"),i.fromPreferencesToCheckboxInput(),i.queryController.executeQuery()}),n},i.prototype.confirmDelete=function(t,i){if(confirm(e.l("AreYouSureDeleteFilter",t.caption,t.expression))){var n=t.selected;this.deleteFilterPreference(t,i),n&&(this.fromFilterToAnalyticsEvent(t,"deleted"),this.queryController.executeQuery())}},i.prototype.editElement=function(e,t){var i=this.preferences[e.caption].caption,n=this.preferences[e.caption].tab,o=this.preferences[e.caption].expression;this.deleteFilterPreference(e,t),this.openAdvancedFilterSectionOrSaveFilters(),this.populateEditSection({tab:n,caption:i,expression:o}),this.advancedFiltersBuilder.find("input[type=text]").first().focus()},i.prototype.populateEditSection=function(t){void 0===t&&(t={tab:[""],caption:"",expression:""}),this.advancedFiltersTextInputCaption.setValue(e.l("Caption"),t.caption),this.advancedFiltersTextInputExpression.setValue(e.l("Expression"),t.expression),this.advancedFiltersTabSelect.setValues(t.tab)},i.prototype.deleteFilterPreference=function(e,t){this.preferencePanelLocalStorage.remove(e.caption),delete this.preferences[e.caption],t.closest(".coveo-choice-container").remove()},i.prototype.openAdvancedFilterSectionOrSaveFilters=function(){this.advancedFiltersBuilder.hasClass("coveo-active")?this.advancedFilterFormValidate.find("input[type=submit]").click():(this.populateEditSection(),this.advancedFiltersBuilder.toggleClass("coveo-active"))},i.prototype.validateAndSaveAdvancedFilter=function(t){t.preventDefault(),this.advancedFiltersBuilder.removeClass("coveo-active");var i=this.advancedFiltersTextInputCaption.getValues()[0],n=this.advancedFiltersTextInputExpression.getValues()[0],o=this.advancedFiltersTabSelect.getValues();this.preferences[i]={caption:i,custom:!0,expression:n,tab:o,selected:!0},this.buildCheckboxesInput(),this.save(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.t,this.getActiveTab()),this.advancedFiltersTextInputCaption.reset(),this.advancedFiltersTextInputExpression.reset(),this.advancedFiltersTabSelect.reset(),this.advancedFiltersBuilder.appendTo(this.element),this.fromFilterToAnalyticsEvent(this.preferences[i],"saved"),this.queryController.executeQuery()},i.prototype.fromPreferencesToCheckboxInput=function(){var t=this;e._.each(this.getActiveFilters(),function(e){t.preferencePanelCheckboxInput.select(e.caption)}),e._.each(this.getInactiveFilters(),function(e){t.preferencePanelCheckboxInput.unselect(e.caption)}),e._.each(this.getDormantFilters(),function(e){t.preferencePanelCheckboxInput.select(e.caption)})},i.prototype.fromCheckboxInputToPreferences=function(){var t=this.preferencePanelCheckboxInput.getSelecteds();e._.each(this.preferences,function(i){i.selected=e._.contains(t,i.caption)?!0:!1})},i.prototype.getDormantFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return e.selected&&!t.filterIsInActiveTab(e,i)})},i.prototype.getActiveFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return e.selected&&t.filterIsInActiveTab(e,i)})},i.prototype.getInactiveFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return!e.selected||!t.filterIsInActiveTab(e,i)})},i.prototype.getActiveTab=function(){return this.queryStateModel.get(e.QueryStateModel.attributesEnum.t)},i.prototype.filterIsInActiveTab=function(t,i){return t.tab=e._.compact(t.tab),e._.contains(t.tab,i)||e.Utils.isEmptyArray(t.tab)},i.prototype.getFilterElementByCaption=function(e){return this.preferenceContainer.find("input[value='"+e+"']").parent()},i.prototype.fromResultsFilterOptionToResultsPreferenceInterface=function(t){void 0===t&&(t=this.options.filters);var i={};return e._.each(this.options.filters,function(e,t){i[t]={expression:e.expression,tab:e.tab,selected:!1,custom:!1,caption:t}}),i},i.prototype.mergeLocalPreferencesWithStaticPreferences=function(){var t=this.fromResultsFilterOptionToResultsPreferenceInterface(),i=this.preferencePanelLocalStorage.load(),n=e._.filter(i,function(i){var n=i.custom,o=e._.find(t,function(e){return e.caption==i.caption});return n||void 0!=o}),o={};e._.each(n,function(e){o[e.caption]={expression:e.expression,tab:e.tab,selected:e.selected,custom:e.custom,caption:e.caption}}),this.preferences=e.$.extend(!0,{},t,o)},i.prototype.fromFilterToAnalyticsEvent=function(t,i){this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.customfiltersChange,{customFilterName:t.caption,customFilterExpression:t.expression,customFilterType:i})},i.ID="ResultsFiltersPreferences",i.options={includeInBreadcrumb:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),showAdvancedFilters:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ResultsFiltersPreferences=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.preferencePanel=e.$(this.element).parents("."+e.Component.computeCssClassNameForType(e.PreferencesPanel.ID)),this.preferencePanelLocalStorage=new e.LocalStorageUtils(i.ID),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(window.localStorage),e.Assert.isLargerOrEqualsThan(1,this.preferencePanel.length),this.preferences=this.preferencePanelLocalStorage.load()||{},e.ComponentOptions.initComponentOptions(this.element,i,this.preferences),this.updateComponentOptionsModel(),this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.savePreferences,function(){return r.save()}),this.bind.on(this.preferencePanel,e.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return r.exitWithoutSave()}),this.buildTitle(),this.buildCheckboxesInput()}return __extends(i,t),i.prototype.save=function(){this.fromCheckboxInputToPreferences(),this.logger.info("Saving preferences",this.preferences),this.preferencePanelLocalStorage.save(this.preferences),this.updateComponentOptionsModel()},i.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput()},i.prototype.updateComponentOptionsModel=function(){this.componentOptionsModel.set(e.ComponentOptionsModel.attributesEnum.resultLink,this.preferences)},i.prototype.buildTitle=function(){e.$(this.element).append(e.$("<div class='coveo-title'>"+e.l("LinkOpeningSettings")+"</div>"))},i.prototype.buildCheckboxesInput=function(){var t=this,n=[];this.options.enableOpenInOutlook&&n.push({label:e.l("OpenInOutlookWhenPossible")}),this.options.enableOpenInNewWindow&&n.push({label:e.l("AlwaysOpenInNewWindow")}),this.preferencePanelCheckboxInput=new e.PreferencesPanelCheckboxInput(n,i.ID);var o=e.$("<div class='coveo-choices-container'></div>");o.append(this.preferencePanelCheckboxInput.build()),o.find("input").change(function(e){t.fromPreferenceChangeEventToUsageAnalyticsLog(e),t.save(),t.queryController.executeQuery()}),e.$(this.element).append(o),this.fromPreferencesToCheckboxInput()},i.prototype.fromCheckboxInputToPreferences=function(){var t=this.preferencePanelCheckboxInput.getSelecteds();this.preferences={openInOutlook:!1,alwaysOpenInNewWindow:!1},e._.contains(t,e.l("OpenInOutlookWhenPossible"))&&(this.preferences.openInOutlook=!0),e._.contains(t,e.l("AlwaysOpenInNewWindow"))&&(this.preferences.alwaysOpenInNewWindow=!0)},i.prototype.fromPreferencesToCheckboxInput=function(){this.preferences.openInOutlook&&this.preferencePanelCheckboxInput.select(e.l("OpenInOutlookWhenPossible")),this.preferences.alwaysOpenInNewWindow&&this.preferencePanelCheckboxInput.select(e.l("AlwaysOpenInNewWindow"))},i.prototype.fromPreferenceChangeEventToUsageAnalyticsLog=function(t){var i=e.$(t.target).is(":checked")?"selected":"unselected",n=e.$(t.target).val();this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.preferencesChange,{preferenceName:n,preferenceType:i})},i.ID="ResultsPreferences",i.options={enableOpenInOutlook:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableOpenInNewWindow:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ResultsPreferences=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r,a){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.result=r,this.os=a,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.options=e.$.extend({},this.options),this.result=r||this.resolveResult(),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(this.result),this.options.field||this.logger.error("You must specify a field to the ResultTagging component"),this.tags=e.Utils.getFieldValue(this.result,this.options.field)||[],this.tagZone=e.$("<div></div>").addClass("coveo-result-tagging-tag-zone").appendTo(e.$(n)),e.$(n).append(this.buildTagIcon()),this.autoCompleteZone=e.$("<div></div>").addClass("coveo-result-tagging-auto-complete-zone").appendTo(e.$(n)),e.$(this.autoCompleteZone).append(this.buildTextBox()),e.$(this.autoCompleteZone).append(this.buildAddIcon()),e.$(this.autoCompleteZone).append(this.buildClearIcon()),this.buildExistingTags()}return __extends(i,t),i.prototype.buildExistingTags=function(){var t=this;this.tags&&e._.each(this.tags,function(i){e.$(t.tagZone).append(t.buildTagValue(i))})},i.prototype.buildTagIcon=function(){var t=this,i=e.$("<div></div>").addClass("coveo-result-tagging-add-tag"),n=e.$("<span></span>").text(e.l("EnterTag")).addClass("coveo-result-tagging-add-tag-text");return i.append(e.$("<span></span>").addClass("coveo-result-tagging-add-tag-icon").click(function(){return setTimeout(e.$.proxy(t.focusOnTextBox,t),20)})),i.append(n),i.attr("title",e.l("EnterTag")),i},i.prototype.focusOnTextBox=function(){this.textBox.focus()},i.prototype.buildTagValue=function(t){var i=this,n=e.$("<div></div>").addClass("coveo-result-tagging-coveo-tag");this.buildShortenedTagWithTitle(t).appendTo(n);var o=e.$("<span></span>").addClass("coveo-result-tagging-delete-icon").appendTo(n);return o.click(function(){return i.doRemoveTag(n,t.toLowerCase())}),n},i.prototype.buildShortenedTagWithTitle=function(t){var i=e.StringUtils.removeMiddle(t,16,"..."),n=e.$("<a></a>").text(i).attr("title",t).attr("href","javascript:void;");return this.bindFacetEventOnValue(n,t),n},i.prototype.buildTextBox=function(){var t=this;return this.textBox=e.$("<input/>").attr("type","text").addClass("coveo-add-tag-textbox").attr("placeholder",e.l("EnterTag")),this.autoCompletePopup=e.$("<div></div>").addClass(i.AUTO_COMPLETE_CLASS).appendTo(e.$(this.autoCompleteZone)),this.manageAutocompleteAutoHide(),this.textBox.keyup(function(i){38==i.keyCode||40==i.keyCode||13==i.keyCode?t.manageUpDownEnter(i.keyCode):e.KeyboardUtils.isArrowKeyPushed(i.keyCode)||t.populateSuggestions(),e.$(t.element).removeClass("coveo-error")}),this.textBox.click(function(){t.populateSuggestions()}),this.textBox},i.prototype.buildAddIcon=function(){var t=this;return e.$("<div></div>").addClass("coveo-result-tagging-add-tag-tick-icon").append(e.$("<span></span>")).click(function(){return t.doAddTag()})},i.prototype.buildClearIcon=function(){var t=this;return e.$("<div></div>").addClass("coveo-result-tagging-clear-icon").append(e.$("<span></span>")).click(function(){return t.textBox.val("")})},i.prototype.bindFacetEventOnValue=function(t,i){var n=this,o=e.QueryStateModel.getFacetId(this.options.field),s=this.queryStateModel.get(o),r=this.componentStateModel.get(o),a=e._.filter(r,function(e){return!e.disabled}).length>0;null!=s&&a&&(e.$(t).on("click",function(){e._.contains(s,i)?n.queryStateModel.set(o,e._.without(s,i)):n.queryStateModel.set(o,e._.union(s,[i])),n.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.documentTag,{facetId:n.options.field,facetValue:i})}})}),e._.contains(s,i)&&e.$(t).addClass("coveo-selected"),e.$(t).addClass("coveo-clickable"))},i.prototype.clearPopup=function(){this.autoCompletePopup.hide(),this.autoCompletePopup.empty()},i.prototype.showPopup=function(){this.autoCompletePopup.show()},i.prototype.populateSuggestions=function(){var t=this;this.autoCompletePopup.width(this.textBox.innerWidth());{var i=this.queryController.getEndpoint(),n=this.textBox.val(),o={field:this.options.field,ignoreAccents:!0,sortCriteria:"occurences",maximumNumberOfValues:this.options.suggestBoxSize,queryOverride:"@sysuri",pattern:this.buildRegEx(n),patternType:"RegularExpression"};i.listFieldValues(o).done(function(i){t.clearPopup(),e._.each(i,function(e){t.autoCompletePopup.append(t.buildSelectableValue(e.lookupValue))}),t.showPopup()})}},i.prototype.manageAutocompleteAutoHide=function(){var t,n=this;this.textBox.on("mouseover",function(){window.clearTimeout(t)}),this.autoCompletePopup.mouseout(function(o){e.$(o.target).hasClass(i.AUTO_COMPLETE_CLASS)&&(t=window.setTimeout(e.$.proxy(n.clearPopup,n),n.options.autoCompleteTimer))}),this.autoCompletePopup.mouseenter(function(){window.clearTimeout(t)}),e.$(this.element).mouseenter(function(){n.clearPopup(),e.$(n.element).addClass("coveo-opened")}),e.$(this.element).closest(".CoveoResult").mouseleave(function(){n.clearPopup(),""==n.textBox.val()&&e.$(n.element).removeClass("coveo-opened")}),e.$(this.element).closest(".CoveoResult").focusout(function(t){""!=n.textBox.val()&&e.$(t.target).closest(".CoveoResult")!=e.$(n.element).closest(".CoveoResult")&&e.$(n.element).addClass("coveo-error")}),e.$(this.element).closest(".CoveoResult").focusin(function(){e.$(n.element).removeClass("coveo-error")})},i.prototype.buildRegEx=function(t){var i=this;return"(?=.*"+t+")"+e._.map(this.tags,function(e){return i.buildTermToExclude(e)}).join("")+".*"},i.prototype.buildTermToExclude=function(e){return"(?!^"+e+"$)"},i.prototype.manageUpDownEnter=function(t){var i=e.$(this.element).find(".coveo-selectable");if(13==t)return this.doAddTag(),void 0;if(i.length>0){var n=this.computeNextIndex(t,i);n=Math.max(0,n),n=Math.min(i.length-1,n);
var o=e.$(i.get(n));o.addClass("coveo-selected"),this.textBox.val(o.text())}},i.prototype.computeNextIndex=function(t,i){var n=0;return e._.each(i,function(i,o){e.$(i).hasClass("coveo-selected")&&(38==t?n=o-1:40==t&&(n=o+1),e.$(i).removeClass("coveo-selected"))}),n},i.prototype.buildSelectableValue=function(t){var i=this,n=e.$("<div></div>").append(this.buildShortenedTagWithTitle(t));return n.addClass("coveo-selectable"),n.click(function(){i.doAddTagWithValue(t)}),n},i.prototype.doRemoveTag=function(t,i){var n=this,o={fieldName:this.options.field,fieldValue:i,doAdd:!1,uniqueId:this.result.uniqueId},s=this.queryController.getEndpoint().tagDocument(o);s.done(function(){n.tags.splice(e.$.inArray(i,n.tags),1),t.remove()})},i.prototype.doAddTagWithValue=function(t){var i=this;e._.each(t.split(","),function(e){i.doAddSingleTagValue(e)})},i.prototype.doAddSingleTagValue=function(t){var i=this;if(this.clearPopup(),e.$.inArray(t,this.tags)>-1)return e.$(this.element).addClass("coveo-error"),void 0;this.tags.push(t);var n={fieldName:this.options.field,fieldValue:t,doAdd:!0,uniqueId:this.result.uniqueId},o=this.queryController.getEndpoint().tagDocument(n);o.done(function(){i.tagZone.append(i.buildTagValue(t)),i.textBox.val(""),e.$(i.element).removeClass("coveo-error")}).fail(function(){i.tags=e._.without(i.tags,e._.findWhere(i.tags,t))})},i.prototype.doAddTag=function(){var e=this.textBox.val().toLowerCase().trim();this.doAddTagWithValue(e)},i.ID="ResultTagging",i.options={field:e.ComponentOptions.buildFieldOption({match:function(e){return"Tag"==e.type},required:!0}),suggestBoxSize:e.ComponentOptions.buildNumberOption({defaultValue:5,min:0}),autoCompleteTimer:e.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0})},i.AUTO_COMPLETE_CLASS="coveo-result-tagging-auto-complete",i}(e.Component);e.ResultTagging=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bind.click(e.$(n),this.handleClick),""==e.$.trim(e.$(n).text())&&e.$("<span/>").text(e.l("Search")).addClass("coveo-icon").appendTo(n)}return __extends(i,t),i.prototype.handleClick=function(){var t=this;this.logger.debug("Performing query following button click"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})}})},i.ID="SearchButton",i}(e.Component);e.SearchButton=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,o,s),this.element=n,this.options=o,this.omniboxHeaderSearchForTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-omnibox-section coveo-omnibox-header'><div class='coveo-text'>"+e.l("SearchFor","<strong><%- data %></strong>")+"</div></div>"),this.omniboxIsOpen=!1,this.isLoadingData=!1,this.headerIsCurrentlyRendered=!1,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(n).keyup(function(e){return r._handleKeyUp(e)}),this.renderOmniboxDiv(),this.omniboxDiv.hide(),this.prepareThrottledCall(),e.$("body").click(function(t){r.omniboxIsOpen&&!e.$.contains(r.omniboxDiv.get(0),e.$(t.target).get(0))&&r.close()});var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(a,e.$.proxy(this._handleQueryStateChanged,this)),e.$(window).on("resize",function(){r.omniboxIsOpen&&r.setWidthOnOmniboxDiv()})}return __extends(i,t),i.prototype.close=function(){this.wasClosed=!0,this.clearLastOmniboxRows(),e.$(this.root).trigger(e.OmniboxEvents.closeOmnibox),this.omniboxDiv&&(this.omniboxDiv.children().remove(),this.omniboxDiv.hide()),this.clearLastOmniboxRows(),e.Utils.isNullOrUndefined(this.lastOmniboxData)||this.rejectAllPendingDeferred(this.lastOmniboxData),this.resetOmniboxInternalData(),this.omniboxIsOpen=!1,this.removeSearchAnimation()},i.prototype.open=function(){this.wasClosed=!1,""!=e.$(this.element).val()?(this.throttledCallForOmniboxBody(),e.$(this.root).trigger(e.OmniboxEvents.openOmnibox)):this.close()},i.prototype.getDataForOmniboxBody=function(){if(this.addSearchAnimation(),this.isCurrentlyBeingRendered)this.throttledCallForOmniboxBody();else{var e=this.buildOmniboxRequestObject(),t=this.requestOmniboxData(e);this.processNewOmniboxData(t)}},i.prototype.buildOmniboxRequestObject=function(){var t=this,i=this.getCurrentQueryExpression(),n={completeQueryExpression:{word:e.$(this.element).val(),regex:this.getRegexToSearch()},currentQueryExpression:{word:i,regex:this.getRegexToSearch(i)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:e.$(this.element).getCursorPosition(),clear:function(){t.clear()},clearCurrentExpression:function(){t.clearCurrentExpression()},replace:function(e,i){t.replace(e,i)},replaceCurrentExpression:function(e){t.replaceCurrentExpression(e)},insertAt:function(e,i){t.insertAt(e,i)},closeOmnibox:function(){t.close()}};return n},i.prototype.prepareThrottledCall=function(){this.throttledCallForOmniboxBody=e.Utils.throttle(this.getDataForOmniboxBody,this.options.omniboxDelay,void 0,this)},i.prototype.requestOmniboxData=function(t){e.Assert.exists(t),this.logger.info("Requesting omnibox data to all components");var i=e.$.extend({rows:[]},t);return e.$(this.root).trigger(e.OmniboxEvents.populateOmnibox,i),i},i.prototype.getQueryExpressionBreakDown=function(){var t=this,i=[],n=e.$(this.element).val().split(" ");return e._.each(n,function(e){i.push({word:e,regex:t.getRegexToSearch(e)})}),i},i.prototype._handleNewQuery=function(e,i){t.prototype._handleNewQuery.call(this,e,i),this.omniboxIsOpen&&e.stopPropagation()},i.prototype._handleKeyUp=function(t){var i=this;t.stopImmediatePropagation();var n=e.$(this.element).val().length;!e.Utils.isNullOrUndefined(this.lastOmniboxData)&&!e.Utils.isNullOrUndefined(this.lastNumberOfLettersInOmnibox)&&Math.abs(n-this.lastNumberOfLettersInOmnibox)>this.options.omniboxChangeLimit&&(this.rejectAllPendingDeferred(this.lastOmniboxData),this.prepareThrottledCall()),e.KeyboardUtils.keysEqual(t,27)&&this.omniboxIsOpen?this.close():e.KeyboardUtils.keysEqual(t,13)?this.omniboxIsOpen?this.selectionEvent():(this.close(),this.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})})):e.KeyboardUtils.isArrowKeyPushed(t.keyCode)&&this.omniboxIsOpen?this.navigationEvent(t):e.KeyboardUtils.isAllowedKeyForOmnibox(t)&&(""==e.$(this.element).val()?this.close():this.open())},i.prototype._handleChange=function(e){return e.stopImmediatePropagation(),!1},i.prototype.handleHover=function(e){var t=this.getCorrectTarget(e);t&&this.toggleSelected(t)},i.prototype.bindHoverEvent=function(){var t=this;e.$(this.omniboxDiv).find(".coveo-omnibox-selectable").hover(function(e){t.handleHover(e)})},i.prototype.selectionEvent=function(){var t=this;this.isFirstValueSelected(this.findSelected())?(this.close(),this.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})})):this.keyBoardSelection()},i.prototype.navigationEvent=function(e){var t=this.findSelected();0==t.length?this.navigationEventWhenNoSelection(e):this.navigationEventWhenSelection(e,t)},i.prototype.navigationEventWhenNoSelection=function(t){e.KeyboardUtils.keysEqual(t,40)&&this.findSelectable().first().addClass("coveo-omnibox-selected")},i.prototype.navigationEventWhenSelection=function(e,t){if(!this.isLoadingData)switch(e.keyCode){case 38:this.isFirstValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueBeforeAlreadySelected(t));break;case 40:this.isLastValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueAfterAlreadySelected(t))}},i.prototype.keyBoardSelection=function(){this.logger.trace("Selecting facet value because of omnibox selection");var e=this.findSelected();e.trigger("keyboardSelect"),this.close()},i.prototype.triggerNewQuery=function(t){this.logger.info("Triggering new query because of omnibox selection"),this.close(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,e.$(this.element).val()),this.queryController.deferExecuteQuery({beforeExecuteQuery:t})},i.prototype.processNewOmniboxData=function(e){this.logger.trace("Processing omnibox data"),this.isCurrentlyBeingRendered=!0,this.numberOfPendingQueries=0,this.renderOmniboxBody(e),this.omniboxIsOpen=!0},i.prototype.renderHeader=function(){this.buildHeader(),this.setWidthOnOmniboxDiv(),this.omniboxDiv.show(),this.findSelectable().first().addClass("coveo-omnibox-selected"),this.headerIsCurrentlyRendered=!0},i.prototype.renderOmniboxDiv=function(){this.omniboxDiv=e.$("<div class='coveo-omnibox'></div>"),e.$(this.element).after(this.omniboxDiv)},i.prototype.setWidthOnOmniboxDiv=function(){this.omniboxDiv.width(this.getWidth())},i.prototype.buildHeader=function(){var t=this;void 0!=this.omniboxHeader&&this.omniboxHeader.remove(),this.omniboxHeader=e.$(this.omniboxHeaderSearchForTemplate({data:e.$(this.element).val()})),this.omniboxHeader.click(function(){t.triggerNewQuery(function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.searchboxSubmit,{})})}),this.omniboxDiv.prepend(this.omniboxHeader)},i.prototype.renderOmniboxBody=function(t){var i=this;if(this.wasClosed)this.close();else{this.omniboxRows=[],this.lastOmniboxData=t,this.lastNumberOfLettersInOmnibox=e.$(this.element).val().length;var n=(e._.find(t.rows,function(t){return!e.Utils.isNullOrUndefined(t.element)}),e._.partition(t.rows,function(t){return e.Utils.isNullOrUndefined(t.deferred)}));e._.each(n[0],function(e){i.renderOmniboxForOneElement(e)}),this.numberOfPendingQueries=n[1].length,0==this.numberOfPendingQueries?this.allDeferredHaveArrived():e._.each(n[1],function(e){i.renderOmniboxForOneElementDeferred(e)}),setTimeout(function(){i.rejectAllPendingDeferred(t)},this.options.omniboxTimeout)}},i.prototype.rejectAllPendingDeferred=function(t){e._.each(t.rows,function(t){e.Utils.isNullOrUndefined(t.deferred)||t.deferred.reject()})},i.prototype.allDeferredHaveArrived=function(){this.appendOmniboxSections(),this.resetOmniboxInternalData(),this.removeSearchAnimation()},i.prototype.clearLastOmniboxRows=function(){void 0!=this.lastOmniboxRows&&e._.each(this.lastOmniboxRows,function(t){e.$(t.element).remove()})},i.prototype.appendOmniboxSections=function(){if(this.omniboxRows.length>0&&""!=e.$(this.element).val()){this.renderHeader(),this.clearLastOmniboxRows(),this.omniboxRows=e._.sortBy(this.omniboxRows,function(e){return e.zIndex}).reverse();for(var t=0;t<this.omniboxRows.length;t++)this.omniboxDiv.append(this.omniboxRows[t].element);this.bindHoverEvent(),this.resetOmniboxInternalData()}else this.close()},i.prototype.resetOmniboxInternalData=function(){this.lastOmniboxRows=this.omniboxRows,this.isCurrentlyBeingRendered=!1,this.headerIsCurrentlyRendered=!1},i.prototype.renderOmniboxForOneElement=function(t){var i=t.zIndex||-1;e.$(t.element).addClass("coveo-omnibox-section"),this.omniboxRows.push({zIndex:i,element:t.element})},i.prototype.renderOmniboxForOneElementDeferred=function(t){var i=this;t.deferred.done(function(t){i.headerIsCurrentlyRendered||void 0==t.element||i.renderHeader(),i.numberOfPendingQueries--,e.Utils.isNullOrUndefined(t.element)||i.renderOmniboxForOneElement(t),0==i.numberOfPendingQueries&&i.allDeferredHaveArrived()}),t.deferred.fail(function(){i.numberOfPendingQueries--,0==i.numberOfPendingQueries&&i.allDeferredHaveArrived()})},i.prototype.isFirstValueSelected=function(e){return e.get(0)==this.findSelectable().first().get(0)},i.prototype.isLastValueSelected=function(e){return e.get(0)==this.findSelectable().last().get(0)},i.prototype.unselectValueInOmnibox=function(e){e.removeClass("coveo-omnibox-selected")},i.prototype.selectValueBeforeAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)-1)).addClass("coveo-omnibox-selected")},i.prototype.selectValueAfterAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)+1)).addClass("coveo-omnibox-selected")},i.prototype.findPosOfAlreadySelected=function(t){var i=-1,n=this.findSelectable();return e._.find(n,function(e){return i++,e==t.get(0)}),i},i.prototype.findSelectable=function(){return this.omniboxDiv.find(".coveo-omnibox-selectable")},i.prototype.findSelected=function(){return this.findSelectable().closest(".coveo-omnibox-selected")},i.prototype.toggleSelected=function(e){this.omniboxDiv.find(".coveo-omnibox-selected").removeClass("coveo-omnibox-selected"),e.addClass("coveo-omnibox-selected")},i.prototype.getWidth=function(){var t=e.$(this.element);return t.outerWidth()+this.getSearchButtonWidth()},i.prototype.getSearchButtonWidth=function(){var t=e.$(this.element).closest("."+e.Component.computeCssClassNameForType(e.Searchbox.ID));if(0!=t.length){var i=t.coveo(e.Searchbox);if(i.searchButton&&"absolute"!=e.$(i.searchButton.element).css("position"))return e.$(i.searchButton.element).outerWidth()}return 0},i.prototype.getRegexToSearch=function(t){return void 0===t&&(t=e.$(this.element).val()),new RegExp(e.Utils.escapeRegexCharacter(t),"i")},i.prototype.getCorrectTarget=function(t){var i=e.$(t.target);return i.closest(".coveo-omnibox-selectable")},i.prototype.addSearchAnimation=function(){this._hideClearElement(),e.$(this.element).addClass("coveo-omnibox-loading"),this.isLoadingData=!0},i.prototype.removeSearchAnimation=function(){e.$(this.element).removeClass("coveo-omnibox-loading"),this._addClearElement(),this.isLoadingData=!1},i.ID="Omnibox",i.options={omniboxDelay:e.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),omniboxTimeout:e.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0}),omniboxChangeLimit:e.ComponentOptions.buildNumberOption({defaultValue:3,min:1}),omniboxMinimumLetters:e.ComponentOptions.buildNumberOption({defaultValue:1,min:1})},i.parent=e.Querybox,i}(e.Querybox);e.Omnibox=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.structure=e,this.onSelect=t}return t.prototype.buildOmniboxElement=function(t,i){var n;if(0!=t.length){n=e.$("<div></div>");var o=this.buildElementHeader();n.append(o);var s=this.buildRowElements(t,i);e._.each(s,function(e){n.append(e)})}return n},t.prototype.buildElementHeader=function(){return e.$(this.structure.header.template({headerTitle:this.structure.header.title}))},t.prototype.buildRowElements=function(t,i){var n=this,o=[];return e._.each(t,function(t){var s=e.$(n.structure.row({rawValue:t.value,data:e.JQueryUtils.highlightElement(t.value,i.completeQueryExpression.word)}));s.click(function(){n.onSelect.call(n,t.value,i)}),s.on("keyboardSelect",function(){n.onSelect.call(n,t.value,i)}),o.push(s)}),o},t}();e.SuggestionForOmnibox=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,o,s,i.ID),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.setupOptions(),this.bind.onRoot(e.OmniboxEvents.populateOmnibox,this.handlePopulateOmnibox),this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleQueryOverride)}return __extends(i,t),i.prototype._buildResults=function(t){var i=this;if(this.lastOmniboxRequest){var n=e.$("<div></div>");n.append("<div class='coveo-omnibox-result-list-header'>              <span class='coveo-icon-omnibox-result-list'></span>               <span class='coveo-caption'>"+(this.options.headerTitle||e.l("SuggestedResults"))+"</span>         </div>"),e._.each(t.results,function(t){var o=i._instantiateTemplateForResult(t);e.$(o).addClass("coveo-omnibox-selectable").appendTo(n),e.$(o).on("keyboardSelect",function(){i.options.onSelect.call(i,t,e.$(o),i.lastOmniboxRequest.omniboxObject)}),i._autoCreateComponentsInsideResult(o,t),i._triggerNewResultDisplayed(t,o)}),this.lastOmniboxRequest.deferred.resolve({element:n.get(0),zIndex:this.options.omniboxZIndex})}},i.prototype.setupOptions=function(){this.logger.info("Disabling infinite scroll for OmniboxResultList",this),this.options.enableInfiniteScroll=!1,this.options.onSelect=this.options.onSelect||this.onRowSelection},i.prototype.handlePopulateOmnibox=function(t,i){var n=this,o=e.$.Deferred();i.rows.push({deferred:o}),this.lastOmniboxRequest={omniboxObject:i,deferred:o},this.queryController.executeQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchAsYouType(e.AnalyticsActionCauseList.searchboxSubmit,{})},searchAsYouType:!0})},i.prototype.handleQueryOverride=function(t,i){e.Assert.exists(i),e.Utils.isNonEmptyString(this.options.queryOverride)&&i.queryBuilder.constantExpression.add(this.options.queryOverride)},i.prototype.onRowSelection=function(t){this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.documentOpen,{},t,this.root),window.location.href=t.clickUri},i.ID="OmniboxResultList",i.options={omniboxZIndex:e.ComponentOptions.buildNumberOption({defaultValue:51,min:16}),headerTitle:e.ComponentOptions.buildStringOption(),queryOverride:e.ComponentOptions.buildStringOption()},i}(e.ResultList);e.OmniboxResultList=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.root).on(e.InitializationEvents.afterInitialization,e.$.proxy(this.init,this))}return __extends(i,t),i.prototype.init=function(){var t=this;this.menu=this.buildMenu(),e.$("<span/>").addClass("coveo-settings-icon").appendTo(this.element),e.$(this.element).click(function(){t.toggleMenu()}),this.settingsButton=e.$(this.element);var i;e.$([this.settingsButton[0],this.menu[0]]).mouseleave(function(){i=setTimeout(function(){t.menu.detach()},t.options.menuDelay)}).mouseenter(function(){clearTimeout(i)})},i.prototype.buildMenu=function(){var t=e.$("<div/>").addClass("coveo-settings-advanced-menu"),i=e._.map(this.options.includeInMenu,function(t){return e.$(t).coveo()});return t.append(this.buildSection(i)),t},i.prototype.buildSection=function(t){var i=this,n=e._.map(t,function(n){var o=e._.filter(t,function(t){return!e.Utils.objectEqual(t,n)});if(void 0!=n){var s=e.$("<div/>").addClass("coveo-settings-section").addClass(n.getCssClass());e.$("<div/>").addClass("coveo-icon").appendTo(s);var r=e.$("<div>").addClass("coveo-settings-items").appendTo(s);e._.each(n.getMenuItems(),function(t){var s=e._.filter(n.getMenuItems(),function(e){return e.text!=t.text});r.append(i.buildLine(t.text,t.onOpen,o,s,t.tooltip))})}return s});return e._.reduce(n,function(e,t){return e.add(t)},e.$())},i.prototype.buildLine=function(t,i,n,o,s){var r=this,a=o.concat(e._.compact(e._.flatten(e._.map(n,function(e){return e?e.getMenuItems():void 0}),!0))),l=e.$("<div/>").addClass("coveo-settings-item").text(t).click(function(){r.menu.detach(),i(),e._.invoke(a,"onClose")});return s&&l.prop("title",s),l},i.prototype.toggleMenu=function(){this.menu.is(":visible")?this.menu.detach():e.JQueryUtils.positionPopup(this.menu,e.$(this.element),e.$(this.root),e.$(this.root),this.getPopupPositioning())},i.prototype.getPopupPositioning=function(){return{horizontal:4,vertical:2,verticalOffset:8}},i.ID="Settings",i.options={includeInMenu:e.ComponentOptions.buildListOption({defaultValue:[]}),menuDelay:e.ComponentOptions.buildNumberOption({defaultValue:300,min:0})},i}(e.Component);e.Settings=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.dialogBoxContent=this.buildContent(),e.$(n).append(this.dialogBoxContent),e.$(this.root).on(e.QueryEvents.querySuccess,e.$.proxy(this.handleProcessNewQueryResults,this))}return __extends(i,t),i.prototype.open=function(){e.$(this.element).addClass("coveo-share-query-opened")},i.prototype.close=function(){e.$(this.element).removeClass("coveo-share-query-opened")},i.prototype.getCssClass=function(){return"coveo-share-query"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("ShareQuery"),onOpen:function(){return t.open()},onClose:function(){return t.close()}}]},i.prototype.handleProcessNewQueryResults=function(t,i){e.Assert.exists(i),e.Assert.exists(i.results);var n=i.query;this.linkToThisQuery.val(window.location.href),this.completeQuery.val(e.$.trim(this.outputIfNotNull(n.q)+" "+this.outputIfNotNull(n.aq)+" "+this.outputIfNotNull(n.cq))),this.logger.trace("Received query results from new query",n)},i.prototype.outputIfNotNull=function(e){return e?"("+e+")":""},i.prototype.buildContent=function(){var t=this,i=e.$("<div/>").addClass("coveo-share-query-summary-info");i.append(e.$("<span/>").addClass("coveo-query-summary-info-title").text(e.l("ShareQuery")));var n=e.$("<div/>").addClass("coveo-share-query-summary-info-close").append("<span/>");n.click(function(){return t.close()}),i.append(n);var o=e.$("<div/>").addClass("coveo-share-query-summary-info-boxes");return this.linkToThisQuery=e.$("<input/>").attr("type","text").addClass("coveo-share-query-summary-info-input"),this.linkToThisQuery.click(function(){return t.linkToThisQuery.select()}),this.completeQuery=e.$("<input/>").attr("type","text").addClass("coveo-share-query-summary-info-input"),o.append(this.buildTextBoxWithLabel(e.l("Link")+":",this.linkToThisQuery)),o.append(this.buildTextBoxWithLabel(e.l("CompleteQuery")+":",this.completeQuery)),o.appendTo(i),e.Component.pointElementsToDummyForm(i),i},i.prototype.buildTextBoxWithLabel=function(t,i){var n=e.$("<span/>").addClass("coveo-share-query-summary-info-label").text(t);return e.$("<div/>").append(n).append(i)},i.create=function(t,n,o){return e.Assert.exists(t),new i(t,n,o)},i.ID="ShareQuery",i.options={},i}(e.Component);e.ShareQuery=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.isLargerOrEqualsThan(1,this.options.sortCriteria.length);var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne)+e.QueryStateModel.attributesEnum.sort;this.bind.onRoot(a,function(e,t){return r.handleQueryStateChanged(e,t)}),this.bind.onRoot(e.QueryEvents.querySuccess,function(e,t){return r.handleQuerySuccess(e,t)}),this.bind.onRoot(e.QueryEvents.buildingQuery,function(e,t){return r.handleBuildingQuery(e,t)}),this.bind.click(e.$(this.element),this.handleClick),e.Utils.isNonEmptyString(this.options.caption)&&e.$(this.element).text(this.options.caption),this.isToggle()&&e.$(this.element).append('<span class="coveo-icon" />'),this.updateAppearance()}return __extends(i,t),i.prototype.select=function(t,i){if(void 0===i&&(i=!1),t)this.currentCriteria=e._.find(this.options.sortCriteria,function(e){return e.direction==t});else if(e.Utils.exists(this.currentCriteria)){var n=e._.indexOf(this.options.sortCriteria,this.currentCriteria);e.Assert.check(n>=0),this.currentCriteria=this.options.sortCriteria[(n+1)%this.options.sortCriteria.length]}else this.currentCriteria=this.options.sortCriteria[0];this.queryStateModel.set(e.QueryStateModel.attributesEnum.sort,this.currentCriteria.toString(),{silent:i})},i.prototype.disable=function(){e.$(this.element).addClass("coveo-tab-disabled"),t.prototype.disable.call(this)},i.prototype.enable=function(){e.$(this.element).removeClass("coveo-tab-disabled"),t.prototype.enable.call(this)},i.prototype.getCurrentCriteria=function(){return this.currentCriteria},i.prototype.handleQueryStateChanged=function(){var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.sort);if(e.Utils.isNonEmptyString(t)){var i=e.SortCriteria.parse(t);this.currentCriteria=e._.find(this.options.sortCriteria,function(e){return i.equals(e)})}else this.currentCriteria=null;this.updateAppearance()},i.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.queryStateModel.get(e.QueryStateModel.attributesEnum.sort);(n==e.QueryStateModel.defaultAttributes.sort||this.isSelected())&&this.currentCriteria&&this.currentCriteria.putInQueryBuilder(i.queryBuilder)},i.prototype.handleQuerySuccess=function(t,i){0==i.results.results.length?e.$(this.element).hide():e.$(this.element).show()},i.prototype.handleClick=function(){var t=this,i=this.currentCriteria;this.select(),i!=this.currentCriteria&&this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return t.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.resultsSort,{resultsSortBy:t.currentCriteria.sort+t.currentCriteria.direction})}})},i.prototype.isToggle=function(){return this.options.sortCriteria.length>1},i.prototype.isSelected=function(){return e.Utils.exists(this.currentCriteria)},i.prototype.updateAppearance=function(){if(e.$(this.element).toggleClass("coveo-selected",this.isSelected()),this.isToggle()){var t=this.currentCriteria?this.currentCriteria.direction:this.options.sortCriteria[0].direction;e.$(this.element).toggleClass("coveo-ascending","ascending"==t)}},i.prototype.match=function(t){return e._.any(this.options.sortCriteria,function(e){return t==e.toString()})},i.ID="Sort",i.options={sortCriteria:e.ComponentOptions.buildCustomListOption(function(t){return e._.map(t,function(t){return e.SortCriteria.parse(t)})},{required:!0}),caption:e.ComponentOptions.buildLocalizedStringOption({required:!0})},i}(e.Component);e.Sort=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,e.ComponentOptions.initComponentOptions(n,i,o),s,i.ID),this.element=n,this.options=o,e.$(this.element).hide(),this.options.includeDemoSection&&this.buildAllDemo(),this.submit()}return __extends(i,t),i.prototype.getOrCreateContainerForDemo=function(){return this.demoContainer||(this.demoContainer=e.$("<div class='coveo-demo-section-container'></div>"),e.$(this.root).append(this.demoContainer)),this.demoContainer},i.prototype.buildAllDemo=function(){this.buildNewToCoveoSection(),this.buildDemoSection(),this.hideDemoSection()},i.prototype.buildDemoSection=function(){var t=this;this.demoCoveoSection=e.$("<div class='coveo-demo-section'></div>"),this.hideDemoSection();var i=e.$("<div class='coveo-demo-section-back-to-login'><span class='coveo-demo-section-arrow-backward'></span>"+e.l("GoBack")+"</div>");i.click(function(){t.hideDemoSection()});var n=e.$("<div class='coveo-demo-section-logo'></div>"),o=e.$("<div class='coveo-demo-section-explanation'>"+e.l("AppIntro")+"</div>"),s=e.$("<button class='coveo-demo-section-try-it'>"+e.l("TryDemo")+"</button>");s.click(function(){window.location.href="demo.html"});var r=e.$("<button class='coveo-demo-section-contact'>"+e.l("ContactUs")+"</button>");r.click(function(){window.open("http://www.coveo.com/company/contact-us","_system")}),this.demoCoveoSection.append(i,n,o,s,r),this.getOrCreateContainerForDemo().append(this.demoCoveoSection)},i.prototype.buildNewToCoveoSection=function(){var t=this;this.newToCoveoSection=e.$("<div class='coveo-new-to-coveo-section'><h2>"+e.l("NewToCoveo")+"</h2><h3>"+e.l("LetUsHelpGetStarted")+"</h3><span class='coveo-demo-section-arrow-forward'></span></div>"),this.newToCoveoSection.click(function(){return t.showDemoSection()}),e.DeviceUtils.isAndroid()&&(window.addEventListener("native.keyboardshow",function(i){var n=e.$(window).height()-i.keyboardHeight,o=e.$(":focus").get(0).getBoundingClientRect();if(o.top>n){var s=o.top-n+o.height;t.getOrCreateCombined().css("top","-"+s+"px")}}),window.addEventListener("native.keyboardhide",function(){t.getOrCreateCombined().css("top","0")})),this.getOrCreateCombined().append(this.newToCoveoSection)},i.prototype.showDemoSection=function(){this.getOrCreateContainerForDemo().addClass("coveo-active"),this.getOrCreateCombined().removeClass("coveo-active")},i.prototype.hideDemoSection=function(){this.getOrCreateContainerForDemo().removeClass("coveo-active"),this.getOrCreateCombined().addClass("coveo-active")},i.ID="StandaloneLogin",i.options={requirePageSettings:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),includeDemoSection:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Login);e.StandaloneLogin=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n){this.searchInterface=t,this.result=n,this.element=i.instantiateToElement(n),e.$(this.element).data("CoveoResult",n),e.Component.bindResultToElement(this.element,n)}return t.prototype.initialize=function(){var t=this.searchInterface.options,i={options:t,bindings:this.searchInterface.getBindings(),result:this.result};e.CoveoJQuery.automaticallyCreateComponentsInside(this.element,i)},t}();e.StandaloneResult=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){void 0===e&&(e=0),this.previewActive=!1,this.html=t,this.value=e}return t.prototype.getValue=function(){return this.value},t.prototype.getHTML=function(){return this.html},t.prototype.setValue=function(e){this.value=e},t.prototype.setHTML=function(e){this.html=e},t.prototype.addPreview=function(t,i){this.previewActive=!0;var n=e.$('<div class="matrix-results-preview-container"></div>');n.css("min-width",t),n.css("max-width",i),n.click(function(e){e.stopPropagation()}),e.$(this.html).append(n),e.$(this.html).children(".matrix-results-preview-container").hide()},t.prototype.removePreview=function(){this.previewActive=!1,e.$(this.html).find(".matrix-results-preview-container").remove()},t.prototype.updatePreview=function(t){if(this.previewActive){var i=e.$(this.html).find(".matrix-results-preview-container");i.append(t),i.show()}},t}();e.Cell=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,i){t.call(this),this.computedField=e,this.format=i}return __extends(i,t),i.prototype.instantiateToString=function(e){var t='<div class="coveo-result-frame"><div class="coveo-result-row"><div class="coveo-result-cell" style="width: 20px; padding-right:5px"><a class="CoveoIcon"></a></div><div class="coveo-result-cell" style="font-size:13px"><a class="CoveoResultLink"></a></div><div class="coveo-result-cell" style="width:80px; text-align:right; font-size:13px; padding-right: 5px; padding-left: 5px">'+Globalize.format(parseInt(e.raw[this.computedField.slice(1)]),this.format)+"</div></div></div>";return t},i.prototype.instantiateToElement=function(t){return e.$(this.instantiateToString(t)).get(0)},i}(e.Template);e.DefaultMatrixResultPreviewTemplate=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.groupByIndex=[],this.rowId="",this.columnId="",this.selectedRowValue=void 0,this.selectedColumnValue=void 0,this.numberOfRows=0,this.numberOfColumns=0,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.options.previewTemplate||(this.options.previewTemplate=new e.DefaultMatrixResultPreviewTemplate(this.options.computedField,this.options.computedFieldFormat)),this.options.previewSortField||(this.options.previewSortField=this.options.computedField),this.options.columnFieldValues.length!=this.options.columnLabels.length&&(this.options.columnLabels=this.options.columnFieldValues),this.buildMatrix(),null==this.options.rowField?this.logger.error('"rowField" option is required in the Matrix component'):null==this.options.columnField?this.logger.error('"columnField" option is required in the Matrix component'):null==this.options.computedField?this.logger.error('"computedField" option is required in the Matrix component'):(this.bindEvents(),this.initQueryState())}return __extends(i,t),i.prototype.bindEvents=function(){this.bind.onRoot(e.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.QueryEvents.doneBuildingQuery,this.handleDoneBuildingQuery),this.bind.onRoot(e.QueryEvents.deferredQuerySuccess,this.handleDeferredQuerySuccess)
},i.prototype.initQueryState=function(){this.rowId=e.QueryStateModel.getFacetId(this.options.rowField),this.columnId=e.QueryStateModel.getFacetId(this.options.columnField),this.queryStateModel.registerNewAttribute(this.rowId,[]),this.queryStateModel.registerNewAttribute(this.columnId,[])},i.prototype.buildMatrix=function(){this.buildTitle(),this.buildBody(),this.data=new Array,this.addHeaderRow()},i.prototype.buildTitle=function(){var t=this.options.title?this.options.title:"",i="<div class=coveo-matrix-title>"+t+"</div>";e.$(this.element).append(i)},i.prototype.buildBody=function(){var t="<div class='coveo-matrix'></div>";e.$(this.element).append(t)},i.prototype.handleBuildingQuery=function(e,t){this.areFacetsPresent()||(this.selectedRowValue&&!this.isRowFacetPresent()&&t.queryBuilder.advancedExpression.addFieldExpression(this.options.rowField,"=",[this.selectedRowValue]),this.selectedColumnValue&&!this.isColumnFacetPresent()&&t.queryBuilder.advancedExpression.addFieldExpression(this.options.columnField,"=",[this.selectedColumnValue]))},i.prototype.handleDoneBuildingQuery=function(e,t){this.addMainGroubByRequest(t.queryBuilder),this.addColumnsGroupByRequests(t.queryBuilder)},i.prototype.addMainGroubByRequest=function(e){var t={field:this.options.rowField,sortCriteria:this.options.sortCriteria,computedFields:this.getComputedFields(),maximumNumberOfValues:this.options.maximumNumberOfRows};this.groupByIndex.push(e.groupByRequests.length),e.groupByRequests.push(t)},i.prototype.addColumnsGroupByRequests=function(e){for(var t=0;t<this.options.columnFieldValues.length;t++){var i={field:this.options.rowField,sortCriteria:this.options.sortCriteria,computedFields:this.getComputedFields(),queryOverride:"("+this.buildExpression(e)+")("+this.options.columnField+"='"+this.options.columnFieldValues[t]+"')",maximumNumberOfValues:this.options.maximumNumberOfValuesInGroupBy};this.groupByIndex.push(e.groupByRequests.length),e.groupByRequests.push(i)}},i.prototype.buildExpression=function(e){var t=e.expression.build(),i=e.advancedExpression.build(),n=e.constantExpression.build(),o="";return t&&(o+=" "+t),i&&(o+=" "+i),n&&(o+=" "+n),o},i.prototype.getComputedFields=function(){var e=[{field:this.options.computedField,operation:this.options.computedFieldOperation}];return e},i.prototype.handleDeferredQuerySuccess=function(e,t){this.reset(),this.parseResults(t.results),this.addTotals(),this.drawMatrix(),this.formatCells(),this.selectedRowValue=void 0,this.selectedColumnValue=void 0},i.prototype.getCellResult=function(e,t,i){for(var n=this.getRowValue(t),o=this.getColumnValue(i),s=0,r=0;r<e.values.length;r++)if(e.values[r].value===n){s=e.values[r].computedFieldResults[0];break}return this.isAColumnSelected()&&!this.isColumnSelected(o)&&(s=0),s},i.prototype.addTotals=function(){this.options.enableRowTotals&&this.addRowTotals(),this.options.enableColumnTotals&&this.addColumnTotals()},i.prototype.addRowTotals=function(){var e=this;this.addColumn("<div class='coveo-matrix-cell matrix-total-column'></div>"),this.setValue("Total",0,this.numberOfColumns-1);for(var t=1;t<this.numberOfRows;t++){var i=this.computeRowTotal(t);this.setValue(i,t,this.numberOfColumns-1)}"ComputedFieldDescending"==this.options.sortCriteria&&this.data.sort(function(t,i){return i[e.numberOfColumns-1].getValue()-t[e.numberOfColumns-1].getValue()}),"ComputedFieldAscending"==this.options.sortCriteria&&this.data.sort(function(t,i){return t[e.numberOfColumns-1].getValue()-i[e.numberOfColumns-1].getValue()})},i.prototype.addColumnTotals=function(){this.addRow(),this.setValue("Total",this.numberOfRows-1,0);for(var e=1;e<this.numberOfColumns;e++){var t=this.computeColumnTotal(e);this.setValue(t,this.numberOfRows-1,e)}},i.prototype.computeRowTotal=function(e){for(var t=0,i=1;i<this.numberOfColumns-1;i++)t+=parseInt(this.getCellValue(e,i));return t},i.prototype.computeColumnTotal=function(e){for(var t=0,i=1;i<this.numberOfRows-1;i++)t+=parseInt(this.getCellValue(i,e));return t},i.prototype.formatCells=function(){for(var e=1;e<this.numberOfRows;e++)for(var t=1;t<this.numberOfColumns;t++){var i=this.getCellValue(e,t);i=Globalize.format(parseInt(i),this.options.computedFieldFormat),this.setValue(i,e,t)}},i.prototype.addHeaderRow=function(){this.addRow(),this.addColumn(),this.setValue(this.options.columnHeader,0,0);for(var e=0;e<this.options.columnLabels.length;e++)this.addColumn(),this.setValue(this.options.columnLabels[e],0,e+1)},i.prototype.addRow=function(){this.data.push(new Array);for(var e=0;e<this.numberOfColumns;e++)this.addCellToRow(this.numberOfRows,e);this.numberOfRows++},i.prototype.addColumn=function(e){void 0===e&&(e="<div class='coveo-matrix-cell'></div>");for(var t=0;t<this.numberOfRows;t++)this.addCellToRow(t,this.numberOfColumns);this.numberOfColumns++},i.prototype.addCellToRow=function(t,i){var n=e.$("<div class='coveo-matrix-cell'></div>");0==i&&n.addClass("matrix-first-column"),this.data[t].push(new e.Cell(0,n.get(0)))},i.prototype.setValue=function(e,t,i){var n=this.getCell(t,i);n.text(e),this.isCellSelected(this.getRowValue(t),this.getColumnValue(i))&&n.addClass("matrix-selected"),this.isAColumnSelected()&&!this.isColumnSelected(this.getColumnValue(i))&&0!=i&&0!=t&&n.addClass("matrix-unimportant"),this.data[t][i].setValue(e)},i.prototype.getCell=function(t,i){return e.$(this.data[t][i].getHTML())},i.prototype.getCellValue=function(e,t){var i=this.getCell(e,t);return i.text()},i.prototype.handleClick=function(e,t){if(0!==e&&e!==this.numberOfRows-1)var i=this.getRowValue(e);if(0!==t&&t!==this.numberOfColumns-1)var n=this.getColumnValue(t);i&&this.isRowFacetPresent()?this.queryStateModel.set(this.rowId,[i]):(this.selectedRowValue=i,this.queryStateModel.set(this.rowId,[])),n&&this.isColumnFacetPresent()?this.queryStateModel.set(this.columnId,[n]):(this.selectedColumnValue=n,this.queryStateModel.set(this.columnId,[])),this.queryController.deferExecuteQuery()},i.prototype.getRowValue=function(e){return this.data[e][0].getValue()},i.prototype.getColumnValue=function(e){return this.options.columnFieldValues[e-1]},i.prototype.isAColumnSelected=function(){var e=this.queryStateModel.get(this.columnId)||[];return 0!==e.length||void 0!=this.selectedColumnValue},i.prototype.isColumnSelected=function(e){if(this.isAColumnSelected()&&e)for(var t=this.queryStateModel.attributes[this.columnId]||[],i=0;i<t.length;i++)if(t[i].toLowerCase()===e.toLowerCase())return!0;return this.selectedColumnValue==e},i.prototype.isARowSelected=function(){var e=this.queryStateModel.get(this.rowId)||[];return 0!==e.length||void 0!==this.selectedRowValue},i.prototype.isRowSelected=function(e){if(this.isARowSelected()&&e)for(var t=this.queryStateModel.get(this.rowId)||[],i=0;i<t.length;i++)if(t[i].toLowerCase()===e.toLowerCase())return!0;return this.selectedRowValue==e},i.prototype.isCellSelected=function(e,t){return this.isAColumnSelected()&&this.isARowSelected()?this.isRowSelected(e)&&this.isColumnSelected(t):this.isAColumnSelected()?this.isColumnSelected(t):!1},i.prototype.areFacetsPresent=function(){return this.isRowFacetPresent()&&this.isColumnFacetPresent()},i.prototype.isRowFacetPresent=function(){var e=this.componentStateModel.get(this.rowId);return e&&!e[0].disabled},i.prototype.isColumnFacetPresent=function(){var e=this.componentStateModel.get(this.columnId);return e&&!e[0].disabled},i.prototype.reset=function(){e.$(this.element).html(""),this.numberOfRows=0,this.numberOfColumns=0,this.data=new Array,this.buildMatrix()},i.prototype.parseResults=function(e){for(var t=e.groupByResults[this.groupByIndex[0]],i=0;i<t.values.length;i++){var n=t.values[i].value;this.addRow(),this.setValue(n,i+1,0)}for(var i=1;i<this.numberOfRows;i++)for(var o=1;o<this.numberOfColumns;o++){var s=e.groupByResults[this.groupByIndex[o]],r=this.getCellResult(s,i,o);this.setValue(r,i,o)}},i.prototype.drawMatrix=function(){var t=e.$("<div class='coveo-matrix-row matrix-header-row'></div>");this.drawRow(t,0);for(var i=this.options.enableColumnTotals?this.numberOfRows-1:this.numberOfRows,n=1;i>n;n++){var o=e.$("<div class='coveo-matrix-row'></div>");this.drawRow(o,n)}if(this.options.enableColumnTotals){var s=e.$("<div class='coveo-matrix-row matrix-total-row'></div>");this.drawRow(s,this.numberOfRows-1)}""!==this.options.cellFontSize&&e.$(".coveo-matrix-cell").css("font-size",this.options.cellFontSize)},i.prototype.drawRow=function(t,i){for(var n=e.$(this.element).find(".coveo-matrix"),o=0;o<this.numberOfColumns;o++){var s=this.data[i][o].getHTML();e.$(s).click(e.$.proxy(this.handleClick,this,i,o)),this.options.enableHoverPreview&&e.$(s).hover(e.$.proxy(this.handleHoverIn,this,i,o),e.$.proxy(this.handleHoverOut,this,i,o)),t.append(s)}n.append(t)},i.prototype.handleHoverIn=function(e,t){var i=this;this.isHoverWorkingOnRow(e)&&this.isHoverWorkingOnColumn(t)&&(this.previewTimeout=setTimeout(function(){i.displayResultsPreview(e,t)},this.options.previewDelay))},i.prototype.handleHoverOut=function(e,t){clearTimeout(this.previewTimeout);var i=this.data[e][t];i.removePreview()},i.prototype.displayResultsPreview=function(t,i){var n=this,o=this.createPreviewQuery(t,i),s=this.data[t][i];s.addPreview(this.options.previewMinWidth,this.options.previewMaxWidth);var r=this.queryController.getEndpoint();r.search(o).done(e.$.proxy(function(o){if(n.isDataAvailable(t,i)){for(var s=n.data[t][i],r=[],a=0;a<o.results.length;a++)r.push(n.instanciateTemplate(o.results[a]));var l="";e._.each(r,function(e){l+=e.outerHTML}),s.updatePreview(l)}},this))},i.prototype.instanciateTemplate=function(t){var i=this.options.previewTemplate.instantiateToElement(t,!1),n=(this.searchInterface.options.originalOptionsObject,{options:this.options,bindings:this.getBindings(),result:t});return e.CoveoJQuery.automaticallyCreateComponentsInside(i,n),i},i.prototype.createPreviewQuery=function(t,i){var n="("+e.QueryUtils.buildFieldExpression(this.options.rowField,"=",[this.getRowValue(t)])+")",o="("+e.QueryUtils.buildFieldExpression(this.options.columnField,"=",[this.getColumnValue(i)])+")",s=this.queryController.getLastQuery();return s.aq=n,s.aq+=o,s.sortCriteria=this.options.previewSortCriteria,s.sortField=this.options.previewSortField,s},i.prototype.isHoverWorkingOnRow=function(e){return this.options.enableColumnTotals?0!==e&&e!==this.numberOfRows-1:0!==e},i.prototype.isHoverWorkingOnColumn=function(e){return this.options.enableRowTotals?0!==e&&e!==this.numberOfColumns-1:0!==e},i.prototype.isDataAvailable=function(e,t){return void 0!==this.data[e]&&void 0!==this.data[e][t]},i.ID="Matrix",i.options={title:e.ComponentOptions.buildStringOption(),rowField:e.ComponentOptions.buildFieldOption({required:!0}),sortCriteria:e.ComponentOptions.buildStringOption({defaultValue:"ComputedFieldDescending"}),maximumNumberOfRows:e.ComponentOptions.buildNumberOption({defaultValue:10,min:0}),enableRowTotals:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),columnField:e.ComponentOptions.buildFieldOption({required:!0}),columnFieldValues:e.ComponentOptions.buildListOption({defaultValue:[]}),columnLabels:e.ComponentOptions.buildListOption({defaultValue:[]}),columnHeader:e.ComponentOptions.buildStringOption(),maximumNumberOfValuesInGroupBy:e.ComponentOptions.buildNumberOption({defaultValue:100,min:0}),enableColumnTotals:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),computedField:e.ComponentOptions.buildFieldOption({required:!0}),computedFieldOperation:e.ComponentOptions.buildStringOption({defaultValue:"sum"}),computedFieldFormat:e.ComponentOptions.buildStringOption({defaultValue:"c0"}),cellFontSize:e.ComponentOptions.buildStringOption({defaultValue:""}),enableHoverPreview:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),previewSortCriteria:e.ComponentOptions.buildStringOption({defaultValue:"FieldDescending"}),previewSortField:e.ComponentOptions.buildFieldOption(),previewMaxWidth:e.ComponentOptions.buildStringOption({defaultValue:"300px"}),previewMinWidth:e.ComponentOptions.buildStringOption({defaultValue:"0"}),previewDelay:e.ComponentOptions.buildNumberOption({defaultValue:500}),previewTemplate:e.ComponentOptions.buildTemplateOption()},i}(e.Component);e.Matrix=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.options=o,this.menuIsOpen=!1,this.menuItemsContainerTemplate=e._.template("<div class='coveo-menu-item-container'></div>"),this.activeMenuItemTemplate=e._.template("<a class='coveo-menu-item-active'><%= itemIcon %><%= caption %><%= showMoreIcon %> </a>"),this.activeMenuItemIconTemplate=e._.template("<span class='coveo-icon <%= _class %>'></span>"),this.activeMenuItemCaptionTemplate=e._.template("<span class='coveo-caption'><%= text %></span>"),this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.initQueryStateEvents(),this.initMiscEvents()}return __extends(i,t),i.prototype.open=function(){this.renderMenu(),this.menuItemsContainer.css("min-width",this.activeMenuItemDisplay.outerWidth()),this.menuItemsContainer.show(),this.activeMenuItemDisplay.addClass("coveo-menu-open"),this.menuIsOpen=!0},i.prototype.close=function(){this.menuItemsContainer.hide(),this.activeMenuItemDisplay.removeClass("coveo-menu-open"),this.menuIsOpen=!1},i.prototype.handleClick=function(e){this.targetIsAMenuItem(e)?this.handleClickOnMenuItem(e):this.handleClickOnMenu()},i.prototype.handleClickOnMenuItem=function(t){var i=e.Component.get(this.getCorrectTarget(t).get(0),e.TabGroup);this.selectMenuItem(this.getItemInMenuById(i.getId())),this.close(),this.queryController.deferExecuteQuery()},i.prototype.handleClickOnMenu=function(){this.menuIsOpen?this.close():this.open()},i.prototype.handleMouseLeave=function(){this.close()},i.prototype.handleAfterInitialization=function(){this.initMenuItems();var t=this.queryStateModel.get(e.QueryStateModel.attributesEnum.tg);this.selectMenuItem(this.getItemInMenuById(t))},i.prototype.handleQueryStateChange=function(t,i){e.Assert.exists(i),this.selectMenuItem(this.getItemInMenuById(i.value))},i.prototype.initMenuItems=function(){var t=this;this.menuItemsContainer=e.$(this.menuItemsContainerTemplate()).hide(),this.activeMenuItemDisplay=e.$("<div></div>"),e.$(this.element).append(this.activeMenuItemDisplay,this.menuItemsContainer),this.menuItems=e._.map(e.$(this.element).find("."+e.Component.computeCssClassNameForType(e.TabGroup.ID)),function(i){return t.menuItemsContainer.append(i),{tabGroup:e.$(i).coveo(),element:e.$(i)}})},i.prototype.initQueryStateEvents=function(){var t=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.tg);e.$(this.root).on(t,e.$.proxy(this.handleQueryStateChange,this))},i.prototype.initMiscEvents=function(){var t=this;e.$(this.root).on(e.InitializationEvents.afterInitialization,function(){return t.handleAfterInitialization()}),e.$(this.element).click(function(e){t.handleClick(e)}),e.$(this.element).mouseleave(function(e){setTimeout(function(){t.handleMouseLeave(e)},t.options.menuDelay)})},i.prototype.renderDisplayActiveMenuItem=function(){this.activeMenuItemDisplay.empty(),this.activeMenuItemDisplay.html(this.activeMenuItemTemplate({itemIcon:this.activeMenuItemIconTemplate({_class:this.activeMenuItem.tabGroup.getIcon()}),caption:this.activeMenuItemCaptionTemplate({text:this.activeMenuItem.tabGroup.getTitle()}),showMoreIcon:this.activeMenuItemIconTemplate({_class:"coveo-show-more"})}))},i.prototype.renderMenu=function(){e._.each(this.getInactiveMenuItems(),function(e){e.element.show()}),this.activeMenuItem.element.hide()},i.prototype.selectMenuItem=function(e){void 0!=this.menuItems&&(void 0==e&&(e=this.menuItems[0]),this.activeMenuItem=e,this.activeMenuItem.tabGroup.select(),this.renderDisplayActiveMenuItem())},i.prototype.getItemInMenuById=function(t){return e._.find(this.menuItems,function(e){return e.tabGroup.getId()==t})},i.prototype.getItemInMenuByElement=function(t){return e._.find(this.menuItems,function(i){return e.Utils.objectEqual(t,i.element)})},i.prototype.getInactiveMenuItems=function(){var t=this;return e._.reject(this.menuItems,function(i){return e.Utils.objectEqual(i,t.activeMenuItem)})},i.prototype.getItemMenuClass=function(){return e.Component.computeCssClassNameForType(e.TabGroup.ID)},i.prototype.getCorrectTarget=function(t){return e.$(t.target).parent().hasClass(this.getItemMenuClass())?e.$(t.target).parent():e.$(t.target)},i.prototype.targetIsAMenuItem=function(e){return this.getCorrectTarget(e).hasClass(this.getItemMenuClass())},i.ID="TabGroupMenu",i.options={menuDelay:e.ComponentOptions.buildNumberOption({defaultValue:300,min:0})},i}(e.Component);e.TabGroupMenu=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.options=o,this.isSelected=!1,this.iconTemplate=e._.template("<span class='coveo-icon <%= _class %>'></span>"),this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.title=e.$(this.element).text(),this.initQueryEvents(),this.initQueryStateEvents(),e.$(this.element).prepend(this.iconTemplate({_class:this.options.icon}))}return __extends(i,t),i.prototype.select=function(){this.actionOnSelect(),this.updateQueryStateModel()},i.prototype.getTitle=function(){return this.title},i.prototype.getIcon=function(){return this.options.icon},i.prototype.getId=function(){return this.options.id},i.prototype.actionOnSelect=function(){this.hideTabsNotInThisGroup(),this.isSelected=!0},i.prototype.actionOnUnSelect=function(){this.isSelected=!1},i.prototype.updateQueryStateModel=function(){this.queryStateModel.set(e.QueryStateModel.attributesEnum.tg,this.options.id)},i.prototype.initQueryEvents=function(){e.$(this.root).on(e.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQueryEvents,this))},i.prototype.initQueryStateEvents=function(){var t=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.tg);e.$(this.root).on(t,e.$.proxy(this.handleQueryStateChange,this))},i.prototype.handleBuildingQueryEvents=function(t,i){e.Assert.exists(i),this.isSelected&&e.Utils.isNonEmptyString(this.options.expression)&&i.queryBuilder.advancedExpression.add(this.options.expression)},i.prototype.handleQueryStateChange=function(t,i){e.Assert.exists(i),i.value==this.options.id?this.actionOnSelect():this.actionOnUnSelect()},i.prototype.hideTabsNotInThisGroup=function(){var t=this,i=this.getAllTabs();e._.each(i,function(e){t.isElementIncludedInTabGroup(e.element)?e.enable():e.disable()})},i.prototype.getAllVisibleTab=function(){return e._.filter(this.getAllTabs(),function(t){return e.$(t.element).is(":visible")})},i.prototype.getAllTabs=function(){return this.searchInterface.components(e.Tab.ID)},i.prototype.isElementIncludedInTabGroup=function(t){var i=e.$(t).attr("data-tab-group");return void 0==i||e._.contains(i.split(","),this.options.id)},i.ID="TabGroup",i.options={id:e.ComponentOptions.buildStringOption(),icon:e.ComponentOptions.buildIconOption(),expression:e.ComponentOptions.buildStringOption()},i}(e.Component);e.TabGroup=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),e.Assert.exists(this.result),null!=this.options.condition){var a=new Function("obj","with(obj||{}){return "+this.options.condition+"}");a(this.result)&&this.initialize()}else this.initialize()}return __extends(i,t),i.prototype.initialize=function(){var t=this;if(null!=this.options.template){var n=this.searchInterface.options,o={options:n,bindings:this.bindings,result:this.result},s=e.$(this.element).parents("."+e.Component.computeCssClassNameForType(i.ID));e._.each(s,function(i){var n=e.$(i).clone().children().remove().end().get(0).outerHTML;e.Assert.check(-1===n.indexOf(t.element.outerHTML),"TemplateLoader cannot load a template into itself.")}),this.element.innerHTML=this.options.template.instantiateToString(this.result,!1),e.CoveoJQuery.automaticallyCreateComponentsInside(this.element,o)}},i.ID="TemplateLoader",i.options={template:e.ComponentOptions.buildTemplateOption(),condition:e.ComponentOptions.buildStringOption()},i}(e.Component);e.TemplateLoader=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.classToToggle=this.options.toggleClass,this.target=this.options.target,this.activateGlass=this.options.activateGlass,this.activateGlass&&this.buildGlass(),e.$(n).click(function(){return r.handleClick()}),"A"==n.tagName&&e.$(n).attr("href","javascript:");var a=this.queryStateModel.getEventName(e.Model.eventTypes.changeOne+e.QueryStateModel.attributesEnum.t);this.bind.onRoot(a,this.handleTabChanged)}return __extends(i,t),i.prototype.handleClick=function(){e.$("."+this.target).hasClass(this.classToToggle)?this.removeToggleClass():this.addToggleClass()},i.prototype.handleTabChanged=function(){this.removeToggleClass()},i.prototype.addToggleClass=function(){e.MobileUtils.addToggleClassOnSearchInterface(this.classToToggle.substr(6),e.DeviceUtils.isPhonegap())},i.prototype.removeToggleClass=function(){e.MobileUtils.removeToggleClassOnSearchInterface(e.DeviceUtils.isPhonegap())},i.prototype.getGlass=function(){return e.$(".coveo-glass")},i.prototype.buildGlass=function(){if(0==this.getGlass().length){var t=e.$("<div></div>").addClass("coveo-glass");t.click(function(){e.MobileUtils.removeToggleClassOnSearchInterface()});var i=e.$("."+e.Component.computeCssClassNameForType(e.SearchInterface.ID));e.$(i).append(t)}},i.ID="ToggleButton",i.options={toggleClass:e.ComponentOptions.buildStringOption(),target:e.ComponentOptions.buildStringOption(),activateGlass:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.ToggleButton=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.options=o,this.partialQueries=[],this.lastSuggestions=[],this.topAnalyticsElementHeaderTemplate=e._.template("<div class='coveo-top-analytics-suggestion-header'>          <span class='coveo-icon-top-analytics'></span>           <span class='coveo-caption'><%= headerTitle %></span>         </div>"),this.topAnalyticsElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-analytics-suggestion-row'>           <%= data %>         </div>"),this.resultsToBuildWith=[],"omniboxSuggestionOptions"in this.options&&(this.options=e._.extend(this.options,this.options.omniboxSuggestionOptions)),e.ComponentOptions.initComponentOptions(n,i,this.options),this.options.onSelect=this.options.onSelect||this.onRowSelection;var a={header:{template:this.topAnalyticsElementHeaderTemplate,title:this.options.headerTitle},row:this.topAnalyticsElementRowTemplate};this.suggestionForOmnibox=new e.SuggestionForOmnibox(a,e.$.proxy(this.options.onSelect,this)),e.$(this.root).on(e.OmniboxEvents.populateOmnibox,e.$.proxy(this.handlePopulateOmnibox,this)),this.bind.onRoot(e.QueryEvents.querySuccess,function(){return r.partialQueries=[]})}return __extends(i,t),i.prototype.handlePopulateOmnibox=function(t,i){var n=this;if(e.Assert.exists(i),!this.disabled){var o=e.$.Deferred(),s=this.usageAnalytics.getTopQueries({pageSize:this.options.numberOfSuggestions,queryText:i.completeQueryExpression.word});s.done(function(t){n.resultsToBuildWith=e._.map(t,function(e){return{value:e}}),n.lastSuggestions=t,e._.isEmpty(n.resultsToBuildWith)||""==i.completeQueryExpression.word||n.partialQueries.push(i.completeQueryExpression.word);var s=n.suggestionForOmnibox.buildOmniboxElement(n.resultsToBuildWith,i);o.resolve({element:void 0==s?void 0:s.get(0),zIndex:n.options.omniboxZIndex})}),s.fail(function(){n.resolveWithUndefined(o)}),i.rows.push({deferred:o})}},i.prototype.onRowSelection=function(t,i){var n=this;i.clear(),i.closeOmnibox(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){n.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.omniboxAnalytics,{partialQueries:n.cleanCustomData(n.partialQueries),suggestionRanking:e._.indexOf(e._.pluck(n.resultsToBuildWith,"value"),t),suggestions:n.cleanCustomData(n.lastSuggestions),partialQuery:i.completeQueryExpression.word})}})},i.prototype.cleanCustomData=function(t,i){void 0===i&&(i=256),t=e._.filter(t,function(e,t,i){return 0===t||e!==i[t-1]}),t=e._.map(t,function(e){return e.replace(/;/g,"")});var n=[];e._.reduceRight(t,function(e,t){var o=e+t.length;return i>=o&&n.push(t),o},0),t=n.reverse();var o=t.join(";");return o.length>=256?this.cleanCustomData(t,i-10):t.join(";")},i.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},i.ID="AnalyticsSuggestions",i.options={omniboxZIndex:e.ComponentOptions.buildNumberOption({defaultValue:52,min:0}),headerTitle:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("SuggestedQueries")}),numberOfSuggestions:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1})},i}(e.Component);e.AnalyticsSuggestions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.options=o,this.topFieldElementHeaderTemplate=e._.template("<div class='coveo-top-field-suggestion-header'>          <span class='coveo-icon-top-field'></span>           <span class='coveo-caption'><%= headerTitle %></span>         </div>"),this.topFieldElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-field-suggestion-row'>           <%= data %>         </div>"),"omniboxSuggestionOptions"in this.options&&(this.options=e._.extend(this.options,this.options.omniboxSuggestionOptions)),this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),this.options.onSelect=this.options.onSelect||this.onRowSelection;var r={header:{template:this.topFieldElementHeaderTemplate,title:this.options.headerTitle},row:this.topFieldElementRowTemplate};this.suggestionForOmnibox=new e.SuggestionForOmnibox(r,e.$.proxy(this.options.onSelect,this)),e.$(this.root).on(e.OmniboxEvents.populateOmnibox,e.$.proxy(this.handlePopulateOmnibox,this))}return __extends(i,t),i.prototype.handlePopulateOmnibox=function(t,i){var n=this;if(e.Assert.exists(i),!this.disabled){var o=i.completeQueryExpression.word,s=e.$.Deferred(),r=this.queryController.getEndpoint().listFieldValues(this.buildListFieldValueRequest(o));r.done(function(e){var t=n.suggestionForOmnibox.buildOmniboxElement(e,i);s.resolve({element:void 0==t?void 0:t.get(0),zIndex:n.options.omniboxZIndex})}),r.fail(function(){n.resolveWithUndefined(s)}),i.rows.push({deferred:s})}},i.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},i.prototype.onRowSelection=function(t,i){var n=this;i.clear(),i.closeOmnibox(),this.queryStateModel.set(e.QueryStateModel.attributesEnum.q,t),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.omniboxField,{})}})},i.prototype.buildListFieldValueRequest=function(e){return{field:this.options.field,ignoreAccents:!0,sortCriteria:"occurrences",maximumNumberOfValues:this.options.numberOfSuggestions,patternType:"Wildcards",pattern:"*"+e+"*",queryOverride:this.options.queryOverride}},i.ID="FieldSuggestions",i.options={field:e.ComponentOptions.buildFieldOption({required:!0}),queryOverride:e.ComponentOptions.buildStringOption({defaultValue:""}),omniboxZIndex:e.ComponentOptions.buildNumberOption({defaultValue:51,min:0}),headerTitle:e.ComponentOptions.buildLocalizedStringOption({defaultValue:e.l("SuggestedResults")}),numberOfSuggestions:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1})},i}(e.Component);e.FieldSuggestions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this._window=r,this._window=this._window||window,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.Assert.exists(n),e.Assert.exists(this.options),this.bind.onRoot(e.QueryEvents.querySuccess,this.handleProcessNewQueryResults),this.skipRedirects=!0}return __extends(i,t),i.prototype.handleProcessNewQueryResults=function(t,i){var n=this;e.Assert.exists(i),e.Assert.exists(i.results),e.$(this.element).empty();var o=!1;return void 0===i.results.triggers?(e.$(this.element).toggleClass("coveo-visible",o),void 0):(this.executeTriggers(i.results.triggers,"notify",function(t){n.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.triggerNotify,{notification:t.content},n.element),e.$("<div/>").addClass("coveo-trigger-notify").text(t.content).appendTo(n.element),o=!0}),this.executeTriggers(i.results.triggers,"redirect",function(t){n.skipRedirects?n.logger.debug("Redirect to '"+t.content+"' skipped on first query."):(n.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.triggerRedirect,{redirectedTo:t.content},n.element),n._window.location.replace(t.content))},!0),this.executeTriggers(i.results.triggers,"execute",function(t){try{var o=window[t.content.name];if("function"==typeof o){var s=e._.object(e._.map(t.content.params,function(e,t){return["param"+(t+1),e]}));s.element=n.element,n.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.triggerExecute,{executed:t.content.name},n.element),o.apply(window,[s])}else n.logger.error("A trigger tried to call the function '"+t.content.name+"' which doesn't exist.",n,i.query,t)}catch(r){n.logger.error("A trigger called the function '"+t.content.name+"' which thrown an error.",n,i.query,t)}}),e.$(this.element).toggleClass("coveo-visible",o),this.skipRedirects=!1,void 0)},i.prototype.executeTriggers=function(t,i,n,o){void 0===o&&(o=!1);var s=e._.filter(t,function(e){return e.type==i}),r=e._.take(s,o?1:Number.MAX_VALUE);e._.each(r,n)},i.ID="Triggers",i.options={},i}(e.Component);e.Triggers=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),null!=r.raw.syssfcreatedby&&(e.$("<span>").text((this.options.useFromInstead?e.l("From"):e.l("PostedBy"))+" ").appendTo(n),e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfcreatedbyid)).text(r.raw.syssfcreatedby).appendTo(n),!this.options.enablePostedOn||e.Utils.isNullOrUndefined(r.raw.sfparentname)||e.Utils.isNullOrUndefined(r.raw.sfparentid)||(e.Utils.isNullOrUndefined(r.raw.sfuserid)||r.raw.sfuserid==r.raw.sfinsertedbyid?e.Utils.isNullOrUndefined(r.raw.sfuserid)&&(e.$("<span>").text(" "+e.l("On").toLowerCase()+" ").appendTo(n),e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfparentid)).text(r.raw.sfparentname).appendTo(n)):e.$("<span>").html(" "+e.l("OnFeed",e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfparentid)).text(r.raw.sfparentname).prop("outerHTML"))).appendTo(n)))}return __extends(i,t),i.ID="ChatterPostedBy",i.options={enablePostedOn:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),useFromInstead:e.ComponentOptions.buildBooleanOption({defaultValue:!1})},i}(e.Component);e.ChatterPostedBy=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),!e.Utils.isNullOrUndefined(r.raw.sflikedby)&&!e.Utils.isNullOrUndefined(r.raw.sflikedbyid)){var a=r.raw.sflikedby.split(";"),l=r.raw.sflikedbyid.split(";"),u=e.$("<div>").addClass("coveo-chatter-result-box-row").appendTo(n);
e.$("<div>").addClass("coveo-sprites-common-thumbup_inactive").addClass("coveo-chatter-result-box-icon").appendTo(u);var c=e.$("<div>").addClass("coveo-chatter-result-likes").appendTo(u);this.renderLikesList(c[0],r,a,l,this.options.nbLikesToRender)}}return __extends(i,t),i.prototype.renderLikesList=function(t,i,n,o,s){for(var r=this,a=e.$("<div>"),l=0;l<o.length-1&&(0==s||s>l);l++)this.renderLikeLink(i,n[l],o[l]).appendTo(a),(0==s||s-1>l)&&l<o.length-2?e.$("<span>").text(", ").appendTo(a):l<o.length-1&&e.$("<span>").text(" "+e.l("And").toLowerCase()+" ").appendTo(a);if(0==s||o.length<=s)this.renderLikeLink(i,n[o.length-1],o[o.length-1]).appendTo(a);else{var u=o.length-s;e.$("<a>").click(function(s){s.preventDefault(),e.$(t).empty(),r.renderLikesList(t,i,n,o,0)}).text(" "+e.l("Others",u.toString(),u)).appendTo(a)}o.length>0&&e.$("<span>").html(e.l("LikesThis",a.html(),o.length)).appendTo(t)},i.prototype.renderLikeLink=function(t,i,n){return e.$("<a>").attr("href",e.ChatterUtils.buildURI(t.raw.sysclickableuri,t.raw.sffeeditemid,n)).text(i)},i.ID="ChatterLikedBy",i.options={nbLikesToRender:e.ComponentOptions.buildNumberOption({defaultValue:2,min:0})},i}(e.Component);e.ChatterLikedBy=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,!e.Utils.isNullOrUndefined(r.raw.coveochatterfeedtopics)){var a=e.$("<div>").addClass("coveo-chatter-result-box-row"),l=r.raw.coveochatterfeedtopics.split(";");e.$("<div>").addClass("coveo-sprites-common-tagging_tag").addClass("coveo-chatter-result-box-icon").appendTo(a);for(var u=0;u<l.length;u++)e.$("<span>").text(l[u]).appendTo(a),u<l.length-1&&e.$("<span>").text(", ").appendTo(a);a.appendTo(n)}}return __extends(i,t),i.ID="ChatterTopic",i}(e.Component);e.ChatterTopic=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){if(t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,!e.Utils.isNullOrUndefined(r.raw.sfcontentversionid)){var a=e.$("<div>").addClass("coveo-chatter-result-box-row").appendTo(n);e.$("<div>").addClass("coveo-sprites-common-system").addClass("coveo-chatter-result-box-icon").appendTo(a);var l=e.$("<a>").attr("href",e.ChatterUtils.buildURI(r.raw.sysclickableuri,r.raw.sffeeditemid,r.raw.sfcontentversionid)).appendTo(a);e.Utils.isNullOrUndefined(r.raw.sfcontentfilename)?l.text(e.l("ShowAttachment")):l.text(r.raw.sfcontentfilename)}}return __extends(i,t),i.ID="ChatterPostAttachment",i}(e.Component);e.ChatterPostAttachment=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).attr("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),e.QueryUtils.hasThumbnail(r)?this.buildThumbnailImage():this.setEmptyThumbnailClass()}return __extends(i,t),i.prototype.buildThumbnailImage=function(){var t=this.bindings.queryController.getEndpoint();t.isJsonp()||e.DeviceUtils.isIE8or9()?this.buildImageWithDirectSrcAttribute(t):this.buildImageWithBase64SrcAttribute(t)},i.prototype.buildImageWithDirectSrcAttribute=function(t){var i=t.getViewAsDatastreamUri(this.result.uniqueId,"$Thumbnail$",{contentType:"image/png"});e.$(this.element).attr("src",i)},i.prototype.buildImageWithBase64SrcAttribute=function(t){var i=this;t.getRawDataStream(this.result.uniqueId,"$Thumbnail$").done(function(t){var n=String.fromCharCode.apply(null,new Uint8Array(t));e.$(i.element).attr("src","data:image/png;base64, "+btoa(n))}).fail(function(){i.setEmptyThumbnailClass()})},i.prototype.setEmptyThumbnailClass=function(){e.$(this.element).addClass(this.options.noThumbnailClass)},i.ID="Thumbnail",i.options={noThumbnailClass:e.ComponentOptions.buildStringOption({defaultValue:"coveo-no-thumbnail"})},i}(e.Component);e.Thumbnail=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o);var l=e.$('<a class="'+e.Component.computeCssClassNameForType(e.ResultLink.ID)+'" />'),u=e.$("<div />").addClass("coveo-youtube-thumbnail-container").appendTo(l);e.$("<img />").css({width:this.options.width}).attr("src",r.raw.ytthumbnailurl).addClass("coveo-youtube-thumbnail-img").appendTo(u),e.$("<span></span>").addClass("coveo-youtube-thumbnail-play-button").appendTo(u),e.$(this.element).append(l),this.options.embed&&(this.options=e._.extend(this.options,{onClick:function(){return a.handleOnClick()}}));var c=this.searchInterface.options.originalOptionsObject,p=e._.extend({},this.getBindings(),{resultElement:n}),d={options:e._.extend({},{initOptions:{ResultLink:o}},c),bindings:p,result:r};e.CoveoJQuery.automaticallyCreateComponentsInside(n,d)}return __extends(i,t),i.prototype.handleOnClick=function(){var t=this,i=e.$("<iframe />"),n=e.$("<div></div>");i.attr({src:"https://www.youtube.com/embed/"+this.extractVideoId()+"?autoplay=1",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",width:"100%",height:"100%"}),n.append(i),this.modalbox=e.ModalBox.open(n,{overlayClose:!0,title:e.JQueryUtils.getQuickviewHeader(this.result,{showDate:!0,title:this.result.title},this.bindings),className:"coveo-quick-view coveo-youtube-player",validation:function(){return!0},body:this.element.ownerDocument.body}),e.$(this.modalbox.wrapper.find(".coveo-quickview-close-button")).click(function(){t.modalbox.close()})},i.prototype.extractVideoId=function(){return this.result.clickUri.split("watch?v=")[1]},i.ID="YouTubeThumbnail",i.options={width:e.ComponentOptions.buildStringOption({defaultValue:"200px"}),embed:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},i}(e.Component);e.YouTubeThumbnail=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Lowest=1]="Lowest",e[e.Low=2]="Low",e[e.Average=3]="Average",e[e.Good=4]="Good",e[e.Best=5]="Best"}(e.RatingValues||(e.RatingValues={}));var t=e.RatingValues,i=function(i){function n(t,o,s,r){i.call(this,t,n.ID,s),this.element=t,this.options=o,this.bindings=s,this.result=r,this.options=e.ComponentOptions.initComponentOptions(t,n,o),e.Utils.isNullOrUndefined(r.rating)||this.renderComponent(t,r.rating)}return __extends(n,i),n.prototype.renderComponent=function(e,t){for(var i=1;5>=i;i++)this.renderStars(e,t>=i,i)},n.prototype.renderStars=function(t,i,n){var o=this,s=e.$(t).find('a[rating-value="'+n+'"]');0==s.length&&(s=e.$("<a>").appendTo(t),this.bindings.searchInterface.options.enableCollaborativeRating&&(s.click(function(t){o.rateDocument(+e.$(t.currentTarget).attr("rating-value"))}),s.mouseover(function(i){o.renderComponent(t,parseInt(e.$(i.currentTarget).attr("rating-value"),10))}),s.mouseout(function(){o.renderComponent(t,o.result.rating)})),s.attr("rating-value",n)),s.toggleClass("coveo-sprites-common-star_placeholder",!i),s.toggleClass("coveo-sprites-common-star_active",i)},n.prototype.rateDocument=function(e){var i=this,n={rating:t[e],uniqueId:this.result.uniqueId},o=this.queryController.getEndpoint().rateDocument(n);o.done(function(){i.result.rating=e,i.renderComponent(i.element,e)}),o.fail(function(){i.logger.error("An error occurred while rating the document")})},n.ID="ResultRating",n}(e.Component);e.ResultRating=i,e.CoveoJQuery.registerAutoCreateComponent(i)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),e.$(this.element).text(this.options.value),e.$(this.element).css("font-size",this.options.size),e.$(this.element).css("font-style",this.options.style),e.$(this.element).css("font-weight",this.options.weight),e.$(this.element).css("text-align",this.options.textAlign),e.$(this.element).css("margin-top",this.options.marginTop),e.$(this.element).css("margin-bottom",this.options.marginBottom),e.$(this.element).css("margin-right",this.options.marginRight),e.$(this.element).css("margin-left",this.options.marginLeft),e.$(this.element).css("padding-top",this.options.paddingTop),e.$(this.element).css("padding-bottom",this.options.paddingBottom),e.$(this.element).css("padding-left",this.options.paddingLeft),e.$(this.element).css("padding-right",this.options.paddingRight)}return __extends(i,t),i.ID="Text",i.options={value:e.ComponentOptions.buildLocalizedStringOption(),size:e.ComponentOptions.buildStringOption(),style:e.ComponentOptions.buildStringOption(),weight:e.ComponentOptions.buildStringOption(),textAlign:e.ComponentOptions.buildStringOption(),marginTop:e.ComponentOptions.buildStringOption(),marginBottom:e.ComponentOptions.buildStringOption(),marginLeft:e.ComponentOptions.buildStringOption(),marginRight:e.ComponentOptions.buildStringOption(),paddingTop:e.ComponentOptions.buildStringOption(),paddingBottom:e.ComponentOptions.buildStringOption(),paddingLeft:e.ComponentOptions.buildStringOption(),paddingRight:e.ComponentOptions.buildStringOption()},i}(e.Component);e.Text=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){var r=this;t.call(this,n,i.ID,s),this.element=n,this.options=o,this.bindings=s,this.options=e.ComponentOptions.initComponentOptions(n,i,o),"undefined"!=typeof userActionsHandler&&this.setHandler(userActionsHandler),this.render(),this.options.enableBindOnBox&&e.$(n).closest(".CoveoBoxPopup").on("onPopupOpen",function(){r.open()})}return __extends(i,t),i.prototype.setHandler=function(e){this.handler=e},i.prototype.setFilters=function(e){this.options.filters=e},i.prototype.render=function(){var t=this;if(this.options.showButton){this.renderButton().appendTo(this.element).click(function(){t.toggle()})}this.renderPlaceholder().appendTo(this.element),this.loadingBox=e.JQueryUtils.getBasicLoadingDots().hide().appendTo(this.element),this.eventListBox=e.$("<div>").addClass("coveo-useractions-events-list").hide().appendTo(this.element)},i.prototype.open=function(){var t=this;this.eventListBox.is(":empty")&&null!=this.handler?(this.loadingBox.show(),this.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.getUserHistory,null,this.element),this.handler.getDataFromUA(function(e){t.renderEvents(e)})):this.eventListBox.slideDown()},i.prototype.toggle=function(){this.eventListBox.is(":visible")?this.close():this.open()},i.prototype.close=function(){this.eventListBox.is(":visible")&&this.eventListBox.slideUp()},i.prototype.renderEvents=function(t){var i=this;this.eventListBox.empty(),null!=t.message?"NoVisitIdError"==t.type?(this.logger.info(t.message,t.type,t),e.$("<span>").text(e.l("UserActionsNoVisitId")).addClass("coveo-useractions-nodata").appendTo(this.eventListBox)):(this.logger.error(t.message,t.type,t),e.$("<span>").text(e.l("UserActionsErrorOccured")).addClass("coveo-useractions-nodata").appendTo(this.eventListBox)):t.totalNumberOfVisits>0?t.visits[0].numberOfEvents>0&&(this.renderHeaderBox(t.visits[0]).appendTo(this.eventListBox),e._.each(t.visits[0].events,function(t){(e._.contains(i.options.filters,t.eventMetadata.actionCause)||e._.contains(i.options.filters,t.eventMetadata.customEventValue))&&i.renderEvent(t).appendTo(i.eventListBox)})):e.$("<span>").text(e.l("NoData")).addClass("coveo-useractions-nodata").appendTo(this.eventListBox),this.loadingBox.hide(),this.eventListBox.slideToggle()},i.prototype.renderPlaceholder=function(){return e.$("<div>").addClass("coveo-box-popup-toggle").addClass("coveo-useractions-placeholder").append(e.$("<span>").addClass("coveo-box-popup-title").append(e.$("<span>").text(e.l(i.ID))))},i.prototype.renderEvent=function(t){var i=e.$("<div>").addClass("coveo-useractions-event"),n=e.$("<div>").addClass("coveo-useractions-event-right").appendTo(i),o=e.$("<div>").addClass("coveo-useractions-event-left").appendTo(i);return this.renderField(e.l("Time"),new Date(t.dateTime).toLocaleTimeString()).appendTo(o),t.eventMetadata.documentTitle&&t.eventMetadata.documentURL&&this.renderLinkField(e.l("Document"),t.eventMetadata.documentTitle,t.eventMetadata.documentURL).appendTo(n),t.eventMetadata.queryExpression&&this.renderField(e.l("UserQuery"),t.eventMetadata.queryExpression).appendTo(n),"pageView"==t.eventMetadata.customEventValue?this.renderLinkField(t.type,t.eventMetadata.originLevel3,t.eventMetadata.originLevel3).appendTo(n):t.eventMetadata.customEventValue&&this.renderField(t.type,t.eventMetadata.customEventValue).appendTo(n),n.is(":empty")&&this.renderField(e.l("EventType"),t.type+(t.eventMetadata.actionCause?", "+t.eventMetadata.actionCause:"")).appendTo(n),i},i.prototype.renderField=function(t,i){var n=e.$("<div>");return i&&(e.$("<span>").addClass("coveo-useractions-event-title").text(t).appendTo(n),e.$("<span>").addClass("coveo-useractions-event-value-expand").text(i).appendTo(n)),n},i.prototype.renderLinkField=function(t,i,n){var o=e.$("<div>");return i&&(e.$("<span>").addClass("coveo-useractions-event-title").text(t).appendTo(o),e.$("<a>").addClass("coveo-useractions-event-value-expand CoveoResultLink").text(i).attr("href",n).attr("target","_blanc").appendTo(o)),o},i.prototype.renderHeaderBox=function(t){var i=e.$("<div>").addClass("coveo-useractions-event").addClass("coveo-useractions-event-header"),n=e.$("<div>").addClass("coveo-useractions-event-right").appendTo(i),o=e.$("<div>").addClass("coveo-useractions-event-left").appendTo(i),s=new Date(t.events[0].dateTime).toDateString(),r=new Date(t.events[0].dateTime).toLocaleTimeString(),a=e.DateUtils.timeBetween(new Date(t.events[0].dateTime),new Date(t.events[t.numberOfEvents-1].dateTime));return this.renderField(e.l("StartDate"),s).appendTo(o),this.renderField(e.l("StartTime"),r).css("float","left").appendTo(n),this.renderField(e.l("DurationTitle"),a).css("float","right").appendTo(n),i},i.prototype.renderButton=function(){return e.$("<div>").addClass("coveo-useractions-button").append(e.$("<span>").text(e.l("ShowUserActions").toUpperCase()))},i.ID="UserActions",i.DEFAULT_FILTERS=["searchboxSubmit","documentOpen","documentQuickView","pageVisit","pageView","createCase"],i.options={showButton:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableBindOnBox:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),filters:e.ComponentOptions.buildListOption({defaultValue:i.DEFAULT_FILTERS})},i}(e.Component);e.UserActions=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this.element=n,this.options=o,this.result=r,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.result=this.result||this.resolveResult(),this.searchInterface=this.searchInterface||this.resolveSearchInterface(),e.Assert.exists(this.result),"undefined"!=typeof attachToCaseInitDefer&&void 0!=attachToCaseInitDefer&&"undefined"!=typeof attachToCaseInitDefer_LEGACY&&void 0!=attachToCaseInitDefer_LEGACY&&void 0!=attachToCaseHandler?(e.$.when(attachToCaseInitDefer,attachToCaseInitDefer_LEGACY).done(function(){return a.buildAttachToCaseButton()}),e.$(this.element).show()):e.$(this.element).hide()}return __extends(i,t),i.prototype.buildAttachToCaseButton=function(){var t=this;attachToCaseHandler.attachedResults[this.result.raw.sysurihash]?e.$(this.element).text(e.l("Detach")):(e.$(this.element).text(e.l("Attach")),null!=this.result.raw.sfkbid&&(attachToCaseHandler.attachedResults[this.result.raw.sfkbid]?e.$(this.element).text(e.l("Detach")):e.$(this.element).text(e.l("Attach")))),e.$(this.element).click(function(){t.attachToCase()})},i.prototype.isAttached=function(){return"undefined"!=typeof attachToCaseHandler?null!=attachToCaseHandler.attachedResults[this.result.raw.sysurihash]:!1},i.prototype.attachToCase=function(){var t=attachToCaseHandler.attachedResults[this.result.raw.sysurihash];null==t&&null!=this.result.raw.sfkbid&&(t=attachToCaseHandler.attachedResults[this.result.raw.sfkbid]);var i={articleID:this.result.raw.sfkbid,caseID:attachToCaseHandler.caseId,resultUriHash:this.result.raw.sysurihash};e.Utils.isNullOrUndefined(t)?attachToCaseHandler.attachToCase(this.result)?(this.usageAnalytics.logClickEvent(e.AnalyticsActionCauseList.caseAttach,{documentTitle:this.result.title,documentURL:this.result.clickUri},this.result,this.root),this.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.caseAttach,i,this.searchInterface.element),e.$(this.element).text(e.l("Detach"))):alert("Unable to attach the article to the case"):attachToCaseHandler.detachFromCase(attachToCaseHandler.attachedResults[this.result.raw.sysurihash],this.result.raw.sysurihash,this.result.raw.sfkbid)?(this.usageAnalytics.logCustomEvent(e.AnalyticsActionCauseList.caseDetach,i,this.searchInterface.element),e.$(this.element).text(e.l("Attach"))):alert("Unable to detach the article from the case")},i.ID="AttachToCase",i}(e.Component);e.AttachToCase=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(n,o,s){t.call(this,n,i.ID,s),this.element=n,this.options=o,this.options=e.ComponentOptions.initComponentOptions(n,i,o),this.searchButton=new e.SearchButton(e.$("<a/>").appendTo(this.element).get(0),void 0,s);var r=e.$("<div/>").appendTo(this.element),a=this.buildInputTag();a.appendTo(r),this.searchbox=this.options.enableOmnibox?new e.Omnibox(a.get(0),this.options,s):new e.Querybox(a.get(0),this.options,s)}return __extends(i,t),i.prototype.buildInputTag=function(){var t=this;return e.$('<input type="text" autocapitalize="off" autocorrect="off" />').blur(function(i){t.queryStateModel.set(e.QueryStateModel.attributesEnum.q,e.$(i.target).val())})},i.ID="Searchbox",i.parent=e.Omnibox,i.options=e._.extend({},{enableOmnibox:e.ComponentOptions.buildBooleanOption({defaultValue:!1,postProcessing:function(t,i){return i.enableSearchAsYouType?(t&&new e.Logger(document).warn("Cannot initialize omnibox and search as you type at the same time : Disabling omnibox functionnality"),!1):t}}),enableSearchAsYouType:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:e.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),enableQuerySyntax:e.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableWildcards:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:e.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:e.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),partialMatchThreshold:e.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:e.ComponentOptions.buildBooleanOption({defaultValue:!0})},e.Omnibox.options),i}(e.Component);e.Searchbox=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(t){function i(e,n,o,s){t.call(this,e,i.ID,o),this.element=e,this.options=n,this.bindings=o,this._window=s,this._window=this._window||window}return __extends(i,t),i.prototype.getCssClass=function(){return"coveo-export-to-excel"},i.prototype.getMenuItems=function(){var t=this;return[{text:e.l("ExportToExcel"),tooltip:e.l("ExportToExcelDescription"),onOpen:function(){return t.open()},onClose:function(){}}]},i.prototype.open=function(){var t=this.queryController.getLastQuery();if(t){this.logger.debug('Performing query following "Export to Excel" click');var i=this.queryController.getEndpoint();this.usageAnalytics.logSearchEvent(e.AnalyticsActionCauseList.exportToExcel,{}),this._window.location.replace(i.getExportToExcelLink(t))}},i.create=function(e,t,n){return new i(e,t,n)},i.ID="ExportToExcel",i.options={},i}(e.Component);e.ExportToExcel=t,e.CoveoJQuery.registerAutoCreateComponent(t)}(Coveo||(Coveo={}));
Coveo.Logger.disable();
